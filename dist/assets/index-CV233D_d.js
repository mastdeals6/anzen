var OL=Object.defineProperty;var UL=(e,t,r)=>t in e?OL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var jr=(e,t,r)=>UL(e,typeof t!="symbol"?t+"":t,r);function PL(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function DS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function DL(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var RS={exports:{}},Ax={},QS={exports:{}},fr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m0=Symbol.for("react.element"),RL=Symbol.for("react.portal"),QL=Symbol.for("react.fragment"),ML=Symbol.for("react.strict_mode"),HL=Symbol.for("react.profiler"),qL=Symbol.for("react.provider"),KL=Symbol.for("react.context"),$L=Symbol.for("react.forward_ref"),VL=Symbol.for("react.suspense"),GL=Symbol.for("react.memo"),WL=Symbol.for("react.lazy"),U5=Symbol.iterator;function zL(e){return e===null||typeof e!="object"?null:(e=U5&&e[U5]||e["@@iterator"],typeof e=="function"?e:null)}var MS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HS=Object.assign,qS={};function Fd(e,t,r){this.props=e,this.context=t,this.refs=qS,this.updater=r||MS}Fd.prototype.isReactComponent={};Fd.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fd.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function KS(){}KS.prototype=Fd.prototype;function $2(e,t,r){this.props=e,this.context=t,this.refs=qS,this.updater=r||MS}var V2=$2.prototype=new KS;V2.constructor=$2;HS(V2,Fd.prototype);V2.isPureReactComponent=!0;var P5=Array.isArray,$S=Object.prototype.hasOwnProperty,G2={current:null},VS={key:!0,ref:!0,__self:!0,__source:!0};function GS(e,t,r){var n,a={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)$S.call(t,n)&&!VS.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:m0,type:e,key:s,ref:o,props:a,_owner:G2.current}}function XL(e,t){return{$$typeof:m0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function W2(e){return typeof e=="object"&&e!==null&&e.$$typeof===m0}function YL(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var D5=/\/+/g;function O1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?YL(""+e.key):t.toString(36)}function jm(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case m0:case RL:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+O1(o,0):n,P5(a)?(r="",e!=null&&(r=e.replace(D5,"$&/")+"/"),jm(a,t,r,"",function(u){return u})):a!=null&&(W2(a)&&(a=XL(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(D5,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",P5(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+O1(s,l);o+=jm(s,t,r,c,a)}else if(c=zL(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+O1(s,l++),o+=jm(s,t,r,c,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ap(e,t,r){if(e==null)return e;var n=[],a=0;return jm(e,n,"","",function(s){return t.call(r,s,a++)}),n}function JL(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var bs={current:null},Fm={transition:null},ZL={ReactCurrentDispatcher:bs,ReactCurrentBatchConfig:Fm,ReactCurrentOwner:G2};function WS(){throw Error("act(...) is not supported in production builds of React.")}fr.Children={map:Ap,forEach:function(e,t,r){Ap(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ap(e,function(){t++}),t},toArray:function(e){return Ap(e,function(t){return t})||[]},only:function(e){if(!W2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};fr.Component=Fd;fr.Fragment=QL;fr.Profiler=HL;fr.PureComponent=$2;fr.StrictMode=ML;fr.Suspense=VL;fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZL;fr.act=WS;fr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=HS({},e.props),a=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=G2.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)$S.call(t,c)&&!VS.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:m0,type:e.type,key:a,ref:s,props:n,_owner:o}};fr.createContext=function(e){return e={$$typeof:KL,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:qL,_context:e},e.Consumer=e};fr.createElement=GS;fr.createFactory=function(e){var t=GS.bind(null,e);return t.type=e,t};fr.createRef=function(){return{current:null}};fr.forwardRef=function(e){return{$$typeof:$L,render:e}};fr.isValidElement=W2;fr.lazy=function(e){return{$$typeof:WL,_payload:{_status:-1,_result:e},_init:JL}};fr.memo=function(e,t){return{$$typeof:GL,type:e,compare:t===void 0?null:t}};fr.startTransition=function(e){var t=Fm.transition;Fm.transition={};try{e()}finally{Fm.transition=t}};fr.unstable_act=WS;fr.useCallback=function(e,t){return bs.current.useCallback(e,t)};fr.useContext=function(e){return bs.current.useContext(e)};fr.useDebugValue=function(){};fr.useDeferredValue=function(e){return bs.current.useDeferredValue(e)};fr.useEffect=function(e,t){return bs.current.useEffect(e,t)};fr.useId=function(){return bs.current.useId()};fr.useImperativeHandle=function(e,t,r){return bs.current.useImperativeHandle(e,t,r)};fr.useInsertionEffect=function(e,t){return bs.current.useInsertionEffect(e,t)};fr.useLayoutEffect=function(e,t){return bs.current.useLayoutEffect(e,t)};fr.useMemo=function(e,t){return bs.current.useMemo(e,t)};fr.useReducer=function(e,t,r){return bs.current.useReducer(e,t,r)};fr.useRef=function(e){return bs.current.useRef(e)};fr.useState=function(e){return bs.current.useState(e)};fr.useSyncExternalStore=function(e,t,r){return bs.current.useSyncExternalStore(e,t,r)};fr.useTransition=function(){return bs.current.useTransition()};fr.version="18.3.1";QS.exports=fr;var Z=QS.exports;const eO=DS(Z);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tO=Z,rO=Symbol.for("react.element"),nO=Symbol.for("react.fragment"),aO=Object.prototype.hasOwnProperty,sO=tO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iO={key:!0,ref:!0,__self:!0,__source:!0};function zS(e,t,r){var n,a={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)aO.call(t,n)&&!iO.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:rO,type:e,key:s,ref:o,props:a,_owner:sO.current}}Ax.Fragment=nO;Ax.jsx=zS;Ax.jsxs=zS;RS.exports=Ax;var i=RS.exports,XS={exports:{}},li={},YS={exports:{}},JS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,M){var G=W.length;W.push(M);e:for(;0<G;){var H=G-1>>>1,C=W[H];if(0<a(C,M))W[H]=M,W[G]=C,G=H;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var M=W[0],G=W.pop();if(G!==M){W[0]=G;e:for(var H=0,C=W.length,L=C>>>1;H<L;){var O=2*(H+1)-1,D=W[O],P=O+1,Q=W[P];if(0>a(D,G))P<C&&0>a(Q,D)?(W[H]=Q,W[P]=G,H=P):(W[H]=D,W[O]=G,H=O);else if(P<C&&0>a(Q,G))W[H]=Q,W[P]=G,H=P;else break e}}return M}function a(W,M){var G=W.sortIndex-M.sortIndex;return G!==0?G:W.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],A=1,h=null,f=3,d=!1,v=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(W){for(var M=r(u);M!==null;){if(M.callback===null)n(u);else if(M.startTime<=W)n(u),M.sortIndex=M.expirationTime,t(c,M);else break;M=r(u)}}function x(W){if(g=!1,w(W),!v)if(r(c)!==null)v=!0,V(b);else{var M=r(u);M!==null&&X(x,M.startTime-W)}}function b(W,M){v=!1,g&&(g=!1,p(k),k=-1),d=!0;var G=f;try{for(w(M),h=r(c);h!==null&&(!(h.expirationTime>M)||W&&!S());){var H=h.callback;if(typeof H=="function"){h.callback=null,f=h.priorityLevel;var C=H(h.expirationTime<=M);M=e.unstable_now(),typeof C=="function"?h.callback=C:h===r(c)&&n(c),w(M)}else n(c);h=r(c)}if(h!==null)var L=!0;else{var O=r(u);O!==null&&X(x,O.startTime-M),L=!1}return L}finally{h=null,f=G,d=!1}}var B=!1,_=null,k=-1,E=5,T=-1;function S(){return!(e.unstable_now()-T<E)}function j(){if(_!==null){var W=e.unstable_now();T=W;var M=!0;try{M=_(!0,W)}finally{M?I():(B=!1,_=null)}}else B=!1}var I;if(typeof m=="function")I=function(){m(j)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,q=U.port2;U.port1.onmessage=j,I=function(){q.postMessage(null)}}else I=function(){y(j,0)};function V(W){_=W,B||(B=!0,I())}function X(W,M){k=y(function(){W(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){v||d||(v=!0,V(b))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(W){switch(f){case 1:case 2:case 3:var M=3;break;default:M=f}var G=f;f=M;try{return W()}finally{f=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,M){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var G=f;f=W;try{return M()}finally{f=G}},e.unstable_scheduleCallback=function(W,M,G){var H=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?H+G:H):G=H,W){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=G+C,W={id:A++,callback:M,priorityLevel:W,startTime:G,expirationTime:C,sortIndex:-1},G>H?(W.sortIndex=G,t(u,W),r(c)===null&&W===r(u)&&(g?(p(k),k=-1):g=!0,X(x,G-H))):(W.sortIndex=C,t(c,W),v||d||(v=!0,V(b))),W},e.unstable_shouldYield=S,e.unstable_wrapCallback=function(W){var M=f;return function(){var G=f;f=M;try{return W.apply(this,arguments)}finally{f=G}}}})(JS);YS.exports=JS;var oO=YS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lO=Z,ii=oO;function ft(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ZS=new Set,jh={};function zu(e,t){vd(e,t),vd(e+"Capture",t)}function vd(e,t){for(jh[e]=t,e=0;e<t.length;e++)ZS.add(t[e])}var Bl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Oy=Object.prototype.hasOwnProperty,cO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,R5={},Q5={};function uO(e){return Oy.call(Q5,e)?!0:Oy.call(R5,e)?!1:cO.test(e)?Q5[e]=!0:(R5[e]=!0,!1)}function AO(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function dO(e,t,r,n){if(t===null||typeof t>"u"||AO(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _s(e,t,r,n,a,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Da={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Da[e]=new _s(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Da[t]=new _s(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Da[e]=new _s(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Da[e]=new _s(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Da[e]=new _s(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Da[e]=new _s(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Da[e]=new _s(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Da[e]=new _s(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Da[e]=new _s(e,5,!1,e.toLowerCase(),null,!1,!1)});var z2=/[\-:]([a-z])/g;function X2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(z2,X2);Da[t]=new _s(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(z2,X2);Da[t]=new _s(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(z2,X2);Da[t]=new _s(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Da[e]=new _s(e,1,!1,e.toLowerCase(),null,!1,!1)});Da.xlinkHref=new _s("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Da[e]=new _s(e,1,!1,e.toLowerCase(),null,!0,!0)});function Y2(e,t,r,n){var a=Da.hasOwnProperty(t)?Da[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(dO(t,r,a,n)&&(r=null),n||a===null?uO(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Tl=lO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dp=Symbol.for("react.element"),QA=Symbol.for("react.portal"),MA=Symbol.for("react.fragment"),J2=Symbol.for("react.strict_mode"),Uy=Symbol.for("react.profiler"),ek=Symbol.for("react.provider"),tk=Symbol.for("react.context"),Z2=Symbol.for("react.forward_ref"),Py=Symbol.for("react.suspense"),Dy=Symbol.for("react.suspense_list"),eb=Symbol.for("react.memo"),sc=Symbol.for("react.lazy"),rk=Symbol.for("react.offscreen"),M5=Symbol.iterator;function wf(e){return e===null||typeof e!="object"?null:(e=M5&&e[M5]||e["@@iterator"],typeof e=="function"?e:null)}var pn=Object.assign,U1;function qf(e){if(U1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);U1=t&&t[1]||""}return`
`+U1+e}var P1=!1;function D1(e,t){if(!e||P1)return"";P1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),o=a.length-1,l=s.length-1;1<=o&&0<=l&&a[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==s[l]){var c=`
`+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{P1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?qf(e):""}function fO(e){switch(e.tag){case 5:return qf(e.type);case 16:return qf("Lazy");case 13:return qf("Suspense");case 19:return qf("SuspenseList");case 0:case 2:case 15:return e=D1(e.type,!1),e;case 11:return e=D1(e.type.render,!1),e;case 1:return e=D1(e.type,!0),e;default:return""}}function Ry(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case MA:return"Fragment";case QA:return"Portal";case Uy:return"Profiler";case J2:return"StrictMode";case Py:return"Suspense";case Dy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case tk:return(e.displayName||"Context")+".Consumer";case ek:return(e._context.displayName||"Context")+".Provider";case Z2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case eb:return t=e.displayName||null,t!==null?t:Ry(e.type)||"Memo";case sc:t=e._payload,e=e._init;try{return Ry(e(t))}catch{}}return null}function hO(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ry(t);case 8:return t===J2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function jc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function nk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function pO(e){var t=nk(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fp(e){e._valueTracker||(e._valueTracker=pO(e))}function ak(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=nk(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Zm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Qy(e,t){var r=t.checked;return pn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function H5(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=jc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function sk(e,t){t=t.checked,t!=null&&Y2(e,"checked",t,!1)}function My(e,t){sk(e,t);var r=jc(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Hy(e,t.type,r):t.hasOwnProperty("defaultValue")&&Hy(e,t.type,jc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function q5(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Hy(e,t,r){(t!=="number"||Zm(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Kf=Array.isArray;function td(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+jc(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function qy(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ft(91));return pn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function K5(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ft(92));if(Kf(r)){if(1<r.length)throw Error(ft(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:jc(r)}}function ik(e,t){var r=jc(t.value),n=jc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function $5(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ok(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ky(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ok(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var hp,lk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(hp=hp||document.createElement("div"),hp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=hp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Fh(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ah={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mO=["Webkit","ms","Moz","O"];Object.keys(ah).forEach(function(e){mO.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ah[t]=ah[e]})});function ck(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ah.hasOwnProperty(e)&&ah[e]?(""+t).trim():t+"px"}function uk(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=ck(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var gO=pn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $y(e,t){if(t){if(gO[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ft(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ft(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ft(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ft(62))}}function Vy(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gy=null;function tb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Wy=null,rd=null,nd=null;function V5(e){if(e=v0(e)){if(typeof Wy!="function")throw Error(ft(280));var t=e.stateNode;t&&(t=mx(t),Wy(e.stateNode,e.type,t))}}function Ak(e){rd?nd?nd.push(e):nd=[e]:rd=e}function dk(){if(rd){var e=rd,t=nd;if(nd=rd=null,V5(e),t)for(e=0;e<t.length;e++)V5(t[e])}}function fk(e,t){return e(t)}function hk(){}var R1=!1;function pk(e,t,r){if(R1)return e(t,r);R1=!0;try{return fk(e,t,r)}finally{R1=!1,(rd!==null||nd!==null)&&(hk(),dk())}}function Th(e,t){var r=e.stateNode;if(r===null)return null;var n=mx(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ft(231,t,typeof r));return r}var zy=!1;if(Bl)try{var bf={};Object.defineProperty(bf,"passive",{get:function(){zy=!0}}),window.addEventListener("test",bf,bf),window.removeEventListener("test",bf,bf)}catch{zy=!1}function xO(e,t,r,n,a,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(A){this.onError(A)}}var sh=!1,eg=null,tg=!1,Xy=null,vO={onError:function(e){sh=!0,eg=e}};function yO(e,t,r,n,a,s,o,l,c){sh=!1,eg=null,xO.apply(vO,arguments)}function wO(e,t,r,n,a,s,o,l,c){if(yO.apply(this,arguments),sh){if(sh){var u=eg;sh=!1,eg=null}else throw Error(ft(198));tg||(tg=!0,Xy=u)}}function Xu(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function mk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function G5(e){if(Xu(e)!==e)throw Error(ft(188))}function bO(e){var t=e.alternate;if(!t){if(t=Xu(e),t===null)throw Error(ft(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return G5(a),e;if(s===n)return G5(a),t;s=s.sibling}throw Error(ft(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o)throw Error(ft(189))}}if(r.alternate!==n)throw Error(ft(190))}if(r.tag!==3)throw Error(ft(188));return r.stateNode.current===r?e:t}function gk(e){return e=bO(e),e!==null?xk(e):null}function xk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=xk(e);if(t!==null)return t;e=e.sibling}return null}var vk=ii.unstable_scheduleCallback,W5=ii.unstable_cancelCallback,_O=ii.unstable_shouldYield,NO=ii.unstable_requestPaint,Tn=ii.unstable_now,BO=ii.unstable_getCurrentPriorityLevel,rb=ii.unstable_ImmediatePriority,yk=ii.unstable_UserBlockingPriority,rg=ii.unstable_NormalPriority,CO=ii.unstable_LowPriority,wk=ii.unstable_IdlePriority,dx=null,Oo=null;function EO(e){if(Oo&&typeof Oo.onCommitFiberRoot=="function")try{Oo.onCommitFiberRoot(dx,e,void 0,(e.current.flags&128)===128)}catch{}}var ao=Math.clz32?Math.clz32:jO,SO=Math.log,kO=Math.LN2;function jO(e){return e>>>=0,e===0?32:31-(SO(e)/kO|0)|0}var pp=64,mp=4194304;function $f(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ng(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=$f(l):(s&=o,s!==0&&(n=$f(s)))}else o=r&~a,o!==0?n=$f(o):s!==0&&(n=$f(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ao(t),a=1<<r,n|=e[r],t&=~a;return n}function FO(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TO(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ao(s),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=FO(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Yy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function bk(){var e=pp;return pp<<=1,!(pp&4194240)&&(pp=64),e}function Q1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function g0(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ao(t),e[t]=r}function IO(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ao(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function nb(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ao(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Or=0;function _k(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Nk,ab,Bk,Ck,Ek,Jy=!1,gp=[],vc=null,yc=null,wc=null,Ih=new Map,Lh=new Map,lc=[],LO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function z5(e,t){switch(e){case"focusin":case"focusout":vc=null;break;case"dragenter":case"dragleave":yc=null;break;case"mouseover":case"mouseout":wc=null;break;case"pointerover":case"pointerout":Ih.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lh.delete(t.pointerId)}}function _f(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=v0(t),t!==null&&ab(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function OO(e,t,r,n,a){switch(t){case"focusin":return vc=_f(vc,e,t,r,n,a),!0;case"dragenter":return yc=_f(yc,e,t,r,n,a),!0;case"mouseover":return wc=_f(wc,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Ih.set(s,_f(Ih.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Lh.set(s,_f(Lh.get(s)||null,e,t,r,n,a)),!0}return!1}function Sk(e){var t=yu(e.target);if(t!==null){var r=Xu(t);if(r!==null){if(t=r.tag,t===13){if(t=mk(r),t!==null){e.blockedOn=t,Ek(e.priority,function(){Bk(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Tm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Zy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Gy=n,r.target.dispatchEvent(n),Gy=null}else return t=v0(r),t!==null&&ab(t),e.blockedOn=r,!1;t.shift()}return!0}function X5(e,t,r){Tm(e)&&r.delete(t)}function UO(){Jy=!1,vc!==null&&Tm(vc)&&(vc=null),yc!==null&&Tm(yc)&&(yc=null),wc!==null&&Tm(wc)&&(wc=null),Ih.forEach(X5),Lh.forEach(X5)}function Nf(e,t){e.blockedOn===t&&(e.blockedOn=null,Jy||(Jy=!0,ii.unstable_scheduleCallback(ii.unstable_NormalPriority,UO)))}function Oh(e){function t(a){return Nf(a,e)}if(0<gp.length){Nf(gp[0],e);for(var r=1;r<gp.length;r++){var n=gp[r];n.blockedOn===e&&(n.blockedOn=null)}}for(vc!==null&&Nf(vc,e),yc!==null&&Nf(yc,e),wc!==null&&Nf(wc,e),Ih.forEach(t),Lh.forEach(t),r=0;r<lc.length;r++)n=lc[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<lc.length&&(r=lc[0],r.blockedOn===null);)Sk(r),r.blockedOn===null&&lc.shift()}var ad=Tl.ReactCurrentBatchConfig,ag=!0;function PO(e,t,r,n){var a=Or,s=ad.transition;ad.transition=null;try{Or=1,sb(e,t,r,n)}finally{Or=a,ad.transition=s}}function DO(e,t,r,n){var a=Or,s=ad.transition;ad.transition=null;try{Or=4,sb(e,t,r,n)}finally{Or=a,ad.transition=s}}function sb(e,t,r,n){if(ag){var a=Zy(e,t,r,n);if(a===null)X1(e,t,n,sg,r),z5(e,n);else if(OO(a,e,t,r,n))n.stopPropagation();else if(z5(e,n),t&4&&-1<LO.indexOf(e)){for(;a!==null;){var s=v0(a);if(s!==null&&Nk(s),s=Zy(e,t,r,n),s===null&&X1(e,t,n,sg,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else X1(e,t,n,null,r)}}var sg=null;function Zy(e,t,r,n){if(sg=null,e=tb(n),e=yu(e),e!==null)if(t=Xu(e),t===null)e=null;else if(r=t.tag,r===13){if(e=mk(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return sg=e,null}function kk(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BO()){case rb:return 1;case yk:return 4;case rg:case CO:return 16;case wk:return 536870912;default:return 16}default:return 16}}var Ac=null,ib=null,Im=null;function jk(){if(Im)return Im;var e,t=ib,r=t.length,n,a="value"in Ac?Ac.value:Ac.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[s-n];n++);return Im=a.slice(e,1<n?1-n:void 0)}function Lm(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function xp(){return!0}function Y5(){return!1}function ci(e){function t(r,n,a,s,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?xp:Y5,this.isPropagationStopped=Y5,this}return pn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=xp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=xp)},persist:function(){},isPersistent:xp}),t}var Td={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ob=ci(Td),x0=pn({},Td,{view:0,detail:0}),RO=ci(x0),M1,H1,Bf,fx=pn({},x0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lb,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bf&&(Bf&&e.type==="mousemove"?(M1=e.screenX-Bf.screenX,H1=e.screenY-Bf.screenY):H1=M1=0,Bf=e),M1)},movementY:function(e){return"movementY"in e?e.movementY:H1}}),J5=ci(fx),QO=pn({},fx,{dataTransfer:0}),MO=ci(QO),HO=pn({},x0,{relatedTarget:0}),q1=ci(HO),qO=pn({},Td,{animationName:0,elapsedTime:0,pseudoElement:0}),KO=ci(qO),$O=pn({},Td,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),VO=ci($O),GO=pn({},Td,{data:0}),Z5=ci(GO),WO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},XO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function YO(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=XO[e])?!!t[e]:!1}function lb(){return YO}var JO=pn({},x0,{key:function(e){if(e.key){var t=WO[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Lm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?zO[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lb,charCode:function(e){return e.type==="keypress"?Lm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ZO=ci(JO),eU=pn({},fx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),e4=ci(eU),tU=pn({},x0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lb}),rU=ci(tU),nU=pn({},Td,{propertyName:0,elapsedTime:0,pseudoElement:0}),aU=ci(nU),sU=pn({},fx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),iU=ci(sU),oU=[9,13,27,32],cb=Bl&&"CompositionEvent"in window,ih=null;Bl&&"documentMode"in document&&(ih=document.documentMode);var lU=Bl&&"TextEvent"in window&&!ih,Fk=Bl&&(!cb||ih&&8<ih&&11>=ih),t4=" ",r4=!1;function Tk(e,t){switch(e){case"keyup":return oU.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ik(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var HA=!1;function cU(e,t){switch(e){case"compositionend":return Ik(t);case"keypress":return t.which!==32?null:(r4=!0,t4);case"textInput":return e=t.data,e===t4&&r4?null:e;default:return null}}function uU(e,t){if(HA)return e==="compositionend"||!cb&&Tk(e,t)?(e=jk(),Im=ib=Ac=null,HA=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fk&&t.locale!=="ko"?null:t.data;default:return null}}var AU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!AU[e.type]:t==="textarea"}function Lk(e,t,r,n){Ak(n),t=ig(t,"onChange"),0<t.length&&(r=new ob("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var oh=null,Uh=null;function dU(e){$k(e,0)}function hx(e){var t=$A(e);if(ak(t))return e}function fU(e,t){if(e==="change")return t}var Ok=!1;if(Bl){var K1;if(Bl){var $1="oninput"in document;if(!$1){var a4=document.createElement("div");a4.setAttribute("oninput","return;"),$1=typeof a4.oninput=="function"}K1=$1}else K1=!1;Ok=K1&&(!document.documentMode||9<document.documentMode)}function s4(){oh&&(oh.detachEvent("onpropertychange",Uk),Uh=oh=null)}function Uk(e){if(e.propertyName==="value"&&hx(Uh)){var t=[];Lk(t,Uh,e,tb(e)),pk(dU,t)}}function hU(e,t,r){e==="focusin"?(s4(),oh=t,Uh=r,oh.attachEvent("onpropertychange",Uk)):e==="focusout"&&s4()}function pU(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hx(Uh)}function mU(e,t){if(e==="click")return hx(t)}function gU(e,t){if(e==="input"||e==="change")return hx(t)}function xU(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var co=typeof Object.is=="function"?Object.is:xU;function Ph(e,t){if(co(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Oy.call(t,a)||!co(e[a],t[a]))return!1}return!0}function i4(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function o4(e,t){var r=i4(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=i4(r)}}function Pk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Pk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Dk(){for(var e=window,t=Zm();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Zm(e.document)}return t}function ub(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function vU(e){var t=Dk(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Pk(r.ownerDocument.documentElement,r)){if(n!==null&&ub(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=o4(r,s);var o=o4(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var yU=Bl&&"documentMode"in document&&11>=document.documentMode,qA=null,ew=null,lh=null,tw=!1;function l4(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;tw||qA==null||qA!==Zm(n)||(n=qA,"selectionStart"in n&&ub(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),lh&&Ph(lh,n)||(lh=n,n=ig(ew,"onSelect"),0<n.length&&(t=new ob("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=qA)))}function vp(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var KA={animationend:vp("Animation","AnimationEnd"),animationiteration:vp("Animation","AnimationIteration"),animationstart:vp("Animation","AnimationStart"),transitionend:vp("Transition","TransitionEnd")},V1={},Rk={};Bl&&(Rk=document.createElement("div").style,"AnimationEvent"in window||(delete KA.animationend.animation,delete KA.animationiteration.animation,delete KA.animationstart.animation),"TransitionEvent"in window||delete KA.transitionend.transition);function px(e){if(V1[e])return V1[e];if(!KA[e])return e;var t=KA[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Rk)return V1[e]=t[r];return e}var Qk=px("animationend"),Mk=px("animationiteration"),Hk=px("animationstart"),qk=px("transitionend"),Kk=new Map,c4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dc(e,t){Kk.set(e,t),zu(t,[e])}for(var G1=0;G1<c4.length;G1++){var W1=c4[G1],wU=W1.toLowerCase(),bU=W1[0].toUpperCase()+W1.slice(1);Dc(wU,"on"+bU)}Dc(Qk,"onAnimationEnd");Dc(Mk,"onAnimationIteration");Dc(Hk,"onAnimationStart");Dc("dblclick","onDoubleClick");Dc("focusin","onFocus");Dc("focusout","onBlur");Dc(qk,"onTransitionEnd");vd("onMouseEnter",["mouseout","mouseover"]);vd("onMouseLeave",["mouseout","mouseover"]);vd("onPointerEnter",["pointerout","pointerover"]);vd("onPointerLeave",["pointerout","pointerover"]);zu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));zu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));zu("onBeforeInput",["compositionend","keypress","textInput","paste"]);zu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));zu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));zu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_U=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vf));function u4(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,wO(n,t,void 0,e),e.currentTarget=null}function $k(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&a.isPropagationStopped())break e;u4(a,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&a.isPropagationStopped())break e;u4(a,l,u),s=c}}}if(tg)throw e=Xy,tg=!1,Xy=null,e}function Xr(e,t){var r=t[iw];r===void 0&&(r=t[iw]=new Set);var n=e+"__bubble";r.has(n)||(Vk(t,e,2,!1),r.add(n))}function z1(e,t,r){var n=0;t&&(n|=4),Vk(r,e,n,t)}var yp="_reactListening"+Math.random().toString(36).slice(2);function Dh(e){if(!e[yp]){e[yp]=!0,ZS.forEach(function(r){r!=="selectionchange"&&(_U.has(r)||z1(r,!1,e),z1(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[yp]||(t[yp]=!0,z1("selectionchange",!1,t))}}function Vk(e,t,r,n){switch(kk(t)){case 1:var a=PO;break;case 4:a=DO;break;default:a=sb}r=a.bind(null,t,r,e),a=void 0,!zy||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function X1(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=yu(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}pk(function(){var u=s,A=tb(r),h=[];e:{var f=Kk.get(e);if(f!==void 0){var d=ob,v=e;switch(e){case"keypress":if(Lm(r)===0)break e;case"keydown":case"keyup":d=ZO;break;case"focusin":v="focus",d=q1;break;case"focusout":v="blur",d=q1;break;case"beforeblur":case"afterblur":d=q1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=J5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=MO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=rU;break;case Qk:case Mk:case Hk:d=KO;break;case qk:d=aU;break;case"scroll":d=RO;break;case"wheel":d=iU;break;case"copy":case"cut":case"paste":d=VO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=e4}var g=(t&4)!==0,y=!g&&e==="scroll",p=g?f!==null?f+"Capture":null:f;g=[];for(var m=u,w;m!==null;){w=m;var x=w.stateNode;if(w.tag===5&&x!==null&&(w=x,p!==null&&(x=Th(m,p),x!=null&&g.push(Rh(m,x,w)))),y)break;m=m.return}0<g.length&&(f=new d(f,v,null,r,A),h.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",f&&r!==Gy&&(v=r.relatedTarget||r.fromElement)&&(yu(v)||v[Cl]))break e;if((d||f)&&(f=A.window===A?A:(f=A.ownerDocument)?f.defaultView||f.parentWindow:window,d?(v=r.relatedTarget||r.toElement,d=u,v=v?yu(v):null,v!==null&&(y=Xu(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(d=null,v=u),d!==v)){if(g=J5,x="onMouseLeave",p="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(g=e4,x="onPointerLeave",p="onPointerEnter",m="pointer"),y=d==null?f:$A(d),w=v==null?f:$A(v),f=new g(x,m+"leave",d,r,A),f.target=y,f.relatedTarget=w,x=null,yu(A)===u&&(g=new g(p,m+"enter",v,r,A),g.target=w,g.relatedTarget=y,x=g),y=x,d&&v)t:{for(g=d,p=v,m=0,w=g;w;w=pA(w))m++;for(w=0,x=p;x;x=pA(x))w++;for(;0<m-w;)g=pA(g),m--;for(;0<w-m;)p=pA(p),w--;for(;m--;){if(g===p||p!==null&&g===p.alternate)break t;g=pA(g),p=pA(p)}g=null}else g=null;d!==null&&A4(h,f,d,g,!1),v!==null&&y!==null&&A4(h,y,v,g,!0)}}e:{if(f=u?$A(u):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var b=fU;else if(n4(f))if(Ok)b=gU;else{b=pU;var B=hU}else(d=f.nodeName)&&d.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=mU);if(b&&(b=b(e,u))){Lk(h,b,r,A);break e}B&&B(e,f,u),e==="focusout"&&(B=f._wrapperState)&&B.controlled&&f.type==="number"&&Hy(f,"number",f.value)}switch(B=u?$A(u):window,e){case"focusin":(n4(B)||B.contentEditable==="true")&&(qA=B,ew=u,lh=null);break;case"focusout":lh=ew=qA=null;break;case"mousedown":tw=!0;break;case"contextmenu":case"mouseup":case"dragend":tw=!1,l4(h,r,A);break;case"selectionchange":if(yU)break;case"keydown":case"keyup":l4(h,r,A)}var _;if(cb)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else HA?Tk(e,r)&&(k="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(Fk&&r.locale!=="ko"&&(HA||k!=="onCompositionStart"?k==="onCompositionEnd"&&HA&&(_=jk()):(Ac=A,ib="value"in Ac?Ac.value:Ac.textContent,HA=!0)),B=ig(u,k),0<B.length&&(k=new Z5(k,e,null,r,A),h.push({event:k,listeners:B}),_?k.data=_:(_=Ik(r),_!==null&&(k.data=_)))),(_=lU?cU(e,r):uU(e,r))&&(u=ig(u,"onBeforeInput"),0<u.length&&(A=new Z5("onBeforeInput","beforeinput",null,r,A),h.push({event:A,listeners:u}),A.data=_))}$k(h,t)})}function Rh(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ig(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Th(e,r),s!=null&&n.unshift(Rh(e,s,a)),s=Th(e,t),s!=null&&n.push(Rh(e,s,a))),e=e.return}return n}function pA(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function A4(e,t,r,n,a){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=Th(r,s),c!=null&&o.unshift(Rh(r,c,l))):a||(c=Th(r,s),c!=null&&o.push(Rh(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var NU=/\r\n?/g,BU=/\u0000|\uFFFD/g;function d4(e){return(typeof e=="string"?e:""+e).replace(NU,`
`).replace(BU,"")}function wp(e,t,r){if(t=d4(t),d4(e)!==t&&r)throw Error(ft(425))}function og(){}var rw=null,nw=null;function aw(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var sw=typeof setTimeout=="function"?setTimeout:void 0,CU=typeof clearTimeout=="function"?clearTimeout:void 0,f4=typeof Promise=="function"?Promise:void 0,EU=typeof queueMicrotask=="function"?queueMicrotask:typeof f4<"u"?function(e){return f4.resolve(null).then(e).catch(SU)}:sw;function SU(e){setTimeout(function(){throw e})}function Y1(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Oh(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Oh(t)}function bc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function h4(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Id=Math.random().toString(36).slice(2),Fo="__reactFiber$"+Id,Qh="__reactProps$"+Id,Cl="__reactContainer$"+Id,iw="__reactEvents$"+Id,kU="__reactListeners$"+Id,jU="__reactHandles$"+Id;function yu(e){var t=e[Fo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Cl]||r[Fo]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=h4(e);e!==null;){if(r=e[Fo])return r;e=h4(e)}return t}e=r,r=e.parentNode}return null}function v0(e){return e=e[Fo]||e[Cl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function $A(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ft(33))}function mx(e){return e[Qh]||null}var ow=[],VA=-1;function Rc(e){return{current:e}}function en(e){0>VA||(e.current=ow[VA],ow[VA]=null,VA--)}function Gr(e,t){VA++,ow[VA]=e.current,e.current=t}var Fc={},ns=Rc(Fc),js=Rc(!1),Ou=Fc;function yd(e,t){var r=e.type.contextTypes;if(!r)return Fc;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Fs(e){return e=e.childContextTypes,e!=null}function lg(){en(js),en(ns)}function p4(e,t,r){if(ns.current!==Fc)throw Error(ft(168));Gr(ns,t),Gr(js,r)}function Gk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ft(108,hO(e)||"Unknown",a));return pn({},r,n)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Fc,Ou=ns.current,Gr(ns,e),Gr(js,js.current),!0}function m4(e,t,r){var n=e.stateNode;if(!n)throw Error(ft(169));r?(e=Gk(e,t,Ou),n.__reactInternalMemoizedMergedChildContext=e,en(js),en(ns),Gr(ns,e)):en(js),Gr(js,r)}var pl=null,gx=!1,J1=!1;function Wk(e){pl===null?pl=[e]:pl.push(e)}function FU(e){gx=!0,Wk(e)}function Qc(){if(!J1&&pl!==null){J1=!0;var e=0,t=Or;try{var r=pl;for(Or=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}pl=null,gx=!1}catch(a){throw pl!==null&&(pl=pl.slice(e+1)),vk(rb,Qc),a}finally{Or=t,J1=!1}}return null}var GA=[],WA=0,ug=null,Ag=0,bi=[],_i=0,Uu=null,gl=1,xl="";function cu(e,t){GA[WA++]=Ag,GA[WA++]=ug,ug=e,Ag=t}function zk(e,t,r){bi[_i++]=gl,bi[_i++]=xl,bi[_i++]=Uu,Uu=e;var n=gl;e=xl;var a=32-ao(n)-1;n&=~(1<<a),r+=1;var s=32-ao(t)+a;if(30<s){var o=a-a%5;s=(n&(1<<o)-1).toString(32),n>>=o,a-=o,gl=1<<32-ao(t)+a|r<<a|n,xl=s+e}else gl=1<<s|r<<a|n,xl=e}function Ab(e){e.return!==null&&(cu(e,1),zk(e,1,0))}function db(e){for(;e===ug;)ug=GA[--WA],GA[WA]=null,Ag=GA[--WA],GA[WA]=null;for(;e===Uu;)Uu=bi[--_i],bi[_i]=null,xl=bi[--_i],bi[_i]=null,gl=bi[--_i],bi[_i]=null}var ai=null,ri=null,sn=!1,eo=null;function Xk(e,t){var r=Bi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function g4(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ai=e,ri=bc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ai=e,ri=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Uu!==null?{id:gl,overflow:xl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Bi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ai=e,ri=null,!0):!1;default:return!1}}function lw(e){return(e.mode&1)!==0&&(e.flags&128)===0}function cw(e){if(sn){var t=ri;if(t){var r=t;if(!g4(e,t)){if(lw(e))throw Error(ft(418));t=bc(r.nextSibling);var n=ai;t&&g4(e,t)?Xk(n,r):(e.flags=e.flags&-4097|2,sn=!1,ai=e)}}else{if(lw(e))throw Error(ft(418));e.flags=e.flags&-4097|2,sn=!1,ai=e}}}function x4(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ai=e}function bp(e){if(e!==ai)return!1;if(!sn)return x4(e),sn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!aw(e.type,e.memoizedProps)),t&&(t=ri)){if(lw(e))throw Yk(),Error(ft(418));for(;t;)Xk(e,t),t=bc(t.nextSibling)}if(x4(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ft(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ri=bc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ri=null}}else ri=ai?bc(e.stateNode.nextSibling):null;return!0}function Yk(){for(var e=ri;e;)e=bc(e.nextSibling)}function wd(){ri=ai=null,sn=!1}function fb(e){eo===null?eo=[e]:eo.push(e)}var TU=Tl.ReactCurrentBatchConfig;function Cf(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ft(309));var n=r.stateNode}if(!n)throw Error(ft(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=a.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(ft(284));if(!r._owner)throw Error(ft(290,e))}return e}function _p(e,t){throw e=Object.prototype.toString.call(t),Error(ft(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function v4(e){var t=e._init;return t(e._payload)}function Jk(e){function t(p,m){if(e){var w=p.deletions;w===null?(p.deletions=[m],p.flags|=16):w.push(m)}}function r(p,m){if(!e)return null;for(;m!==null;)t(p,m),m=m.sibling;return null}function n(p,m){for(p=new Map;m!==null;)m.key!==null?p.set(m.key,m):p.set(m.index,m),m=m.sibling;return p}function a(p,m){return p=Cc(p,m),p.index=0,p.sibling=null,p}function s(p,m,w){return p.index=w,e?(w=p.alternate,w!==null?(w=w.index,w<m?(p.flags|=2,m):w):(p.flags|=2,m)):(p.flags|=1048576,m)}function o(p){return e&&p.alternate===null&&(p.flags|=2),p}function l(p,m,w,x){return m===null||m.tag!==6?(m=sv(w,p.mode,x),m.return=p,m):(m=a(m,w),m.return=p,m)}function c(p,m,w,x){var b=w.type;return b===MA?A(p,m,w.props.children,x,w.key):m!==null&&(m.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===sc&&v4(b)===m.type)?(x=a(m,w.props),x.ref=Cf(p,m,w),x.return=p,x):(x=Mm(w.type,w.key,w.props,null,p.mode,x),x.ref=Cf(p,m,w),x.return=p,x)}function u(p,m,w,x){return m===null||m.tag!==4||m.stateNode.containerInfo!==w.containerInfo||m.stateNode.implementation!==w.implementation?(m=iv(w,p.mode,x),m.return=p,m):(m=a(m,w.children||[]),m.return=p,m)}function A(p,m,w,x,b){return m===null||m.tag!==7?(m=Eu(w,p.mode,x,b),m.return=p,m):(m=a(m,w),m.return=p,m)}function h(p,m,w){if(typeof m=="string"&&m!==""||typeof m=="number")return m=sv(""+m,p.mode,w),m.return=p,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case dp:return w=Mm(m.type,m.key,m.props,null,p.mode,w),w.ref=Cf(p,null,m),w.return=p,w;case QA:return m=iv(m,p.mode,w),m.return=p,m;case sc:var x=m._init;return h(p,x(m._payload),w)}if(Kf(m)||wf(m))return m=Eu(m,p.mode,w,null),m.return=p,m;_p(p,m)}return null}function f(p,m,w,x){var b=m!==null?m.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return b!==null?null:l(p,m,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case dp:return w.key===b?c(p,m,w,x):null;case QA:return w.key===b?u(p,m,w,x):null;case sc:return b=w._init,f(p,m,b(w._payload),x)}if(Kf(w)||wf(w))return b!==null?null:A(p,m,w,x,null);_p(p,w)}return null}function d(p,m,w,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return p=p.get(w)||null,l(m,p,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case dp:return p=p.get(x.key===null?w:x.key)||null,c(m,p,x,b);case QA:return p=p.get(x.key===null?w:x.key)||null,u(m,p,x,b);case sc:var B=x._init;return d(p,m,w,B(x._payload),b)}if(Kf(x)||wf(x))return p=p.get(w)||null,A(m,p,x,b,null);_p(m,x)}return null}function v(p,m,w,x){for(var b=null,B=null,_=m,k=m=0,E=null;_!==null&&k<w.length;k++){_.index>k?(E=_,_=null):E=_.sibling;var T=f(p,_,w[k],x);if(T===null){_===null&&(_=E);break}e&&_&&T.alternate===null&&t(p,_),m=s(T,m,k),B===null?b=T:B.sibling=T,B=T,_=E}if(k===w.length)return r(p,_),sn&&cu(p,k),b;if(_===null){for(;k<w.length;k++)_=h(p,w[k],x),_!==null&&(m=s(_,m,k),B===null?b=_:B.sibling=_,B=_);return sn&&cu(p,k),b}for(_=n(p,_);k<w.length;k++)E=d(_,p,k,w[k],x),E!==null&&(e&&E.alternate!==null&&_.delete(E.key===null?k:E.key),m=s(E,m,k),B===null?b=E:B.sibling=E,B=E);return e&&_.forEach(function(S){return t(p,S)}),sn&&cu(p,k),b}function g(p,m,w,x){var b=wf(w);if(typeof b!="function")throw Error(ft(150));if(w=b.call(w),w==null)throw Error(ft(151));for(var B=b=null,_=m,k=m=0,E=null,T=w.next();_!==null&&!T.done;k++,T=w.next()){_.index>k?(E=_,_=null):E=_.sibling;var S=f(p,_,T.value,x);if(S===null){_===null&&(_=E);break}e&&_&&S.alternate===null&&t(p,_),m=s(S,m,k),B===null?b=S:B.sibling=S,B=S,_=E}if(T.done)return r(p,_),sn&&cu(p,k),b;if(_===null){for(;!T.done;k++,T=w.next())T=h(p,T.value,x),T!==null&&(m=s(T,m,k),B===null?b=T:B.sibling=T,B=T);return sn&&cu(p,k),b}for(_=n(p,_);!T.done;k++,T=w.next())T=d(_,p,k,T.value,x),T!==null&&(e&&T.alternate!==null&&_.delete(T.key===null?k:T.key),m=s(T,m,k),B===null?b=T:B.sibling=T,B=T);return e&&_.forEach(function(j){return t(p,j)}),sn&&cu(p,k),b}function y(p,m,w,x){if(typeof w=="object"&&w!==null&&w.type===MA&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case dp:e:{for(var b=w.key,B=m;B!==null;){if(B.key===b){if(b=w.type,b===MA){if(B.tag===7){r(p,B.sibling),m=a(B,w.props.children),m.return=p,p=m;break e}}else if(B.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===sc&&v4(b)===B.type){r(p,B.sibling),m=a(B,w.props),m.ref=Cf(p,B,w),m.return=p,p=m;break e}r(p,B);break}else t(p,B);B=B.sibling}w.type===MA?(m=Eu(w.props.children,p.mode,x,w.key),m.return=p,p=m):(x=Mm(w.type,w.key,w.props,null,p.mode,x),x.ref=Cf(p,m,w),x.return=p,p=x)}return o(p);case QA:e:{for(B=w.key;m!==null;){if(m.key===B)if(m.tag===4&&m.stateNode.containerInfo===w.containerInfo&&m.stateNode.implementation===w.implementation){r(p,m.sibling),m=a(m,w.children||[]),m.return=p,p=m;break e}else{r(p,m);break}else t(p,m);m=m.sibling}m=iv(w,p.mode,x),m.return=p,p=m}return o(p);case sc:return B=w._init,y(p,m,B(w._payload),x)}if(Kf(w))return v(p,m,w,x);if(wf(w))return g(p,m,w,x);_p(p,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,m!==null&&m.tag===6?(r(p,m.sibling),m=a(m,w),m.return=p,p=m):(r(p,m),m=sv(w,p.mode,x),m.return=p,p=m),o(p)):r(p,m)}return y}var bd=Jk(!0),Zk=Jk(!1),dg=Rc(null),fg=null,zA=null,hb=null;function pb(){hb=zA=fg=null}function mb(e){var t=dg.current;en(dg),e._currentValue=t}function uw(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function sd(e,t){fg=e,hb=zA=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ks=!0),e.firstContext=null)}function Fi(e){var t=e._currentValue;if(hb!==e)if(e={context:e,memoizedValue:t,next:null},zA===null){if(fg===null)throw Error(ft(308));zA=e,fg.dependencies={lanes:0,firstContext:e}}else zA=zA.next=e;return t}var wu=null;function gb(e){wu===null?wu=[e]:wu.push(e)}function e3(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,gb(t)):(r.next=a.next,a.next=r),t.interleaved=r,El(e,n)}function El(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ic=!1;function xb(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function t3(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function yl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _c(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,yr&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,El(e,r)}return a=n.interleaved,a===null?(t.next=t,gb(n)):(t.next=a.next,a.next=t),n.interleaved=t,El(e,r)}function Om(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,nb(e,r)}}function y4(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function hg(e,t,r,n){var a=e.updateQueue;ic=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var A=e.alternate;A!==null&&(A=A.updateQueue,l=A.lastBaseUpdate,l!==o&&(l===null?A.firstBaseUpdate=u:l.next=u,A.lastBaseUpdate=c))}if(s!==null){var h=a.baseState;o=0,A=u=c=null,l=s;do{var f=l.lane,d=l.eventTime;if((n&f)===f){A!==null&&(A=A.next={eventTime:d,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(f=t,d=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){h=v.call(d,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,f=typeof v=="function"?v.call(d,h,f):v,f==null)break e;h=pn({},h,f);break e;case 2:ic=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[l]:f.push(l))}else d={eventTime:d,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},A===null?(u=A=d,c=h):A=A.next=d,o|=f;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;f=l,l=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(A===null&&(c=h),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=A,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Du|=o,e.lanes=o,e.memoizedState=h}}function w4(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ft(191,a));a.call(n)}}}var y0={},Uo=Rc(y0),Mh=Rc(y0),Hh=Rc(y0);function bu(e){if(e===y0)throw Error(ft(174));return e}function vb(e,t){switch(Gr(Hh,t),Gr(Mh,e),Gr(Uo,y0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ky(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ky(t,e)}en(Uo),Gr(Uo,t)}function _d(){en(Uo),en(Mh),en(Hh)}function r3(e){bu(Hh.current);var t=bu(Uo.current),r=Ky(t,e.type);t!==r&&(Gr(Mh,e),Gr(Uo,r))}function yb(e){Mh.current===e&&(en(Uo),en(Mh))}var un=Rc(0);function pg(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Z1=[];function wb(){for(var e=0;e<Z1.length;e++)Z1[e]._workInProgressVersionPrimary=null;Z1.length=0}var Um=Tl.ReactCurrentDispatcher,ev=Tl.ReactCurrentBatchConfig,Pu=0,hn=null,aa=null,pa=null,mg=!1,ch=!1,qh=0,IU=0;function Ma(){throw Error(ft(321))}function bb(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!co(e[r],t[r]))return!1;return!0}function _b(e,t,r,n,a,s){if(Pu=s,hn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Um.current=e===null||e.memoizedState===null?PU:DU,e=r(n,a),ch){s=0;do{if(ch=!1,qh=0,25<=s)throw Error(ft(301));s+=1,pa=aa=null,t.updateQueue=null,Um.current=RU,e=r(n,a)}while(ch)}if(Um.current=gg,t=aa!==null&&aa.next!==null,Pu=0,pa=aa=hn=null,mg=!1,t)throw Error(ft(300));return e}function Nb(){var e=qh!==0;return qh=0,e}function jo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pa===null?hn.memoizedState=pa=e:pa=pa.next=e,pa}function Ti(){if(aa===null){var e=hn.alternate;e=e!==null?e.memoizedState:null}else e=aa.next;var t=pa===null?hn.memoizedState:pa.next;if(t!==null)pa=t,aa=e;else{if(e===null)throw Error(ft(310));aa=e,e={memoizedState:aa.memoizedState,baseState:aa.baseState,baseQueue:aa.baseQueue,queue:aa.queue,next:null},pa===null?hn.memoizedState=pa=e:pa=pa.next=e}return pa}function Kh(e,t){return typeof t=="function"?t(e):t}function tv(e){var t=Ti(),r=t.queue;if(r===null)throw Error(ft(311));r.lastRenderedReducer=e;var n=aa,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=o=null,c=null,u=s;do{var A=u.lane;if((Pu&A)===A)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:A,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=n):c=c.next=h,hn.lanes|=A,Du|=A}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,co(n,t.memoizedState)||(ks=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,hn.lanes|=s,Du|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function rv(e){var t=Ti(),r=t.queue;if(r===null)throw Error(ft(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do s=e(s,o.action),o=o.next;while(o!==a);co(s,t.memoizedState)||(ks=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function n3(){}function a3(e,t){var r=hn,n=Ti(),a=t(),s=!co(n.memoizedState,a);if(s&&(n.memoizedState=a,ks=!0),n=n.queue,Bb(o3.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||pa!==null&&pa.memoizedState.tag&1){if(r.flags|=2048,$h(9,i3.bind(null,r,n,a,t),void 0,null),va===null)throw Error(ft(349));Pu&30||s3(r,t,a)}return a}function s3(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=hn.updateQueue,t===null?(t={lastEffect:null,stores:null},hn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function i3(e,t,r,n){t.value=r,t.getSnapshot=n,l3(t)&&c3(e)}function o3(e,t,r){return r(function(){l3(t)&&c3(e)})}function l3(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!co(e,r)}catch{return!0}}function c3(e){var t=El(e,1);t!==null&&so(t,e,1,-1)}function b4(e){var t=jo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kh,lastRenderedState:e},t.queue=e,e=e.dispatch=UU.bind(null,hn,e),[t.memoizedState,e]}function $h(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=hn.updateQueue,t===null?(t={lastEffect:null,stores:null},hn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function u3(){return Ti().memoizedState}function Pm(e,t,r,n){var a=jo();hn.flags|=e,a.memoizedState=$h(1|t,r,void 0,n===void 0?null:n)}function xx(e,t,r,n){var a=Ti();n=n===void 0?null:n;var s=void 0;if(aa!==null){var o=aa.memoizedState;if(s=o.destroy,n!==null&&bb(n,o.deps)){a.memoizedState=$h(t,r,s,n);return}}hn.flags|=e,a.memoizedState=$h(1|t,r,s,n)}function _4(e,t){return Pm(8390656,8,e,t)}function Bb(e,t){return xx(2048,8,e,t)}function A3(e,t){return xx(4,2,e,t)}function d3(e,t){return xx(4,4,e,t)}function f3(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function h3(e,t,r){return r=r!=null?r.concat([e]):null,xx(4,4,f3.bind(null,t,e),r)}function Cb(){}function p3(e,t){var r=Ti();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&bb(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function m3(e,t){var r=Ti();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&bb(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function g3(e,t,r){return Pu&21?(co(r,t)||(r=bk(),hn.lanes|=r,Du|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ks=!0),e.memoizedState=r)}function LU(e,t){var r=Or;Or=r!==0&&4>r?r:4,e(!0);var n=ev.transition;ev.transition={};try{e(!1),t()}finally{Or=r,ev.transition=n}}function x3(){return Ti().memoizedState}function OU(e,t,r){var n=Bc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},v3(e))y3(t,r);else if(r=e3(e,t,r,n),r!==null){var a=xs();so(r,e,n,a),w3(r,t,n)}}function UU(e,t,r){var n=Bc(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(v3(e))y3(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(a.hasEagerState=!0,a.eagerState=l,co(l,o)){var c=t.interleaved;c===null?(a.next=a,gb(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=e3(e,t,a,n),r!==null&&(a=xs(),so(r,e,n,a),w3(r,t,n))}}function v3(e){var t=e.alternate;return e===hn||t!==null&&t===hn}function y3(e,t){ch=mg=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function w3(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,nb(e,r)}}var gg={readContext:Fi,useCallback:Ma,useContext:Ma,useEffect:Ma,useImperativeHandle:Ma,useInsertionEffect:Ma,useLayoutEffect:Ma,useMemo:Ma,useReducer:Ma,useRef:Ma,useState:Ma,useDebugValue:Ma,useDeferredValue:Ma,useTransition:Ma,useMutableSource:Ma,useSyncExternalStore:Ma,useId:Ma,unstable_isNewReconciler:!1},PU={readContext:Fi,useCallback:function(e,t){return jo().memoizedState=[e,t===void 0?null:t],e},useContext:Fi,useEffect:_4,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Pm(4194308,4,f3.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Pm(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pm(4,2,e,t)},useMemo:function(e,t){var r=jo();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=jo();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=OU.bind(null,hn,e),[n.memoizedState,e]},useRef:function(e){var t=jo();return e={current:e},t.memoizedState=e},useState:b4,useDebugValue:Cb,useDeferredValue:function(e){return jo().memoizedState=e},useTransition:function(){var e=b4(!1),t=e[0];return e=LU.bind(null,e[1]),jo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=hn,a=jo();if(sn){if(r===void 0)throw Error(ft(407));r=r()}else{if(r=t(),va===null)throw Error(ft(349));Pu&30||s3(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,_4(o3.bind(null,n,s,e),[e]),n.flags|=2048,$h(9,i3.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=jo(),t=va.identifierPrefix;if(sn){var r=xl,n=gl;r=(n&~(1<<32-ao(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=qh++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=IU++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},DU={readContext:Fi,useCallback:p3,useContext:Fi,useEffect:Bb,useImperativeHandle:h3,useInsertionEffect:A3,useLayoutEffect:d3,useMemo:m3,useReducer:tv,useRef:u3,useState:function(){return tv(Kh)},useDebugValue:Cb,useDeferredValue:function(e){var t=Ti();return g3(t,aa.memoizedState,e)},useTransition:function(){var e=tv(Kh)[0],t=Ti().memoizedState;return[e,t]},useMutableSource:n3,useSyncExternalStore:a3,useId:x3,unstable_isNewReconciler:!1},RU={readContext:Fi,useCallback:p3,useContext:Fi,useEffect:Bb,useImperativeHandle:h3,useInsertionEffect:A3,useLayoutEffect:d3,useMemo:m3,useReducer:rv,useRef:u3,useState:function(){return rv(Kh)},useDebugValue:Cb,useDeferredValue:function(e){var t=Ti();return aa===null?t.memoizedState=e:g3(t,aa.memoizedState,e)},useTransition:function(){var e=rv(Kh)[0],t=Ti().memoizedState;return[e,t]},useMutableSource:n3,useSyncExternalStore:a3,useId:x3,unstable_isNewReconciler:!1};function Xi(e,t){if(e&&e.defaultProps){t=pn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Aw(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:pn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var vx={isMounted:function(e){return(e=e._reactInternals)?Xu(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=xs(),a=Bc(e),s=yl(n,a);s.payload=t,r!=null&&(s.callback=r),t=_c(e,s,a),t!==null&&(so(t,e,a,n),Om(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=xs(),a=Bc(e),s=yl(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=_c(e,s,a),t!==null&&(so(t,e,a,n),Om(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=xs(),n=Bc(e),a=yl(r,n);a.tag=2,t!=null&&(a.callback=t),t=_c(e,a,n),t!==null&&(so(t,e,n,r),Om(t,e,n))}};function N4(e,t,r,n,a,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!Ph(r,n)||!Ph(a,s):!0}function b3(e,t,r){var n=!1,a=Fc,s=t.contextType;return typeof s=="object"&&s!==null?s=Fi(s):(a=Fs(t)?Ou:ns.current,n=t.contextTypes,s=(n=n!=null)?yd(e,a):Fc),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=vx,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function B4(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&vx.enqueueReplaceState(t,t.state,null)}function dw(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},xb(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Fi(s):(s=Fs(t)?Ou:ns.current,a.context=yd(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Aw(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&vx.enqueueReplaceState(a,a.state,null),hg(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Nd(e,t){try{var r="",n=t;do r+=fO(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function nv(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function fw(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var QU=typeof WeakMap=="function"?WeakMap:Map;function _3(e,t,r){r=yl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){vg||(vg=!0,_w=n),fw(e,t)},r}function N3(e,t,r){r=yl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){fw(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){fw(e,t),typeof n!="function"&&(Nc===null?Nc=new Set([this]):Nc.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function C4(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new QU;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=eP.bind(null,e,t,r),t.then(e,e))}function E4(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function S4(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=yl(-1,1),t.tag=2,_c(r,t,1))),r.lanes|=1),e)}var MU=Tl.ReactCurrentOwner,ks=!1;function fs(e,t,r,n){t.child=e===null?Zk(t,null,r,n):bd(t,e.child,r,n)}function k4(e,t,r,n,a){r=r.render;var s=t.ref;return sd(t,a),n=_b(e,t,r,n,s,a),r=Nb(),e!==null&&!ks?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Sl(e,t,a)):(sn&&r&&Ab(t),t.flags|=1,fs(e,t,n,a),t.child)}function j4(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!Lb(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,B3(e,t,s,n,a)):(e=Mm(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ph,r(o,n)&&e.ref===t.ref)return Sl(e,t,a)}return t.flags|=1,e=Cc(s,n),e.ref=t.ref,e.return=t,t.child=e}function B3(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Ph(s,n)&&e.ref===t.ref)if(ks=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(ks=!0);else return t.lanes=e.lanes,Sl(e,t,a)}return hw(e,t,r,n,a)}function C3(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gr(YA,Ws),Ws|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Gr(YA,Ws),Ws|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Gr(YA,Ws),Ws|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Gr(YA,Ws),Ws|=n;return fs(e,t,a,r),t.child}function E3(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function hw(e,t,r,n,a){var s=Fs(r)?Ou:ns.current;return s=yd(t,s),sd(t,a),r=_b(e,t,r,n,s,a),n=Nb(),e!==null&&!ks?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Sl(e,t,a)):(sn&&n&&Ab(t),t.flags|=1,fs(e,t,r,a),t.child)}function F4(e,t,r,n,a){if(Fs(r)){var s=!0;cg(t)}else s=!1;if(sd(t,a),t.stateNode===null)Dm(e,t),b3(t,r,n),dw(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Fi(u):(u=Fs(r)?Ou:ns.current,u=yd(t,u));var A=r.getDerivedStateFromProps,h=typeof A=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&B4(t,o,n,u),ic=!1;var f=t.memoizedState;o.state=f,hg(t,n,o,a),c=t.memoizedState,l!==n||f!==c||js.current||ic?(typeof A=="function"&&(Aw(t,r,A,n),c=t.memoizedState),(l=ic||N4(t,r,l,n,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,t3(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Xi(t.type,l),o.props=u,h=t.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Fi(c):(c=Fs(r)?Ou:ns.current,c=yd(t,c));var d=r.getDerivedStateFromProps;(A=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&B4(t,o,n,c),ic=!1,f=t.memoizedState,o.state=f,hg(t,n,o,a);var v=t.memoizedState;l!==h||f!==v||js.current||ic?(typeof d=="function"&&(Aw(t,r,d,n),v=t.memoizedState),(u=ic||N4(t,r,u,n,f,v,c)||!1)?(A||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),o.props=n,o.state=v,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return pw(e,t,r,n,s,a)}function pw(e,t,r,n,a,s){E3(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&m4(t,r,!1),Sl(e,t,s);n=t.stateNode,MU.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=bd(t,e.child,null,s),t.child=bd(t,null,l,s)):fs(e,t,l,s),t.memoizedState=n.state,a&&m4(t,r,!0),t.child}function S3(e){var t=e.stateNode;t.pendingContext?p4(e,t.pendingContext,t.pendingContext!==t.context):t.context&&p4(e,t.context,!1),vb(e,t.containerInfo)}function T4(e,t,r,n,a){return wd(),fb(a),t.flags|=256,fs(e,t,r,n),t.child}var mw={dehydrated:null,treeContext:null,retryLane:0};function gw(e){return{baseLanes:e,cachePool:null,transitions:null}}function k3(e,t,r){var n=t.pendingProps,a=un.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Gr(un,a&1),e===null)return cw(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=bx(o,n,0,null),e=Eu(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=gw(r),t.memoizedState=mw,e):Eb(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return HU(e,t,o,n,l,a,r);if(s){s=n.fallback,o=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Cc(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=Cc(l,s):(s=Eu(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?gw(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=mw,n}return s=e.child,e=s.sibling,n=Cc(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Eb(e,t){return t=bx({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Np(e,t,r,n){return n!==null&&fb(n),bd(t,e.child,null,r),e=Eb(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function HU(e,t,r,n,a,s,o){if(r)return t.flags&256?(t.flags&=-257,n=nv(Error(ft(422))),Np(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=bx({mode:"visible",children:n.children},a,0,null),s=Eu(s,a,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&bd(t,e.child,null,o),t.child.memoizedState=gw(o),t.memoizedState=mw,s);if(!(t.mode&1))return Np(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(ft(419)),n=nv(s,n,void 0),Np(e,t,o,n)}if(l=(o&e.childLanes)!==0,ks||l){if(n=va,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,El(e,a),so(n,e,a,-1))}return Ib(),n=nv(Error(ft(421))),Np(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=tP.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ri=bc(a.nextSibling),ai=t,sn=!0,eo=null,e!==null&&(bi[_i++]=gl,bi[_i++]=xl,bi[_i++]=Uu,gl=e.id,xl=e.overflow,Uu=t),t=Eb(t,n.children),t.flags|=4096,t)}function I4(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),uw(e.return,t,r)}function av(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function j3(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(fs(e,t,n.children,r),n=un.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&I4(e,r,t);else if(e.tag===19)I4(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Gr(un,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&pg(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),av(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&pg(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}av(t,!0,r,null,s);break;case"together":av(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Dm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Sl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Du|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ft(153));if(t.child!==null){for(e=t.child,r=Cc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Cc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function qU(e,t,r){switch(t.tag){case 3:S3(t),wd();break;case 5:r3(t);break;case 1:Fs(t.type)&&cg(t);break;case 4:vb(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Gr(dg,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Gr(un,un.current&1),t.flags|=128,null):r&t.child.childLanes?k3(e,t,r):(Gr(un,un.current&1),e=Sl(e,t,r),e!==null?e.sibling:null);Gr(un,un.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return j3(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Gr(un,un.current),n)break;return null;case 22:case 23:return t.lanes=0,C3(e,t,r)}return Sl(e,t,r)}var F3,xw,T3,I3;F3=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};xw=function(){};T3=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,bu(Uo.current);var s=null;switch(r){case"input":a=Qy(e,a),n=Qy(e,n),s=[];break;case"select":a=pn({},a,{value:void 0}),n=pn({},n,{value:void 0}),s=[];break;case"textarea":a=qy(e,a),n=qy(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=og)}$y(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(jh.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(jh.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Xr("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};I3=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ef(e,t){if(!sn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ha(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function KU(e,t,r){var n=t.pendingProps;switch(db(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ha(t),null;case 1:return Fs(t.type)&&lg(),Ha(t),null;case 3:return n=t.stateNode,_d(),en(js),en(ns),wb(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(bp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,eo!==null&&(Cw(eo),eo=null))),xw(e,t),Ha(t),null;case 5:yb(t);var a=bu(Hh.current);if(r=t.type,e!==null&&t.stateNode!=null)T3(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ft(166));return Ha(t),null}if(e=bu(Uo.current),bp(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Fo]=t,n[Qh]=s,e=(t.mode&1)!==0,r){case"dialog":Xr("cancel",n),Xr("close",n);break;case"iframe":case"object":case"embed":Xr("load",n);break;case"video":case"audio":for(a=0;a<Vf.length;a++)Xr(Vf[a],n);break;case"source":Xr("error",n);break;case"img":case"image":case"link":Xr("error",n),Xr("load",n);break;case"details":Xr("toggle",n);break;case"input":H5(n,s),Xr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Xr("invalid",n);break;case"textarea":K5(n,s),Xr("invalid",n)}$y(r,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&wp(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&wp(n.textContent,l,e),a=["children",""+l]):jh.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Xr("scroll",n)}switch(r){case"input":fp(n),q5(n,s,!0);break;case"textarea":fp(n),$5(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=og)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ok(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Fo]=t,e[Qh]=n,F3(e,t,!1,!1),t.stateNode=e;e:{switch(o=Vy(r,n),r){case"dialog":Xr("cancel",e),Xr("close",e),a=n;break;case"iframe":case"object":case"embed":Xr("load",e),a=n;break;case"video":case"audio":for(a=0;a<Vf.length;a++)Xr(Vf[a],e);a=n;break;case"source":Xr("error",e),a=n;break;case"img":case"image":case"link":Xr("error",e),Xr("load",e),a=n;break;case"details":Xr("toggle",e),a=n;break;case"input":H5(e,n),a=Qy(e,n),Xr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=pn({},n,{value:void 0}),Xr("invalid",e);break;case"textarea":K5(e,n),a=qy(e,n),Xr("invalid",e);break;default:a=n}$y(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?uk(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&lk(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Fh(e,c):typeof c=="number"&&Fh(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(jh.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Xr("scroll",e):c!=null&&Y2(e,s,c,o))}switch(r){case"input":fp(e),q5(e,n,!1);break;case"textarea":fp(e),$5(e);break;case"option":n.value!=null&&e.setAttribute("value",""+jc(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?td(e,!!n.multiple,s,!1):n.defaultValue!=null&&td(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=og)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ha(t),null;case 6:if(e&&t.stateNode!=null)I3(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ft(166));if(r=bu(Hh.current),bu(Uo.current),bp(t)){if(n=t.stateNode,r=t.memoizedProps,n[Fo]=t,(s=n.nodeValue!==r)&&(e=ai,e!==null))switch(e.tag){case 3:wp(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&wp(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Fo]=t,t.stateNode=n}return Ha(t),null;case 13:if(en(un),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(sn&&ri!==null&&t.mode&1&&!(t.flags&128))Yk(),wd(),t.flags|=98560,s=!1;else if(s=bp(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ft(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ft(317));s[Fo]=t}else wd(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ha(t),s=!1}else eo!==null&&(Cw(eo),eo=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||un.current&1?oa===0&&(oa=3):Ib())),t.updateQueue!==null&&(t.flags|=4),Ha(t),null);case 4:return _d(),xw(e,t),e===null&&Dh(t.stateNode.containerInfo),Ha(t),null;case 10:return mb(t.type._context),Ha(t),null;case 17:return Fs(t.type)&&lg(),Ha(t),null;case 19:if(en(un),s=t.memoizedState,s===null)return Ha(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)Ef(s,!1);else{if(oa!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=pg(e),o!==null){for(t.flags|=128,Ef(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Gr(un,un.current&1|2),t.child}e=e.sibling}s.tail!==null&&Tn()>Bd&&(t.flags|=128,n=!0,Ef(s,!1),t.lanes=4194304)}else{if(!n)if(e=pg(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ef(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!sn)return Ha(t),null}else 2*Tn()-s.renderingStartTime>Bd&&r!==1073741824&&(t.flags|=128,n=!0,Ef(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Tn(),t.sibling=null,r=un.current,Gr(un,n?r&1|2:r&1),t):(Ha(t),null);case 22:case 23:return Tb(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ws&1073741824&&(Ha(t),t.subtreeFlags&6&&(t.flags|=8192)):Ha(t),null;case 24:return null;case 25:return null}throw Error(ft(156,t.tag))}function $U(e,t){switch(db(t),t.tag){case 1:return Fs(t.type)&&lg(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _d(),en(js),en(ns),wb(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return yb(t),null;case 13:if(en(un),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ft(340));wd()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return en(un),null;case 4:return _d(),null;case 10:return mb(t.type._context),null;case 22:case 23:return Tb(),null;case 24:return null;default:return null}}var Bp=!1,Ja=!1,VU=typeof WeakSet=="function"?WeakSet:Set,St=null;function XA(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){yn(e,t,n)}else r.current=null}function vw(e,t,r){try{r()}catch(n){yn(e,t,n)}}var L4=!1;function GU(e,t){if(rw=ag,e=Dk(),ub(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,A=0,h=e,f=null;t:for(;;){for(var d;h!==r||a!==0&&h.nodeType!==3||(l=o+a),h!==s||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===e)break t;if(f===r&&++u===a&&(l=o),f===s&&++A===n&&(c=o),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(nw={focusedElem:e,selectionRange:r},ag=!1,St=t;St!==null;)if(t=St,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,St=e;else for(;St!==null;){t=St;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,y=v.memoizedState,p=t.stateNode,m=p.getSnapshotBeforeUpdate(t.elementType===t.type?g:Xi(t.type,g),y);p.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ft(163))}}catch(x){yn(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,St=e;break}St=t.return}return v=L4,L4=!1,v}function uh(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&vw(t,r,s)}a=a.next}while(a!==n)}}function yx(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function yw(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function L3(e){var t=e.alternate;t!==null&&(e.alternate=null,L3(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fo],delete t[Qh],delete t[iw],delete t[kU],delete t[jU])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function O3(e){return e.tag===5||e.tag===3||e.tag===4}function O4(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||O3(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ww(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=og));else if(n!==4&&(e=e.child,e!==null))for(ww(e,t,r),e=e.sibling;e!==null;)ww(e,t,r),e=e.sibling}function bw(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(bw(e,t,r),e=e.sibling;e!==null;)bw(e,t,r),e=e.sibling}var Fa=null,Ji=!1;function Jl(e,t,r){for(r=r.child;r!==null;)U3(e,t,r),r=r.sibling}function U3(e,t,r){if(Oo&&typeof Oo.onCommitFiberUnmount=="function")try{Oo.onCommitFiberUnmount(dx,r)}catch{}switch(r.tag){case 5:Ja||XA(r,t);case 6:var n=Fa,a=Ji;Fa=null,Jl(e,t,r),Fa=n,Ji=a,Fa!==null&&(Ji?(e=Fa,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Fa.removeChild(r.stateNode));break;case 18:Fa!==null&&(Ji?(e=Fa,r=r.stateNode,e.nodeType===8?Y1(e.parentNode,r):e.nodeType===1&&Y1(e,r),Oh(e)):Y1(Fa,r.stateNode));break;case 4:n=Fa,a=Ji,Fa=r.stateNode.containerInfo,Ji=!0,Jl(e,t,r),Fa=n,Ji=a;break;case 0:case 11:case 14:case 15:if(!Ja&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&vw(r,t,o),a=a.next}while(a!==n)}Jl(e,t,r);break;case 1:if(!Ja&&(XA(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){yn(r,t,l)}Jl(e,t,r);break;case 21:Jl(e,t,r);break;case 22:r.mode&1?(Ja=(n=Ja)||r.memoizedState!==null,Jl(e,t,r),Ja=n):Jl(e,t,r);break;default:Jl(e,t,r)}}function U4(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new VU),t.forEach(function(n){var a=rP.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ki(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Fa=l.stateNode,Ji=!1;break e;case 3:Fa=l.stateNode.containerInfo,Ji=!0;break e;case 4:Fa=l.stateNode.containerInfo,Ji=!0;break e}l=l.return}if(Fa===null)throw Error(ft(160));U3(s,o,a),Fa=null,Ji=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){yn(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)P3(t,e),t=t.sibling}function P3(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ki(t,e),bo(e),n&4){try{uh(3,e,e.return),yx(3,e)}catch(g){yn(e,e.return,g)}try{uh(5,e,e.return)}catch(g){yn(e,e.return,g)}}break;case 1:Ki(t,e),bo(e),n&512&&r!==null&&XA(r,r.return);break;case 5:if(Ki(t,e),bo(e),n&512&&r!==null&&XA(r,r.return),e.flags&32){var a=e.stateNode;try{Fh(a,"")}catch(g){yn(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&sk(a,s),Vy(l,o);var u=Vy(l,s);for(o=0;o<c.length;o+=2){var A=c[o],h=c[o+1];A==="style"?uk(a,h):A==="dangerouslySetInnerHTML"?lk(a,h):A==="children"?Fh(a,h):Y2(a,A,h,u)}switch(l){case"input":My(a,s);break;case"textarea":ik(a,s);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?td(a,!!s.multiple,d,!1):f!==!!s.multiple&&(s.defaultValue!=null?td(a,!!s.multiple,s.defaultValue,!0):td(a,!!s.multiple,s.multiple?[]:"",!1))}a[Qh]=s}catch(g){yn(e,e.return,g)}}break;case 6:if(Ki(t,e),bo(e),n&4){if(e.stateNode===null)throw Error(ft(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){yn(e,e.return,g)}}break;case 3:if(Ki(t,e),bo(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Oh(t.containerInfo)}catch(g){yn(e,e.return,g)}break;case 4:Ki(t,e),bo(e);break;case 13:Ki(t,e),bo(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(jb=Tn())),n&4&&U4(e);break;case 22:if(A=r!==null&&r.memoizedState!==null,e.mode&1?(Ja=(u=Ja)||A,Ki(t,e),Ja=u):Ki(t,e),bo(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!A&&e.mode&1)for(St=e,A=e.child;A!==null;){for(h=St=A;St!==null;){switch(f=St,d=f.child,f.tag){case 0:case 11:case 14:case 15:uh(4,f,f.return);break;case 1:XA(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){yn(n,r,g)}}break;case 5:XA(f,f.return);break;case 22:if(f.memoizedState!==null){D4(h);continue}}d!==null?(d.return=f,St=d):D4(h)}A=A.sibling}e:for(A=null,h=e;;){if(h.tag===5){if(A===null){A=h;try{a=h.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=ck("display",o))}catch(g){yn(e,e.return,g)}}}else if(h.tag===6){if(A===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){yn(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;A===h&&(A=null),h=h.return}A===h&&(A=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ki(t,e),bo(e),n&4&&U4(e);break;case 21:break;default:Ki(t,e),bo(e)}}function bo(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(O3(r)){var n=r;break e}r=r.return}throw Error(ft(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Fh(a,""),n.flags&=-33);var s=O4(e);bw(e,s,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=O4(e);ww(e,l,o);break;default:throw Error(ft(161))}}catch(c){yn(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function WU(e,t,r){St=e,D3(e)}function D3(e,t,r){for(var n=(e.mode&1)!==0;St!==null;){var a=St,s=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||Bp;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Ja;l=Bp;var u=Ja;if(Bp=o,(Ja=c)&&!u)for(St=a;St!==null;)o=St,c=o.child,o.tag===22&&o.memoizedState!==null?R4(a):c!==null?(c.return=o,St=c):R4(a);for(;s!==null;)St=s,D3(s),s=s.sibling;St=a,Bp=l,Ja=u}P4(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,St=s):P4(e)}}function P4(e){for(;St!==null;){var t=St;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ja||yx(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ja)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Xi(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&w4(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}w4(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var A=u.memoizedState;if(A!==null){var h=A.dehydrated;h!==null&&Oh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ft(163))}Ja||t.flags&512&&yw(t)}catch(f){yn(t,t.return,f)}}if(t===e){St=null;break}if(r=t.sibling,r!==null){r.return=t.return,St=r;break}St=t.return}}function D4(e){for(;St!==null;){var t=St;if(t===e){St=null;break}var r=t.sibling;if(r!==null){r.return=t.return,St=r;break}St=t.return}}function R4(e){for(;St!==null;){var t=St;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{yx(4,t)}catch(c){yn(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){yn(t,a,c)}}var s=t.return;try{yw(t)}catch(c){yn(t,s,c)}break;case 5:var o=t.return;try{yw(t)}catch(c){yn(t,o,c)}}}catch(c){yn(t,t.return,c)}if(t===e){St=null;break}var l=t.sibling;if(l!==null){l.return=t.return,St=l;break}St=t.return}}var zU=Math.ceil,xg=Tl.ReactCurrentDispatcher,Sb=Tl.ReactCurrentOwner,Si=Tl.ReactCurrentBatchConfig,yr=0,va=null,Gn=null,Ua=0,Ws=0,YA=Rc(0),oa=0,Vh=null,Du=0,wx=0,kb=0,Ah=null,Ss=null,jb=0,Bd=1/0,fl=null,vg=!1,_w=null,Nc=null,Cp=!1,dc=null,yg=0,dh=0,Nw=null,Rm=-1,Qm=0;function xs(){return yr&6?Tn():Rm!==-1?Rm:Rm=Tn()}function Bc(e){return e.mode&1?yr&2&&Ua!==0?Ua&-Ua:TU.transition!==null?(Qm===0&&(Qm=bk()),Qm):(e=Or,e!==0||(e=window.event,e=e===void 0?16:kk(e.type)),e):1}function so(e,t,r,n){if(50<dh)throw dh=0,Nw=null,Error(ft(185));g0(e,r,n),(!(yr&2)||e!==va)&&(e===va&&(!(yr&2)&&(wx|=r),oa===4&&cc(e,Ua)),Ts(e,n),r===1&&yr===0&&!(t.mode&1)&&(Bd=Tn()+500,gx&&Qc()))}function Ts(e,t){var r=e.callbackNode;TO(e,t);var n=ng(e,e===va?Ua:0);if(n===0)r!==null&&W5(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&W5(r),t===1)e.tag===0?FU(Q4.bind(null,e)):Wk(Q4.bind(null,e)),EU(function(){!(yr&6)&&Qc()}),r=null;else{switch(_k(n)){case 1:r=rb;break;case 4:r=yk;break;case 16:r=rg;break;case 536870912:r=wk;break;default:r=rg}r=V3(r,R3.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function R3(e,t){if(Rm=-1,Qm=0,yr&6)throw Error(ft(327));var r=e.callbackNode;if(id()&&e.callbackNode!==r)return null;var n=ng(e,e===va?Ua:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=wg(e,n);else{t=n;var a=yr;yr|=2;var s=M3();(va!==e||Ua!==t)&&(fl=null,Bd=Tn()+500,Cu(e,t));do try{JU();break}catch(l){Q3(e,l)}while(!0);pb(),xg.current=s,yr=a,Gn!==null?t=0:(va=null,Ua=0,t=oa)}if(t!==0){if(t===2&&(a=Yy(e),a!==0&&(n=a,t=Bw(e,a))),t===1)throw r=Vh,Cu(e,0),cc(e,n),Ts(e,Tn()),r;if(t===6)cc(e,n);else{if(a=e.current.alternate,!(n&30)&&!XU(a)&&(t=wg(e,n),t===2&&(s=Yy(e),s!==0&&(n=s,t=Bw(e,s))),t===1))throw r=Vh,Cu(e,0),cc(e,n),Ts(e,Tn()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ft(345));case 2:uu(e,Ss,fl);break;case 3:if(cc(e,n),(n&130023424)===n&&(t=jb+500-Tn(),10<t)){if(ng(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){xs(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=sw(uu.bind(null,e,Ss,fl),t);break}uu(e,Ss,fl);break;case 4:if(cc(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-ao(n);s=1<<o,o=t[o],o>a&&(a=o),n&=~s}if(n=a,n=Tn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*zU(n/1960))-n,10<n){e.timeoutHandle=sw(uu.bind(null,e,Ss,fl),n);break}uu(e,Ss,fl);break;case 5:uu(e,Ss,fl);break;default:throw Error(ft(329))}}}return Ts(e,Tn()),e.callbackNode===r?R3.bind(null,e):null}function Bw(e,t){var r=Ah;return e.current.memoizedState.isDehydrated&&(Cu(e,t).flags|=256),e=wg(e,t),e!==2&&(t=Ss,Ss=r,t!==null&&Cw(t)),e}function Cw(e){Ss===null?Ss=e:Ss.push.apply(Ss,e)}function XU(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!co(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function cc(e,t){for(t&=~kb,t&=~wx,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ao(t),n=1<<r;e[r]=-1,t&=~n}}function Q4(e){if(yr&6)throw Error(ft(327));id();var t=ng(e,0);if(!(t&1))return Ts(e,Tn()),null;var r=wg(e,t);if(e.tag!==0&&r===2){var n=Yy(e);n!==0&&(t=n,r=Bw(e,n))}if(r===1)throw r=Vh,Cu(e,0),cc(e,t),Ts(e,Tn()),r;if(r===6)throw Error(ft(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,uu(e,Ss,fl),Ts(e,Tn()),null}function Fb(e,t){var r=yr;yr|=1;try{return e(t)}finally{yr=r,yr===0&&(Bd=Tn()+500,gx&&Qc())}}function Ru(e){dc!==null&&dc.tag===0&&!(yr&6)&&id();var t=yr;yr|=1;var r=Si.transition,n=Or;try{if(Si.transition=null,Or=1,e)return e()}finally{Or=n,Si.transition=r,yr=t,!(yr&6)&&Qc()}}function Tb(){Ws=YA.current,en(YA)}function Cu(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,CU(r)),Gn!==null)for(r=Gn.return;r!==null;){var n=r;switch(db(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&lg();break;case 3:_d(),en(js),en(ns),wb();break;case 5:yb(n);break;case 4:_d();break;case 13:en(un);break;case 19:en(un);break;case 10:mb(n.type._context);break;case 22:case 23:Tb()}r=r.return}if(va=e,Gn=e=Cc(e.current,null),Ua=Ws=t,oa=0,Vh=null,kb=wx=Du=0,Ss=Ah=null,wu!==null){for(t=0;t<wu.length;t++)if(r=wu[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=a,n.next=o}r.pending=n}wu=null}return e}function Q3(e,t){do{var r=Gn;try{if(pb(),Um.current=gg,mg){for(var n=hn.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}mg=!1}if(Pu=0,pa=aa=hn=null,ch=!1,qh=0,Sb.current=null,r===null||r.return===null){oa=1,Vh=t,Gn=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=Ua,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,A=l,h=A.tag;if(!(A.mode&1)&&(h===0||h===11||h===15)){var f=A.alternate;f?(A.updateQueue=f.updateQueue,A.memoizedState=f.memoizedState,A.lanes=f.lanes):(A.updateQueue=null,A.memoizedState=null)}var d=E4(o);if(d!==null){d.flags&=-257,S4(d,o,l,s,t),d.mode&1&&C4(s,u,t),t=d,c=u;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){C4(s,u,t),Ib();break e}c=Error(ft(426))}}else if(sn&&l.mode&1){var y=E4(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),S4(y,o,l,s,t),fb(Nd(c,l));break e}}s=c=Nd(c,l),oa!==4&&(oa=2),Ah===null?Ah=[s]:Ah.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var p=_3(s,c,t);y4(s,p);break e;case 1:l=c;var m=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof m.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Nc===null||!Nc.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var x=N3(s,l,t);y4(s,x);break e}}s=s.return}while(s!==null)}q3(r)}catch(b){t=b,Gn===r&&r!==null&&(Gn=r=r.return);continue}break}while(!0)}function M3(){var e=xg.current;return xg.current=gg,e===null?gg:e}function Ib(){(oa===0||oa===3||oa===2)&&(oa=4),va===null||!(Du&268435455)&&!(wx&268435455)||cc(va,Ua)}function wg(e,t){var r=yr;yr|=2;var n=M3();(va!==e||Ua!==t)&&(fl=null,Cu(e,t));do try{YU();break}catch(a){Q3(e,a)}while(!0);if(pb(),yr=r,xg.current=n,Gn!==null)throw Error(ft(261));return va=null,Ua=0,oa}function YU(){for(;Gn!==null;)H3(Gn)}function JU(){for(;Gn!==null&&!_O();)H3(Gn)}function H3(e){var t=$3(e.alternate,e,Ws);e.memoizedProps=e.pendingProps,t===null?q3(e):Gn=t,Sb.current=null}function q3(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=$U(r,t),r!==null){r.flags&=32767,Gn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{oa=6,Gn=null;return}}else if(r=KU(r,t,Ws),r!==null){Gn=r;return}if(t=t.sibling,t!==null){Gn=t;return}Gn=t=e}while(t!==null);oa===0&&(oa=5)}function uu(e,t,r){var n=Or,a=Si.transition;try{Si.transition=null,Or=1,ZU(e,t,r,n)}finally{Si.transition=a,Or=n}return null}function ZU(e,t,r,n){do id();while(dc!==null);if(yr&6)throw Error(ft(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ft(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(IO(e,s),e===va&&(Gn=va=null,Ua=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Cp||(Cp=!0,V3(rg,function(){return id(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Si.transition,Si.transition=null;var o=Or;Or=1;var l=yr;yr|=4,Sb.current=null,GU(e,r),P3(r,e),vU(nw),ag=!!rw,nw=rw=null,e.current=r,WU(r),NO(),yr=l,Or=o,Si.transition=s}else e.current=r;if(Cp&&(Cp=!1,dc=e,yg=a),s=e.pendingLanes,s===0&&(Nc=null),EO(r.stateNode),Ts(e,Tn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(vg)throw vg=!1,e=_w,_w=null,e;return yg&1&&e.tag!==0&&id(),s=e.pendingLanes,s&1?e===Nw?dh++:(dh=0,Nw=e):dh=0,Qc(),null}function id(){if(dc!==null){var e=_k(yg),t=Si.transition,r=Or;try{if(Si.transition=null,Or=16>e?16:e,dc===null)var n=!1;else{if(e=dc,dc=null,yg=0,yr&6)throw Error(ft(331));var a=yr;for(yr|=4,St=e.current;St!==null;){var s=St,o=s.child;if(St.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(St=u;St!==null;){var A=St;switch(A.tag){case 0:case 11:case 15:uh(8,A,s)}var h=A.child;if(h!==null)h.return=A,St=h;else for(;St!==null;){A=St;var f=A.sibling,d=A.return;if(L3(A),A===u){St=null;break}if(f!==null){f.return=d,St=f;break}St=d}}}var v=s.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}St=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,St=o;else e:for(;St!==null;){if(s=St,s.flags&2048)switch(s.tag){case 0:case 11:case 15:uh(9,s,s.return)}var p=s.sibling;if(p!==null){p.return=s.return,St=p;break e}St=s.return}}var m=e.current;for(St=m;St!==null;){o=St;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,St=w;else e:for(o=m;St!==null;){if(l=St,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:yx(9,l)}}catch(b){yn(l,l.return,b)}if(l===o){St=null;break e}var x=l.sibling;if(x!==null){x.return=l.return,St=x;break e}St=l.return}}if(yr=a,Qc(),Oo&&typeof Oo.onPostCommitFiberRoot=="function")try{Oo.onPostCommitFiberRoot(dx,e)}catch{}n=!0}return n}finally{Or=r,Si.transition=t}}return!1}function M4(e,t,r){t=Nd(r,t),t=_3(e,t,1),e=_c(e,t,1),t=xs(),e!==null&&(g0(e,1,t),Ts(e,t))}function yn(e,t,r){if(e.tag===3)M4(e,e,r);else for(;t!==null;){if(t.tag===3){M4(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Nc===null||!Nc.has(n))){e=Nd(r,e),e=N3(t,e,1),t=_c(t,e,1),e=xs(),t!==null&&(g0(t,1,e),Ts(t,e));break}}t=t.return}}function eP(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=xs(),e.pingedLanes|=e.suspendedLanes&r,va===e&&(Ua&r)===r&&(oa===4||oa===3&&(Ua&130023424)===Ua&&500>Tn()-jb?Cu(e,0):kb|=r),Ts(e,t)}function K3(e,t){t===0&&(e.mode&1?(t=mp,mp<<=1,!(mp&130023424)&&(mp=4194304)):t=1);var r=xs();e=El(e,t),e!==null&&(g0(e,t,r),Ts(e,r))}function tP(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),K3(e,r)}function rP(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ft(314))}n!==null&&n.delete(t),K3(e,r)}var $3;$3=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||js.current)ks=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ks=!1,qU(e,t,r);ks=!!(e.flags&131072)}else ks=!1,sn&&t.flags&1048576&&zk(t,Ag,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Dm(e,t),e=t.pendingProps;var a=yd(t,ns.current);sd(t,r),a=_b(null,t,n,e,a,r);var s=Nb();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Fs(n)?(s=!0,cg(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,xb(t),a.updater=vx,t.stateNode=a,a._reactInternals=t,dw(t,n,e,r),t=pw(null,t,n,!0,s,r)):(t.tag=0,sn&&s&&Ab(t),fs(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Dm(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=aP(n),e=Xi(n,e),a){case 0:t=hw(null,t,n,e,r);break e;case 1:t=F4(null,t,n,e,r);break e;case 11:t=k4(null,t,n,e,r);break e;case 14:t=j4(null,t,n,Xi(n.type,e),r);break e}throw Error(ft(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Xi(n,a),hw(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Xi(n,a),F4(e,t,n,a,r);case 3:e:{if(S3(t),e===null)throw Error(ft(387));n=t.pendingProps,s=t.memoizedState,a=s.element,t3(e,t),hg(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Nd(Error(ft(423)),t),t=T4(e,t,n,r,a);break e}else if(n!==a){a=Nd(Error(ft(424)),t),t=T4(e,t,n,r,a);break e}else for(ri=bc(t.stateNode.containerInfo.firstChild),ai=t,sn=!0,eo=null,r=Zk(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(wd(),n===a){t=Sl(e,t,r);break e}fs(e,t,n,r)}t=t.child}return t;case 5:return r3(t),e===null&&cw(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,o=a.children,aw(n,a)?o=null:s!==null&&aw(n,s)&&(t.flags|=32),E3(e,t),fs(e,t,o,r),t.child;case 6:return e===null&&cw(t),null;case 13:return k3(e,t,r);case 4:return vb(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=bd(t,null,n,r):fs(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Xi(n,a),k4(e,t,n,a,r);case 7:return fs(e,t,t.pendingProps,r),t.child;case 8:return fs(e,t,t.pendingProps.children,r),t.child;case 12:return fs(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,Gr(dg,n._currentValue),n._currentValue=o,s!==null)if(co(s.value,o)){if(s.children===a.children&&!js.current){t=Sl(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=yl(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var A=u.pending;A===null?c.next=c:(c.next=A.next,A.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),uw(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ft(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),uw(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}fs(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,sd(t,r),a=Fi(a),n=n(a),t.flags|=1,fs(e,t,n,r),t.child;case 14:return n=t.type,a=Xi(n,t.pendingProps),a=Xi(n.type,a),j4(e,t,n,a,r);case 15:return B3(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Xi(n,a),Dm(e,t),t.tag=1,Fs(n)?(e=!0,cg(t)):e=!1,sd(t,r),b3(t,n,a),dw(t,n,a,r),pw(null,t,n,!0,e,r);case 19:return j3(e,t,r);case 22:return C3(e,t,r)}throw Error(ft(156,t.tag))};function V3(e,t){return vk(e,t)}function nP(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bi(e,t,r,n){return new nP(e,t,r,n)}function Lb(e){return e=e.prototype,!(!e||!e.isReactComponent)}function aP(e){if(typeof e=="function")return Lb(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Z2)return 11;if(e===eb)return 14}return 2}function Cc(e,t){var r=e.alternate;return r===null?(r=Bi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Mm(e,t,r,n,a,s){var o=2;if(n=e,typeof e=="function")Lb(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case MA:return Eu(r.children,a,s,t);case J2:o=8,a|=8;break;case Uy:return e=Bi(12,r,t,a|2),e.elementType=Uy,e.lanes=s,e;case Py:return e=Bi(13,r,t,a),e.elementType=Py,e.lanes=s,e;case Dy:return e=Bi(19,r,t,a),e.elementType=Dy,e.lanes=s,e;case rk:return bx(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ek:o=10;break e;case tk:o=9;break e;case Z2:o=11;break e;case eb:o=14;break e;case sc:o=16,n=null;break e}throw Error(ft(130,e==null?e:typeof e,""))}return t=Bi(o,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Eu(e,t,r,n){return e=Bi(7,e,n,t),e.lanes=r,e}function bx(e,t,r,n){return e=Bi(22,e,n,t),e.elementType=rk,e.lanes=r,e.stateNode={isHidden:!1},e}function sv(e,t,r){return e=Bi(6,e,null,t),e.lanes=r,e}function iv(e,t,r){return t=Bi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function sP(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Q1(0),this.expirationTimes=Q1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Q1(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Ob(e,t,r,n,a,s,o,l,c){return e=new sP(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Bi(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},xb(s),e}function iP(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:QA,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function G3(e){if(!e)return Fc;e=e._reactInternals;e:{if(Xu(e)!==e||e.tag!==1)throw Error(ft(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Fs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ft(171))}if(e.tag===1){var r=e.type;if(Fs(r))return Gk(e,r,t)}return t}function W3(e,t,r,n,a,s,o,l,c){return e=Ob(r,n,!0,e,a,s,o,l,c),e.context=G3(null),r=e.current,n=xs(),a=Bc(r),s=yl(n,a),s.callback=t??null,_c(r,s,a),e.current.lanes=a,g0(e,a,n),Ts(e,n),e}function _x(e,t,r,n){var a=t.current,s=xs(),o=Bc(a);return r=G3(r),t.context===null?t.context=r:t.pendingContext=r,t=yl(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=_c(a,t,o),e!==null&&(so(e,a,o,s),Om(e,a,o)),o}function bg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function H4(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ub(e,t){H4(e,t),(e=e.alternate)&&H4(e,t)}function oP(){return null}var z3=typeof reportError=="function"?reportError:function(e){console.error(e)};function Pb(e){this._internalRoot=e}Nx.prototype.render=Pb.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ft(409));_x(e,t,null,null)};Nx.prototype.unmount=Pb.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ru(function(){_x(null,e,null,null)}),t[Cl]=null}};function Nx(e){this._internalRoot=e}Nx.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ck();e={blockedOn:null,target:e,priority:t};for(var r=0;r<lc.length&&t!==0&&t<lc[r].priority;r++);lc.splice(r,0,e),r===0&&Sk(e)}};function Db(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Bx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function q4(){}function lP(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=bg(o);s.call(u)}}var o=W3(t,n,e,0,null,!1,!1,"",q4);return e._reactRootContainer=o,e[Cl]=o.current,Dh(e.nodeType===8?e.parentNode:e),Ru(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=bg(c);l.call(u)}}var c=Ob(e,0,!1,null,null,!1,!1,"",q4);return e._reactRootContainer=c,e[Cl]=c.current,Dh(e.nodeType===8?e.parentNode:e),Ru(function(){_x(t,c,r,n)}),c}function Cx(e,t,r,n,a){var s=r._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var l=a;a=function(){var c=bg(o);l.call(c)}}_x(t,o,e,a)}else o=lP(r,t,e,a,n);return bg(o)}Nk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=$f(t.pendingLanes);r!==0&&(nb(t,r|1),Ts(t,Tn()),!(yr&6)&&(Bd=Tn()+500,Qc()))}break;case 13:Ru(function(){var n=El(e,1);if(n!==null){var a=xs();so(n,e,1,a)}}),Ub(e,1)}};ab=function(e){if(e.tag===13){var t=El(e,134217728);if(t!==null){var r=xs();so(t,e,134217728,r)}Ub(e,134217728)}};Bk=function(e){if(e.tag===13){var t=Bc(e),r=El(e,t);if(r!==null){var n=xs();so(r,e,t,n)}Ub(e,t)}};Ck=function(){return Or};Ek=function(e,t){var r=Or;try{return Or=e,t()}finally{Or=r}};Wy=function(e,t,r){switch(t){case"input":if(My(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=mx(n);if(!a)throw Error(ft(90));ak(n),My(n,a)}}}break;case"textarea":ik(e,r);break;case"select":t=r.value,t!=null&&td(e,!!r.multiple,t,!1)}};fk=Fb;hk=Ru;var cP={usingClientEntryPoint:!1,Events:[v0,$A,mx,Ak,dk,Fb]},Sf={findFiberByHostInstance:yu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uP={bundleType:Sf.bundleType,version:Sf.version,rendererPackageName:Sf.rendererPackageName,rendererConfig:Sf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Tl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=gk(e),e===null?null:e.stateNode},findFiberByHostInstance:Sf.findFiberByHostInstance||oP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ep=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ep.isDisabled&&Ep.supportsFiber)try{dx=Ep.inject(uP),Oo=Ep}catch{}}li.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cP;li.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Db(t))throw Error(ft(200));return iP(e,t,null,r)};li.createRoot=function(e,t){if(!Db(e))throw Error(ft(299));var r=!1,n="",a=z3;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Ob(e,1,!1,null,null,r,!1,n,a),e[Cl]=t.current,Dh(e.nodeType===8?e.parentNode:e),new Pb(t)};li.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ft(188)):(e=Object.keys(e).join(","),Error(ft(268,e)));return e=gk(t),e=e===null?null:e.stateNode,e};li.flushSync=function(e){return Ru(e)};li.hydrate=function(e,t,r){if(!Bx(t))throw Error(ft(200));return Cx(null,e,t,!0,r)};li.hydrateRoot=function(e,t,r){if(!Db(e))throw Error(ft(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",o=z3;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=W3(t,null,e,1,r??null,a,!1,s,o),e[Cl]=t.current,Dh(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Nx(t)};li.render=function(e,t,r){if(!Bx(t))throw Error(ft(200));return Cx(null,e,t,!1,r)};li.unmountComponentAtNode=function(e){if(!Bx(e))throw Error(ft(40));return e._reactRootContainer?(Ru(function(){Cx(null,null,e,!1,function(){e._reactRootContainer=null,e[Cl]=null})}),!0):!1};li.unstable_batchedUpdates=Fb;li.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Bx(r))throw Error(ft(200));if(e==null||e._reactInternals===void 0)throw Error(ft(38));return Cx(e,t,r,!1,n)};li.version="18.3.1-next-f1338f8080-20240426";function X3(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X3)}catch(e){console.error(e)}}X3(),XS.exports=li;var Y3=XS.exports,J3,K4=Y3;J3=K4.createRoot,K4.hydrateRoot;var Ew=function(e,t){return Ew=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Ew(e,t)};function Z3(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ew(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var _g=function(){return _g=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},_g.apply(this,arguments)};function Ld(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function ej(e,t,r,n){var a=arguments.length,s=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(a<3?o(s):a>3?o(t,r,s):o(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s}function tj(e,t){return function(r,n){t(r,n,e)}}function rj(e,t,r,n,a,s){function o(p){if(p!==void 0&&typeof p!="function")throw new TypeError("Function expected");return p}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&e?n.static?e:e.prototype:null,A=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),h,f=!1,d=r.length-1;d>=0;d--){var v={};for(var g in n)v[g]=g==="access"?{}:n[g];for(var g in n.access)v.access[g]=n.access[g];v.addInitializer=function(p){if(f)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(p||null))};var y=(0,r[d])(l==="accessor"?{get:A.get,set:A.set}:A[c],v);if(l==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(h=o(y.get))&&(A.get=h),(h=o(y.set))&&(A.set=h),(h=o(y.init))&&a.unshift(h)}else(h=o(y))&&(l==="field"?a.unshift(h):A[c]=h)}u&&Object.defineProperty(u,n.name,A),f=!0}function nj(e,t,r){for(var n=arguments.length>2,a=0;a<t.length;a++)r=n?t[a].call(e,r):t[a].call(e);return n?r:void 0}function aj(e){return typeof e=="symbol"?e:"".concat(e)}function sj(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function ij(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Ut(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(A){try{u(n.next(A))}catch(h){o(h)}}function c(A){try{u(n.throw(A))}catch(h){o(h)}}function u(A){A.done?s(A.value):a(A.value).then(l,c)}u((n=n.apply(e,t||[])).next())})}function oj(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(A){return c([u,A])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(A){u=[6,A],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var Ex=Object.create?function(e,t,r,n){n===void 0&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function lj(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Ex(t,e,r)}function Ng(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rb(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,s=[],o;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)s.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function cj(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Rb(arguments[t]));return e}function uj(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var s=arguments[t],o=0,l=s.length;o<l;o++,a++)n[a]=s[o];return n}function Aj(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function Cd(e){return this instanceof Cd?(this.v=e,this):new Cd(e)}function dj(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),a[Symbol.asyncIterator]=function(){return this},a;function o(d){return function(v){return Promise.resolve(v).then(d,h)}}function l(d,v){n[d]&&(a[d]=function(g){return new Promise(function(y,p){s.push([d,g,y,p])>1||c(d,g)})},v&&(a[d]=v(a[d])))}function c(d,v){try{u(n[d](v))}catch(g){f(s[0][3],g)}}function u(d){d.value instanceof Cd?Promise.resolve(d.value.v).then(A,h):f(s[0][2],d)}function A(d){c("next",d)}function h(d){c("throw",d)}function f(d,v){d(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function fj(e){var t,r;return t={},n("next"),n("throw",function(a){throw a}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(a,s){t[a]=e[a]?function(o){return(r=!r)?{value:Cd(e[a](o)),done:!1}:s?s(o):o}:s}}function hj(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Ng=="function"?Ng(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(l,c){o=e[s](o),a(l,c,o.done,o.value)})}}function a(s,o,l,c){Promise.resolve(c).then(function(u){s({value:u,done:l})},o)}}function pj(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var AP=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Sw=function(e){return Sw=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Sw(e)};function mj(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Sw(e),n=0;n<r.length;n++)r[n]!=="default"&&Ex(t,e,r[n]);return AP(t,e),t}function gj(e){return e&&e.__esModule?e:{default:e}}function xj(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function vj(e,t,r,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,r):a?a.value=r:t.set(e,r),r}function yj(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function wj(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,a;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(a=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");a&&(n=function(){try{a.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var dP=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function bj(e){function t(s){e.error=e.hasError?new dP(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}var r,n=0;function a(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(a);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(a,function(o){return t(o),a()})}else n|=1}catch(o){t(o)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return a()}function _j(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,a,s,o){return n?t?".jsx":".js":a&&(!s||!o)?r:a+s+"."+o.toLowerCase()+"js"}):e}const fP={__extends:Z3,__assign:_g,__rest:Ld,__decorate:ej,__param:tj,__esDecorate:rj,__runInitializers:nj,__propKey:aj,__setFunctionName:sj,__metadata:ij,__awaiter:Ut,__generator:oj,__createBinding:Ex,__exportStar:lj,__values:Ng,__read:Rb,__spread:cj,__spreadArrays:uj,__spreadArray:Aj,__await:Cd,__asyncGenerator:dj,__asyncDelegator:fj,__asyncValues:hj,__makeTemplateObject:pj,__importStar:mj,__importDefault:gj,__classPrivateFieldGet:xj,__classPrivateFieldSet:vj,__classPrivateFieldIn:yj,__addDisposableResource:wj,__disposeResources:bj,__rewriteRelativeImportExtension:_j},hP=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:wj,get __assign(){return _g},__asyncDelegator:fj,__asyncGenerator:dj,__asyncValues:hj,__await:Cd,__awaiter:Ut,__classPrivateFieldGet:xj,__classPrivateFieldIn:yj,__classPrivateFieldSet:vj,__createBinding:Ex,__decorate:ej,__disposeResources:bj,__esDecorate:rj,__exportStar:lj,__extends:Z3,__generator:oj,__importDefault:gj,__importStar:mj,__makeTemplateObject:pj,__metadata:ij,__param:tj,__propKey:aj,__read:Rb,__rest:Ld,__rewriteRelativeImportExtension:_j,__runInitializers:nj,__setFunctionName:sj,__spread:cj,__spreadArray:Aj,__spreadArrays:uj,__values:Ng,default:fP},Symbol.toStringTag,{value:"Module"})),pP=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Qb extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class mP extends Qb{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class $4 extends Qb{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class V4 extends Qb{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var kw;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(kw||(kw={}));class gP{constructor(t,{headers:r={},customFetch:n,region:a=kw.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=pP(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Ut(this,arguments,void 0,function*(r,n={}){var a;let s,o;try{const{headers:l,method:c,body:u,signal:A,timeout:h}=n;let f={},{region:d}=n;d||(d=this.region);const v=new URL(`${this.url}/${r}`);d&&d!=="any"&&(f["x-region"]=d,v.searchParams.set("forceFunctionRegion",d));let g;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",g=u):typeof u=="string"?(f["Content-Type"]="text/plain",g=u):typeof FormData<"u"&&u instanceof FormData?g=u:(f["Content-Type"]="application/json",g=JSON.stringify(u)):g=u;let y=A;h&&(o=new AbortController,s=setTimeout(()=>o.abort(),h),A?(y=o.signal,A.addEventListener("abort",()=>o.abort())):y=o.signal);const p=yield this.fetch(v.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:g,signal:y}).catch(b=>{throw new mP(b)}),m=p.headers.get("x-relay-error");if(m&&m==="true")throw new $4(p);if(!p.ok)throw new V4(p);let w=((a=p.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),x;return w==="application/json"?x=yield p.json():w==="application/octet-stream"||w==="application/pdf"?x=yield p.blob():w==="text/event-stream"?x=p:w==="multipart/form-data"?x=yield p.formData():x=yield p.text(),{data:x,error:null,response:p}}catch(l){return{data:null,error:l,response:l instanceof V4||l instanceof $4?l.context:void 0}}finally{s&&clearTimeout(s)}})}}var gs={};const Od=DL(hP);var Sp={},kp={},jp={},Fp={},Tp={},Ip={},G4;function Nj(){if(G4)return Ip;G4=1,Object.defineProperty(Ip,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Ip.default=e,Ip}var W4;function Bj(){if(W4)return Tp;W4=1,Object.defineProperty(Tp,"__esModule",{value:!0});const t=Od.__importDefault(Nj());class r{constructor(a){var s,o;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(s=a.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=a.signal,this.isMaybeSingle=(o=a.isMaybeSingle)!==null&&o!==void 0?o:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,s){return this.headers=new Headers(this.headers),this.headers.set(a,s),this}then(a,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,A,h,f;let d=null,v=null,g=null,y=c.status,p=c.statusText;if(c.ok){if(this.method!=="HEAD"){const b=await c.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?v=b:v=JSON.parse(b))}const w=(A=this.headers.get("Prefer"))===null||A===void 0?void 0:A.match(/count=(exact|planned|estimated)/),x=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");w&&x&&x.length>1&&(g=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(d={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,g=null,y=406,p="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const w=await c.text();try{d=JSON.parse(w),Array.isArray(d)&&c.status===404&&(v=[],d=null,y=200,p="OK")}catch{c.status===404&&w===""?(y=204,p="No Content"):d={message:w}}if(d&&this.isMaybeSingle&&(!((f=d==null?void 0:d.details)===null||f===void 0)&&f.includes("0 rows"))&&(d=null,y=200,p="OK"),d&&this.shouldThrowOnError)throw new t.default(d)}return{error:d,data:v,count:g,status:y,statusText:p}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,A,h,f,d,v;let g="";const y=c==null?void 0:c.cause;if(y){const p=(u=y==null?void 0:y.message)!==null&&u!==void 0?u:"",m=(A=y==null?void 0:y.code)!==null&&A!==void 0?A:"";g=`${(h=c==null?void 0:c.name)!==null&&h!==void 0?h:"FetchError"}: ${c==null?void 0:c.message}`,g+=`

Caused by: ${(f=y==null?void 0:y.name)!==null&&f!==void 0?f:"Error"}: ${p}`,m&&(g+=` (${m})`),y!=null&&y.stack&&(g+=`
${y.stack}`)}else g=(d=c==null?void 0:c.stack)!==null&&d!==void 0?d:"";return{error:{message:`${(v=c==null?void 0:c.name)!==null&&v!==void 0?v:"FetchError"}: ${c==null?void 0:c.message}`,details:g,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(a,s)}returns(){return this}overrideTypes(){return this}}return Tp.default=r,Tp}var z4;function Cj(){if(z4)return Fp;z4=1,Object.defineProperty(Fp,"__esModule",{value:!0});const t=Od.__importDefault(Bj());class r extends t.default{select(a){let s=!1;const o=(a??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:s=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",A=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${A?`${A},`:""}${a}.${s?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:s,referencedTable:o=s}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${a}`),this}range(a,s,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this.url.searchParams.set(u,`${s-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:s=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var A;const h=[a?"analyze":null,s?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(A=this.headers.get("Accept"))!==null&&A!==void 0?A:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${f}"; options=${h};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return Fp.default=r,Fp}var X4;function Mb(){if(X4)return jp;X4=1,Object.defineProperty(jp,"__esModule",{value:!0});const t=Od.__importDefault(Cj()),r=new RegExp("[,()]");class n extends t.default{eq(s,o){return this.url.searchParams.append(s,`eq.${o}`),this}neq(s,o){return this.url.searchParams.append(s,`neq.${o}`),this}gt(s,o){return this.url.searchParams.append(s,`gt.${o}`),this}gte(s,o){return this.url.searchParams.append(s,`gte.${o}`),this}lt(s,o){return this.url.searchParams.append(s,`lt.${o}`),this}lte(s,o){return this.url.searchParams.append(s,`lte.${o}`),this}like(s,o){return this.url.searchParams.append(s,`like.${o}`),this}likeAllOf(s,o){return this.url.searchParams.append(s,`like(all).{${o.join(",")}}`),this}likeAnyOf(s,o){return this.url.searchParams.append(s,`like(any).{${o.join(",")}}`),this}ilike(s,o){return this.url.searchParams.append(s,`ilike.${o}`),this}ilikeAllOf(s,o){return this.url.searchParams.append(s,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(s,o){return this.url.searchParams.append(s,`ilike(any).{${o.join(",")}}`),this}regexMatch(s,o){return this.url.searchParams.append(s,`match.${o}`),this}regexIMatch(s,o){return this.url.searchParams.append(s,`imatch.${o}`),this}is(s,o){return this.url.searchParams.append(s,`is.${o}`),this}isDistinct(s,o){return this.url.searchParams.append(s,`isdistinct.${o}`),this}in(s,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cs.{${o.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(o)}`),this}containedBy(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cd.{${o.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(o)}`),this}rangeGt(s,o){return this.url.searchParams.append(s,`sr.${o}`),this}rangeGte(s,o){return this.url.searchParams.append(s,`nxl.${o}`),this}rangeLt(s,o){return this.url.searchParams.append(s,`sl.${o}`),this}rangeLte(s,o){return this.url.searchParams.append(s,`nxr.${o}`),this}rangeAdjacent(s,o){return this.url.searchParams.append(s,`adj.${o}`),this}overlaps(s,o){return typeof o=="string"?this.url.searchParams.append(s,`ov.${o}`):this.url.searchParams.append(s,`ov.{${o.join(",")}}`),this}textSearch(s,o,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const A=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${u}fts${A}.${o}`),this}match(s){return Object.entries(s).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(s,o,l){return this.url.searchParams.append(s,`not.${o}.${l}`),this}or(s,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${s})`),this}filter(s,o,l){return this.url.searchParams.append(s,`${o}.${l}`),this}}return jp.default=n,jp}var Y4;function Ej(){if(Y4)return kp;Y4=1,Object.defineProperty(kp,"__esModule",{value:!0});const t=Od.__importDefault(Mb());class r{constructor(a,{headers:s={},schema:o,fetch:l}){this.url=a,this.headers=new Headers(s),this.schema=o,this.fetch=l}select(a,s){const{head:o=!1,count:l}=s??{},c=o?"HEAD":"GET";let u=!1;const A=(a??"*").split("").map(h=>/\s/.test(h)&&!u?"":(h==='"'&&(u=!u),h)).join("");return this.url.searchParams.set("select",A),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:s,defaultToNull:o=!0}={}){var l;const c="POST";if(s&&this.headers.append("Prefer",`count=${s}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const u=a.reduce((A,h)=>A.concat(Object.keys(h)),[]);if(u.length>0){const A=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",A.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(a,{onConflict:s,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var u;const A="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const h=a.reduce((f,d)=>f.concat(Object.keys(d)),[]);if(h.length>0){const f=[...new Set(h)].map(d=>`"${d}"`);this.url.searchParams.set("columns",f.join(","))}}return new t.default({method:A,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(a,{count:s}={}){var o;const l="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:a}={}){var s;const o="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return kp.default=r,kp}var J4;function xP(){if(J4)return Sp;J4=1,Object.defineProperty(Sp,"__esModule",{value:!0});const e=Od,t=e.__importDefault(Ej()),r=e.__importDefault(Mb());class n{constructor(s,{headers:o={},schema:l,fetch:c}={}){this.url=s,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${s}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,o={},{head:l=!1,get:c=!1,count:u}={}){var A;let h;const f=new URL(`${this.url}/rpc/${s}`);let d;l||c?(h=l?"HEAD":"GET",Object.entries(o).filter(([g,y])=>y!==void 0).map(([g,y])=>[g,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([g,y])=>{f.searchParams.append(g,y)})):(h="POST",d=o);const v=new Headers(this.headers);return u&&v.set("Prefer",`count=${u}`),new r.default({method:h,url:f,headers:v,schema:this.schemaName,body:d,fetch:(A=this.fetch)!==null&&A!==void 0?A:fetch})}}return Sp.default=n,Sp}Object.defineProperty(gs,"__esModule",{value:!0});var Sj=gs.PostgrestError=Dj=gs.PostgrestBuilder=Uj=gs.PostgrestTransformBuilder=Lj=gs.PostgrestFilterBuilder=Tj=gs.PostgrestQueryBuilder=jj=gs.PostgrestClient=void 0;const Ud=Od,kj=Ud.__importDefault(xP());var jj=gs.PostgrestClient=kj.default;const Fj=Ud.__importDefault(Ej());var Tj=gs.PostgrestQueryBuilder=Fj.default;const Ij=Ud.__importDefault(Mb());var Lj=gs.PostgrestFilterBuilder=Ij.default;const Oj=Ud.__importDefault(Cj());var Uj=gs.PostgrestTransformBuilder=Oj.default;const Pj=Ud.__importDefault(Bj());var Dj=gs.PostgrestBuilder=Pj.default;const Rj=Ud.__importDefault(Nj());Sj=gs.PostgrestError=Rj.default;var Qj=gs.default={PostgrestClient:kj.default,PostgrestQueryBuilder:Fj.default,PostgrestFilterBuilder:Ij.default,PostgrestTransformBuilder:Oj.default,PostgrestBuilder:Pj.default,PostgrestError:Rj.default};const vP=PL({__proto__:null,get PostgrestBuilder(){return Dj},get PostgrestClient(){return jj},get PostgrestError(){return Sj},get PostgrestFilterBuilder(){return Lj},get PostgrestQueryBuilder(){return Tj},get PostgrestTransformBuilder(){return Uj},default:Qj},[gs]),{PostgrestClient:yP,PostgrestQueryBuilder:Kde,PostgrestFilterBuilder:$de,PostgrestTransformBuilder:Vde,PostgrestBuilder:Gde,PostgrestError:Wde}=Qj||vP;class wP{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const bP="2.84.0",_P=`realtime-js/${bP}`,Mj="1.0.0",NP="2.0.0",Z4=Mj,jw=1e4,BP=1e3,CP=100;var hu;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(hu||(hu={}));var na;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(na||(na={}));var Zi;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Zi||(Zi={}));var Fw;(function(e){e.websocket="websocket"})(Fw||(Fw={}));var pu;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(pu||(pu={}));class EP{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast"}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n,a,s;const o=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(n=t.join_ref)!==null&&n!==void 0?n:"",u=t.payload.event,A=(s=(a=t.payload)===null||a===void 0?void 0:a.payload)!==null&&s!==void 0?s:new ArrayBuffer(0),h=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+u.length,f=new ArrayBuffer(this.HEADER_LENGTH+h);let d=new DataView(f),v=0;d.setUint8(v++,this.KINDS.userBroadcastPush),d.setUint8(v++,c.length),d.setUint8(v++,l.length),d.setUint8(v++,o.length),d.setUint8(v++,u.length),d.setUint8(v++,this.BINARY_ENCODING),Array.from(c,y=>d.setUint8(v++,y.charCodeAt(0))),Array.from(l,y=>d.setUint8(v++,y.charCodeAt(0))),Array.from(o,y=>d.setUint8(v++,y.charCodeAt(0))),Array.from(u,y=>d.setUint8(v++,y.charCodeAt(0)));var g=new Uint8Array(f.byteLength+A.byteLength);return g.set(new Uint8Array(f),0),g.set(new Uint8Array(A),f.byteLength),g.buffer}_encodeJsonUserBroadcastPush(t){var r,n,a,s;const o=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(n=t.join_ref)!==null&&n!==void 0?n:"",u=t.payload.event,A=(s=(a=t.payload)===null||a===void 0?void 0:a.payload)!==null&&s!==void 0?s:{},f=new TextEncoder().encode(JSON.stringify(A)).buffer,d=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+u.length,v=new ArrayBuffer(this.HEADER_LENGTH+d);let g=new DataView(v),y=0;g.setUint8(y++,this.KINDS.userBroadcastPush),g.setUint8(y++,c.length),g.setUint8(y++,l.length),g.setUint8(y++,o.length),g.setUint8(y++,u.length),g.setUint8(y++,this.JSON_ENCODING),Array.from(c,m=>g.setUint8(y++,m.charCodeAt(0))),Array.from(l,m=>g.setUint8(y++,m.charCodeAt(0))),Array.from(o,m=>g.setUint8(y++,m.charCodeAt(0))),Array.from(u,m=>g.setUint8(y++,m.charCodeAt(0)));var p=new Uint8Array(v.byteLength+f.byteLength);return p.set(new Uint8Array(v),0),p.set(new Uint8Array(f),v.byteLength),p.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,s,o,l,c]=n;return r({join_ref:a,ref:s,topic:o,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(t.slice(c,c+a));c=c+a;const A=n.decode(t.slice(c,c+s));c=c+s;const h=n.decode(t.slice(c,c+o));c=c+o;const f=t.slice(c,t.byteLength),d=l===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,v={type:this.BROADCAST_EVENT,event:A,payload:d};return o>0&&(v.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class Hj{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var $r;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})($r||($r={}));const eN=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,o)=>(s[o]=SP(o,e,t,a),s),{}):{}},SP=(e,t,r,n)=>{const a=t.find(l=>l.name===e),s=a==null?void 0:a.type,o=r[e];return s&&!n.includes(s)?qj(s,o):Tw(o)},qj=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return TP(t,r)}switch(e){case $r.bool:return kP(t);case $r.float4:case $r.float8:case $r.int2:case $r.int4:case $r.int8:case $r.numeric:case $r.oid:return jP(t);case $r.json:case $r.jsonb:return FP(t);case $r.timestamp:return IP(t);case $r.abstime:case $r.date:case $r.daterange:case $r.int4range:case $r.int8range:case $r.money:case $r.reltime:case $r.text:case $r.time:case $r.timestamptz:case $r.timetz:case $r.tsrange:case $r.tstzrange:return Tw(t);default:return Tw(t)}},Tw=e=>e,kP=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},jP=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},FP=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},TP=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const o=e.slice(1,r);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>qj(t,l))}return e},IP=e=>typeof e=="string"?e.replace(" ","T"):e,Kj=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class ov{constructor(t,r,n={},a=jw){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var tN;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(tN||(tN={}));class fh{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fh.syncState(this.state,a,s,o),this.pendingDiffs.forEach(c=>{this.state=fh.syncDiff(this.state,c,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=fh.syncDiff(this.state,a,s,o),l())}),this.onJoin((a,s,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:o})}),this.onLeave((a,s,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(s,(u,A)=>{o[u]||(c[u]=A)}),this.map(o,(u,A)=>{const h=s[u];if(h){const f=A.map(y=>y.presence_ref),d=h.map(y=>y.presence_ref),v=A.filter(y=>d.indexOf(y.presence_ref)<0),g=h.filter(y=>f.indexOf(y.presence_ref)<0);v.length>0&&(l[u]=v),g.length>0&&(c[u]=g)}else l[u]=A}),this.syncDiff(s,{joins:l,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(l,c)=>{var u;const A=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),A.length>0){const h=t[l].map(d=>d.presence_ref),f=A.filter(d=>h.indexOf(d.presence_ref)<0);t[l].unshift(...f)}n(l,A,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const A=c.map(h=>h.presence_ref);u=u.filter(h=>A.indexOf(h.presence_ref)<0),t[l]=u,a(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var rN;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(rN||(rN={}));var hh;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(hh||(hh={}));var hl;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(hl||(hl={}));class Hb{constructor(t,r={config:{}},n){var a,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=na.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ov(this,Zi.join,this.params,this.timeout),this.rejoinTimer=new Hj(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=na.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=na.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=na.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=na.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=na.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zi.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new fh(this),this.broadcastEndpointURL=Kj(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==na.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&a!==void 0?a:[],A=!!this.bindings[hh.PRESENCE]&&this.bindings[hh.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:A}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(d=>t==null?void 0:t(hl.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(hl.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var v;if(this.socket.setAuth(),d===void 0){t==null||t(hl.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(v=g==null?void 0:g.length)!==null&&v!==void 0?v:0,p=[];for(let m=0;m<y;m++){const w=g[m],{filter:{event:x,schema:b,table:B,filter:_}}=w,k=d&&d[m];if(k&&k.event===x&&k.schema===b&&k.table===B&&k.filter===_)p.push(Object.assign(Object.assign({},w),{id:k.id}));else{this.unsubscribe(),this.state=na.errored,t==null||t(hl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,t&&t(hl.SUBSCRIBED);return}}).receive("error",d=>{this.state=na.errored,t==null||t(hl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(hl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===na.joined&&t===hh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=na.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zi.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new ov(this,Zi.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=na.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new ov(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>CP){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:A}=Zi;if(n&&[l,c,u,A].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(d=>{var v,g,y;return((v=d.filter)===null||v===void 0?void 0:v.event)==="*"||((y=(g=d.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(d=>d.callback(f,n)):(s=this.bindings[o])===null||s===void 0||s.filter(d=>{var v,g,y,p,m,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in d){const x=d.id,b=(v=d.filter)===null||v===void 0?void 0:v.event;return x&&((g=r.ids)===null||g===void 0?void 0:g.includes(x))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const x=(m=(p=d==null?void 0:d.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return x==="*"||x===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===o}).map(d=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:g,table:y,commit_timestamp:p,type:m,errors:w}=v;f=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:p,eventType:m,new:{},old:{},errors:w}),this._getPayloadRecords(v))}d.callback(f,n)})}_isClosed(){return this.state===na.closed}_isJoined(){return this.state===na.joined}_isJoining(){return this.state===na.joining}_isLeaving(){return this.state===na.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Hb.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Zi.close,{},t)}_onError(t){this._on(Zi.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=na.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=eN(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=eN(t.columns,t.old_record)),r}}const lv=()=>{},Lp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},LP=[1e3,2e3,5e3,1e4],OP=1e4,UP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class PP{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=jw,this.transport=null,this.heartbeatIntervalMs=Lp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=lv,this.ref=0,this.reconnectTimer=null,this.vsn=Z4,this.logger=lv,this.conn=null,this.sendBuffer=[],this.serializer=new EP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...s)=>a(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Fw.websocket}`,this.httpEndpoint=Kj(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=wP.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case hu.connecting:return pu.Connecting;case hu.open:return pu.Open;case hu.closing:return pu.Closing;default:return pu.Closed}}isConnected(){return this.connectionState()===pu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new Hb(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(BP,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Lp.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:o}=r,l=o?`(${o})`:"",c=s.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(a,s,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===hu.open||this.conn.readyState===hu.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Zi.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([UP],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:_P};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Zi.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Hj(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Lp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,o,l,c,u,A,h,f,d;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:jw,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Lp.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:lv,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:Z4,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:v=>LP[v-1]||OP,this.vsn){case Mj:this.encode=(A=t==null?void 0:t.encode)!==null&&A!==void 0?A:(v,g)=>g(JSON.stringify(v)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(v,g)=>g(JSON.parse(v));break;case NP:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class qb extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function cn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class DP extends qb{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Iw extends qb{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const Kb=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),RP=()=>Response,Lw=e=>{if(Array.isArray(e))return e.map(r=>Lw(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Lw(n)}),t},QP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},cv=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},MP=(e,t,r)=>Ut(void 0,void 0,void 0,function*(){const n=yield RP();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const s=e.status||500,o=(a==null?void 0:a.statusCode)||s+"";t(new DP(cv(a),s,o))}).catch(a=>{t(new Iw(cv(a),a))}):t(new Iw(cv(e),e))}),HP=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(QP(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function w0(e,t,r,n,a,s){return Ut(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,HP(t,n,a,s)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>MP(c,l,n))})})}function Gh(e,t,r,n){return Ut(this,void 0,void 0,function*(){return w0(e,"GET",t,r,n)})}function Yi(e,t,r,n,a){return Ut(this,void 0,void 0,function*(){return w0(e,"POST",t,n,a,r)})}function Ow(e,t,r,n,a){return Ut(this,void 0,void 0,function*(){return w0(e,"PUT",t,n,a,r)})}function qP(e,t,r,n){return Ut(this,void 0,void 0,function*(){return w0(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function $b(e,t,r,n,a){return Ut(this,void 0,void 0,function*(){return w0(e,"DELETE",t,n,a,r)})}class KP{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Ut(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}}var $j;class $P{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[$j]="BlobDownloadBuilder",this.promise=null}asStream(){return new KP(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ut(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}}$j=Symbol.toStringTag;const VP={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},nN={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class GP{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=Kb(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return Ut(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},nN),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.has("cacheControl")||s.append("cacheControl",o.cacheControl),c&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(c))):(s=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!o.duplex&&(o.duplex="half")),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const u=this._removeEmptyFolders(r),A=this._getFinalPath(u),h=yield(t=="PUT"?Ow:Yi)(this.fetch,`${this.url}/object/${A}`,s,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Ut(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Ut(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:nN.upsert},a),A=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,A["cache-control"]=`max-age=${u.cacheControl}`,A["content-type"]=u.contentType);const h=yield Ow(this.fetch,l.toString(),c,{headers:A});return{data:{path:s,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(cn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Ut(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield Yi(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(this.url+s.url),l=o.searchParams.get("token");if(!l)throw new qb("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n))return{data:null,error:n};throw n}})}update(t,r,n){return Ut(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Ut(this,void 0,void 0,function*(){try{return{data:yield Yi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cn(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Ut(this,void 0,void 0,function*(){try{return{data:{path:(yield Yi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cn(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Ut(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Yi(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cn(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Ut(this,void 0,void 0,function*(){try{const a=yield Yi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cn(a))return{data:null,error:a};throw a}})}download(t,r){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=s?`?${s}`:"",l=this._getFinalPath(t),c=()=>Gh(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new $P(c,this.shouldThrowOnError)}info(t){return Ut(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Gh(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Lw(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n))return{data:null,error:n};throw n}})}exists(t){return Ut(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield qP(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n)&&n instanceof Iw){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield $b(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}list(t,r,n){return Ut(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},VP),r),{prefix:t||""});return{data:yield Yi(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cn(a))return{data:null,error:a};throw a}})}listV2(t,r){return Ut(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Yi(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Vj="2.84.0",Gj={"X-Client-Info":`storage-js/${Vj}`};class WP{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const s=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gj),r),this.fetch=Kb(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Ut(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield Gh(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}getBucket(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield Gh(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}createBucket(t){return Ut(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Yi(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cn(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return Ut(this,void 0,void 0,function*(){try{return{data:yield Ow(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield Yi(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield $b(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class zP{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gj),r),this.fetch=Kb(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield Yi(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}listBuckets(t){return Ut(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),a=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Gh(this.fetch,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield $b(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}}const Vb={"X-Client-Info":`storage-js/${Vj}`,"Content-Type":"application/json"};class Wj extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Ys(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class uv extends Wj{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class XP extends Wj{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var aN;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(aN||(aN={}));const Gb=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),YP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},sN=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),JP=(e,t,r)=>Ut(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const a=e.status||500,s=e;if(typeof s.json=="function")s.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||a+"";t(new uv(sN(o),a,l))}).catch(()=>{const o=a+"",l=s.statusText||`HTTP ${a} error`;t(new uv(l,a,o))});else{const o=a+"",l=s.statusText||`HTTP ${a} error`;t(new uv(l,a,o))}}else t(new XP(sN(e),e))}),ZP=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(YP(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,Object.assign(Object.assign({},a),r)):a};function eD(e,t,r,n,a,s){return Ut(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,ZP(t,n,a,s)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>JP(c,l,n))})})}function Js(e,t,r,n,a){return Ut(this,void 0,void 0,function*(){return eD(e,"POST",t,n,a,r)})}class tD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Vb),r),this.fetch=Gb(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Ut(this,void 0,void 0,function*(){try{return{data:(yield Js(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Ut(this,void 0,void 0,function*(){try{return{data:yield Js(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ys(n))return{data:null,error:n};throw n}})}listIndexes(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield Js(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Ut(this,void 0,void 0,function*(){try{return{data:(yield Js(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ys(n))return{data:null,error:n};throw n}})}}class rD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Vb),r),this.fetch=Gb(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Ut(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Js(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}getVectors(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield Js(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}listVectors(t){return Ut(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Js(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}queryVectors(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield Js(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Ut(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Js(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}}class nD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Vb),r),this.fetch=Gb(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ut(this,void 0,void 0,function*(){try{return{data:(yield Js(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}getBucket(t){return Ut(this,void 0,void 0,function*(){try{return{data:yield Js(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}listBuckets(){return Ut(this,arguments,void 0,function*(t={}){try{return{data:yield Js(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ut(this,void 0,void 0,function*(){try{return{data:(yield Js(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ys(r))return{data:null,error:r};throw r}})}}class aD extends nD{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new sD(this.url,this.headers,t,this.fetch)}}class sD extends tD{constructor(t,r,n,a){super(t,r,a),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ut(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ut(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ut(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ut(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new iD(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class iD extends rD{constructor(t,r,n,a,s){super(t,r,s),this.vectorBucketName=n,this.indexName=a}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ut(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ut(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ut(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ut(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ut(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class oD extends WP{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new GP(this.url,this.headers,t,this.fetch)}get vectors(){return new aD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new zP(this.url+"/iceberg",this.headers,this.fetch)}}const lD="2.84.0";let Gf="";typeof Deno<"u"?Gf="deno":typeof document<"u"?Gf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Gf="react-native":Gf="node";const cD={"X-Client-Info":`supabase-js-${Gf}/${lD}`},uD={headers:cD},AD={schema:"public"},dD={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},fD={},hD=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),pD=()=>Headers,mD=(e,t,r)=>{const n=hD(r),a=pD();return async(s,o)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new a(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(s,Object.assign(Object.assign({},o),{headers:u}))}};function gD(e){return e.endsWith("/")?e:e+"/"}function xD(e,t){var r,n;const{db:a,auth:s,realtime:o,global:l}=e,{db:c,auth:u,realtime:A,global:h}=t,f={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},A),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function vD(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(gD(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const zj="2.84.0",IA=30*1e3,Uw=3,Av=Uw*IA,yD="http://localhost:9999",wD="supabase.auth.token",bD={"X-Client-Info":`gotrue-js/${zj}`},Pw="X-Supabase-Api-Version",Xj={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_D=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ND=10*60*1e3;class Wh extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Rt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class BD extends Wh{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function CD(e){return Rt(e)&&e.name==="AuthApiError"}class mu extends Wh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Mc extends Wh{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Vs extends Mc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ED(e){return Rt(e)&&e.name==="AuthSessionMissingError"}class mA extends Mc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Op extends Mc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Up extends Mc{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function SD(e){return Rt(e)&&e.name==="AuthImplicitGrantRedirectError"}class iN extends Mc{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Dw extends Mc{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function dv(e){return Rt(e)&&e.name==="AuthRetryableFetchError"}class oN extends Mc{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Rw extends Mc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),lN=` 	
\r=`.split(""),kD=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<lN.length;t+=1)e[lN[t].charCodeAt(0)]=-2;for(let t=0;t<Bg.length;t+=1)e[Bg[t].charCodeAt(0)]=t;return e})();function cN(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Bg[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Bg[n]),t.queuedBits-=6}}function Yj(e,t,r){const n=kD[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function uN(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=o=>{TD(o,n,r)};for(let o=0;o<e.length;o+=1)Yj(e.charCodeAt(o),a,s);return t.join("")}function jD(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function FD(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}jD(n,t)}}function TD(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function od(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Yj(e.charCodeAt(a),r,n);return new Uint8Array(t)}function ID(e){const t=[];return FD(e,r=>t.push(r)),new Uint8Array(t)}function _u(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>cN(a,r,n)),cN(null,r,n),t.join("")}function LD(e){return Math.round(Date.now()/1e3)+e}function OD(){return Symbol("auth-callback")}const ka=()=>typeof window<"u"&&typeof document<"u",iu={tested:!1,writable:!1},Jj=()=>{if(!ka())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(iu.tested)return iu.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),iu.tested=!0,iu.writable=!0}catch{iu.tested=!0,iu.writable=!1}return iu.writable};function UD(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const Zj=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),PD=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",LA=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ou=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Zl=async(e,t)=>{await e.removeItem(t)};class Sx{constructor(){this.promise=new Sx.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Sx.promiseConstructor=Promise;function fv(e){const t=e.split(".");if(t.length!==3)throw new Rw("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!_D.test(t[n]))throw new Rw("JWT not in base64url format");return{header:JSON.parse(uN(t[0])),payload:JSON.parse(uN(t[1])),signature:od(t[2]),raw:{header:t[0],payload:t[1]}}}async function DD(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function RD(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await e(s);if(!t(s,null,o)){n(o);return}}catch(o){if(!t(s,o)){a(o);return}}})()})}function QD(e){return("0"+e.toString(16)).substr(-2)}function MD(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,QD).join("")}async function HD(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function qD(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await HD(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function gA(e,t,r=!1){const n=MD();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await LA(e,`${t}-code-verifier`,a);const s=await qD(n);return[s,n===s?"plain":"s256"]}const KD=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function $D(e){const t=e.headers.get(Pw);if(!t||!t.match(KD))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function VD(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function GD(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const WD=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xA(e){if(!WD.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function hv(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function zD(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function AN(e){return JSON.parse(JSON.stringify(e))}const Au=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),XD=[502,503,504];async function dN(e){var t;if(!PD(e))throw new Dw(Au(e),0);if(XD.includes(e.status))throw new Dw(Au(e),e.status);let r;try{r=await e.json()}catch(s){throw new mu(Au(s),s)}let n;const a=$D(e);if(a&&a.getTime()>=Xj["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new oN(Au(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Vs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new oN(Au(r),e.status,r.weak_password.reasons);throw new BD(Au(r),e.status||500,n)}const YD=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function qt(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[Pw]||(s[Pw]=Xj["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await JD(e,t,r+l,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function JD(e,t,r,n,a,s){const o=YD(t,n,a,s);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new Dw(Au(c),0)}if(l.ok||await dN(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await dN(c)}}function Gi(e){var t;let r=null;t7(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=LD(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function fN(e){const t=Gi(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function uc(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function ZD(e){return{data:e,error:null}}function e7(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,o=Ld(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function hN(e){return e}function t7(e){return e.access_token&&e.refresh_token&&e.expires_in}const pv=["global","local","others"];class r7{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Zj(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=pv[0]){if(pv.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${pv.join(", ")}`);try{return await qt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Rt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await qt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:uc})}catch(n){if(Rt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Ld(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await qt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:e7,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Rt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await qt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:uc})}catch(r){if(Rt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},A=await qt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:hN});if(A.error)throw A.error;const h=await A.json(),f=(o=A.headers.get("x-total-count"))!==null&&o!==void 0?o:0,d=(c=(l=A.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return d.length>0&&(d.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);u[`${y}Page`]=g}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Rt(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){xA(t);try{return await qt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:uc})}catch(r){if(Rt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){xA(t);try{return await qt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:uc})}catch(n){if(Rt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){xA(t);try{return await qt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:uc})}catch(n){if(Rt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){xA(t.userId);try{const{data:r,error:n}=await qt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){xA(t.userId),xA(t.id);try{return{data:await qt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,s,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},A=await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:hN});if(A.error)throw A.error;const h=await A.json(),f=(o=A.headers.get("x-total-count"))!==null&&o!==void 0?o:0,d=(c=(l=A.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return d.length>0&&(d.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);u[`${y}Page`]=g}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Rt(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await qt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Rt(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await qt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Rt(r))return{data:null,error:r};throw r}}}function pN(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const vA={debug:!!(globalThis&&Jj()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class eF extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class n7 extends eF{}async function a7(e,t,r){vA.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),vA.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){vA.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{vA.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw vA.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new n7(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(vA.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function s7(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function tF(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function i7(e){return parseInt(e,16)}function o7(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function l7(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:s=new Date,nonce:o,notBefore:l,requestId:c,resources:u,scheme:A,uri:h,version:f}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const d=tF(e.address),v=A?`${A}://${n}`:n,g=e.statement?`${e.statement}
`:"",y=`${v} wants you to sign in with your Ethereum account:
${d}

${g}`;let p=`URI: ${h}
Version: ${f}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${s.toISOString()}`;if(a&&(p+=`
Expiration Time: ${a.toISOString()}`),l&&(p+=`
Not Before: ${l.toISOString()}`),c&&(p+=`
Request ID: ${c}`),u){let m=`
Resources:`;for(const w of u){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);m+=`
- ${w}`}p+=m}return`${y}
${p}`}class $n extends Error{constructor({message:t,code:r,cause:n,name:a}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=a??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Cg extends $n{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function c7({error:e,options:t}){var r,n,a;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $n({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new $n({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new $n({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new $n({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new $n({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new $n({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new $n({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new $n({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(rF(o)){if(s.rp.id!==o)return new $n({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new $n({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new $n({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new $n({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new $n({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function u7({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $n({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new $n({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(rF(n)){if(r.rpId!==n)return new $n({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new $n({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new $n({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new $n({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class A7{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const d7=new A7;function f7(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=Ld(e,["challenge","user","excludeCredentials"]),s=od(t).buffer,o=Object.assign(Object.assign({},r),{id:od(r.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:s,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:od(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function h7(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Ld(e,["challenge","allowCredentials"]),a=od(t).buffer,s=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];s.allowCredentials[o]=Object.assign(Object.assign({},l),{id:od(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return s}function p7(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:_u(new Uint8Array(e.response.attestationObject)),clientDataJSON:_u(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function m7(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:_u(new Uint8Array(a.authenticatorData)),clientDataJSON:_u(new Uint8Array(a.clientDataJSON)),signature:_u(new Uint8Array(a.signature)),userHandle:a.userHandle?_u(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function rF(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function mN(){var e,t;return!!(ka()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function g7(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Cg("Browser returned unexpected credential type",t)}:{data:null,error:new Cg("Empty credential response",t)}}catch(t){return{data:null,error:c7({error:t,options:e})}}}async function x7(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Cg("Browser returned unexpected credential type",t)}:{data:null,error:new Cg("Empty credential response",t)}}catch(t){return{data:null,error:u7({error:t,options:e})}}}const v7={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},y7={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Eg(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const s in a){const o=a[s];if(o!==void 0)if(Array.isArray(o))n[s]=o;else if(r(o))n[s]=o;else if(t(o)){const l=n[s];t(l)?n[s]=Eg(l,o):n[s]=Eg(o)}else n[s]=o}return n}function w7(e,t){return Eg(v7,e,t||{})}function b7(e,t){return Eg(y7,e,t||{})}class _7{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},s){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const c=a??d7.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=w7(o.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:A,error:h}=await g7({publicKey:u,signal:c});return A?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:A}},error:null}:{data:null,error:h}}case"request":{const u=b7(o.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:A,error:h}=await x7(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return A?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:A}},error:null}:{data:null,error:h}}}}catch(o){return Rt(o)?{data:null,error:o}:{data:null,error:new mu("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},s){if(!r)return{data:null,error:new Wh("rpId is required for WebAuthn authentication")};try{if(!mN())return{data:null,error:new mu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:s});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return Rt(o)?{data:null,error:o}:{data:null,error:new mu("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},s){if(!r)return{data:null,error:new Wh("rpId is required for WebAuthn registration")};try{if(!mN())return{data:null,error:new mu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(A=>{var h;return(h=A.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(A=>A?this.client.mfa.unenroll({factorId:A==null?void 0:A.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:s});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(o){return Rt(o)?{data:null,error:o}:{data:null,error:new mu("Unexpected error in register",o)}}}}s7();const N7={url:yD,storageKey:wD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function gN(e,t,r){return await r()}const yA={};class zh{get jwks(){var t,r;return(r=(t=yA[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){yA[this.storageKey]=Object.assign(Object.assign({},yA[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=yA[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){yA[this.storageKey]=Object.assign(Object.assign({},yA[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},N7),t);if(this.storageKey=s.storageKey,this.instanceID=(r=zh.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,zh.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&ka()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new r7({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Zj(s.fetch),this.lock=s.lock||gN,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:ka()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=a7:this.lock=gN,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new _7(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Jj()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=pN(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=pN(this.memoryStorage)),ka()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${zj}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(ka()&&(r=UD(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),ka()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),SD(s)){const c=(t=s.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Rt(r)?this._returnResult({error:r}):this._returnResult({error:new mu("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Gi}),{data:o,error:l}=s;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(Rt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:A,password:h,options:f}=t;let d=null,v=null;this.flowType==="pkce"&&([d,v]=await gA(this.storage,this.storageKey)),s=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:A,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:d,code_challenge_method:v},xform:Gi})}else if("phone"in t){const{phone:A,password:h,options:f}=t;s=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:A,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(a=f==null?void 0:f.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Gi})}else throw new Op("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(Rt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:o,options:l}=t;r=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:fN})}else if("phone"in t){const{phone:s,password:o,options:l}=t;r=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:fN})}else throw new Op("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const s=new mA;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,s,o,l,c,u,A,h,f;let d,v;if("message"in t)d=t.message,v=t.signature;else{const{chain:g,wallet:y,statement:p,options:m}=t;let w;if(ka())if(typeof y=="object")w=y;else{const E=window;if("ethereum"in E&&typeof E.ethereum=="object"&&"request"in E.ethereum&&typeof E.ethereum.request=="function")w=E.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const x=new URL((r=m==null?void 0:m.url)!==null&&r!==void 0?r:window.location.href),b=await w.request({method:"eth_requestAccounts"}).then(E=>E).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||b.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const B=tF(b[0]);let _=(n=m==null?void 0:m.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!_){const E=await w.request({method:"eth_chainId"});_=i7(E)}const k={domain:x.host,address:B,statement:p,uri:x.href,version:"1",chainId:_,nonce:(a=m==null?void 0:m.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(s=m==null?void 0:m.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=m==null?void 0:m.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=m==null?void 0:m.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=m==null?void 0:m.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(A=m==null?void 0:m.signInWithEthereum)===null||A===void 0?void 0:A.resources};d=l7(k),v=await w.request({method:"personal_sign",params:[o7(d),B]})}try{const{data:g,error:y}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:v},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Gi});if(y)throw y;if(!g||!g.session||!g.user){const p=new mA;return this._returnResult({data:{user:null,session:null},error:p})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:y})}catch(g){if(Rt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var r,n,a,s,o,l,c,u,A,h,f,d;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:y,wallet:p,statement:m,options:w}=t;let x;if(ka())if(typeof p=="object")x=p;else{const B=window;if("solana"in B&&typeof B.solana=="object"&&("signIn"in B.solana&&typeof B.solana.signIn=="function"||"signMessage"in B.solana&&typeof B.solana.signMessage=="function"))x=B.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=p}const b=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in x&&x.signIn){const B=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),m?{statement:m}:null));let _;if(Array.isArray(B)&&B[0]&&typeof B[0]=="object")_=B[0];else if(B&&typeof B=="object"&&"signedMessage"in B&&"signature"in B)_=B;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)v=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),g=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${b.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(a=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(A=w==null?void 0:w.signInWithSolana)===null||A===void 0?void 0:A.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const B=await x.signMessage(new TextEncoder().encode(v),"utf8");if(!B||!(B instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=B}}try{const{data:y,error:p}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:_u(g)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:Gi});if(p)throw p;if(!y||!y.session||!y.user){const m=new mA;return this._returnResult({data:{user:null,session:null},error:m})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:p})}catch(y){if(Rt(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(t){const r=await ou(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:o}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Gi});if(await Zl(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!s||!s.session||!s.user){const l=new mA;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:o})}catch(s){if(Rt(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:o}=t,l=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Gi}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const A=new mA;return this._returnResult({data:{user:null,session:null},error:A})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(Rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,s,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,A=null;this.flowType==="pkce"&&([u,A]=await gA(this.storage,this.storageKey));const{error:h}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:A},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:A}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:A})}throw new Op("You must provide either an email or phone number.")}catch(l){if(Rt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await qt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Gi});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Rt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a,s,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await gA(this.storage,this.storageKey));const u=await qt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:ZD});return!((s=u.data)===null||s===void 0)&&s.url&&ka()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(Rt(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Vs;const{error:a}=await qt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(Rt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:o}=await qt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:o,error:l}=await qt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Op("You must provide either an email or phone number and a type")}catch(r){if(Rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ou(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Av:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await ou(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=hv()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=zD(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:uc}):await this._useSession(async r=>{var n,a,s;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Vs}:await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:uc})})}catch(r){if(Rt(r))return ED(r)&&(await this._removeSession(),await Zl(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Vs;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await gA(this.storage,this.storageKey));const{data:u,error:A}=await qt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:uc});if(A)throw A;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(Rt(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Vs;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:o}=fv(t.access_token);if(o.exp&&(n=o.exp,a=n<=r),a){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;s={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Rt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Vs;const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ka())throw new Up("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Up(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new iN("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Up("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new iN("No code detected.");const{data:m,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!s||!l||!o||!u)throw new Up("No session defined in URL");const A=Math.round(Date.now()/1e3),h=parseInt(l);let f=A+h;c&&(f=parseInt(c));const d=f-A;d*1e3<=IA&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);const v=f-h;A-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,A):A-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,A);const{data:g,error:y}=await this._getUser(s);if(y)throw y;const p={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:p,redirectType:t.type},error:null})}catch(n){if(Rt(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ou(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({error:s});const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(CD(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Zl(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=OD(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await gA(this.storage,this.storageKey,!0));try{return await qt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Rt(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var o,l,c,u,A;const{data:h,error:f}=s;if(f)throw f;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await qt(this.fetch,"GET",d,{headers:this.headers,jwt:(A=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&A!==void 0?A:void 0})});if(a)throw a;return ka()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Rt(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:s}}=r;if(a)throw a;const{options:o,provider:l,token:c,access_token:u,nonce:A}=t,h=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:u,nonce:A,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Gi}),{data:f,error:d}=h;return d?this._returnResult({data:{user:null,session:null},error:d}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new mA}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:d}))}catch(a){if(Rt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:o}=r;if(o)throw o;return await qt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await RD(async a=>(a>0&&await DD(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await qt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Gi})),(a,s)=>{const o=200*Math.pow(2,a);return s&&dv(s)&&Date.now()+o-n<IA})}catch(n){if(this._debug(r,"error",n),Rt(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ka()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await ou(this.storage,this.storageKey);if(a&&this.userStorage){let o=await ou(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await LA(this.userStorage,this.storageKey+"-user",o)),a.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:hv()}else if(a&&!a.user&&!a.user){const o=await ou(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await Zl(this.storage,this.storageKey+"-user"),await LA(this.storage,this.storageKey,a)):a.user=hv()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Av;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Av}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),dv(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Vs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Sx;const{data:s,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!s.session)throw new Vs;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={data:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(a,"error",s),Rt(s)){const o={data:null,error:s};return dv(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){s.push(c)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await LA(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=AN(a);await LA(this.storage,this.storageKey,s)}else{const a=AN(r);await LA(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Zl(this.storage,this.storageKey),await Zl(this.storage,this.storageKey+"-code-verifier"),await Zl(this.storage,this.storageKey+"-user"),this.userStorage&&await Zl(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ka()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),IA);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/IA);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${IA}ms, refresh threshold is ${Uw} ticks`),a<=Uw&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof eF)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ka()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await gA(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?this._returnResult({data:null,error:s}):await qt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await qt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?p7(t.webauthn.credential_response):m7(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await qt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=await qt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:f7(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:h7(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(s),s.status==="verified"&&a[s.factor_type].push(s);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=fv(n.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(A=>A.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await qt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Vs})})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!a)return this._returnResult({data:null,error:new Vs});const o=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&ka()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Rt(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!a)return this._returnResult({data:null,error:new Vs});const o=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&ka()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Rt(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await qt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Vs})})}catch(t){if(Rt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await qt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new Vs})})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+ND>a)return n;const{data:s,error:o}=await qt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:d,error:v}=await this.getSession();if(v||!d.session)return this._returnResult({data:null,error:v});n=d.session.access_token}const{header:a,payload:s,signature:o,raw:{header:l,payload:c}}=fv(n);r!=null&&r.allowExpired||VD(s.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:s,header:a,signature:o},error:null}}const A=GD(a.alg),h=await crypto.subtle.importKey("jwk",u,A,!0,["verify"]);if(!await crypto.subtle.verify(A,h,o,ID(`${l}.${c}`)))throw new Rw("Invalid JWT signature");return{data:{claims:s,header:a,signature:o},error:null}}catch(n){if(Rt(n))return this._returnResult({data:null,error:n});throw n}}}zh.nextInstanceID={};const B7=zh;class C7 extends B7{constructor(t){super(t)}}class E7{constructor(t,r,n){var a,s,o;this.supabaseUrl=t,this.supabaseKey=r;const l=vD(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:AD,realtime:fD,auth:Object.assign(Object.assign({},dD),{storageKey:c}),global:uD},A=xD(n??{},u);this.storageKey=(a=A.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=A.global.headers)!==null&&s!==void 0?s:{},A.accessToken?(this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=A.auth)!==null&&o!==void 0?o:{},this.headers,A.global.fetch),this.fetch=mD(r,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new yP(new URL("rest/v1",l).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),this.storage=new oD(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),A.accessToken||this._listenForAuthEvents()}get functions(){return new gP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,storageKey:o,flowType:l,lock:c,debug:u,throwOnError:A},h,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new C7({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),h),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,flowType:l,lock:c,debug:u,throwOnError:A,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new PP(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const S7=(e,t,r)=>new E7(e,t,r);function k7(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}k7()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const j7="https://dkrtsqienlhpouohmfki.supabase.co",F7="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY",de=S7(j7,F7),nF=Z.createContext(void 0);function T7({children:e}){const[t,r]=Z.useState(null),[n,a]=Z.useState(null),[s,o]=Z.useState(!0);Z.useEffect(()=>{de.auth.getSession().then(({data:{session:f}})=>{r((f==null?void 0:f.user)??null),f!=null&&f.user?l(f.user.id):o(!1)});const{data:{subscription:h}}=de.auth.onAuthStateChange((f,d)=>{r((d==null?void 0:d.user)??null),d!=null&&d.user?l(d.user.id):(a(null),o(!1))});return()=>h.unsubscribe()},[]);const l=async h=>{try{const{data:f,error:d}=await de.from("user_profiles").select("*").eq("id",h).maybeSingle();if(d)throw d;a(f)}catch(f){console.error("Error loading profile:",f)}finally{o(!1)}},c=async(h,f)=>{let d=h;if(!h.includes("@")){console.log("Looking up username:",h.toLowerCase());const{data:g,error:y}=await de.from("user_profiles").select("email, username, is_active").eq("username",h.toLowerCase()).maybeSingle();if(console.log("Username lookup result:",{data:g,error:y}),y)throw console.error("Error looking up username:",y),new Error("Invalid username or password");if(!g)throw console.error("Username not found:",h),new Error("Invalid username or password");if(!g.is_active)throw new Error("Account is inactive. Please contact administrator.");d=g.email,console.log("Resolved email:",d)}console.log("Attempting sign in with email:",d);const{error:v}=await de.auth.signInWithPassword({email:d,password:f});if(v)throw console.error("Sign in error:",v),v;console.log("Sign in successful")},u=async(h,f,d,v)=>{const{data:g,error:y}=await de.auth.signUp({email:h,password:f});if(y)throw y;if(g.user){const{error:p}=await de.from("user_profiles").insert({id:g.user.id,email:h,full_name:d,role:v,language:"en",is_active:!0});if(p)throw p}},A=async()=>{const{error:h}=await de.auth.signOut();if(h)throw h};return i.jsx(nF.Provider,{value:{user:t,profile:n,loading:s,signIn:c,signUp:u,signOut:A},children:e})}function Dr(){const e=Z.useContext(nF);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const I7={en:{common:{search:"Search",filter:"Filter",export:"Export",add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",close:"Close",submit:"Submit",actions:"Actions",loading:"Loading...",noData:"No data available",confirm:"Confirm",yes:"Yes",no:"No",success:"Success",error:"Error",warning:"Warning"},auth:{login:"Login",logout:"Logout",email:"Email",password:"Password",signIn:"Sign In",signOut:"Sign Out",welcomeBack:"Welcome Back",enterCredentials:"Enter your credentials to continue"},nav:{dashboard:"Dashboard",products:"Products",stock:"Stock",batches:"Batches",inventory:"Inventory",customers:"Customers",crm:"CRM",deliveryChallan:"Delivery Challan",sales:"Sales",finance:"Finance",settings:"Settings",users:"Users"},commandCenter:{title:"CRM Command Center",subtitle:"Ultra-fast inquiry processing with AI automation",emailList:"Email Inbox",inquiryForm:"Inquiry Form",quickActions:"Quick Actions",todaysActions:"Today's Actions",parseEmail:"Parse Email",parsing:"Parsing...",autoFilled:"Auto-filled by AI",confidence:"Confidence",saveInquiry:"Save Inquiry",saving:"Saving...",sendPrice:"Send Price",sendCOA:"Send COA",sendMSDS:"Send MSDS",sendSample:"Send Sample",logActivity:"Log Activity",noEmailSelected:"Select an email to parse",noInquirySelected:"Select an inquiry for quick actions",selectEmail:"Select an email from the list",emailFrom:"From",emailDate:"Date",requestedItems:"Requested",priority:"Priority",activityType:"Activity Type",activityOutcome:"Outcome",activityNotes:"Notes",dueReminders:"Due Reminders",upcomingFollowups:"Upcoming Follow-ups",recentActivity:"Recent Activity",viewAll:"View All",noReminders:"No due reminders",noFollowups:"No upcoming follow-ups",noActivity:"No recent activity",priorities:{low:"Low",medium:"Medium",high:"High",urgent:"Urgent"},statuses:{new:"New Inquiry",price_quoted:"Price Quoted",coa_pending:"COA Pending",sample_sent:"Sample Sent",negotiation:"Negotiation",po_received:"PO Received",won:"Won",lost:"Lost"},activities:{email_sent:"Email Sent",phone_call:"Phone Call",meeting:"Meeting",document_sent:"Document Sent",follow_up:"Follow-up",note:"Note"},outcomes:{positive:"Positive",neutral:"Neutral",negative:"Negative",pending:"Pending Response"}},dashboard:{title:"Dashboard",totalProducts:"Total Products",lowStock:"Low Stock Items",nearExpiry:"Near Expiry",totalCustomers:"Total Customers",salesThisMonth:"Sales This Month",revenueThisMonth:"Revenue This Month",profitThisMonth:"Profit This Month",pendingFollowUps:"Pending Follow-ups"},products:{title:"Products",addProduct:"Add Product",editProduct:"Edit Product",productName:"Product Name",productCode:"Product Code",hsnCode:"HSN Code",category:"Category",unit:"Unit",packagingType:"Packaging Type",defaultSupplier:"Default Supplier",description:"Description",uploadFiles:"Upload Files",categories:{api:"API",excipient:"Excipient",solvent:"Solvent",other:"Other"},units:{kg:"Kilogram",litre:"Litre",ton:"Ton",piece:"Piece"}},batches:{title:"Batches",addBatch:"Add Batch",editBatch:"Edit Batch",batchNumber:"Batch Number",product:"Product",importDate:"Import Date",importQuantity:"Import Quantity",currentStock:"Current Stock",packagingDetails:"Packaging Details",importPrice:"Import Price",dutyCharges:"Duty Charges",freightCharges:"Freight Charges",otherCharges:"Other Charges",totalCost:"Total Cost",costPerUnit:"Cost Per Unit",expiryDate:"Expiry Date",warehouseLocation:"Warehouse Location",uploadDocuments:"Upload Documents"},inventory:{title:"Inventory",stockSummary:"Stock Summary",batchWiseStock:"Batch-wise Stock",lowStockAlert:"Low Stock Alert",expiryAlert:"Expiry Alert",stockMovement:"Stock Movement",adjustStock:"Adjust Stock"},customers:{title:"Customers",addCustomer:"Add Customer",editCustomer:"Edit Customer",customerName:"Customer Name",companyName:"Company Name",npwp:"NPWP (Tax ID)",address:"Address",city:"City",country:"Country",contactPerson:"Contact Person",email:"Email",phone:"Phone",gstVatType:"GST/VAT Type",paymentTerms:"Payment Terms"},crm:{title:"CRM",leads:"Leads",activities:"Activities",addLead:"Add Lead",editLead:"Edit Lead",companyName:"Company Name",contactPerson:"Contact Person",productInterest:"Product Interest",quantityInterest:"Quantity Interest",leadSource:"Lead Source",status:"Status",assignedTo:"Assigned To",expectedCloseDate:"Expected Close Date",estimatedValue:"Estimated Value",addActivity:"Add Activity",followUp:"Follow-up",statuses:{inquiry:"Inquiry",quotation:"Quotation",negotiation:"Negotiation",won:"Won",lost:"Lost"}},sales:{title:"Sales",invoices:"Invoices",createInvoice:"Create Invoice",invoiceNumber:"Invoice Number",customer:"Customer",invoiceDate:"Invoice Date",dueDate:"Due Date",items:"Items",addItem:"Add Item",quantity:"Quantity",unitPrice:"Unit Price",taxRate:"Tax Rate",subtotal:"Subtotal",tax:"Tax",discount:"Discount",total:"Total",paymentStatus:"Payment Status",deliveryChallan:"Delivery Challan",generatePDF:"Generate PDF",sendEmail:"Send Email"},salesOrders:{title:"Sales Orders",createSalesOrder:"Create Sales Order",customerPoNumber:"Customer PO Number",customerPoDate:"Customer PO Date",soDate:"Sales Order Date",expectedDeliveryDate:"Expected Delivery Date",uploadPo:"Upload Customer PO",product:"Product",freeStock:"Free Stock",discountPercent:"Discount %",taxPercent:"Tax %",lineTotal:"Line Total",itemDeliveryDate:"Item Delivery Date",notes:"Notes",grandTotal:"Grand Total",saveAsDraft:"Save as Draft",submitForApproval:"Submit for Approval"},finance:{title:"Finance",dashboard:"Dashboard",expenses:"Expenses",reports:"Reports",importCosts:"Import Costs",salesRevenue:"Sales Revenue",grossProfit:"Gross Profit",profitMargin:"Profit Margin",addExpense:"Add Expense",expenseCategory:"Category",amount:"Amount",expenseDate:"Date"},settings:{title:"Settings",companyProfile:"Company Profile",taxSettings:"Tax Settings",emailSettings:"Email Settings",systemSettings:"System Settings",companyName:"Company Name",companyAddress:"Company Address",companyPhone:"Company Phone",companyEmail:"Company Email",companyTaxId:"Company Tax ID",defaultTaxRate:"Default Tax Rate",invoicePrefix:"Invoice Prefix",lowStockThreshold:"Low Stock Threshold",expiryAlertDays:"Expiry Alert Days"}},id:{common:{search:"Cari",filter:"Filter",export:"Ekspor",add:"Tambah",edit:"Edit",delete:"Hapus",save:"Simpan",cancel:"Batal",close:"Tutup",submit:"Kirim",actions:"Aksi",loading:"Memuat...",noData:"Tidak ada data",confirm:"Konfirmasi",yes:"Ya",no:"Tidak",success:"Berhasil",error:"Error",warning:"Peringatan"},auth:{login:"Masuk",logout:"Keluar",email:"Email",password:"Kata Sandi",signIn:"Masuk",signOut:"Keluar",welcomeBack:"Selamat Datang Kembali",enterCredentials:"Masukkan kredensial Anda untuk melanjutkan"},nav:{dashboard:"Dasbor",products:"Produk",stock:"Stok",batches:"Batch",inventory:"Inventaris",customers:"Pelanggan",crm:"CRM",deliveryChallan:"Surat Jalan",sales:"Penjualan",finance:"Keuangan",settings:"Pengaturan",users:"Pengguna"},commandCenter:{title:"Pusat Komando CRM",subtitle:"Pemrosesan pertanyaan ultra-cepat dengan otomasi AI",emailList:"Kotak Masuk Email",inquiryForm:"Formulir Pertanyaan",quickActions:"Aksi Cepat",todaysActions:"Aksi Hari Ini",parseEmail:"Parse Email",parsing:"Memproses...",autoFilled:"Diisi otomatis oleh AI",confidence:"Kepercayaan",saveInquiry:"Simpan Pertanyaan",saving:"Menyimpan...",sendPrice:"Kirim Harga",sendCOA:"Kirim COA",sendMSDS:"Kirim MSDS",sendSample:"Kirim Sample",logActivity:"Catat Aktivitas",noEmailSelected:"Pilih email untuk diproses",noInquirySelected:"Pilih pertanyaan untuk aksi cepat",selectEmail:"Pilih email dari daftar",emailFrom:"Dari",emailDate:"Tanggal",requestedItems:"Diminta",priority:"Prioritas",activityType:"Jenis Aktivitas",activityOutcome:"Hasil",activityNotes:"Catatan",dueReminders:"Pengingat Jatuh Tempo",upcomingFollowups:"Tindak Lanjut Mendatang",recentActivity:"Aktivitas Terbaru",viewAll:"Lihat Semua",noReminders:"Tidak ada pengingat jatuh tempo",noFollowups:"Tidak ada tindak lanjut mendatang",noActivity:"Tidak ada aktivitas terbaru",priorities:{low:"Rendah",medium:"Sedang",high:"Tinggi",urgent:"Mendesak"},statuses:{new:"Pertanyaan Baru",price_quoted:"Harga Dikutip",coa_pending:"COA Tertunda",sample_sent:"Sample Terkirim",negotiation:"Negosiasi",po_received:"PO Diterima",won:"Menang",lost:"Kalah"},activities:{email_sent:"Email Terkirim",phone_call:"Panggilan Telepon",meeting:"Pertemuan",document_sent:"Dokumen Terkirim",follow_up:"Tindak Lanjut",note:"Catatan"},outcomes:{positive:"Positif",neutral:"Netral",negative:"Negatif",pending:"Menunggu Respons"}},dashboard:{title:"Dasbor",totalProducts:"Total Produk",lowStock:"Stok Rendah",nearExpiry:"Mendekati Kadaluarsa",totalCustomers:"Total Pelanggan",salesThisMonth:"Penjualan Bulan Ini",revenueThisMonth:"Pendapatan Bulan Ini",profitThisMonth:"Laba Bulan Ini",pendingFollowUps:"Follow-up Tertunda"},products:{title:"Produk",addProduct:"Tambah Produk",editProduct:"Edit Produk",productName:"Nama Produk",productCode:"Kode Produk",hsnCode:"Kode HSN",category:"Kategori",unit:"Satuan",packagingType:"Jenis Kemasan",defaultSupplier:"Pemasok Default",description:"Deskripsi",uploadFiles:"Unggah File",categories:{api:"API",excipient:"Excipient",solvent:"Pelarut",other:"Lainnya"},units:{kg:"Kilogram",litre:"Liter",ton:"Ton",piece:"Buah"}},batches:{title:"Batch",addBatch:"Tambah Batch",editBatch:"Edit Batch",batchNumber:"Nomor Batch",product:"Produk",importDate:"Tanggal Impor",importQuantity:"Jumlah Impor",currentStock:"Stok Saat Ini",packagingDetails:"Detail Kemasan",importPrice:"Harga Impor",dutyCharges:"Biaya Bea",freightCharges:"Biaya Pengiriman",otherCharges:"Biaya Lainnya",totalCost:"Total Biaya",costPerUnit:"Biaya Per Unit",expiryDate:"Tanggal Kadaluarsa",warehouseLocation:"Lokasi Gudang",uploadDocuments:"Unggah Dokumen"},inventory:{title:"Inventaris",stockSummary:"Ringkasan Stok",batchWiseStock:"Stok Per Batch",lowStockAlert:"Peringatan Stok Rendah",expiryAlert:"Peringatan Kadaluarsa",stockMovement:"Pergerakan Stok",adjustStock:"Sesuaikan Stok"},customers:{title:"Pelanggan",addCustomer:"Tambah Pelanggan",editCustomer:"Edit Pelanggan",customerName:"Nama Pelanggan",companyName:"Nama Perusahaan",npwp:"NPWP",address:"Alamat",city:"Kota",country:"Negara",contactPerson:"Orang yang Dihubungi",email:"Email",phone:"Telepon",gstVatType:"Jenis GST/VAT",paymentTerms:"Syarat Pembayaran"},crm:{title:"CRM",leads:"Prospek",activities:"Aktivitas",addLead:"Tambah Prospek",editLead:"Edit Prospek",companyName:"Nama Perusahaan",contactPerson:"Orang yang Dihubungi",productInterest:"Produk yang Diminati",quantityInterest:"Jumlah yang Diminati",leadSource:"Sumber Prospek",status:"Status",assignedTo:"Ditugaskan Kepada",expectedCloseDate:"Tanggal Penutupan yang Diharapkan",estimatedValue:"Nilai Perkiraan",addActivity:"Tambah Aktivitas",followUp:"Tindak Lanjut",statuses:{inquiry:"Pertanyaan",quotation:"Penawaran",negotiation:"Negosiasi",won:"Menang",lost:"Kalah"}},sales:{title:"Penjualan",invoices:"Faktur",createInvoice:"Buat Faktur",invoiceNumber:"Nomor Faktur",customer:"Pelanggan",invoiceDate:"Tanggal Faktur",dueDate:"Tanggal Jatuh Tempo",items:"Item",addItem:"Tambah Item",quantity:"Jumlah",unitPrice:"Harga Satuan",taxRate:"Tarif Pajak",subtotal:"Subtotal",tax:"Pajak",discount:"Diskon",total:"Total",paymentStatus:"Status Pembayaran",deliveryChallan:"Surat Jalan",generatePDF:"Buat PDF",sendEmail:"Kirim Email"},salesOrders:{title:"Sales Order",createSalesOrder:"Buat Sales Order",customerPoNumber:"Nomor PO Pelanggan",customerPoDate:"Tanggal PO Pelanggan",soDate:"Tanggal Sales Order",expectedDeliveryDate:"Tanggal Pengiriman Diharapkan",uploadPo:"Unggah PO Pelanggan",product:"Produk",freeStock:"Stok Tersedia",discountPercent:"Diskon %",taxPercent:"Pajak %",lineTotal:"Total Baris",itemDeliveryDate:"Tanggal Pengiriman Item",notes:"Catatan",grandTotal:"Total Keseluruhan",saveAsDraft:"Simpan sebagai Draft",submitForApproval:"Kirim untuk Persetujuan"},finance:{title:"Keuangan",dashboard:"Dasbor",expenses:"Pengeluaran",reports:"Laporan",importCosts:"Biaya Impor",salesRevenue:"Pendapatan Penjualan",grossProfit:"Laba Kotor",profitMargin:"Margin Laba",addExpense:"Tambah Pengeluaran",expenseCategory:"Kategori",amount:"Jumlah",expenseDate:"Tanggal"},settings:{title:"Pengaturan",companyProfile:"Profil Perusahaan",taxSettings:"Pengaturan Pajak",emailSettings:"Pengaturan Email",systemSettings:"Pengaturan Sistem",companyName:"Nama Perusahaan",companyAddress:"Alamat Perusahaan",companyPhone:"Telepon Perusahaan",companyEmail:"Email Perusahaan",companyTaxId:"ID Pajak Perusahaan",defaultTaxRate:"Tarif Pajak Default",invoicePrefix:"Awalan Faktur",lowStockThreshold:"Ambang Stok Rendah",expiryAlertDays:"Hari Peringatan Kadaluarsa"}}},aF=Z.createContext(void 0);function L7({children:e}){const[t,r]=Z.useState("en");Z.useEffect(()=>{const s=localStorage.getItem("language");s&&(s==="en"||s==="id")&&r(s)},[]);const n=s=>{r(s),localStorage.setItem("language",s)},a=s=>{const o=s.split(".");let l=I7[t];for(const c of o)if(l&&typeof l=="object"&&c in l)l=l[c];else return s;return typeof l=="string"?l:s};return i.jsx(aF.Provider,{value:{language:t,setLanguage:n,t:a},children:e})}function ba(){const e=Z.useContext(aF);if(e===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return e}const sF=Z.createContext(void 0);function O7({children:e}){const[t,r]=Z.useState("dashboard"),[n,a]=Z.useState(null),[s,o]=Z.useState(!1),l=()=>a(null);return i.jsx(sF.Provider,{value:{currentPage:t,setCurrentPage:r,navigationData:n,setNavigationData:a,clearNavigationData:l,sidebarCollapsed:s,setSidebarCollapsed:o},children:e})}function Mo(){const e=Z.useContext(sF);if(e===void 0)throw new Error("useNavigation must be used within a NavigationProvider");return e}const iF="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Creator:%20CorelDRAW%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='48.8745mm'%20height='48.2317mm'%20version='1.1'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20viewBox='0%200%2015686.55%2015480.24'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20xmlns:xodm='http://www.corel.com/coreldraw/odm/2003'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c![CDATA[%20.fil1%20{fill:%23FD6D26}%20.fil0%20{fill:%23FDB763}%20]]%3e%3c/style%3e%3c/defs%3e%3cg%20id='Layer_x0020_1'%3e%3cmetadata%20id='CorelCorpID_0Corel-Layer'/%3e%3cg%20id='_105553262742272'%3e%3cpath%20class='fil0'%20d='M69.94%2010438.12l10353.39%200%200%20-1798.67%201665.92%200%200%201868.6%200%20320.44%200%204552.28c0,38.48%20-31.45,69.94%20-69.94,69.94l-11949.38%200c-38.48,0%20-69.94,-31.45%20-69.94,-69.94l0%20-4872.72c0,-38.48%2031.45,-69.94%2069.94,-69.94zm1605.9%201710.15l8737.57%200c13.58,0%2024.68,11.11%2024.68,24.68l0%201719.84c0,13.58%20-11.11,24.68%20-24.68,24.68l-8737.57%200c-13.58,0%20-24.68,-11.11%20-24.68,-24.68l0%20-1719.84c0,-13.58%2011.11,-24.68%2024.68,-24.68z'/%3e%3cpath%20class='fil0'%20d='M15587.15%205136.67l-10353.49%200%200%201822.07%20-1665.92%200%200%20-1892.9%200%20-324.61%200%20-4611.43c0,-39%2031.45,-70.87%2069.94,-70.87l11949.47%200c38.48,0%2069.94,31.87%2069.94,70.87l0%204936.04c0,39%20-31.45,70.83%20-69.94,70.83zm-1605.9%20-1732.36l-8737.67%200c-13.58,0%20-24.68,-11.27%20-24.68,-25l0%20-1742.21c0,-13.74%2011.11,-25%2024.68,-25l8737.67%200c13.58,0%2024.68,11.27%2024.68,25l0%201742.21c0,13.74%20-11.11,25%20-24.68,25z'/%3e%3cpolygon%20class='fil1'%20points='-0,0%201651.16,0%201651.16,6929.27%2015657.09,6929.27%2015657.09,6958.74%2015686.55,6958.74%2015686.55,15480.24%2014022.85,15480.24%2014022.85,8639.45%201651.16,8639.45%20-0,8639.45%20-0,6929.27%20'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";function U7(){const[e,t]=Z.useState(""),[r,n]=Z.useState(""),[a,s]=Z.useState(!1),[o,l]=Z.useState(""),{signIn:c}=Dr(),{t:u}=ba(),A=async h=>{h.preventDefault(),l(""),s(!0);try{await c(e,r)}catch{l("Invalid username or password")}finally{s(!1)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-8",children:[i.jsxs("div",{className:"flex flex-col items-center mb-8",children:[i.jsx("div",{className:"mb-4",children:i.jsx("img",{src:iF,alt:"Company Logo",className:"h-24 w-24 mx-auto"})}),i.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center",children:"PT. SHUBHAM ANZEN"}),i.jsx("h2",{className:"text-xl font-bold text-gray-900 text-center",children:"PHARMA JAYA"})]}),i.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-2",children:u("auth.welcomeBack")}),i.jsx("p",{className:"text-gray-600 text-center mb-8",children:u("auth.enterCredentials")}),i.jsxs("form",{onSubmit:A,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),i.jsx("input",{id:"username",type:"text",value:e,onChange:h=>t(h.target.value),required:!0,autoComplete:"username",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"username"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your username (e.g., admin, kunal, sales)"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:u("auth.password")}),i.jsx("input",{id:"password",type:"password",value:r,onChange:h=>n(h.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:""})]}),o&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o}),i.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:u(a?"common.loading":"auth.signIn")})]})]})})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var P7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D7=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),dt=(e,t)=>{const r=Z.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:l="",children:c,...u},A)=>Z.createElement("svg",{ref:A,...P7,width:a,height:a,stroke:n,strokeWidth:o?Number(s)*24/Number(a):s,className:["lucide",`lucide-${D7(e)}`,l].join(" "),...u},[...t.map(([h,f])=>Z.createElement(h,f)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R7=dt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=dt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=dt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=dt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q7=dt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M7=dt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=dt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=dt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H7=dt("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mv=dt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q7=dt("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gv=dt("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=dt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K7=dt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=dt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $7=dt("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=dt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=dt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=dt("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V7=dt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=dt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G7=dt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ld=dt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=dt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W7=dt("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=dt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=dt("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=dt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z7=dt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X7=dt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=dt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=dt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sg=dt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=dt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=dt("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y7=dt("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J7=dt("FileOutput",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4 7V4a2 2 0 0 1 2-2 2 2 0 0 0-2 2",key:"1vk7w2"}],["path",{d:"M4.063 20.999a2 2 0 0 0 2 1L18 22a2 2 0 0 0 2-2V7l-5-5H6",key:"1jink5"}],["path",{d:"m5 11-3 3",key:"1dgrs4"}],["path",{d:"m5 17-3-3h10",key:"1mvvaf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=dt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=dt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=dt("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z7=dt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=dt("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=dt("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=dt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=dt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=dt("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=dt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=dt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=dt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=dt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=dt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=dt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=dt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=dt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=dt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=dt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=dt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0=dt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=dt("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=dt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=dt("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=dt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=dt("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=dt("PauseCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=dt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kl=dt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=dt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wb=dt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=dt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ec=dt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=dt("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=dt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xv=dt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hc=dt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=dt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=dt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=dt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cd=dt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=dt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vv=dt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=dt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=dt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=dt("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=dt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=dt("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=dt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=dt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=dt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=dt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=dt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=dt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=dt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=dt("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=dt("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=dt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=dt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=dt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function AR(){const[e,t]=Z.useState(!1),[r,n]=Z.useState([]),[a,s]=Z.useState(0),{user:o}=Dr();Z.useEffect(()=>{if(o){l();const f=setInterval(l,6e4);return()=>clearInterval(f)}},[o]);const l=async()=>{try{const{data:f,error:d}=await de.from("notifications").select("*").eq("user_id",o==null?void 0:o.id).order("created_at",{ascending:!1}).limit(10);if(d)throw d;n(f||[]),s((f==null?void 0:f.filter(v=>!v.is_read).length)||0)}catch(f){console.error("Error loading notifications:",f)}},c=async f=>{try{const{error:d}=await de.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("id",f);if(d)throw d;l()}catch(d){console.error("Error marking notification as read:",d)}},u=async()=>{try{const{error:f}=await de.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("user_id",o==null?void 0:o.id).eq("is_read",!1);if(f)throw f;l()}catch(f){console.error("Error marking all as read:",f)}},A=f=>{switch(f){case"low_stock":return i.jsx(Po,{className:"w-5 h-5 text-orange-600"});case"near_expiry":return i.jsx(ts,{className:"w-5 h-5 text-red-600"});case"pending_invoice":return i.jsx(pr,{className:"w-5 h-5 text-blue-600"});case"follow_up":return i.jsx(mv,{className:"w-5 h-5 text-purple-600"});case"task_assigned":return i.jsx(Xh,{className:"w-5 h-5 text-blue-600"});case"task_mention":return i.jsx(H7,{className:"w-5 h-5 text-purple-600"});case"task_comment":return i.jsx(_0,{className:"w-5 h-5 text-green-600"});case"task_status_change":return i.jsx(Xh,{className:"w-5 h-5 text-orange-600"});case"task_deadline":return i.jsx(ts,{className:"w-5 h-5 text-red-600"});default:return i.jsx(si,{className:"w-5 h-5 text-gray-600"})}},h=f=>{const d=new Date(f),g=new Date().getTime()-d.getTime(),y=Math.floor(g/6e4),p=Math.floor(g/36e5),m=Math.floor(g/864e5);return y<1?"Just now":y<60?`${y}m ago`:p<24?`${p}h ago`:m<7?`${m}d ago`:d.toLocaleDateString()};return i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>t(!e),className:"p-2 rounded hover:bg-gray-100 relative",children:[i.jsx(mv,{className:"w-5 h-5 text-gray-600"}),a>0&&i.jsx("span",{className:"absolute top-1 right-1 w-5 h-5 bg-red-500 rounded-full text-white text-xs flex items-center justify-center font-semibold",children:a>9?"9+":a})]}),e&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>t(!1)}),i.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-xl border border-gray-200 z-40",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),i.jsxs("div",{className:"flex items-center gap-2",children:[a>0&&i.jsxs("button",{onClick:u,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[i.jsx($7,{className:"w-4 h-4"}),"Mark all read"]}),i.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:i.jsx(An,{className:"w-5 h-5"})})]})]}),i.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.length===0?i.jsxs("div",{className:"p-8 text-center text-gray-500",children:[i.jsx(mv,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{children:"No notifications"})]}):r.map(f=>i.jsx("div",{className:`p-4 border-b hover:bg-gray-50 cursor-pointer transition ${f.is_read?"":"bg-blue-50"}`,onClick:()=>{f.is_read||c(f.id)},children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-1",children:A(f.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("p",{className:`text-sm font-medium ${f.is_read?"text-gray-700":"text-gray-900"}`,children:f.title}),!f.is_read&&i.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full flex-shrink-0 mt-1.5"})]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:f.message}),i.jsx("p",{className:"text-xs text-gray-400 mt-2",children:h(f.created_at)})]})]})},f.id))}),r.length>0&&i.jsx("div",{className:"p-3 border-t bg-gray-50 text-center",children:i.jsxs("p",{className:"text-xs text-gray-500",children:["Showing last ",r.length," notifications"]})})]})]})]})}function ca({children:e}){const[t,r]=Z.useState(!1),{profile:n,signOut:a}=Dr(),{language:s,setLanguage:o,t:l}=ba(),{currentPage:c,setCurrentPage:u,sidebarCollapsed:A,setSidebarCollapsed:h}=Mo(),d=["crm","command-center"].includes(c);Z.useEffect(()=>{d&&!A&&h(!0)},[c,d,A,h]);const g=[{id:"dashboard",label:l("nav.dashboard"),icon:eR,roles:["admin","accounts","sales","warehouse"]},{id:"products",label:l("nav.products"),icon:si,roles:["admin","sales","warehouse"]},{id:"batches",label:l("nav.batches"),icon:q7,roles:["admin","warehouse","accounts"]},{id:"stock",label:l("nav.stock"),icon:CN,roles:["admin","sales","warehouse","accounts"]},{id:"customers",label:l("nav.customers"),icon:Qu,roles:["admin","accounts","sales"]},{id:"sales-orders",label:"Sales Orders",icon:pr,roles:["admin","accounts","sales"]},{id:"delivery-challan",label:l("nav.deliveryChallan"),icon:vF,roles:["admin","accounts","sales","warehouse"]},{id:"sales",label:l("nav.sales"),icon:cR,roles:["admin","accounts","sales"]},{id:"import-requirements",label:"Import Requirements",icon:Ao,roles:["admin","warehouse","sales"]},{id:"finance",label:l("nav.finance"),icon:Ro,roles:["admin","accounts"]},{id:"crm",label:l("nav.crm"),icon:W7,roles:["admin","sales"]},{id:"command-center",label:"Command Center",icon:wF,roles:["admin","sales"]},{id:"tasks",label:"Tasks",icon:Xh,roles:["admin","accounts","sales","warehouse"]},{id:"inventory",label:l("nav.inventory"),icon:CN,roles:["admin","warehouse"]},{id:"settings",label:l("nav.settings"),icon:gF,roles:["admin"]}].filter(p=>n&&p.roles.includes(n.role)),y=()=>{o(s==="en"?"id":"en")};return i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t&&i.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 z-20 lg:hidden transition-opacity",onClick:()=>r(!1)}),i.jsxs("aside",{className:`fixed top-0 left-0 z-30 h-full bg-white border-r border-gray-200 transform transition-all lg:translate-x-0 ${t?"translate-x-0":"-translate-x-full"} ${A&&d?"w-16":"w-64"} flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("img",{src:iF,alt:"Logo",className:"h-8 w-8 flex-shrink-0"}),!(A&&d)&&i.jsxs("div",{className:"flex flex-col leading-tight",children:[i.jsx("span",{className:"text-xs font-bold text-gray-900",children:"PT. SHUBHAM ANZEN"}),i.jsx("span",{className:"text-xs font-bold text-gray-900",children:"PHARMA JAYA"})]})]}),i.jsx("button",{onClick:()=>r(!1),className:"lg:hidden p-1 rounded hover:bg-gray-100",children:i.jsx(An,{className:"w-5 h-5"})})]}),i.jsx("nav",{className:"flex-1 overflow-y-auto p-3 space-y-1",children:g.map(p=>{const m=p.icon,w=c===p.id;return i.jsxs("button",{onClick:()=>{u(p.id),r(!1)},className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg transition relative group ${w?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50"} ${A&&d?"justify-center":""}`,title:A&&d?p.label:"",children:[i.jsx(m,{className:"w-5 h-5 flex-shrink-0"}),!(A&&d)&&i.jsx("span",{className:"font-medium text-sm",children:p.label}),A&&d&&i.jsx("span",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity z-50",children:p.label})]},p.id)})})]}),i.jsxs("div",{className:`transition-all ${A&&d?"lg:pl-16":"lg:pl-64"}`,children:[i.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:i.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>r(!0),className:"lg:hidden p-2 rounded hover:bg-gray-100",children:i.jsx(_N,{className:"w-6 h-6"})}),d&&i.jsx("button",{onClick:()=>h(!A),className:"hidden lg:block p-2 rounded hover:bg-gray-100",title:A?"Expand sidebar":"Collapse sidebar",children:i.jsx(_N,{className:"w-6 h-6"})})]}),i.jsx("div",{className:"flex-1"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(AR,{}),i.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100",children:[i.jsx(dF,{className:"w-5 h-5 text-gray-600"}),i.jsx("span",{className:"text-sm font-medium text-gray-700 uppercase",children:s})]}),i.jsxs("button",{onClick:()=>a(),className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100 text-gray-700",children:[i.jsx(mF,{className:"w-5 h-5"}),i.jsx("span",{className:"text-sm font-medium",children:l("auth.logout")})]})]})]})}),i.jsx("main",{className:"p-4 lg:p-6",children:e})]})]})}function dR({onActionClick:e}){const{profile:t}=Dr(),{setCurrentPage:r}=Mo(),[n,a]=Z.useState([]),[s,o]=Z.useState([]),[l,c]=Z.useState(0),[u,A]=Z.useState(0),[h,f]=Z.useState(!0);Z.useEffect(()=>{d(),v();const w=de.channel("reminders_changes").on("postgres_changes",{event:"*",schema:"public",table:"crm_reminders"},()=>{d()}).subscribe();return()=>{w.unsubscribe()}},[]);const d=async()=>{try{const w=new Date;w.setHours(0,0,0,0);const x=new Date(w);x.setDate(x.getDate()+1);const{data:b,error:B}=await de.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `).eq("is_completed",!1).gte("due_date",w.toISOString()).lt("due_date",x.toISOString()).order("due_date",{ascending:!0}).limit(5);if(B)throw B;const{data:_,error:k}=await de.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `).eq("is_completed",!1).lt("due_date",w.toISOString()).order("due_date",{ascending:!0}).limit(5);if(k)throw k;a(b||[]),o(_||[])}catch(w){console.error("Error loading reminders:",w)}finally{f(!1)}},v=async()=>{try{if((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales"){const{count:w}=await de.from("sales_orders").select("id",{count:"exact",head:!0}).eq("status","pending_approval");c(w||0)}if((t==null?void 0:t.role)==="admin"){const{count:w}=await de.from("delivery_challans").select("id",{count:"exact",head:!0}).eq("approval_status","pending_approval");A(w||0)}}catch(w){console.error("Error loading approvals:",w)}},g=async w=>{try{const{error:x}=await de.from("crm_reminders").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",w);if(x)throw x;d()}catch(x){console.error("Error completing reminder:",x)}},y=w=>{switch(w){case"send_price":case"send_coa":case"send_sample":return Ii;case"follow_up":return kl;default:return as}},p=w=>{switch(w){case"send_price":return"text-green-600";case"send_coa":return"text-blue-600";case"send_sample":return"text-purple-600";case"follow_up":return"text-orange-600";default:return"text-gray-600"}};if(h)return i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"animate-pulse space-y-4",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),i.jsx("div",{className:"h-10 bg-gray-200 rounded"}),i.jsx("div",{className:"h-10 bg-gray-200 rounded"})]})});const m=n.length+s.length+l+u;return m===0?i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(ts,{className:"w-5 h-5 text-blue-600"}),"Today's Actions"]}),i.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-700 rounded-full",children:"All Clear!"})]}),i.jsxs("div",{className:"text-center py-8",children:[i.jsx(io,{className:"w-16 h-16 text-green-500 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-600",children:"No pending actions for today"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Great job staying on top of everything!"})]})]}):i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(ts,{className:"w-5 h-5 text-blue-600"}),"Today's Actions"]}),i.jsxs("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:[m," ",m===1?"Action":"Actions"]})]})}),i.jsxs("div",{className:"p-4 space-y-3",children:[(l>0||u>0)&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(ya,{className:"w-4 h-4 text-yellow-600"}),i.jsx("h3",{className:"text-sm font-semibold text-yellow-600",children:"Pending Approvals"})]}),i.jsxs("div",{className:"space-y-2",children:[l>0&&i.jsxs("div",{onClick:()=>r("sales-orders"),className:"flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg hover:shadow-md transition cursor-pointer",children:[i.jsx(pr,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Sales Orders Pending Approval"}),i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[l," order",l!==1?"s":""," waiting for your review"]})]}),i.jsx(ld,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]}),u>0&&i.jsxs("div",{onClick:()=>r("delivery-challan"),className:"flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg hover:shadow-md transition cursor-pointer",children:[i.jsx(cF,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Delivery Challans Pending Approval"}),i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[u," challan",u!==1?"s":""," waiting for your review"]})]}),i.jsx(ld,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]})]})]}),s.length>0&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(ya,{className:"w-4 h-4 text-red-600"}),i.jsxs("h3",{className:"text-sm font-semibold text-red-600",children:["Overdue (",s.length,")"]})]}),i.jsx("div",{className:"space-y-2",children:s.map(w=>{const x=y(w.reminder_type),b=p(w.reminder_type);return i.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg hover:shadow-sm transition",children:[i.jsx(x,{className:`w-4 h-4 ${b} mt-0.5 flex-shrink-0`}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:w.title}),w.crm_inquiries&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5 truncate",children:["#",w.crm_inquiries.inquiry_number," - ",w.crm_inquiries.company_name]}),i.jsxs("p",{className:"text-xs text-red-600 font-medium mt-1",children:[Math.abs(Math.floor((new Date().getTime()-new Date(w.due_date).getTime())/(1e3*60*60*24)))," days overdue"]})]}),i.jsx("button",{onClick:()=>g(w.id),className:"p-1 text-gray-400 hover:text-green-600 flex-shrink-0",title:"Mark as complete",children:i.jsx(io,{className:"w-5 h-5"})})]},w.id)})})]}),n.length>0&&i.jsxs("div",{children:[s.length>0&&i.jsxs("div",{className:"flex items-center gap-2 mb-2 mt-4",children:[i.jsx(ts,{className:"w-4 h-4 text-blue-600"}),i.jsxs("h3",{className:"text-sm font-semibold text-blue-600",children:["Today (",n.length,")"]})]}),i.jsx("div",{className:"space-y-2",children:n.map(w=>{const x=y(w.reminder_type),b=p(w.reminder_type);return i.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 border border-blue-200 rounded-lg hover:shadow-sm transition",children:[i.jsx(x,{className:`w-4 h-4 ${b} mt-0.5 flex-shrink-0`}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:w.title}),w.crm_inquiries&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5 truncate",children:["#",w.crm_inquiries.inquiry_number," - ",w.crm_inquiries.company_name]}),i.jsx("p",{className:"text-xs text-blue-600 mt-1",children:new Date(w.due_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),i.jsx("button",{onClick:()=>g(w.id),className:"p-1 text-gray-400 hover:text-green-600 flex-shrink-0",title:"Mark as complete",children:i.jsx(io,{className:"w-5 h-5"})})]},w.id)})})]})]}),m>5&&i.jsx("div",{className:"p-3 border-t border-gray-200",children:i.jsxs("button",{className:"w-full flex items-center justify-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[i.jsx("span",{children:"View All Actions"}),i.jsx(ld,{className:"w-4 h-4"})]})})]})}function EN(){const{t:e}=ba(),{profile:t}=Dr(),{setCurrentPage:r}=Mo(),[n,a]=Z.useState({totalProducts:0,lowStockItems:0,nearExpiryBatches:0,totalCustomers:0,salesThisMonth:0,revenueThisMonth:0,profitThisMonth:0,pendingFollowUps:0,pendingSalesOrders:0,pendingDeliveryChallans:0,overdueInvoicesCount:0,overdueInvoicesAmount:0}),[s,o]=Z.useState(!0);Z.useEffect(()=>{l()},[]);const l=async()=>{var f,d,v,g,y,p,m;try{const w=new Date,x=new Date(w.getFullYear(),w.getMonth(),1),b=new Date(w.getFullYear(),w.getMonth()+1,0,23,59,59),[B,_,k,E,T,S,j,I,U]=await Promise.all([de.from("products").select("id",{count:"exact",head:!0}).eq("is_active",!0),de.from("batches").select("*").eq("is_active",!0),de.from("customers").select("id",{count:"exact",head:!0}).eq("is_active",!0),de.from("sales_invoices").select("total_amount, subtotal, created_at, invoice_date").gte("invoice_date",x.toISOString()).lte("invoice_date",b.toISOString()),de.from("crm_activities").select("id",{count:"exact"}).eq("is_completed",!1).not("follow_up_date","is",null),de.from("app_settings").select("low_stock_threshold").maybeSingle(),de.from("sales_orders").select("id",{count:"exact",head:!0}).eq("status","pending_approval"),de.from("delivery_challans").select("id",{count:"exact",head:!0}).eq("approval_status","pending_approval"),de.from("sales_invoices").select("id, total_amount, due_date").in("payment_status",["pending","partial"]).lt("due_date",new Date().toISOString().split("T")[0])]),q=((f=S==null?void 0:S.data)==null?void 0:f.low_stock_threshold)||100,V=((d=_.data)==null?void 0:d.filter(O=>O.current_stock<q).length)||0,X=new Date;X.setDate(X.getDate()+30);const W=((v=_.data)==null?void 0:v.filter(O=>O.expiry_date&&new Date(O.expiry_date)<=X&&new Date(O.expiry_date)>=new Date).length)||0,M=((g=E.data)==null?void 0:g.reduce((O,D)=>O+(Number(D.total_amount)||0),0))||0,G=((y=E.data)==null?void 0:y.reduce((O,D)=>O+(Number(D.subtotal)||0),0))||0,H=M-G*.7,L=(await Promise.all((U.data||[]).map(async O=>{const{data:D}=await de.rpc("get_invoice_paid_amount",{p_invoice_id:O.id}),P=D||0;return O.total_amount-P}))).reduce((O,D)=>O+D,0);a({totalProducts:B.count||0,lowStockItems:V,nearExpiryBatches:W,totalCustomers:k.count||0,salesThisMonth:((p=E.data)==null?void 0:p.length)||0,revenueThisMonth:M,profitThisMonth:Math.max(0,H),pendingFollowUps:T.count||0,pendingSalesOrders:j.count||0,pendingDeliveryChallans:I.count||0,overdueInvoicesCount:((m=U.data)==null?void 0:m.length)||0,overdueInvoicesAmount:L})}catch(w){console.error("Error loading dashboard:",w)}finally{o(!1)}},c=[{title:e("dashboard.lowStock"),value:n.lowStockItems,icon:Po,color:"orange"},{title:e("dashboard.nearExpiry"),value:n.nearExpiryBatches,icon:ts,color:"red"},{title:e("dashboard.salesThisMonth"),value:n.salesThisMonth,icon:Ao,color:"blue"}],u=[];((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts")&&u.push({title:"Overdue Invoices",value:n.overdueInvoicesCount,subtitle:`Rp ${n.overdueInvoicesAmount.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,icon:Po,color:"red-gradient",link:"sales"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales")&&u.push({title:"Pending PO Approvals",value:n.pendingSalesOrders,icon:pr,color:"yellow",link:"sales-orders"}),(t==null?void 0:t.role)==="admin"&&u.push({title:"Pending DC Approvals",value:n.pendingDeliveryChallans,icon:cF,color:"yellow",link:"delivery-challan"});const A=[...u,...c],h={blue:{bg:"bg-blue-50",text:"text-blue-600",icon:"bg-blue-100"},orange:{bg:"bg-orange-50",text:"text-orange-600",icon:"bg-orange-100"},red:{bg:"bg-red-50",text:"text-red-600",icon:"bg-red-100"},"red-gradient":{bg:"bg-gradient-to-br from-red-500 to-orange-500",text:"text-white",icon:"bg-white/20"},green:{bg:"bg-green-50",text:"text-green-600",icon:"bg-green-100"},emerald:{bg:"bg-emerald-50",text:"text-emerald-600",icon:"bg-emerald-100"},purple:{bg:"bg-purple-50",text:"text-purple-600",icon:"bg-purple-100"},yellow:{bg:"bg-yellow-50",text:"text-yellow-600",icon:"bg-yellow-100"}};return i.jsx(ca,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("dashboard.title")}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome to your pharma trading management system"})]}),s?i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:[...Array(8)].map((f,d)=>i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 animate-pulse",children:[i.jsx("div",{className:"h-10 bg-gray-200 rounded mb-3"}),i.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/2"})]},d))}):i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:A.map((f,d)=>{const v=f.icon,g=h[f.color],y=!!f.link;return i.jsx("div",{className:`${g.bg} rounded-lg shadow p-3 md:p-4 transition hover:shadow-lg ${y?"cursor-pointer":""}`,onClick:()=>y&&r(f.link),children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("p",{className:`text-xs md:text-sm font-medium ${f.color==="red-gradient"?"text-white/80":"text-gray-600"} truncate`,children:f.title}),i.jsx("p",{className:`text-xl md:text-2xl font-bold ${g.text} mt-1`,children:f.value}),f.subtitle&&i.jsx("p",{className:`text-xs mt-0.5 ${f.color==="red-gradient"?"text-white/90":"text-gray-500"} truncate`,children:f.subtitle})]}),i.jsx("div",{className:`${g.icon} p-2 md:p-3 rounded-full flex-shrink-0 ml-2`,children:i.jsx(v,{className:`w-4 h-4 md:w-5 md:h-5 ${g.text}`})})]})},d)})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[i.jsx("div",{className:"lg:col-span-2",children:i.jsx(dR,{})}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Links"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("a",{href:"#",className:"block p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition text-blue-700 font-medium",children:"Go to Command Center"}),i.jsx("a",{href:"#",className:"block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition text-gray-700 font-medium",children:"View All Inquiries"}),i.jsx("a",{href:"#",className:"block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition text-gray-700 font-medium",children:"Create Manual Inquiry"})]})]})]})]})})}function Ls({data:e,columns:t,onRowClick:r,actions:n,loading:a}){const[s,o]=Z.useState(""),[l,c]=Z.useState(null),{t:u}=ba(),A=d=>{let v="asc";(l==null?void 0:l.key)===d&&l.direction==="asc"&&(v="desc"),c({key:d,direction:v})},h=d=>{const v=[],g=y=>{y!=null&&(typeof y=="object"&&!Array.isArray(y)?Object.values(y).forEach(g):Array.isArray(y)?y.forEach(g):v.push(String(y)))};return Object.values(d).forEach(g),v},f=(()=>{let d=[...e];return s&&(d=d.filter(v=>h(v).some(g=>g.toLowerCase().includes(s.toLowerCase())))),l&&d.sort((v,g)=>{const y=v[l.key],p=g[l.key];return y<p?l.direction==="asc"?-1:1:y>p?l.direction==="asc"?1:-1:0}),d})();return a?i.jsx("div",{className:"bg-white rounded-lg shadow",children:i.jsxs("div",{className:"p-8 text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:u("common.loading")})]})}):i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsxs("div",{className:"relative",children:[i.jsx(Hc,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),i.jsx("input",{type:"text",value:s,onChange:d=>o(d.target.value),placeholder:u("common.search"),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[t.map(d=>i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d.sortable?i.jsxs("button",{onClick:()=>A(d.key),className:"flex items-center gap-1 hover:text-gray-700",children:[d.label,(l==null?void 0:l.key)===d.key?l.direction==="asc"?i.jsx(Hw,{className:"w-4 h-4"}):i.jsx(To,{className:"w-4 h-4"}):i.jsx(To,{className:"w-4 h-4 opacity-30"})]}):d.label},d.key)),n&&i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:u("common.actions")})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:t.length+(n?1:0),className:"px-6 py-8 text-center text-gray-500",children:u("common.noData")})}):f.map((d,v)=>i.jsxs("tr",{onClick:()=>r==null?void 0:r(d),className:r?"cursor-pointer hover:bg-gray-50":"",children:[t.map(g=>i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.render?g.render(d):d[g.key]},g.key)),n&&i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:n(d)})]},v))})]})})]})}function ir({isOpen:e,onClose:t,title:r,children:n,size:a="md"}){const{t:s}=ba();if(!e)return null;const o={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:i.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[i.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity",onClick:t}),i.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl ${o[a]} w-full max-h-[90vh] flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:r}),i.jsx("button",{onClick:t,className:"p-1 rounded hover:bg-gray-100 transition",children:i.jsx(An,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:n})]})]})})}function fR(){const{t:e}=ba(),{profile:t}=Dr(),[r,n]=Z.useState([]),[a,s]=Z.useState(!0),[o,l]=Z.useState(!1),[c,u]=Z.useState(null),[A,h]=Z.useState({product_name:"",hsn_code:"",category:"api",unit:"kg",packaging_type:"",default_supplier:"",description:"",min_stock_level:""});Z.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:m,error:w}=await de.from("products").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(w)throw w;n(m||[])}catch(m){console.error("Error loading products:",m)}finally{s(!1)}},d=async m=>{m.preventDefault();try{const w=parseFloat(A.min_stock_level)||null,x={product_name:A.product_name,product_code:null,hsn_code:A.hsn_code,category:A.category,unit:A.unit,packaging_type:A.packaging_type,default_supplier:A.default_supplier,description:A.description,min_stock_level:w};if(c){const{error:b}=await de.from("products").update(x).eq("id",c.id);if(b)throw b}else{const{error:b}=await de.from("products").insert([{...x,created_by:t==null?void 0:t.id}]);if(b)throw b}l(!1),y(),f()}catch(w){console.error("Error saving product:",w),alert("Failed to save product")}},v=m=>{var w;u(m),h({product_name:m.product_name,hsn_code:m.hsn_code,category:m.category,unit:m.unit,packaging_type:m.packaging_type,default_supplier:m.default_supplier,description:m.description,min_stock_level:((w=m.min_stock_level)==null?void 0:w.toString())||""}),l(!0)},g=async m=>{try{const{data:w}=await de.from("sales_invoice_items").select("id").eq("product_id",m.id).limit(1);if(w&&w.length>0){alert('Cannot delete this product. It has been used in sales invoices. Please use the "Deactivate" option instead or contact your administrator.');return}const{data:x}=await de.from("delivery_challan_items").select("id").eq("product_id",m.id).limit(1);if(x&&x.length>0){alert('Cannot delete this product. It has been used in delivery challans. Please use the "Deactivate" option instead.');return}const{data:b}=await de.from("batches").select("id, batch_number").eq("product_id",m.id);if(b&&b.length>0){if(!confirm(`This product has ${b.length} batch(es). Deleting this product will permanently remove:
- ${b.length} batches
- All related inventory transactions
- All related documents

Are you absolutely sure you want to continue?`))return}else if(!confirm("Are you sure you want to delete this product?"))return;if(b&&b.length>0){for(const _ of b)await de.from("batch_documents").delete().eq("batch_id",_.id),await de.from("inventory_transactions").delete().eq("batch_id",_.id),await de.from("finance_expenses").delete().eq("batch_id",_.id);await de.from("batches").delete().eq("product_id",m.id)}await de.from("inventory_transactions").delete().eq("product_id",m.id),await de.from("product_files").delete().eq("product_id",m.id);const{error:B}=await de.from("products").delete().eq("id",m.id);if(B)throw B;alert("Product deleted successfully"),await f()}catch(w){console.error("Error deleting product:",w);const x=(w==null?void 0:w.message)||"Unknown error occurred";alert(`Failed to delete product: ${x}

If this product is in use, consider deactivating it instead.`)}},y=()=>{u(null),h({product_name:"",hsn_code:"",category:"api",unit:"kg",packaging_type:"",default_supplier:"",description:"",min_stock_level:""})},p=[{key:"product_name",label:"Product Name"},{key:"hsn_code",label:"HSN Code"},{key:"category",label:"Category",render:m=>i.jsx("span",{className:"capitalize",children:m.category})},{key:"unit",label:"Unit",render:m=>i.jsx("span",{className:"capitalize",children:m.unit})},{key:"min_stock",label:"Min Stock Level",render:m=>i.jsx("span",{children:m.min_stock_level?`${m.min_stock_level} ${m.unit}`:"-"})}];return i.jsxs(ca,{children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Products"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your product catalog with packaging details"})]}),i.jsxs("button",{onClick:()=>{y(),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Add Product"]})]}),i.jsx(Ls,{data:r,columns:p,loading:a,actions:m=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>v(m),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",children:i.jsx(uo,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>g(m),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",children:i.jsx(wa,{className:"w-4 h-4"})})]})})]}),i.jsx(ir,{isOpen:o,onClose:()=>{l(!1),y()},title:c?"Edit Product":"Add Product",children:i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),i.jsx("input",{type:"text",required:!0,value:A.product_name,onChange:m=>h({...A,product_name:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HSN Code"}),i.jsx("input",{type:"text",value:A.hsn_code,onChange:m=>h({...A,hsn_code:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),i.jsxs("select",{required:!0,value:A.category,onChange:m=>h({...A,category:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[i.jsx("option",{value:"api",children:"API"}),i.jsx("option",{value:"excipient",children:"Excipient"}),i.jsx("option",{value:"solvent",children:"Solvent"}),i.jsx("option",{value:"other",children:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit *"}),i.jsxs("select",{required:!0,value:A.unit,onChange:m=>h({...A,unit:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[i.jsx("option",{value:"kg",children:"Kilogram"}),i.jsx("option",{value:"litre",children:"Litre"}),i.jsx("option",{value:"ton",children:"Ton"}),i.jsx("option",{value:"piece",children:"Piece"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Stock Level"}),i.jsx("input",{type:"number",step:"0.001",value:A.min_stock_level,onChange:m=>h({...A,min_stock_level:m.target.value}),placeholder:"e.g., 100",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Alert when stock falls below this level (in ",A.unit,")"]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Supplier"}),i.jsx("input",{type:"text",value:A.default_supplier,onChange:m=>h({...A,default_supplier:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:A.description,onChange:m=>h({...A,description:m.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{l(!1),y()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Save"})]})]})})]})}const bF=["Jakarta Barat","Jakarta Pusat","Jakarta Selatan","Jakarta Timur","Jakarta Utara","Surabaya","Bandung","Bekasi","Tangerang","Depok","Semarang","Palembang","South Tangerang","Makassar","Bogor","Batam","Pekanbaru","Bandar Lampung","Padang","Malang","Denpasar","Samarinda","Tasikmalaya","Pontianak","Cimahi","Balikpapan","Jambi","Surakarta (Solo)","Serang","Manado","Cilegon","Mataram","Yogyakarta","Kupang","Banjarmasin","Ambon","Sukabumi","Cirebon","Palu","Tegal","Binjai","Pekalongan","Kediri","Jayapura","Palangkaraya","Probolinggo","Tanjung Pinang","Banjar","Madiun","Banjarbaru","Tarakan","Bitung","Pangkal Pinang","Pasuruan","Ternate","Sorong","Bengkulu","Tanjungbalai","Dumai","Batu","Gorontalo","Bontang","Blitar","Metro","Pematang Siantar","Mojokerto","Magelang","Salatiga","Parepare","Bukittinggi","Singkawang","Lubuklinggau","Prabumulih","Langsa","Padang Sidempuan","Tebing Tinggi","Tanjung Balai","Sabang","Lhokseumawe","Subulussalam","Banda Aceh","Medan","Sibolga","Gunungsitoli"].sort(),hR=["Cash on Delivery","Net 7 days","Net 10 days","Net 15 days","Net 30 days","Net 45 days","Net 60 days","Net 90 days","End of Month","2/10 Net 30","1/10 Net 30","Due on Receipt","Advance Payment","50% Advance, 50% on Delivery","Monthly Billing"];function pR(){const{t:e}=ba(),{profile:t}=Dr(),[r,n]=Z.useState([]),[a,s]=Z.useState(!0),[o,l]=Z.useState(!1),[c,u]=Z.useState(null),[A,h]=Z.useState({company_name:"",npwp:"",address:"",city:"Jakarta Pusat",country:"Indonesia",contact_person:"",email:"",phone:"",pbf_license:"",gst_vat_type:"",payment_terms:""});Z.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:m,error:w}=await de.from("customers").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(w)throw w;n(m||[])}catch(m){console.error("Error loading customers:",m)}finally{s(!1)}},d=async m=>{m.preventDefault();try{if(c){const{error:w}=await de.from("customers").update(A).eq("id",c.id);if(w)throw w}else{const{error:w}=await de.from("customers").insert([{...A,created_by:t==null?void 0:t.id}]);if(w)throw w}l(!1),u(null),v(),f()}catch(w){console.error("Error saving customer:",w),alert("Failed to save customer")}},v=()=>{h({company_name:"",npwp:"",address:"",city:"Jakarta Pusat",country:"Indonesia",contact_person:"",email:"",phone:"",pbf_license:"",gst_vat_type:"",payment_terms:""})},g=m=>{u(m),h({company_name:m.company_name,npwp:m.npwp,address:m.address,city:m.city,country:m.country,contact_person:m.contact_person,email:m.email,phone:m.phone,pbf_license:m.pbf_license||"",gst_vat_type:m.gst_vat_type,payment_terms:m.payment_terms}),l(!0)},y=async m=>{if(confirm("Are you sure you want to delete this customer?"))try{const{error:w}=await de.from("customers").update({is_active:!1}).eq("id",m.id);if(w)throw w;f()}catch(w){console.error("Error deleting customer:",w),alert("Failed to delete customer")}},p=[{key:"company_name",label:e("customers.companyName"),sortable:!0},{key:"contact_person",label:e("customers.contactPerson"),sortable:!0,render:m=>i.jsxs("div",{children:[i.jsx("div",{children:m.contact_person}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[m.email&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(la,{className:"w-3 h-3"}),m.email]}),m.phone&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(kl,{className:"w-3 h-3"}),m.phone]})]})]})},{key:"city",label:e("customers.city"),sortable:!0},{key:"payment_terms",label:e("customers.paymentTerms"),sortable:!0}];return i.jsxs(ca,{children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("customers.title")}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your customer relationships"})]}),i.jsxs("button",{onClick:()=>{u(null),v(),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),e("customers.addCustomer")]})]}),i.jsx(Ls,{data:r,columns:p,loading:a,actions:m=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>g(m),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",children:i.jsx(uo,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>y(m),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",children:i.jsx(wa,{className:"w-4 h-4"})})]})})]}),i.jsx(ir,{isOpen:o,onClose:()=>l(!1),title:e(c?"customers.editCustomer":"customers.addCustomer"),size:"xl",children:i.jsxs("form",{onSubmit:d,className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e("customers.companyName")," *"]}),i.jsx("input",{type:"text",required:!0,value:A.company_name,onChange:m=>h({...A,company_name:m.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.npwp")}),i.jsx("input",{type:"text",value:A.npwp,onChange:m=>h({...A,npwp:m.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e("customers.contactPerson")," *"]}),i.jsx("input",{type:"text",required:!0,value:A.contact_person,onChange:m=>h({...A,contact_person:m.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.email")}),i.jsx("input",{type:"email",value:A.email,onChange:m=>h({...A,email:m.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.phone")}),i.jsx("input",{type:"tel",value:A.phone,onChange:m=>h({...A,phone:m.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PBF License (No.Izin PBF)"}),i.jsx("input",{type:"text",value:A.pbf_license,onChange:m=>h({...A,pbf_license:m.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"e.g., 01.001.722.9-411.000"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.city")}),i.jsxs("select",{value:A.city,onChange:m=>h({...A,city:m.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select City"}),bF.map(m=>i.jsx("option",{value:m,children:m},m))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.country")}),i.jsx("input",{type:"text",value:A.country,readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded bg-gray-50 text-gray-600"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.gstVatType")}),i.jsx("input",{type:"text",value:A.gst_vat_type,onChange:m=>h({...A,gst_vat_type:m.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.paymentTerms")}),i.jsxs("select",{value:A.payment_terms,onChange:m=>h({...A,payment_terms:m.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select Payment Terms"}),hR.map(m=>i.jsx("option",{value:m,children:m},m))]})]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.address")}),i.jsx("textarea",{value:A.address,onChange:m=>h({...A,address:m.target.value}),rows:2,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[i.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-3 py-1.5 text-sm text-gray-700 bg-gray-100 rounded hover:bg-gray-200 transition",children:e("common.cancel")}),i.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:e("common.save")})]})]})})]})}function mR(){const{t:e}=ba(),{setCurrentPage:t}=Mo(),[r,n]=Z.useState([]),[a,s]=Z.useState(!0),[o,l]=Z.useState(null),[c,u]=Z.useState([]);Z.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:_,error:k}=await de.from("product_stock_summary").select("*").order("product_name");if(k)throw k;const{data:E}=await de.from("import_requirements").select("product_id, shortage_quantity").in("status",["pending","ordered"]),T=new Map;E==null||E.forEach(I=>{const U=T.get(I.product_id)||0;T.set(I.product_id,U+Number(I.shortage_quantity))});const j=(await Promise.all((_||[]).map(async I=>{const{data:U}=await de.from("stock_reservations").select("reserved_quantity").eq("product_id",I.product_id).eq("is_released",!1),q=(U==null?void 0:U.reduce((M,G)=>M+Number(G.reserved_quantity),0))||0,V=T.get(I.product_id)||0,X=V>0?-V:q,W=I.total_current_stock-q;return{...I,reserved_quantity:X,available_quantity:W}}))).filter(I=>I.total_current_stock>0||I.reserved_quantity!==0||T.has(I.product_id));n(j)}catch(_){console.error("Error loading stock summary:",_)}finally{s(!1)}},h=async _=>{try{const{data:k,error:E}=await de.from("batches").select("id, batch_number, current_stock, reserved_stock, expiry_date, import_date").eq("product_id",_).eq("is_active",!0).gt("current_stock",0).order("expiry_date",{ascending:!0,nullsFirst:!1});if(E)throw E;const T=(k||[]).map(S=>({...S,reserved_quantity:S.reserved_stock||0,available_quantity:S.current_stock-(S.reserved_stock||0)}));u(T)}catch(k){console.error("Error loading product batches:",k)}},f=async _=>{l(_),await h(_.product_id)},d=()=>{t("batches")},v=_=>_?new Date(_)<new Date:!1,g=_=>{if(!_)return!1;const k=new Date;return k.setDate(k.getDate()+30),new Date(_)<=k&&!v(_)},y=(_,k)=>_===0?"text-gray-400":_<500?"text-orange-600":"text-green-600",p=[{key:"product_name",label:"Product",render:_=>i.jsxs("div",{className:"py-1",children:[i.jsx("span",{className:"font-medium text-gray-900",children:_.product_name}),i.jsxs("span",{className:"text-xs text-gray-500 ml-2 capitalize",children:["(",_.category,")"]})]})},{key:"stock",label:"Total Stock",render:_=>i.jsxs("span",{className:`font-semibold ${y(_.total_current_stock,_.active_batch_count)}`,children:[_.total_current_stock.toLocaleString()," ",_.unit]})},{key:"reserved",label:"Reserved",render:_=>_.reserved_quantity===0?i.jsx("span",{className:"text-gray-400",children:"-"}):_.reserved_quantity<0?i.jsxs("span",{className:"text-red-600 font-semibold",children:[_.reserved_quantity.toLocaleString()," ",_.unit]}):i.jsxs("span",{className:"text-orange-600 font-medium",children:[_.reserved_quantity.toLocaleString()," ",_.unit]})},{key:"available",label:"Available",render:_=>i.jsxs("span",{className:"text-green-600 font-semibold",children:[_.available_quantity.toLocaleString()," ",_.unit]})},{key:"batches",label:"Batches",render:_=>i.jsxs("span",{className:"text-sm",children:[i.jsx("span",{className:"text-blue-600 font-medium",children:_.active_batch_count}),_.expired_batch_count>0&&i.jsxs("span",{className:"text-red-600 ml-1",children:["(",_.expired_batch_count," expired)"]})]})},{key:"expiry",label:"Nearest Expiry",render:_=>_.nearest_expiry_date?i.jsxs("span",{className:`text-sm ${v(_.nearest_expiry_date)?"text-red-700 font-semibold":g(_.nearest_expiry_date)?"text-orange-600 font-semibold":"text-gray-700"}`,children:[new Date(_.nearest_expiry_date).toLocaleDateString(),g(_.nearest_expiry_date)&&i.jsx(Po,{className:"w-3 h-3 inline ml-1"})]}):i.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}],m=[{key:"batch_number",label:"Batch",render:_=>i.jsx("span",{className:"font-mono text-sm",children:_.batch_number})},{key:"total_stock",label:"Total",render:_=>i.jsxs("span",{className:"font-semibold text-sm",children:[_.current_stock.toLocaleString()," ",o==null?void 0:o.unit]})},{key:"reserved",label:"Reserved",render:_=>i.jsx("span",{className:"text-orange-600 font-medium text-sm",children:_.reserved_quantity>0?`${_.reserved_quantity.toLocaleString()} ${o==null?void 0:o.unit}`:"-"})},{key:"available",label:"Available",render:_=>i.jsxs("span",{className:"text-green-600 font-semibold text-sm",children:[_.available_quantity.toLocaleString()," ",o==null?void 0:o.unit]})},{key:"import_date",label:"Imported",render:_=>i.jsx("span",{className:"text-sm text-gray-600",children:new Date(_.import_date).toLocaleDateString()})},{key:"expiry_date",label:"Expiry",render:_=>i.jsx("span",{className:`text-sm ${v(_.expiry_date)?"text-red-700 font-semibold":g(_.expiry_date)?"text-orange-600 font-semibold":"text-gray-700"}`,children:_.expiry_date?new Date(_.expiry_date).toLocaleDateString():"-"})}],w=r.reduce((_,k)=>_+k.total_current_stock,0),x=r.length,b=r.filter(_=>_.total_current_stock<500).length,B=r.filter(_=>_.nearest_expiry_date&&g(_.nearest_expiry_date)).length;return i.jsx(ca,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Stock Inventory"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Current stock levels across all products"})]}),i.jsxs("button",{onClick:d,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(si,{className:"w-5 h-5"}),"View Batches"]})]}),o&&i.jsxs("div",{className:"bg-blue-50 rounded-lg shadow-md p-4 border-l-4 border-blue-500",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[o.product_name," - Batch Details"]}),i.jsx("button",{onClick:()=>l(null),className:"text-gray-500 hover:text-gray-700 text-xl font-bold",children:""})]}),i.jsx(Ls,{columns:m,data:c,loading:!1})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[i.jsx(Ls,{columns:p,data:r,loading:a,onRowClick:f}),!a&&r.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(si,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-500 text-lg",children:"No stock available"}),i.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"All products are currently out of stock"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Products In Stock"}),i.jsx("p",{className:"text-3xl font-bold mt-1",children:x})]}),i.jsx(si,{className:"w-10 h-10 text-blue-200"})]})}),i.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Total Stock Units"}),i.jsx("p",{className:"text-3xl font-bold mt-1",children:w.toLocaleString()})]}),i.jsx(Ao,{className:"w-10 h-10 text-green-200"})]})}),i.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg shadow-lg p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-orange-100 text-sm font-medium",children:"Low Stock Items"}),i.jsx("p",{className:"text-3xl font-bold mt-1",children:b})]}),i.jsx(Po,{className:"w-10 h-10 text-orange-200"})]})}),i.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg shadow-lg p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-red-100 text-sm font-medium",children:"Near Expiry"}),i.jsx("p",{className:"text-3xl font-bold mt-1",children:B})]}),i.jsx(as,{className:"w-10 h-10 text-red-200"})]})})]})]})})}const gR=["application/pdf","image/jpeg","image/jpg","image/png","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"],xR=10*1024*1024,vR=[{value:"invoice",label:"Invoice"},{value:"bill_of_lading",label:"Bill of Lading"},{value:"coa",label:"Certificate of Analysis"},{value:"packing_list",label:"Packing List"},{value:"other",label:"Other"}];function _F({batchId:e,existingFiles:t=[],onFilesChange:r,disabled:n=!1}){const[a,s]=Z.useState(t),[o,l]=Z.useState(!1),c=Z.useRef(null),u=m=>{s(m),r==null||r(m)},A=m=>{if(!m||m.length===0)return;const w=[];Array.from(m).forEach(x=>{if(!gR.includes(x.type)){alert(`File ${x.name} is not a supported format. Please upload PDF, JPG, PNG, XLSX, or DOCX files.`);return}if(x.size>xR){alert(`File ${x.name} exceeds the 10MB size limit.`);return}w.push({file:x,file_name:x.name,file_type:"other",file_size:x.size,uploading:!1})}),u([...a,...w])},h=m=>{m.preventDefault(),l(!1),A(m.dataTransfer.files)},f=m=>{m.preventDefault(),l(!0)},d=()=>{l(!1)},v=async m=>{const w=a[m];if(w.id&&e){if(!confirm("Are you sure you want to delete this document?"))return;try{const{error:b}=await de.from("batch_documents").delete().eq("id",w.id);if(b)throw b;if(w.file_url){const B=w.file_url.split("/"),_=B[B.length-1],k=`${e}/${_}`;await de.storage.from("batch-documents").remove([k])}}catch(b){console.error("Error deleting file:",b),alert("Failed to delete file. Please try again.");return}}const x=a.filter((b,B)=>B!==m);u(x)},g=(m,w)=>{const x=[...a];x[m].file_type=w,u(x)},y=m=>{var x;const w=(x=m.split(".").pop())==null?void 0:x.toLowerCase();return["jpg","jpeg","png"].includes(w||"")?i.jsx(fF,{className:"w-5 h-5 text-blue-600"}):w==="pdf"?i.jsx(pr,{className:"w-5 h-5 text-red-600"}):i.jsx(uF,{className:"w-5 h-5 text-gray-600"})},p=m=>m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB";return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{onDrop:h,onDragOver:f,onDragLeave:d,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:()=>{var m;return!n&&((m=c.current)==null?void 0:m.click())},children:[i.jsx(zb,{className:`w-12 h-12 mx-auto mb-3 ${o?"text-blue-500":"text-gray-400"}`}),i.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[i.jsx("span",{className:"font-medium text-blue-600",children:"Click to upload"})," or drag and drop"]}),i.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG, XLSX, DOCX (max 10MB)"}),i.jsx("input",{ref:c,type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png,.xlsx,.xls,.docx,.doc",onChange:m=>A(m.target.files),className:"hidden",disabled:n})]}),a.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Documents (",a.length,")"]}),a.map((m,w)=>i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx("div",{className:"flex-shrink-0",children:y(m.file_name)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"flex items-center gap-2",children:m.file_url?i.jsx("a",{href:m.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-700 truncate",onClick:x=>x.stopPropagation(),children:m.file_name}):i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:m.file_name})}),i.jsx("p",{className:"text-xs text-gray-500",children:p(m.file_size)})]}),i.jsx("select",{value:m.file_type,onChange:x=>g(w,x.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:n,onClick:x=>x.stopPropagation(),children:vR.map(x=>i.jsx("option",{value:x.value,children:x.label},x.value))}),m.uploading&&i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})}),m.error&&i.jsx("div",{className:"flex-shrink-0",title:m.error,children:i.jsx(ya,{className:"w-5 h-5 text-red-600"})}),!n&&!m.uploading&&i.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),v(w)},className:"flex-shrink-0 p-1 text-red-600 hover:bg-red-50 rounded transition",children:i.jsx(An,{className:"w-4 h-4"})})]},w))]})]})}function yR(){const{t:e}=ba(),{profile:t}=Dr(),[r,n]=Z.useState([]),[a,s]=Z.useState([]),[o,l]=Z.useState(!0),[c,u]=Z.useState(!1),[A,h]=Z.useState(!1),[f,d]=Z.useState([]),[v,g]=Z.useState(null),[y,p]=Z.useState(null),[m,w]=Z.useState([]),[x,b]=Z.useState({batch_number:"",product_id:"",import_date:"",import_quantity:0,packaging_details:"",import_price_usd:0,exchange_rate_usd_to_idr:0,duty_charges:0,duty_charge_type:"fixed",freight_charges:0,freight_charge_type:"fixed",other_charges:0,other_charge_type:"fixed",expiry_date:"",per_pack_weight:"",pack_type:"bag"});Z.useEffect(()=>{B(),_()},[]);const B=async()=>{try{const{data:C,error:L}=await de.from("batches").select(`
          *,
          products(product_name, product_code, unit)
        `).order("import_date",{ascending:!1});if(L)throw L;const O=await Promise.all((C||[]).map(async D=>{const{count:P}=await de.from("batch_documents").select("*",{count:"exact",head:!0}).eq("batch_id",D.id);return{...D,document_count:P||0}}));n(O)}catch(C){console.error("Error loading batches:",C)}finally{l(!1)}},_=async()=>{try{const{data:C,error:L}=await de.from("products").select("id, product_name, product_code, unit").eq("is_active",!0).order("product_name");if(L)throw L;s(C||[])}catch(C){console.error("Error loading products:",C)}},k=async C=>{try{const{data:L,error:O}=await de.from("batch_documents").select("*").eq("batch_id",C).order("uploaded_at",{ascending:!1});if(O)throw O;d(L||[]),g(C),h(!0)}catch(L){console.error("Error loading documents:",L),alert("Failed to load documents")}},E=async C=>{if(C.preventDefault(),x.import_price_usd>0&&x.exchange_rate_usd_to_idr<=0){alert("Please enter a valid exchange rate");return}try{let L=0;if(y){const{data:re,error:ke}=await de.from("sales_invoice_items").select("quantity").eq("batch_id",y.id);if(ke)throw ke;if(L=(re==null?void 0:re.reduce((be,ae)=>be+parseFloat(ae.quantity||0),0))||0,x.import_quantity<L){alert(`Cannot reduce import quantity to ${x.import_quantity}. You have already sold ${L} units from this batch.`);return}}const O=x.import_price_usd*x.exchange_rate_usd_to_idr,D=(re,ke,be)=>ke==="percentage"?be*re/100:re,P=D(x.duty_charges,x.duty_charge_type,O),Q=D(x.freight_charges,x.freight_charge_type,O),J=D(x.other_charges,x.other_charge_type,O),te=x.import_quantity-L,z={batch_number:x.batch_number,product_id:x.product_id,import_date:x.import_date,import_quantity:x.import_quantity,current_stock:te,packaging_details:x.packaging_details,import_price:O,import_price_usd:x.import_price_usd||null,exchange_rate_usd_to_idr:x.exchange_rate_usd_to_idr||null,duty_charges:P,duty_charge_type:x.duty_charge_type,freight_charges:Q,freight_charge_type:x.freight_charge_type,other_charges:J,other_charge_type:x.other_charge_type,expiry_date:x.expiry_date||null};let ye;if(y){const{error:re}=await de.from("batches").update(z).eq("id",y.id);if(re)throw re;ye=y.id}else{const{data:{user:re}}=await de.auth.getUser();if(!re)throw new Error("Not authenticated");const{data:ke,error:be}=await de.from("batches").insert([{...z,is_active:!0,created_by:re.id}]).select().single();if(be)throw be;ye=ke.id}await T(ye),u(!1),I(),B()}catch(L){console.error("Error saving batch:",L),alert("Failed to save batch. Please try again.")}},T=async C=>{const L=m.filter(O=>O.file&&!O.id);for(const O of L)try{const D=`${Date.now()}_${O.file.name}`,P=`${C}/${D}`,{error:Q}=await de.storage.from("batch-documents").upload(P,O.file);if(Q)throw Q;const{data:{publicUrl:J}}=de.storage.from("batch-documents").getPublicUrl(P),{error:te}=await de.from("batch_documents").insert([{batch_id:C,file_url:J,file_name:O.file.name,file_type:O.file_type,file_size:O.file_size}]);if(te)throw te}catch(D){console.error("Error uploading file:",D)}},S=async C=>{const{data:L}=await de.from("sales_invoice_items").select("quantity").eq("batch_id",C.id),O=(L==null?void 0:L.reduce((te,z)=>te+parseFloat(z.quantity||0),0))||0,D={...C,current_stock:C.import_quantity-O};p(D);let P="",Q="bag";if(C.packaging_details){const te=C.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/);te&&(P=te[3],Q=te[2].toLowerCase())}b({batch_number:C.batch_number,product_id:C.product_id,import_date:C.import_date,import_quantity:C.import_quantity,packaging_details:C.packaging_details,import_price_usd:C.import_price_usd||0,exchange_rate_usd_to_idr:C.exchange_rate_usd_to_idr||0,duty_charges:C.duty_charges,duty_charge_type:"fixed",freight_charges:C.freight_charges,freight_charge_type:"fixed",other_charges:C.other_charges,other_charge_type:"fixed",expiry_date:C.expiry_date,per_pack_weight:P,pack_type:Q});const{data:J}=await de.from("batch_documents").select("*").eq("batch_id",C.id);w(J||[]),u(!0)},j=async C=>{try{const{data:L}=await de.from("sales_invoice_items").select("id, sales_invoices(invoice_number)").eq("batch_id",C).limit(1);if(L&&L.length>0){alert("Cannot delete this batch. It has been used in sales invoices. Please delete the related invoices first or contact your administrator.");return}const{data:O}=await de.from("delivery_challan_items").select("id").eq("batch_id",C).limit(1);if(O&&O.length>0){alert("Cannot delete this batch. It has been used in delivery challans. Please delete the related delivery challans first.");return}if(!confirm("Are you sure you want to delete this batch? This will permanently remove all related data."))return;const{error:D}=await de.from("batch_documents").delete().eq("batch_id",C);if(D)throw D;const{error:P}=await de.from("inventory_transactions").delete().eq("batch_id",C);if(P)throw P;const{error:Q}=await de.from("finance_expenses").delete().eq("batch_id",C);if(Q)throw Q;const{error:J}=await de.from("batches").delete().eq("id",C);if(J)throw J;alert("Batch deleted successfully"),await B()}catch(L){console.error("Error deleting batch:",L);const O=(L==null?void 0:L.message)||"Unknown error occurred";alert(`Failed to delete batch: ${O}`)}},I=()=>{p(null),w([]),b({batch_number:"",product_id:"",import_date:"",import_quantity:0,packaging_details:"",import_price_usd:0,exchange_rate_usd_to_idr:0,duty_charges:0,duty_charge_type:"fixed",freight_charges:0,freight_charge_type:"fixed",other_charges:0,other_charge_type:"fixed",expiry_date:"",per_pack_weight:"",pack_type:"bag"})},U=C=>C.current_stock<C.import_quantity*.2,q=C=>C.expiry_date?new Date(C.expiry_date)<new Date:!1,V=C=>{if(!C.expiry_date)return!1;const L=new Date;return L.setDate(L.getDate()+30),new Date(C.expiry_date)<=L&&!q(C)},X=()=>{const C=x.import_price_usd*x.exchange_rate_usd_to_idr,L=(Q,J)=>J==="percentage"?C*Q/100:Q,O=L(x.duty_charges,x.duty_charge_type),D=L(x.freight_charges,x.freight_charge_type),P=L(x.other_charges,x.other_charge_type);return C+O+D+P},W=(C,L)=>{const O=x.import_price_usd*x.exchange_rate_usd_to_idr;return L==="percentage"?O*C/100:C},M=(C,L="IDR")=>L==="USD"?`$${C.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`Rp ${C.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,G=[{key:"batch_number",label:"Batch Number"},{key:"product",label:"Product",render:C=>{var L,O;return i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:(L=C.products)==null?void 0:L.product_name}),i.jsx("div",{className:"text-xs text-gray-500",children:(O=C.products)==null?void 0:O.product_code})]})}},{key:"import_date",label:"Import Date",render:C=>new Date(C.import_date).toLocaleDateString()},{key:"stock",label:"Stock",render:C=>{var O,D,P;const L=C.current_stock-(C.reserved_stock||0);return i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:U(C)?"text-orange-600 font-semibold":"font-medium",children:[C.current_stock," ",(O=C.products)==null?void 0:O.unit]}),U(C)&&i.jsx(Po,{className:"w-4 h-4 text-orange-600"})]}),C.reserved_stock>0&&i.jsxs("div",{className:"text-xs space-y-0.5",children:[i.jsxs("div",{className:"text-amber-600",children:["Reserved: ",C.reserved_stock," ",(D=C.products)==null?void 0:D.unit]}),i.jsxs("div",{className:"text-green-600",children:["Free: ",L," ",(P=C.products)==null?void 0:P.unit]})]})]})}},{key:"pricing",label:"Import Price",render:C=>i.jsx("div",{className:"text-sm",children:C.import_price_usd&&C.exchange_rate_usd_to_idr?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"font-medium text-green-700",children:M(C.import_price_usd,"USD")}),i.jsx("div",{className:"text-xs text-gray-500",children:M(C.import_price)}),i.jsxs("div",{className:"text-xs text-gray-400",children:["@ ",C.exchange_rate_usd_to_idr.toLocaleString()]})]}):i.jsx("div",{className:"text-gray-500",children:M(C.import_price)})})},{key:"expiry_date",label:"Expiry Date",render:C=>i.jsx("span",{className:q(C)?"text-red-700 font-semibold":V(C)?"text-orange-600 font-semibold":"",children:C.expiry_date?new Date(C.expiry_date).toLocaleDateString():"N/A"})},{key:"documents",label:"Docs",render:C=>i.jsxs("button",{onClick:()=>k(C.id),className:"flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 transition",children:[i.jsx(pr,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:C.document_count||0})]})},{key:"total_cost",label:"Total Cost",render:C=>{const L=C.import_price+C.duty_charges+C.freight_charges+C.other_charges;return i.jsx("span",{className:"font-medium",children:M(L)})}}],H=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="warehouse"||(t==null?void 0:t.role)==="accounts";return i.jsx(ca,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import Batches"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage import batches with USD pricing and document tracking"})]}),H&&i.jsxs("button",{onClick:()=>{I(),u(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Add Batch"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Batches"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:r.length})]}),i.jsx(si,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-orange-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-orange-600",children:"Low Stock"}),i.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:r.filter(U).length})]}),i.jsx(Po,{className:"w-8 h-8 text-orange-600"})]})}),i.jsx("div",{className:"bg-red-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-red-600",children:"Near Expiry"}),i.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:r.filter(V).length})]}),i.jsx(Po,{className:"w-8 h-8 text-red-600"})]})})]}),i.jsx(Ls,{columns:G,data:r,loading:o,actions:H?C=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>S(C),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(uo,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>j(C.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:i.jsx(wa,{className:"w-4 h-4"})})]}):void 0}),i.jsx(ir,{isOpen:c,onClose:()=>{u(!1),I()},title:y?"Edit Batch":"Add New Batch",children:i.jsxs("form",{onSubmit:E,className:"space-y-3",children:[i.jsxs("div",{className:"border-b pb-2",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Basic Information"}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Batch Number *"}),i.jsx("input",{type:"text",value:x.batch_number,onChange:C=>b({...x,batch_number:C.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Product *"}),i.jsxs("select",{value:x.product_id,onChange:C=>b({...x,product_id:C.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),a.map(C=>i.jsxs("option",{value:C.id,children:[C.product_name," (",C.product_code,")"]},C.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Import Date *"}),i.jsx("input",{type:"date",value:x.import_date,onChange:C=>b({...x,import_date:C.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Expiry Date"}),i.jsx("input",{type:"date",value:x.expiry_date,onChange:C=>b({...x,expiry_date:C.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]})]})]}),i.jsxs("div",{className:"border-b pb-2",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Quantity"}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Import Quantity *"}),i.jsx("input",{type:"number",value:x.import_quantity===0?"":x.import_quantity,onChange:C=>b({...x,import_quantity:C.target.value===""?0:Number(C.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,min:"0",step:"0.001",placeholder:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Total quantity being imported"})]}),y&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Current Stock"}),i.jsx("div",{className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded bg-gray-50",children:i.jsx("span",{className:"text-gray-700 font-medium",children:y.current_stock.toLocaleString()})}),i.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Available: ",y.current_stock.toLocaleString()," | Sold: ",(y.import_quantity-y.current_stock).toLocaleString()]})]})]})]}),i.jsxs("div",{className:"border-b pb-2",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(si,{className:"w-4 h-4"}),"Packaging Details (Optional)"]}),i.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Per Pack Weight"}),i.jsx("input",{type:"number",step:"0.001",value:x.per_pack_weight,onChange:C=>{const L={...x,per_pack_weight:C.target.value};if(x.import_quantity&&C.target.value){const O=parseFloat(C.target.value);if(O){const D=(x.import_quantity/O).toFixed(0);L.packaging_details=`${D} ${x.pack_type}${parseInt(D)!==1?"s":""} x ${O}kg`}}b(L)},placeholder:"e.g., 25",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"kg per pack"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pack Type"}),i.jsxs("select",{value:x.pack_type,onChange:C=>{const L={...x,pack_type:C.target.value};if(x.import_quantity&&x.per_pack_weight){const O=parseFloat(x.per_pack_weight);if(O){const D=(x.import_quantity/O).toFixed(0);L.packaging_details=`${D} ${C.target.value}${parseInt(D)!==1?"s":""} x ${O}kg`}}b(L)},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[i.jsx("option",{value:"bag",children:"Bag"}),i.jsx("option",{value:"drum",children:"Drum"}),i.jsx("option",{value:"tin",children:"Tin"}),i.jsx("option",{value:"box",children:"Box"}),i.jsx("option",{value:"carton",children:"Carton"}),i.jsx("option",{value:"pallet",children:"Pallet"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Calculated Packs"}),i.jsx("div",{className:"px-2 py-1.5 text-sm bg-gray-50 border border-gray-200 rounded",children:i.jsx("span",{className:"text-gray-700 font-medium",children:x.import_quantity&&x.per_pack_weight?Math.ceil(x.import_quantity/parseFloat(x.per_pack_weight)):"-"})}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Total packs"})]})]}),x.packaging_details&&i.jsx("div",{className:"mt-1.5 p-2 bg-blue-50 border border-blue-200 rounded",children:i.jsxs("p",{className:"text-xs text-blue-900",children:[i.jsx("span",{className:"font-semibold",children:"Packaging: "}),x.packaging_details]})})]}),i.jsxs("div",{className:"border-b pb-2",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(Ro,{className:"w-4 h-4 text-green-600"}),"Import Pricing (USD)"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Import Price (USD)"}),i.jsx("input",{type:"number",value:x.import_price_usd===0?"":x.import_price_usd,onChange:C=>b({...x,import_price_usd:C.target.value===""?0:Number(C.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Exchange Rate (USD to IDR)"}),i.jsx("input",{type:"number",value:x.exchange_rate_usd_to_idr===0?"":x.exchange_rate_usd_to_idr,onChange:C=>b({...x,exchange_rate_usd_to_idr:C.target.value===""?0:Number(C.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.0001",placeholder:"15000"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["1 USD = ",x.exchange_rate_usd_to_idr.toLocaleString()," IDR"]})]})]}),x.import_price_usd>0&&x.exchange_rate_usd_to_idr>0&&i.jsxs("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:[i.jsxs("p",{className:"text-xs text-green-800",children:[i.jsx("span",{className:"font-semibold",children:"Calculated Import Price (IDR):"})," ",M(x.import_price_usd*x.exchange_rate_usd_to_idr)]}),i.jsxs("p",{className:"text-xs text-green-600 mt-0.5",children:[M(x.import_price_usd,"USD"),"  ",x.exchange_rate_usd_to_idr.toLocaleString()," = ",M(x.import_price_usd*x.exchange_rate_usd_to_idr)]})]})]}),i.jsxs("div",{className:"border-b pb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Additional Charges"}),i.jsx("div",{className:"space-y-3",children:i.jsxs("div",{className:"grid grid-cols-[1fr_1fr_1fr] gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Duty"}),i.jsxs("div",{className:"flex gap-0.5",children:[i.jsx("input",{type:"number",value:x.duty_charges===0?"":x.duty_charges,onChange:C=>b({...x,duty_charges:C.target.value===""?0:Number(C.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),i.jsxs("select",{value:x.duty_charge_type,onChange:C=>b({...x,duty_charge_type:C.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[i.jsx("option",{value:"percentage",children:"%"}),i.jsx("option",{value:"fixed",children:"Rp"})]})]}),x.duty_charges>0&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",M(W(x.duty_charges,x.duty_charge_type))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Freight"}),i.jsxs("div",{className:"flex gap-0.5",children:[i.jsx("input",{type:"number",value:x.freight_charges===0?"":x.freight_charges,onChange:C=>b({...x,freight_charges:C.target.value===""?0:Number(C.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),i.jsxs("select",{value:x.freight_charge_type,onChange:C=>b({...x,freight_charge_type:C.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[i.jsx("option",{value:"percentage",children:"%"}),i.jsx("option",{value:"fixed",children:"Rp"})]})]}),x.freight_charges>0&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",M(W(x.freight_charges,x.freight_charge_type))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Other"}),i.jsxs("div",{className:"flex gap-0.5",children:[i.jsx("input",{type:"number",value:x.other_charges===0?"":x.other_charges,onChange:C=>b({...x,other_charges:C.target.value===""?0:Number(C.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),i.jsxs("select",{value:x.other_charge_type,onChange:C=>b({...x,other_charge_type:C.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[i.jsx("option",{value:"percentage",children:"%"}),i.jsx("option",{value:"fixed",children:"Rp"})]})]}),x.other_charges>0&&i.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",M(W(x.other_charges,x.other_charge_type))]})]})]})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-2",children:[i.jsx("h3",{className:"text-xs font-semibold text-blue-900 mb-1.5",children:"Total Cost Summary"}),i.jsxs("div",{className:"space-y-0.5 text-xs text-blue-800",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Import Price (IDR):"}),i.jsx("span",{className:"font-medium",children:M(x.import_price_usd*x.exchange_rate_usd_to_idr)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Duty Charges:"}),i.jsxs("span",{className:"font-medium",children:[M(W(x.duty_charges,x.duty_charge_type)),x.duty_charge_type==="percentage"&&x.duty_charges>0&&i.jsxs("span",{className:"text-xs ml-1",children:["(",x.duty_charges,"%)"]})]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Freight Charges:"}),i.jsxs("span",{className:"font-medium",children:[M(W(x.freight_charges,x.freight_charge_type)),x.freight_charge_type==="percentage"&&x.freight_charges>0&&i.jsxs("span",{className:"text-xs ml-1",children:["(",x.freight_charges,"%)"]})]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Other Charges:"}),i.jsxs("span",{className:"font-medium",children:[M(W(x.other_charges,x.other_charge_type)),x.other_charge_type==="percentage"&&x.other_charges>0&&i.jsxs("span",{className:"text-xs ml-1",children:["(",x.other_charges,"%)"]})]})]}),i.jsxs("div",{className:"border-t border-blue-300 pt-1.5 mt-1.5 flex justify-between",children:[i.jsx("span",{className:"font-bold",children:"Total Cost (IDR):"}),i.jsx("span",{className:"font-bold text-sm",children:M(X())})]})]})]}),i.jsxs("div",{className:"border-t pt-2",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(pr,{className:"w-4 h-4"}),"Import Documents"]}),i.jsx(_F,{batchId:y==null?void 0:y.id,existingFiles:m,onFilesChange:w})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{u(!1),I()},className:"px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:y?"Update Batch":"Add Batch"})]})]})}),i.jsx(ir,{isOpen:A,onClose:()=>{h(!1),d([]),g(null)},title:"Batch Documents",children:i.jsx("div",{className:"space-y-3",children:f.length>0?f.map(C=>i.jsxs("a",{href:C.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-blue-50 hover:border-blue-300 transition",children:[i.jsx(pr,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:C.file_name}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[i.jsx("span",{className:"capitalize",children:C.file_type.replace("_"," ")}),i.jsx("span",{children:""}),i.jsxs("span",{children:[(C.file_size/1024).toFixed(1)," KB"]}),i.jsx("span",{children:""}),i.jsx("span",{children:new Date(C.uploaded_at).toLocaleDateString()})]})]}),i.jsx(Sg,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})]},C.id)):i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(pr,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{children:"No documents uploaded for this batch"})]})})})]})})}function wR(){const{t:e}=ba(),{profile:t}=Dr(),[r,n]=Z.useState([]),[a,s]=Z.useState([]),[o,l]=Z.useState([]),[c,u]=Z.useState(!0),[A,h]=Z.useState(!1),[f,d]=Z.useState({transaction_type:"adjustment",product_id:"",batch_id:"",quantity:0,reference_number:"",notes:"",transaction_date:new Date().toISOString().split("T")[0]});Z.useEffect(()=>{v(),g(),y()},[]);const v=async()=>{try{const{data:_,error:k}=await de.from("inventory_transactions").select(`
          *,
          products(product_name, product_code),
          batches(batch_number),
          user_profiles(full_name)
        `).order("transaction_date",{ascending:!1}).order("created_at",{ascending:!1});if(k)throw k;n(_||[])}catch(_){console.error("Error loading transactions:",_)}finally{u(!1)}},g=async()=>{try{const{data:_,error:k}=await de.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(k)throw k;s(_||[])}catch(_){console.error("Error loading products:",_)}},y=async()=>{try{const{data:_,error:k}=await de.from("batches").select("id, batch_number, product_id, current_stock").eq("is_active",!0).gt("current_stock",0).order("import_date",{ascending:!1});if(k)throw k;l(_||[])}catch(_){console.error("Error loading batches:",_)}},p=async _=>{_.preventDefault();try{const{data:{user:k}}=await de.auth.getUser();if(!k)throw new Error("Not authenticated");const{error:E}=await de.from("inventory_transactions").insert([{...f,batch_id:f.batch_id||null,reference_number:f.reference_number||null,notes:f.notes||null,created_by:k.id}]);if(E)throw E;if(f.batch_id){const T=o.find(S=>S.id===f.batch_id);if(T){let S=T.current_stock;f.transaction_type==="purchase"||f.transaction_type==="adjustment"?S+=f.quantity:f.transaction_type==="sale"&&(S-=f.quantity);const{error:j}=await de.from("batches").update({current_stock:S}).eq("id",f.batch_id);if(j)throw j}}h(!1),m(),v(),y()}catch(k){console.error("Error saving transaction:",k),alert("Failed to save transaction. Please try again.")}},m=()=>{d({transaction_type:"adjustment",product_id:"",batch_id:"",quantity:0,reference_number:"",notes:"",transaction_date:new Date().toISOString().split("T")[0]})},w=o.filter(_=>_.product_id===f.product_id),x=[{key:"transaction_date",label:"Date",render:_=>new Date(_.transaction_date).toLocaleDateString()},{key:"transaction_type",label:"Type",render:_=>i.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${_.transaction_type==="purchase"?"bg-green-100 text-green-800":_.transaction_type==="sale"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:[_.transaction_type==="purchase"&&i.jsx(Ao,{className:"w-3 h-3"}),_.transaction_type==="sale"&&i.jsx(qw,{className:"w-3 h-3"}),_.transaction_type==="adjustment"&&i.jsx(Ec,{className:"w-3 h-3"}),_.transaction_type.charAt(0).toUpperCase()+_.transaction_type.slice(1)]})},{key:"product",label:"Product",render:_=>{var k,E;return i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:(k=_.products)==null?void 0:k.product_name}),i.jsx("div",{className:"text-xs text-gray-500",children:(E=_.products)==null?void 0:E.product_code})]})}},{key:"batch_number",label:"Batch",render:_=>{var k;return((k=_.batches)==null?void 0:k.batch_number)||"N/A"}},{key:"quantity",label:"Quantity",render:_=>i.jsxs("span",{className:`font-semibold ${_.transaction_type==="purchase"?"text-green-600":_.transaction_type==="sale"?"text-red-600":"text-blue-600"}`,children:[_.transaction_type==="purchase"?"+":_.transaction_type==="sale"?"-":"",_.quantity]})},{key:"reference_number",label:"Reference",render:_=>_.reference_number||(_.transaction_type==="purchase"?"Batch Import":"-")},{key:"created_by",label:"Created By",render:_=>{var k;return((k=_.user_profiles)==null?void 0:k.full_name)||(_.transaction_type==="purchase"?"System":"Unknown")}}],b=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="warehouse",B={totalTransactions:r.length,purchases:r.filter(_=>_.transaction_type==="purchase").length,sales:r.filter(_=>_.transaction_type==="sale").length,adjustments:r.filter(_=>_.transaction_type==="adjustment").length};return i.jsx(ca,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Inventory Transactions"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Track all stock movements and adjustments"})]}),b&&i.jsxs("button",{onClick:()=>{m(),h(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Add Transaction"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Transactions"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:B.totalTransactions})]}),i.jsx(Ec,{className:"w-8 h-8 text-blue-600"})]})}),i.jsx("div",{className:"bg-green-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-green-600",children:"Purchases"}),i.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:B.purchases})]}),i.jsx(Ao,{className:"w-8 h-8 text-green-600"})]})}),i.jsx("div",{className:"bg-red-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-red-600",children:"Sales"}),i.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:B.sales})]}),i.jsx(qw,{className:"w-8 h-8 text-red-600"})]})}),i.jsx("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-blue-600",children:"Adjustments"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:B.adjustments})]}),i.jsx(Ec,{className:"w-8 h-8 text-blue-600"})]})})]}),i.jsx(Ls,{columns:x,data:r,loading:c}),i.jsx(ir,{isOpen:A,onClose:()=>{h(!1),m()},title:"Add Inventory Transaction",children:i.jsxs("form",{onSubmit:p,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Type *"}),i.jsxs("select",{value:f.transaction_type,onChange:_=>d({...f,transaction_type:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"purchase",children:"Purchase"}),i.jsx("option",{value:"sale",children:"Sale"}),i.jsx("option",{value:"adjustment",children:"Adjustment"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),i.jsxs("select",{value:f.product_id,onChange:_=>d({...f,product_id:_.target.value,batch_id:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),a.map(_=>i.jsxs("option",{value:_.id,children:[_.product_name," (",_.product_code,")"]},_.id))]})]}),f.product_id&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch (Optional)"}),i.jsxs("select",{value:f.batch_id,onChange:_=>d({...f,batch_id:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select Batch"}),w.map(_=>i.jsxs("option",{value:_.id,children:[_.batch_number," (Stock: ",_.current_stock,")"]},_.id))]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),i.jsx("input",{type:"number",value:f.quantity,onChange:_=>d({...f,quantity:Number(_.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Date *"}),i.jsx("input",{type:"date",value:f.transaction_date,onChange:_=>d({...f,transaction_date:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),i.jsx("input",{type:"text",value:f.reference_number,onChange:_=>d({...f,reference_number:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., SAPJ-001, PO-002"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:f.notes,onChange:_=>d({...f,notes:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Additional notes about this transaction"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{h(!1),m()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Add Transaction"})]})]})})]})})}function bR(){this.__data__=[],this.size=0}var _R=bR;function NR(e,t){return e===t||e!==e&&t!==t}var NF=NR,BR=NF;function CR(e,t){for(var r=e.length;r--;)if(BR(e[r][0],t))return r;return-1}var kx=CR,ER=kx,SR=Array.prototype,kR=SR.splice;function jR(e){var t=this.__data__,r=ER(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():kR.call(t,r,1),--this.size,!0}var FR=jR,TR=kx;function IR(e){var t=this.__data__,r=TR(t,e);return r<0?void 0:t[r][1]}var LR=IR,OR=kx;function UR(e){return OR(this.__data__,e)>-1}var PR=UR,DR=kx;function RR(e,t){var r=this.__data__,n=DR(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var QR=RR,MR=_R,HR=FR,qR=LR,KR=PR,$R=QR;function Pd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Pd.prototype.clear=MR;Pd.prototype.delete=HR;Pd.prototype.get=qR;Pd.prototype.has=KR;Pd.prototype.set=$R;var jx=Pd,VR=jx;function GR(){this.__data__=new VR,this.size=0}var WR=GR;function zR(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var XR=zR;function YR(e){return this.__data__.get(e)}var JR=YR;function ZR(e){return this.__data__.has(e)}var eQ=ZR,tQ=typeof ti=="object"&&ti&&ti.Object===Object&&ti,BF=tQ,rQ=BF,nQ=typeof self=="object"&&self&&self.Object===Object&&self,aQ=rQ||nQ||Function("return this")(),Il=aQ,sQ=Il,iQ=sQ.Symbol,Xb=iQ,SN=Xb,CF=Object.prototype,oQ=CF.hasOwnProperty,lQ=CF.toString,kf=SN?SN.toStringTag:void 0;function cQ(e){var t=oQ.call(e,kf),r=e[kf];try{e[kf]=void 0;var n=!0}catch{}var a=lQ.call(e);return n&&(t?e[kf]=r:delete e[kf]),a}var uQ=cQ,AQ=Object.prototype,dQ=AQ.toString;function fQ(e){return dQ.call(e)}var hQ=fQ,kN=Xb,pQ=uQ,mQ=hQ,gQ="[object Null]",xQ="[object Undefined]",jN=kN?kN.toStringTag:void 0;function vQ(e){return e==null?e===void 0?xQ:gQ:jN&&jN in Object(e)?pQ(e):mQ(e)}var Fx=vQ;function yQ(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var EF=yQ,wQ=Fx,bQ=EF,_Q="[object AsyncFunction]",NQ="[object Function]",BQ="[object GeneratorFunction]",CQ="[object Proxy]";function EQ(e){if(!bQ(e))return!1;var t=wQ(e);return t==NQ||t==BQ||t==_Q||t==CQ}var SF=EQ,SQ=Il,kQ=SQ["__core-js_shared__"],jQ=kQ,wv=jQ,FN=function(){var e=/[^.]+$/.exec(wv&&wv.keys&&wv.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function FQ(e){return!!FN&&FN in e}var TQ=FQ,IQ=Function.prototype,LQ=IQ.toString;function OQ(e){if(e!=null){try{return LQ.call(e)}catch{}try{return e+""}catch{}}return""}var kF=OQ,UQ=SF,PQ=TQ,DQ=EF,RQ=kF,QQ=/[\\^$.*+?()[\]{}|]/g,MQ=/^\[object .+?Constructor\]$/,HQ=Function.prototype,qQ=Object.prototype,KQ=HQ.toString,$Q=qQ.hasOwnProperty,VQ=RegExp("^"+KQ.call($Q).replace(QQ,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function GQ(e){if(!DQ(e)||PQ(e))return!1;var t=UQ(e)?VQ:MQ;return t.test(RQ(e))}var WQ=GQ;function zQ(e,t){return e==null?void 0:e[t]}var XQ=zQ,YQ=WQ,JQ=XQ;function ZQ(e,t){var r=JQ(e,t);return YQ(r)?r:void 0}var Dd=ZQ,eM=Dd,tM=Il,rM=eM(tM,"Map"),Yb=rM,nM=Dd,aM=nM(Object,"create"),Tx=aM,TN=Tx;function sM(){this.__data__=TN?TN(null):{},this.size=0}var iM=sM;function oM(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var lM=oM,cM=Tx,uM="__lodash_hash_undefined__",AM=Object.prototype,dM=AM.hasOwnProperty;function fM(e){var t=this.__data__;if(cM){var r=t[e];return r===uM?void 0:r}return dM.call(t,e)?t[e]:void 0}var hM=fM,pM=Tx,mM=Object.prototype,gM=mM.hasOwnProperty;function xM(e){var t=this.__data__;return pM?t[e]!==void 0:gM.call(t,e)}var vM=xM,yM=Tx,wM="__lodash_hash_undefined__";function bM(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=yM&&t===void 0?wM:t,this}var _M=bM,NM=iM,BM=lM,CM=hM,EM=vM,SM=_M;function Rd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Rd.prototype.clear=NM;Rd.prototype.delete=BM;Rd.prototype.get=CM;Rd.prototype.has=EM;Rd.prototype.set=SM;var kM=Rd,IN=kM,jM=jx,FM=Yb;function TM(){this.size=0,this.__data__={hash:new IN,map:new(FM||jM),string:new IN}}var IM=TM;function LM(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var OM=LM,UM=OM;function PM(e,t){var r=e.__data__;return UM(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Ix=PM,DM=Ix;function RM(e){var t=DM(this,e).delete(e);return this.size-=t?1:0,t}var QM=RM,MM=Ix;function HM(e){return MM(this,e).get(e)}var qM=HM,KM=Ix;function $M(e){return KM(this,e).has(e)}var VM=$M,GM=Ix;function WM(e,t){var r=GM(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var zM=WM,XM=IM,YM=QM,JM=qM,ZM=VM,e9=zM;function Qd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Qd.prototype.clear=XM;Qd.prototype.delete=YM;Qd.prototype.get=JM;Qd.prototype.has=ZM;Qd.prototype.set=e9;var jF=Qd,t9=jx,r9=Yb,n9=jF,a9=200;function s9(e,t){var r=this.__data__;if(r instanceof t9){var n=r.__data__;if(!r9||n.length<a9-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new n9(n)}return r.set(e,t),this.size=r.size,this}var i9=s9,o9=jx,l9=WR,c9=XR,u9=JR,A9=eQ,d9=i9;function Md(e){var t=this.__data__=new o9(e);this.size=t.size}Md.prototype.clear=l9;Md.prototype.delete=c9;Md.prototype.get=u9;Md.prototype.has=A9;Md.prototype.set=d9;var f9=Md,h9="__lodash_hash_undefined__";function p9(e){return this.__data__.set(e,h9),this}var m9=p9;function g9(e){return this.__data__.has(e)}var x9=g9,v9=jF,y9=m9,w9=x9;function Tg(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new v9;++t<r;)this.add(e[t])}Tg.prototype.add=Tg.prototype.push=y9;Tg.prototype.has=w9;var b9=Tg;function _9(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var N9=_9;function B9(e,t){return e.has(t)}var C9=B9,E9=b9,S9=N9,k9=C9,j9=1,F9=2;function T9(e,t,r,n,a,s){var o=r&j9,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var u=s.get(e),A=s.get(t);if(u&&A)return u==t&&A==e;var h=-1,f=!0,d=r&F9?new E9:void 0;for(s.set(e,t),s.set(t,e);++h<l;){var v=e[h],g=t[h];if(n)var y=o?n(g,v,h,t,e,s):n(v,g,h,e,t,s);if(y!==void 0){if(y)continue;f=!1;break}if(d){if(!S9(t,function(p,m){if(!k9(d,m)&&(v===p||a(v,p,r,n,s)))return d.push(m)})){f=!1;break}}else if(!(v===g||a(v,g,r,n,s))){f=!1;break}}return s.delete(e),s.delete(t),f}var FF=T9,I9=Il,L9=I9.Uint8Array,O9=L9;function U9(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var P9=U9;function D9(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var R9=D9,LN=Xb,ON=O9,Q9=NF,M9=FF,H9=P9,q9=R9,K9=1,$9=2,V9="[object Boolean]",G9="[object Date]",W9="[object Error]",z9="[object Map]",X9="[object Number]",Y9="[object RegExp]",J9="[object Set]",Z9="[object String]",eH="[object Symbol]",tH="[object ArrayBuffer]",rH="[object DataView]",UN=LN?LN.prototype:void 0,bv=UN?UN.valueOf:void 0;function nH(e,t,r,n,a,s,o){switch(r){case rH:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case tH:return!(e.byteLength!=t.byteLength||!s(new ON(e),new ON(t)));case V9:case G9:case X9:return Q9(+e,+t);case W9:return e.name==t.name&&e.message==t.message;case Y9:case Z9:return e==t+"";case z9:var l=H9;case J9:var c=n&K9;if(l||(l=q9),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;n|=$9,o.set(e,t);var A=M9(l(e),l(t),n,a,s,o);return o.delete(e),A;case eH:if(bv)return bv.call(e)==bv.call(t)}return!1}var aH=nH;function sH(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var iH=sH,oH=Array.isArray,Jb=oH,lH=iH,cH=Jb;function uH(e,t,r){var n=t(e);return cH(e)?n:lH(n,r(e))}var AH=uH;function dH(e,t){for(var r=-1,n=e==null?0:e.length,a=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[a++]=o)}return s}var fH=dH;function hH(){return[]}var pH=hH,mH=fH,gH=pH,xH=Object.prototype,vH=xH.propertyIsEnumerable,PN=Object.getOwnPropertySymbols,yH=PN?function(e){return e==null?[]:(e=Object(e),mH(PN(e),function(t){return vH.call(e,t)}))}:gH,wH=yH;function bH(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var _H=bH;function NH(e){return e!=null&&typeof e=="object"}var Lx=NH,BH=Fx,CH=Lx,EH="[object Arguments]";function SH(e){return CH(e)&&BH(e)==EH}var kH=SH,DN=kH,jH=Lx,TF=Object.prototype,FH=TF.hasOwnProperty,TH=TF.propertyIsEnumerable,IH=DN(function(){return arguments}())?DN:function(e){return jH(e)&&FH.call(e,"callee")&&!TH.call(e,"callee")},LH=IH,Ig={exports:{}};function OH(){return!1}var UH=OH;Ig.exports;(function(e,t){var r=Il,n=UH,a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===a,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;e.exports=u})(Ig,Ig.exports);var IF=Ig.exports,PH=9007199254740991,DH=/^(?:0|[1-9]\d*)$/;function RH(e,t){var r=typeof e;return t=t??PH,!!t&&(r=="number"||r!="symbol"&&DH.test(e))&&e>-1&&e%1==0&&e<t}var QH=RH,MH=9007199254740991;function HH(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=MH}var LF=HH,qH=Fx,KH=LF,$H=Lx,VH="[object Arguments]",GH="[object Array]",WH="[object Boolean]",zH="[object Date]",XH="[object Error]",YH="[object Function]",JH="[object Map]",ZH="[object Number]",eq="[object Object]",tq="[object RegExp]",rq="[object Set]",nq="[object String]",aq="[object WeakMap]",sq="[object ArrayBuffer]",iq="[object DataView]",oq="[object Float32Array]",lq="[object Float64Array]",cq="[object Int8Array]",uq="[object Int16Array]",Aq="[object Int32Array]",dq="[object Uint8Array]",fq="[object Uint8ClampedArray]",hq="[object Uint16Array]",pq="[object Uint32Array]",Yr={};Yr[oq]=Yr[lq]=Yr[cq]=Yr[uq]=Yr[Aq]=Yr[dq]=Yr[fq]=Yr[hq]=Yr[pq]=!0;Yr[VH]=Yr[GH]=Yr[sq]=Yr[WH]=Yr[iq]=Yr[zH]=Yr[XH]=Yr[YH]=Yr[JH]=Yr[ZH]=Yr[eq]=Yr[tq]=Yr[rq]=Yr[nq]=Yr[aq]=!1;function mq(e){return $H(e)&&KH(e.length)&&!!Yr[qH(e)]}var gq=mq;function xq(e){return function(t){return e(t)}}var vq=xq,Lg={exports:{}};Lg.exports;(function(e,t){var r=BF,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,o=s&&r.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(Lg,Lg.exports);var yq=Lg.exports,wq=gq,bq=vq,RN=yq,QN=RN&&RN.isTypedArray,_q=QN?bq(QN):wq,OF=_q,Nq=_H,Bq=LH,Cq=Jb,Eq=IF,Sq=QH,kq=OF,jq=Object.prototype,Fq=jq.hasOwnProperty;function Tq(e,t){var r=Cq(e),n=!r&&Bq(e),a=!r&&!n&&Eq(e),s=!r&&!n&&!a&&kq(e),o=r||n||a||s,l=o?Nq(e.length,String):[],c=l.length;for(var u in e)(t||Fq.call(e,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Sq(u,c)))&&l.push(u);return l}var Iq=Tq,Lq=Object.prototype;function Oq(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Lq;return e===r}var Uq=Oq;function Pq(e,t){return function(r){return e(t(r))}}var Dq=Pq,Rq=Dq,Qq=Rq(Object.keys,Object),Mq=Qq,Hq=Uq,qq=Mq,Kq=Object.prototype,$q=Kq.hasOwnProperty;function Vq(e){if(!Hq(e))return qq(e);var t=[];for(var r in Object(e))$q.call(e,r)&&r!="constructor"&&t.push(r);return t}var Gq=Vq,Wq=SF,zq=LF;function Xq(e){return e!=null&&zq(e.length)&&!Wq(e)}var Yq=Xq,Jq=Iq,Zq=Gq,eK=Yq;function tK(e){return eK(e)?Jq(e):Zq(e)}var rK=tK,nK=AH,aK=wH,sK=rK;function iK(e){return nK(e,sK,aK)}var oK=iK,MN=oK,lK=1,cK=Object.prototype,uK=cK.hasOwnProperty;function AK(e,t,r,n,a,s){var o=r&lK,l=MN(e),c=l.length,u=MN(t),A=u.length;if(c!=A&&!o)return!1;for(var h=c;h--;){var f=l[h];if(!(o?f in t:uK.call(t,f)))return!1}var d=s.get(e),v=s.get(t);if(d&&v)return d==t&&v==e;var g=!0;s.set(e,t),s.set(t,e);for(var y=o;++h<c;){f=l[h];var p=e[f],m=t[f];if(n)var w=o?n(m,p,f,t,e,s):n(p,m,f,e,t,s);if(!(w===void 0?p===m||a(p,m,r,n,s):w)){g=!1;break}y||(y=f=="constructor")}if(g&&!y){var x=e.constructor,b=t.constructor;x!=b&&"constructor"in e&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof b=="function"&&b instanceof b)&&(g=!1)}return s.delete(e),s.delete(t),g}var dK=AK,fK=Dd,hK=Il,pK=fK(hK,"DataView"),mK=pK,gK=Dd,xK=Il,vK=gK(xK,"Promise"),yK=vK,wK=Dd,bK=Il,_K=wK(bK,"Set"),NK=_K,BK=Dd,CK=Il,EK=BK(CK,"WeakMap"),SK=EK,$w=mK,Vw=Yb,Gw=yK,Ww=NK,zw=SK,UF=Fx,Hd=kF,HN="[object Map]",kK="[object Object]",qN="[object Promise]",KN="[object Set]",$N="[object WeakMap]",VN="[object DataView]",jK=Hd($w),FK=Hd(Vw),TK=Hd(Gw),IK=Hd(Ww),LK=Hd(zw),du=UF;($w&&du(new $w(new ArrayBuffer(1)))!=VN||Vw&&du(new Vw)!=HN||Gw&&du(Gw.resolve())!=qN||Ww&&du(new Ww)!=KN||zw&&du(new zw)!=$N)&&(du=function(e){var t=UF(e),r=t==kK?e.constructor:void 0,n=r?Hd(r):"";if(n)switch(n){case jK:return VN;case FK:return HN;case TK:return qN;case IK:return KN;case LK:return $N}return t});var OK=du,_v=f9,UK=FF,PK=aH,DK=dK,GN=OK,WN=Jb,zN=IF,RK=OF,QK=1,XN="[object Arguments]",YN="[object Array]",Pp="[object Object]",MK=Object.prototype,JN=MK.hasOwnProperty;function HK(e,t,r,n,a,s){var o=WN(e),l=WN(t),c=o?YN:GN(e),u=l?YN:GN(t);c=c==XN?Pp:c,u=u==XN?Pp:u;var A=c==Pp,h=u==Pp,f=c==u;if(f&&zN(e)){if(!zN(t))return!1;o=!0,A=!1}if(f&&!A)return s||(s=new _v),o||RK(e)?UK(e,t,r,n,a,s):PK(e,t,c,r,n,a,s);if(!(r&QK)){var d=A&&JN.call(e,"__wrapped__"),v=h&&JN.call(t,"__wrapped__");if(d||v){var g=d?e.value():e,y=v?t.value():t;return s||(s=new _v),a(g,y,r,n,s)}}return f?(s||(s=new _v),DK(e,t,r,n,a,s)):!1}var qK=HK,KK=qK,ZN=Lx;function PF(e,t,r,n,a){return e===t?!0:e==null||t==null||!ZN(e)&&!ZN(t)?e!==e&&t!==t:KK(e,t,r,n,PF,a)}var $K=PF,VK=$K;function GK(e,t){return VK(e,t)}var WK=GK,DF={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(e,t){(function(n,a){e.exports=a()})(typeof self<"u"?self:ti,function(){return function(r){var n={};function a(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return r[s].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=r,a.c=n,a.d=function(s,o,l){a.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:l})},a.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return a.d(o,"a",o),o},a.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},a.p="",a(a.s=109)}([function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(17),o=a(18),l=a(19),c=a(45),u=a(46),A=a(47),h=a(48),f=a(49),d=a(12),v=a(32),g=a(33),y=a(31),p=a(1),m={Scope:p.Scope,create:p.create,find:p.find,query:p.query,register:p.register,Container:s.default,Format:o.default,Leaf:l.default,Embed:h.default,Scroll:c.default,Block:A.default,Inline:u.default,Text:f.default,Attributor:{Attribute:d.default,Class:v.default,Style:g.default,Store:y.default}};n.default=m},function(r,n,a){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,m){p.__proto__=m}||function(p,m){for(var w in m)m.hasOwnProperty(w)&&(p[w]=m[w])};return function(p,m){y(p,m);function w(){this.constructor=p}p.prototype=m===null?Object.create(m):(w.prototype=m.prototype,new w)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(y){s(p,y);function p(m){var w=this;return m="[Parchment] "+m,w=y.call(this,m)||this,w.message=m,w.name=w.constructor.name,w}return p}(Error);n.ParchmentError=o;var l={},c={},u={},A={};n.DATA_KEY="__blot";var h;(function(y){y[y.TYPE=3]="TYPE",y[y.LEVEL=12]="LEVEL",y[y.ATTRIBUTE=13]="ATTRIBUTE",y[y.BLOT=14]="BLOT",y[y.INLINE=7]="INLINE",y[y.BLOCK=11]="BLOCK",y[y.BLOCK_BLOT=10]="BLOCK_BLOT",y[y.INLINE_BLOT=6]="INLINE_BLOT",y[y.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",y[y.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",y[y.ANY=15]="ANY"})(h=n.Scope||(n.Scope={}));function f(y,p){var m=v(y);if(m==null)throw new o("Unable to create "+y+" blot");var w=m,x=y instanceof Node||y.nodeType===Node.TEXT_NODE?y:w.create(p);return new w(x,p)}n.create=f;function d(y,p){return p===void 0&&(p=!1),y==null?null:y[n.DATA_KEY]!=null?y[n.DATA_KEY].blot:p?d(y.parentNode,p):null}n.find=d;function v(y,p){p===void 0&&(p=h.ANY);var m;if(typeof y=="string")m=A[y]||l[y];else if(y instanceof Text||y.nodeType===Node.TEXT_NODE)m=A.text;else if(typeof y=="number")y&h.LEVEL&h.BLOCK?m=A.block:y&h.LEVEL&h.INLINE&&(m=A.inline);else if(y instanceof HTMLElement){var w=(y.getAttribute("class")||"").split(/\s+/);for(var x in w)if(m=c[w[x]],m)break;m=m||u[y.tagName]}return m==null?null:p&h.LEVEL&m.scope&&p&h.TYPE&m.scope?m:null}n.query=v;function g(){for(var y=[],p=0;p<arguments.length;p++)y[p]=arguments[p];if(y.length>1)return y.map(function(x){return g(x)});var m=y[0];if(typeof m.blotName!="string"&&typeof m.attrName!="string")throw new o("Invalid definition");if(m.blotName==="abstract")throw new o("Cannot register abstract class");if(A[m.blotName||m.attrName]=m,typeof m.keyName=="string")l[m.keyName]=m;else if(m.className!=null&&(c[m.className]=m),m.tagName!=null){Array.isArray(m.tagName)?m.tagName=m.tagName.map(function(x){return x.toUpperCase()}):m.tagName=m.tagName.toUpperCase();var w=Array.isArray(m.tagName)?m.tagName:[m.tagName];w.forEach(function(x){(u[x]==null||m.className==null)&&(u[x]=m)})}return m}n.register=g},function(r,n,a){var s=a(51),o=a(11),l=a(3),c=a(20),u="\0",A=function(h){Array.isArray(h)?this.ops=h:h!=null&&Array.isArray(h.ops)?this.ops=h.ops:this.ops=[]};A.prototype.insert=function(h,f){var d={};return h.length===0?this:(d.insert=h,f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(d.attributes=f),this.push(d))},A.prototype.delete=function(h){return h<=0?this:this.push({delete:h})},A.prototype.retain=function(h,f){if(h<=0)return this;var d={retain:h};return f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(d.attributes=f),this.push(d)},A.prototype.push=function(h){var f=this.ops.length,d=this.ops[f-1];if(h=l(!0,{},h),typeof d=="object"){if(typeof h.delete=="number"&&typeof d.delete=="number")return this.ops[f-1]={delete:d.delete+h.delete},this;if(typeof d.delete=="number"&&h.insert!=null&&(f-=1,d=this.ops[f-1],typeof d!="object"))return this.ops.unshift(h),this;if(o(h.attributes,d.attributes)){if(typeof h.insert=="string"&&typeof d.insert=="string")return this.ops[f-1]={insert:d.insert+h.insert},typeof h.attributes=="object"&&(this.ops[f-1].attributes=h.attributes),this;if(typeof h.retain=="number"&&typeof d.retain=="number")return this.ops[f-1]={retain:d.retain+h.retain},typeof h.attributes=="object"&&(this.ops[f-1].attributes=h.attributes),this}}return f===this.ops.length?this.ops.push(h):this.ops.splice(f,0,h),this},A.prototype.chop=function(){var h=this.ops[this.ops.length-1];return h&&h.retain&&!h.attributes&&this.ops.pop(),this},A.prototype.filter=function(h){return this.ops.filter(h)},A.prototype.forEach=function(h){this.ops.forEach(h)},A.prototype.map=function(h){return this.ops.map(h)},A.prototype.partition=function(h){var f=[],d=[];return this.forEach(function(v){var g=h(v)?f:d;g.push(v)}),[f,d]},A.prototype.reduce=function(h,f){return this.ops.reduce(h,f)},A.prototype.changeLength=function(){return this.reduce(function(h,f){return f.insert?h+c.length(f):f.delete?h-f.delete:h},0)},A.prototype.length=function(){return this.reduce(function(h,f){return h+c.length(f)},0)},A.prototype.slice=function(h,f){h=h||0,typeof f!="number"&&(f=1/0);for(var d=[],v=c.iterator(this.ops),g=0;g<f&&v.hasNext();){var y;g<h?y=v.next(h-g):(y=v.next(f-g),d.push(y)),g+=c.length(y)}return new A(d)},A.prototype.compose=function(h){var f=c.iterator(this.ops),d=c.iterator(h.ops),v=[],g=d.peek();if(g!=null&&typeof g.retain=="number"&&g.attributes==null){for(var y=g.retain;f.peekType()==="insert"&&f.peekLength()<=y;)y-=f.peekLength(),v.push(f.next());g.retain-y>0&&d.next(g.retain-y)}for(var p=new A(v);f.hasNext()||d.hasNext();)if(d.peekType()==="insert")p.push(d.next());else if(f.peekType()==="delete")p.push(f.next());else{var m=Math.min(f.peekLength(),d.peekLength()),w=f.next(m),x=d.next(m);if(typeof x.retain=="number"){var b={};typeof w.retain=="number"?b.retain=m:b.insert=w.insert;var B=c.attributes.compose(w.attributes,x.attributes,typeof w.retain=="number");if(B&&(b.attributes=B),p.push(b),!d.hasNext()&&o(p.ops[p.ops.length-1],b)){var _=new A(f.rest());return p.concat(_).chop()}}else typeof x.delete=="number"&&typeof w.retain=="number"&&p.push(x)}return p.chop()},A.prototype.concat=function(h){var f=new A(this.ops.slice());return h.ops.length>0&&(f.push(h.ops[0]),f.ops=f.ops.concat(h.ops.slice(1))),f},A.prototype.diff=function(h,f){if(this.ops===h.ops)return new A;var d=[this,h].map(function(m){return m.map(function(w){if(w.insert!=null)return typeof w.insert=="string"?w.insert:u;var x=m===h?"on":"with";throw new Error("diff() called "+x+" non-document")}).join("")}),v=new A,g=s(d[0],d[1],f),y=c.iterator(this.ops),p=c.iterator(h.ops);return g.forEach(function(m){for(var w=m[1].length;w>0;){var x=0;switch(m[0]){case s.INSERT:x=Math.min(p.peekLength(),w),v.push(p.next(x));break;case s.DELETE:x=Math.min(w,y.peekLength()),y.next(x),v.delete(x);break;case s.EQUAL:x=Math.min(y.peekLength(),p.peekLength(),w);var b=y.next(x),B=p.next(x);o(b.insert,B.insert)?v.retain(x,c.attributes.diff(b.attributes,B.attributes)):v.push(B).delete(x);break}w-=x}}),v.chop()},A.prototype.eachLine=function(h,f){f=f||`
`;for(var d=c.iterator(this.ops),v=new A,g=0;d.hasNext();){if(d.peekType()!=="insert")return;var y=d.peek(),p=c.length(y)-d.peekLength(),m=typeof y.insert=="string"?y.insert.indexOf(f,p)-p:-1;if(m<0)v.push(d.next());else if(m>0)v.push(d.next(m));else{if(h(v,d.next(1).attributes||{},g)===!1)return;g+=1,v=new A}}v.length()>0&&h(v,{},g)},A.prototype.transform=function(h,f){if(f=!!f,typeof h=="number")return this.transformPosition(h,f);for(var d=c.iterator(this.ops),v=c.iterator(h.ops),g=new A;d.hasNext()||v.hasNext();)if(d.peekType()==="insert"&&(f||v.peekType()!=="insert"))g.retain(c.length(d.next()));else if(v.peekType()==="insert")g.push(v.next());else{var y=Math.min(d.peekLength(),v.peekLength()),p=d.next(y),m=v.next(y);if(p.delete)continue;m.delete?g.push(m):g.retain(y,c.attributes.transform(p.attributes,m.attributes,f))}return g.chop()},A.prototype.transformPosition=function(h,f){f=!!f;for(var d=c.iterator(this.ops),v=0;d.hasNext()&&v<=h;){var g=d.peekLength(),y=d.peekType();if(d.next(),y==="delete"){h-=Math.min(g,h-v);continue}else y==="insert"&&(v<h||!f)&&(h+=g);v+=g}return h},r.exports=A},function(r,n){var a=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,c=function(d){return typeof Array.isArray=="function"?Array.isArray(d):s.call(d)==="[object Array]"},u=function(d){if(!d||s.call(d)!=="[object Object]")return!1;var v=a.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&a.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!v&&!g)return!1;var y;for(y in d);return typeof y>"u"||a.call(d,y)},A=function(d,v){o&&v.name==="__proto__"?o(d,v.name,{enumerable:!0,configurable:!0,value:v.newValue,writable:!0}):d[v.name]=v.newValue},h=function(d,v){if(v==="__proto__")if(a.call(d,v)){if(l)return l(d,v).value}else return;return d[v]};r.exports=function f(){var d,v,g,y,p,m,w=arguments[0],x=1,b=arguments.length,B=!1;for(typeof w=="boolean"&&(B=w,w=arguments[1]||{},x=2),(w==null||typeof w!="object"&&typeof w!="function")&&(w={});x<b;++x)if(d=arguments[x],d!=null)for(v in d)g=h(w,v),y=h(d,v),w!==y&&(B&&y&&(u(y)||(p=c(y)))?(p?(p=!1,m=g&&c(g)?g:[]):m=g&&u(g)?g:{},A(w,{name:v,newValue:f(B,m,y)})):typeof y<"u"&&A(w,{name:v,newValue:y}));return w}},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var s=function(){function S(j,I){for(var U=0;U<I.length;U++){var q=I[U];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(j,q.key,q)}}return function(j,I,U){return I&&S(j.prototype,I),U&&S(j,U),j}}(),o=function S(j,I,U){j===null&&(j=Function.prototype);var q=Object.getOwnPropertyDescriptor(j,I);if(q===void 0){var V=Object.getPrototypeOf(j);return V===null?void 0:S(V,I,U)}else{if("value"in q)return q.value;var X=q.get;return X===void 0?void 0:X.call(U)}},l=a(3),c=w(l),u=a(2),A=w(u),h=a(0),f=w(h),d=a(16),v=w(d),g=a(6),y=w(g),p=a(7),m=w(p);function w(S){return S&&S.__esModule?S:{default:S}}function x(S,j){if(!(S instanceof j))throw new TypeError("Cannot call a class as a function")}function b(S,j){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:S}function B(S,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);S.prototype=Object.create(j&&j.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(S,j):S.__proto__=j)}var _=1,k=function(S){B(j,S);function j(){return x(this,j),b(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return s(j,[{key:"attach",value:function(){o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"attach",this).call(this),this.attributes=new f.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new A.default().insert(this.value(),(0,c.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(U,q){var V=f.default.query(U,f.default.Scope.BLOCK_ATTRIBUTE);V!=null&&this.attributes.attribute(V,q)}},{key:"formatAt",value:function(U,q,V,X){this.format(V,X)}},{key:"insertAt",value:function(U,q,V){if(typeof q=="string"&&q.endsWith(`
`)){var X=f.default.create(E.blotName);this.parent.insertBefore(X,U===0?this:this.next),X.insertAt(0,q.slice(0,-1))}else o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"insertAt",this).call(this,U,q,V)}}]),j}(f.default.Embed);k.scope=f.default.Scope.BLOCK_BLOT;var E=function(S){B(j,S);function j(I){x(this,j);var U=b(this,(j.__proto__||Object.getPrototypeOf(j)).call(this,I));return U.cache={},U}return s(j,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(f.default.Leaf).reduce(function(U,q){return q.length()===0?U:U.insert(q.value(),T(q))},new A.default).insert(`
`,T(this))),this.cache.delta}},{key:"deleteAt",value:function(U,q){o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"deleteAt",this).call(this,U,q),this.cache={}}},{key:"formatAt",value:function(U,q,V,X){q<=0||(f.default.query(V,f.default.Scope.BLOCK)?U+q===this.length()&&this.format(V,X):o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"formatAt",this).call(this,U,Math.min(q,this.length()-U-1),V,X),this.cache={})}},{key:"insertAt",value:function(U,q,V){if(V!=null)return o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"insertAt",this).call(this,U,q,V);if(q.length!==0){var X=q.split(`
`),W=X.shift();W.length>0&&(U<this.length()-1||this.children.tail==null?o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"insertAt",this).call(this,Math.min(U,this.length()-1),W):this.children.tail.insertAt(this.children.tail.length(),W),this.cache={});var M=this;X.reduce(function(G,H){return M=M.split(G,!0),M.insertAt(0,H),H.length},U+W.length)}}},{key:"insertBefore",value:function(U,q){var V=this.children.head;o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"insertBefore",this).call(this,U,q),V instanceof v.default&&V.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"length",this).call(this)+_),this.cache.length}},{key:"moveChildren",value:function(U,q){o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"moveChildren",this).call(this,U,q),this.cache={}}},{key:"optimize",value:function(U){o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"optimize",this).call(this,U),this.cache={}}},{key:"path",value:function(U){return o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"path",this).call(this,U,!0)}},{key:"removeChild",value:function(U){o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"removeChild",this).call(this,U),this.cache={}}},{key:"split",value:function(U){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(q&&(U===0||U>=this.length()-_)){var V=this.clone();return U===0?(this.parent.insertBefore(V,this),this):(this.parent.insertBefore(V,this.next),V)}else{var X=o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"split",this).call(this,U,q);return this.cache={},X}}}]),j}(f.default.Block);E.blotName="block",E.tagName="P",E.defaultChild="break",E.allowedChildren=[y.default,f.default.Embed,m.default];function T(S){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return S==null||(typeof S.formats=="function"&&(j=(0,c.default)(j,S.formats())),S.parent==null||S.parent.blotName=="scroll"||S.parent.statics.scope!==S.statics.scope)?j:T(S.parent,j)}n.bubbleFormats=T,n.BlockEmbed=k,n.default=E},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},o=function(){function M(G,H){var C=[],L=!0,O=!1,D=void 0;try{for(var P=G[Symbol.iterator](),Q;!(L=(Q=P.next()).done)&&(C.push(Q.value),!(H&&C.length===H));L=!0);}catch(J){O=!0,D=J}finally{try{!L&&P.return&&P.return()}finally{if(O)throw D}}return C}return function(G,H){if(Array.isArray(G))return G;if(Symbol.iterator in Object(G))return M(G,H);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function M(G,H){for(var C=0;C<H.length;C++){var L=H[C];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(G,L.key,L)}}return function(G,H,C){return H&&M(G.prototype,H),C&&M(G,C),G}}();a(50);var c=a(2),u=T(c),A=a(14),h=T(A),f=a(8),d=T(f),v=a(9),g=T(v),y=a(0),p=T(y),m=a(15),w=T(m),x=a(3),b=T(x),B=a(10),_=T(B),k=a(34),E=T(k);function T(M){return M&&M.__esModule?M:{default:M}}function S(M,G,H){return G in M?Object.defineProperty(M,G,{value:H,enumerable:!0,configurable:!0,writable:!0}):M[G]=H,M}function j(M,G){if(!(M instanceof G))throw new TypeError("Cannot call a class as a function")}var I=(0,_.default)("quill"),U=function(){l(M,null,[{key:"debug",value:function(H){H===!0&&(H="log"),_.default.level(H)}},{key:"find",value:function(H){return H.__quill||p.default.find(H)}},{key:"import",value:function(H){return this.imports[H]==null&&I.error("Cannot import "+H+". Are you sure it was registered?"),this.imports[H]}},{key:"register",value:function(H,C){var L=this,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof H!="string"){var D=H.attrName||H.blotName;typeof D=="string"?this.register("formats/"+D,H,C):Object.keys(H).forEach(function(P){L.register(P,H[P],C)})}else this.imports[H]!=null&&!O&&I.warn("Overwriting "+H+" with",C),this.imports[H]=C,(H.startsWith("blots/")||H.startsWith("formats/"))&&C.blotName!=="abstract"?p.default.register(C):H.startsWith("modules")&&typeof C.register=="function"&&C.register()}}]);function M(G){var H=this,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(j(this,M),this.options=q(G,C),this.container=this.options.container,this.container==null)return I.error("Invalid Quill container",G);this.options.debug&&M.debug(this.options.debug);var L=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new d.default,this.scroll=p.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new h.default(this.scroll),this.selection=new w.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(d.default.events.EDITOR_CHANGE,function(D){D===d.default.events.TEXT_CHANGE&&H.root.classList.toggle("ql-blank",H.editor.isBlank())}),this.emitter.on(d.default.events.SCROLL_UPDATE,function(D,P){var Q=H.selection.lastRange,J=Q&&Q.length===0?Q.index:void 0;V.call(H,function(){return H.editor.update(null,P,J)},D)});var O=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+L+"<p><br></p></div>");this.setContents(O),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(M,[{key:"addContainer",value:function(H){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof H=="string"){var L=H;H=document.createElement("div"),H.classList.add(L)}return this.container.insertBefore(H,C),H}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(H,C,L){var O=this,D=X(H,C,L),P=o(D,4);return H=P[0],C=P[1],L=P[3],V.call(this,function(){return O.editor.deleteText(H,C)},L,H,-1*C)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(H),this.container.classList.toggle("ql-disabled",!H)}},{key:"focus",value:function(){var H=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=H,this.scrollIntoView()}},{key:"format",value:function(H,C){var L=this,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:d.default.sources.API;return V.call(this,function(){var D=L.getSelection(!0),P=new u.default;if(D==null)return P;if(p.default.query(H,p.default.Scope.BLOCK))P=L.editor.formatLine(D.index,D.length,S({},H,C));else{if(D.length===0)return L.selection.format(H,C),P;P=L.editor.formatText(D.index,D.length,S({},H,C))}return L.setSelection(D,d.default.sources.SILENT),P},O)}},{key:"formatLine",value:function(H,C,L,O,D){var P=this,Q=void 0,J=X(H,C,L,O,D),te=o(J,4);return H=te[0],C=te[1],Q=te[2],D=te[3],V.call(this,function(){return P.editor.formatLine(H,C,Q)},D,H,0)}},{key:"formatText",value:function(H,C,L,O,D){var P=this,Q=void 0,J=X(H,C,L,O,D),te=o(J,4);return H=te[0],C=te[1],Q=te[2],D=te[3],V.call(this,function(){return P.editor.formatText(H,C,Q)},D,H,0)}},{key:"getBounds",value:function(H){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,L=void 0;typeof H=="number"?L=this.selection.getBounds(H,C):L=this.selection.getBounds(H.index,H.length);var O=this.container.getBoundingClientRect();return{bottom:L.bottom-O.top,height:L.height,left:L.left-O.left,right:L.right-O.left,top:L.top-O.top,width:L.width}}},{key:"getContents",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-H,L=X(H,C),O=o(L,2);return H=O[0],C=O[1],this.editor.getContents(H,C)}},{key:"getFormat",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof H=="number"?this.editor.getFormat(H,C):this.editor.getFormat(H.index,H.length)}},{key:"getIndex",value:function(H){return H.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(H){return this.scroll.leaf(H)}},{key:"getLine",value:function(H){return this.scroll.line(H)}},{key:"getLines",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof H!="number"?this.scroll.lines(H.index,H.length):this.scroll.lines(H,C)}},{key:"getModule",value:function(H){return this.theme.modules[H]}},{key:"getSelection",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return H&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-H,L=X(H,C),O=o(L,2);return H=O[0],C=O[1],this.editor.getText(H,C)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(H,C,L){var O=this,D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:M.sources.API;return V.call(this,function(){return O.editor.insertEmbed(H,C,L)},D,H)}},{key:"insertText",value:function(H,C,L,O,D){var P=this,Q=void 0,J=X(H,0,L,O,D),te=o(J,4);return H=te[0],Q=te[2],D=te[3],V.call(this,function(){return P.editor.insertText(H,C,Q)},D,H,C.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(H,C,L){this.clipboard.dangerouslyPasteHTML(H,C,L)}},{key:"removeFormat",value:function(H,C,L){var O=this,D=X(H,C,L),P=o(D,4);return H=P[0],C=P[1],L=P[3],V.call(this,function(){return O.editor.removeFormat(H,C)},L,H)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(H){var C=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d.default.sources.API;return V.call(this,function(){H=new u.default(H);var O=C.getLength(),D=C.editor.deleteText(0,O),P=C.editor.applyDelta(H),Q=P.ops[P.ops.length-1];Q!=null&&typeof Q.insert=="string"&&Q.insert[Q.insert.length-1]===`
`&&(C.editor.deleteText(C.getLength()-1,1),P.delete(1));var J=D.compose(P);return J},L)}},{key:"setSelection",value:function(H,C,L){if(H==null)this.selection.setRange(null,C||M.sources.API);else{var O=X(H,C,L),D=o(O,4);H=D[0],C=D[1],L=D[3],this.selection.setRange(new m.Range(H,C),L),L!==d.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(H){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d.default.sources.API,L=new u.default().insert(H);return this.setContents(L,C)}},{key:"update",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d.default.sources.USER,C=this.scroll.update(H);return this.selection.update(H),C}},{key:"updateContents",value:function(H){var C=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d.default.sources.API;return V.call(this,function(){return H=new u.default(H),C.editor.applyDelta(H,L)},L,!0)}}]),M}();U.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},U.events=d.default.events,U.sources=d.default.sources,U.version="1.3.7",U.imports={delta:u.default,parchment:p.default,"core/module":g.default,"core/theme":E.default};function q(M,G){if(G=(0,b.default)(!0,{container:M,modules:{clipboard:!0,keyboard:!0,history:!0}},G),!G.theme||G.theme===U.DEFAULTS.theme)G.theme=E.default;else if(G.theme=U.import("themes/"+G.theme),G.theme==null)throw new Error("Invalid theme "+G.theme+". Did you register it?");var H=(0,b.default)(!0,{},G.theme.DEFAULTS);[H,G].forEach(function(O){O.modules=O.modules||{},Object.keys(O.modules).forEach(function(D){O.modules[D]===!0&&(O.modules[D]={})})});var C=Object.keys(H.modules).concat(Object.keys(G.modules)),L=C.reduce(function(O,D){var P=U.import("modules/"+D);return P==null?I.error("Cannot load "+D+" module. Are you sure you registered it?"):O[D]=P.DEFAULTS||{},O},{});return G.modules!=null&&G.modules.toolbar&&G.modules.toolbar.constructor!==Object&&(G.modules.toolbar={container:G.modules.toolbar}),G=(0,b.default)(!0,{},U.DEFAULTS,{modules:L},H,G),["bounds","container","scrollingContainer"].forEach(function(O){typeof G[O]=="string"&&(G[O]=document.querySelector(G[O]))}),G.modules=Object.keys(G.modules).reduce(function(O,D){return G.modules[D]&&(O[D]=G.modules[D]),O},{}),G}function V(M,G,H,C){if(this.options.strict&&!this.isEnabled()&&G===d.default.sources.USER)return new u.default;var L=H==null?null:this.getSelection(),O=this.editor.delta,D=M();if(L!=null&&(H===!0&&(H=L.index),C==null?L=W(L,D,G):C!==0&&(L=W(L,H,C,G)),this.setSelection(L,d.default.sources.SILENT)),D.length()>0){var P,Q=[d.default.events.TEXT_CHANGE,D,O,G];if((P=this.emitter).emit.apply(P,[d.default.events.EDITOR_CHANGE].concat(Q)),G!==d.default.sources.SILENT){var J;(J=this.emitter).emit.apply(J,Q)}}return D}function X(M,G,H,C,L){var O={};return typeof M.index=="number"&&typeof M.length=="number"?typeof G!="number"?(L=C,C=H,H=G,G=M.length,M=M.index):(G=M.length,M=M.index):typeof G!="number"&&(L=C,C=H,H=G,G=0),(typeof H>"u"?"undefined":s(H))==="object"?(O=H,L=C):typeof H=="string"&&(C!=null?O[H]=C:L=H),L=L||d.default.sources.API,[M,G,O,L]}function W(M,G,H,C){if(M==null)return null;var L=void 0,O=void 0;if(G instanceof u.default){var D=[M.index,M.index+M.length].map(function(te){return G.transformPosition(te,C!==d.default.sources.USER)}),P=o(D,2);L=P[0],O=P[1]}else{var Q=[M.index,M.index+M.length].map(function(te){return te<G||te===G&&C===d.default.sources.USER?te:H>=0?te+H:Math.max(G,te+H)}),J=o(Q,2);L=J[0],O=J[1]}return new m.Range(L,O-L)}n.expandConfig=q,n.overload=X,n.default=U},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function y(p,m){for(var w=0;w<m.length;w++){var x=m[w];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,m,w){return m&&y(p.prototype,m),w&&y(p,w),p}}(),o=function y(p,m,w){p===null&&(p=Function.prototype);var x=Object.getOwnPropertyDescriptor(p,m);if(x===void 0){var b=Object.getPrototypeOf(p);return b===null?void 0:y(b,m,w)}else{if("value"in x)return x.value;var B=x.get;return B===void 0?void 0:B.call(w)}},l=a(7),c=h(l),u=a(0),A=h(u);function h(y){return y&&y.__esModule?y:{default:y}}function f(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}function d(y,p){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:y}function v(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}var g=function(y){v(p,y);function p(){return f(this,p),d(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return s(p,[{key:"formatAt",value:function(w,x,b,B){if(p.compare(this.statics.blotName,b)<0&&A.default.query(b,A.default.Scope.BLOT)){var _=this.isolate(w,x);B&&_.wrap(b,B)}else o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"formatAt",this).call(this,w,x,b,B)}},{key:"optimize",value:function(w){if(o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"optimize",this).call(this,w),this.parent instanceof p&&p.compare(this.statics.blotName,this.parent.statics.blotName)>0){var x=this.parent.isolate(this.offset(),this.length());this.moveChildren(x),x.wrap(this)}}}],[{key:"compare",value:function(w,x){var b=p.order.indexOf(w),B=p.order.indexOf(x);return b>=0||B>=0?b-B:w===x?0:w<x?-1:1}}]),p}(A.default.Inline);g.allowedChildren=[g,A.default.Embed,c.default],g.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=g},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(0),o=l(s);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")}function u(f,d){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:f}function A(f,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);f.prototype=Object.create(d&&d.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(f,d):f.__proto__=d)}var h=function(f){A(d,f);function d(){return c(this,d),u(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(o.default.Text);n.default=h},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function m(w,x){for(var b=0;b<x.length;b++){var B=x[b];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(w,B.key,B)}}return function(w,x,b){return x&&m(w.prototype,x),b&&m(w,b),w}}(),o=function m(w,x,b){w===null&&(w=Function.prototype);var B=Object.getOwnPropertyDescriptor(w,x);if(B===void 0){var _=Object.getPrototypeOf(w);return _===null?void 0:m(_,x,b)}else{if("value"in B)return B.value;var k=B.get;return k===void 0?void 0:k.call(b)}},l=a(54),c=h(l),u=a(10),A=h(u);function h(m){return m&&m.__esModule?m:{default:m}}function f(m,w){if(!(m instanceof w))throw new TypeError("Cannot call a class as a function")}function d(m,w){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:m}function v(m,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);m.prototype=Object.create(w&&w.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(m,w):m.__proto__=w)}var g=(0,A.default)("quill:events"),y=["selectionchange","mousedown","mouseup","click"];y.forEach(function(m){document.addEventListener(m,function(){for(var w=arguments.length,x=Array(w),b=0;b<w;b++)x[b]=arguments[b];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(B){if(B.__quill&&B.__quill.emitter){var _;(_=B.__quill.emitter).handleDOM.apply(_,x)}})})});var p=function(m){v(w,m);function w(){f(this,w);var x=d(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));return x.listeners={},x.on("error",g.error),x}return s(w,[{key:"emit",value:function(){g.log.apply(g,arguments),o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(b){for(var B=arguments.length,_=Array(B>1?B-1:0),k=1;k<B;k++)_[k-1]=arguments[k];(this.listeners[b.type]||[]).forEach(function(E){var T=E.node,S=E.handler;(b.target===T||T.contains(b.target))&&S.apply(void 0,[b].concat(_))})}},{key:"listenDOM",value:function(b,B,_){this.listeners[b]||(this.listeners[b]=[]),this.listeners[b].push({node:B,handler:_})}}]),w}(c.default);p.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},p.sources={API:"api",SILENT:"silent",USER:"user"},n.default=p},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});function s(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var o=function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,l),this.quill=c,this.options=u};o.DEFAULTS={},n.default=o},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function l(u){if(s.indexOf(u)<=s.indexOf(o)){for(var A,h=arguments.length,f=Array(h>1?h-1:0),d=1;d<h;d++)f[d-1]=arguments[d];(A=console)[u].apply(A,f)}}function c(u){return s.reduce(function(A,h){return A[h]=l.bind(console,h,u),A},{})}l.level=c.level=function(u){o=u},n.default=c},function(r,n,a){var s=Array.prototype.slice,o=a(52),l=a(53),c=r.exports=function(f,d,v){return v||(v={}),f===d?!0:f instanceof Date&&d instanceof Date?f.getTime()===d.getTime():!f||!d||typeof f!="object"&&typeof d!="object"?v.strict?f===d:f==d:h(f,d,v)};function u(f){return f==null}function A(f){return!(!f||typeof f!="object"||typeof f.length!="number"||typeof f.copy!="function"||typeof f.slice!="function"||f.length>0&&typeof f[0]!="number")}function h(f,d,v){var g,y;if(u(f)||u(d)||f.prototype!==d.prototype)return!1;if(l(f))return l(d)?(f=s.call(f),d=s.call(d),c(f,d,v)):!1;if(A(f)){if(!A(d)||f.length!==d.length)return!1;for(g=0;g<f.length;g++)if(f[g]!==d[g])return!1;return!0}try{var p=o(f),m=o(d)}catch{return!1}if(p.length!=m.length)return!1;for(p.sort(),m.sort(),g=p.length-1;g>=0;g--)if(p[g]!=m[g])return!1;for(g=p.length-1;g>=0;g--)if(y=p[g],!c(f[y],d[y],v))return!1;return typeof f==typeof d}},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(1),o=function(){function l(c,u,A){A===void 0&&(A={}),this.attrName=c,this.keyName=u;var h=s.Scope.TYPE&s.Scope.ATTRIBUTE;A.scope!=null?this.scope=A.scope&s.Scope.LEVEL|h:this.scope=s.Scope.ATTRIBUTE,A.whitelist!=null&&(this.whitelist=A.whitelist)}return l.keys=function(c){return[].map.call(c.attributes,function(u){return u.name})},l.prototype.add=function(c,u){return this.canAdd(c,u)?(c.setAttribute(this.keyName,u),!0):!1},l.prototype.canAdd=function(c,u){var A=s.query(c,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return A==null?!1:this.whitelist==null?!0:typeof u=="string"?this.whitelist.indexOf(u.replace(/["']/g,""))>-1:this.whitelist.indexOf(u)>-1},l.prototype.remove=function(c){c.removeAttribute(this.keyName)},l.prototype.value=function(c){var u=c.getAttribute(this.keyName);return this.canAdd(c,u)&&u?u:""},l}();n.default=o},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=function(){function k(E,T){var S=[],j=!0,I=!1,U=void 0;try{for(var q=E[Symbol.iterator](),V;!(j=(V=q.next()).done)&&(S.push(V.value),!(T&&S.length===T));j=!0);}catch(X){I=!0,U=X}finally{try{!j&&q.return&&q.return()}finally{if(I)throw U}}return S}return function(E,T){if(Array.isArray(E))return E;if(Symbol.iterator in Object(E))return k(E,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(E,T){for(var S=0;S<T.length;S++){var j=T[S];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(E,j.key,j)}}return function(E,T,S){return T&&k(E.prototype,T),S&&k(E,S),E}}(),l=function k(E,T,S){E===null&&(E=Function.prototype);var j=Object.getOwnPropertyDescriptor(E,T);if(j===void 0){var I=Object.getPrototypeOf(E);return I===null?void 0:k(I,T,S)}else{if("value"in j)return j.value;var U=j.get;return U===void 0?void 0:U.call(S)}},c=a(2),u=m(c),A=a(0),h=m(A),f=a(4),d=m(f),v=a(6),g=m(v),y=a(7),p=m(y);function m(k){return k&&k.__esModule?k:{default:k}}function w(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}function x(k,E){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:k}function b(k,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);k.prototype=Object.create(E&&E.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(k,E):k.__proto__=E)}var B=function(k){b(E,k);function E(){return w(this,E),x(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return E}(g.default);B.blotName="code",B.tagName="CODE";var _=function(k){b(E,k);function E(){return w(this,E),x(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return o(E,[{key:"delta",value:function(){var S=this,j=this.domNode.textContent;return j.endsWith(`
`)&&(j=j.slice(0,-1)),j.split(`
`).reduce(function(I,U){return I.insert(U).insert(`
`,S.formats())},new u.default)}},{key:"format",value:function(S,j){if(!(S===this.statics.blotName&&j)){var I=this.descendant(p.default,this.length()-1),U=s(I,1),q=U[0];q!=null&&q.deleteAt(q.length()-1,1),l(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"format",this).call(this,S,j)}}},{key:"formatAt",value:function(S,j,I,U){if(j!==0&&!(h.default.query(I,h.default.Scope.BLOCK)==null||I===this.statics.blotName&&U===this.statics.formats(this.domNode))){var q=this.newlineIndex(S);if(!(q<0||q>=S+j)){var V=this.newlineIndex(S,!0)+1,X=q-V+1,W=this.isolate(V,X),M=W.next;W.format(I,U),M instanceof E&&M.formatAt(0,S-V+j-X,I,U)}}}},{key:"insertAt",value:function(S,j,I){if(I==null){var U=this.descendant(p.default,S),q=s(U,2),V=q[0],X=q[1];V.insertAt(X,j)}}},{key:"length",value:function(){var S=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?S:S+1}},{key:"newlineIndex",value:function(S){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(j)return this.domNode.textContent.slice(0,S).lastIndexOf(`
`);var I=this.domNode.textContent.slice(S).indexOf(`
`);return I>-1?S+I:-1}},{key:"optimize",value:function(S){this.domNode.textContent.endsWith(`
`)||this.appendChild(h.default.create("text",`
`)),l(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"optimize",this).call(this,S);var j=this.next;j!=null&&j.prev===this&&j.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===j.statics.formats(j.domNode)&&(j.optimize(S),j.moveChildren(this),j.remove())}},{key:"replace",value:function(S){l(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replace",this).call(this,S),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(j){var I=h.default.find(j);I==null?j.parentNode.removeChild(j):I instanceof h.default.Embed?I.remove():I.unwrap()})}}],[{key:"create",value:function(S){var j=l(E.__proto__||Object.getPrototypeOf(E),"create",this).call(this,S);return j.setAttribute("spellcheck",!1),j}},{key:"formats",value:function(){return!0}}]),E}(d.default);_.blotName="code-block",_.tagName="PRE",_.TAB="  ",n.Code=B,n.default=_},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},o=function(){function M(G,H){var C=[],L=!0,O=!1,D=void 0;try{for(var P=G[Symbol.iterator](),Q;!(L=(Q=P.next()).done)&&(C.push(Q.value),!(H&&C.length===H));L=!0);}catch(J){O=!0,D=J}finally{try{!L&&P.return&&P.return()}finally{if(O)throw D}}return C}return function(G,H){if(Array.isArray(G))return G;if(Symbol.iterator in Object(G))return M(G,H);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function M(G,H){for(var C=0;C<H.length;C++){var L=H[C];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(G,L.key,L)}}return function(G,H,C){return H&&M(G.prototype,H),C&&M(G,C),G}}(),c=a(2),u=j(c),A=a(20),h=j(A),f=a(0),d=j(f),v=a(13),g=j(v),y=a(24),p=j(y),m=a(4),w=j(m),x=a(16),b=j(x),B=a(21),_=j(B),k=a(11),E=j(k),T=a(3),S=j(T);function j(M){return M&&M.__esModule?M:{default:M}}function I(M,G,H){return G in M?Object.defineProperty(M,G,{value:H,enumerable:!0,configurable:!0,writable:!0}):M[G]=H,M}function U(M,G){if(!(M instanceof G))throw new TypeError("Cannot call a class as a function")}var q=/^[ -~]*$/,V=function(){function M(G){U(this,M),this.scroll=G,this.delta=this.getDelta()}return l(M,[{key:"applyDelta",value:function(H){var C=this,L=!1;this.scroll.update();var O=this.scroll.length();return this.scroll.batchStart(),H=W(H),H.reduce(function(D,P){var Q=P.retain||P.delete||P.insert.length||1,J=P.attributes||{};if(P.insert!=null){if(typeof P.insert=="string"){var te=P.insert;te.endsWith(`
`)&&L&&(L=!1,te=te.slice(0,-1)),D>=O&&!te.endsWith(`
`)&&(L=!0),C.scroll.insertAt(D,te);var z=C.scroll.line(D),ye=o(z,2),re=ye[0],ke=ye[1],be=(0,S.default)({},(0,m.bubbleFormats)(re));if(re instanceof w.default){var ae=re.descendant(d.default.Leaf,ke),Ie=o(ae,1),De=Ie[0];be=(0,S.default)(be,(0,m.bubbleFormats)(De))}J=h.default.attributes.diff(be,J)||{}}else if(s(P.insert)==="object"){var pe=Object.keys(P.insert)[0];if(pe==null)return D;C.scroll.insertAt(D,pe,P.insert[pe])}O+=Q}return Object.keys(J).forEach(function(we){C.scroll.formatAt(D,Q,we,J[we])}),D+Q},0),H.reduce(function(D,P){return typeof P.delete=="number"?(C.scroll.deleteAt(D,P.delete),D):D+(P.retain||P.insert.length||1)},0),this.scroll.batchEnd(),this.update(H)}},{key:"deleteText",value:function(H,C){return this.scroll.deleteAt(H,C),this.update(new u.default().retain(H).delete(C))}},{key:"formatLine",value:function(H,C){var L=this,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(O).forEach(function(D){if(!(L.scroll.whitelist!=null&&!L.scroll.whitelist[D])){var P=L.scroll.lines(H,Math.max(C,1)),Q=C;P.forEach(function(J){var te=J.length();if(!(J instanceof g.default))J.format(D,O[D]);else{var z=H-J.offset(L.scroll),ye=J.newlineIndex(z+Q)-z+1;J.formatAt(z,ye,D,O[D])}Q-=te})}}),this.scroll.optimize(),this.update(new u.default().retain(H).retain(C,(0,_.default)(O)))}},{key:"formatText",value:function(H,C){var L=this,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(O).forEach(function(D){L.scroll.formatAt(H,C,D,O[D])}),this.update(new u.default().retain(H).retain(C,(0,_.default)(O)))}},{key:"getContents",value:function(H,C){return this.delta.slice(H,H+C)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(H,C){return H.concat(C.delta())},new u.default)}},{key:"getFormat",value:function(H){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,L=[],O=[];C===0?this.scroll.path(H).forEach(function(P){var Q=o(P,1),J=Q[0];J instanceof w.default?L.push(J):J instanceof d.default.Leaf&&O.push(J)}):(L=this.scroll.lines(H,C),O=this.scroll.descendants(d.default.Leaf,H,C));var D=[L,O].map(function(P){if(P.length===0)return{};for(var Q=(0,m.bubbleFormats)(P.shift());Object.keys(Q).length>0;){var J=P.shift();if(J==null)return Q;Q=X((0,m.bubbleFormats)(J),Q)}return Q});return S.default.apply(S.default,D)}},{key:"getText",value:function(H,C){return this.getContents(H,C).filter(function(L){return typeof L.insert=="string"}).map(function(L){return L.insert}).join("")}},{key:"insertEmbed",value:function(H,C,L){return this.scroll.insertAt(H,C,L),this.update(new u.default().retain(H).insert(I({},C,L)))}},{key:"insertText",value:function(H,C){var L=this,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return C=C.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(H,C),Object.keys(O).forEach(function(D){L.scroll.formatAt(H,C.length,D,O[D])}),this.update(new u.default().retain(H).insert(C,(0,_.default)(O)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var H=this.scroll.children.head;return H.statics.blotName!==w.default.blotName||H.children.length>1?!1:H.children.head instanceof b.default}},{key:"removeFormat",value:function(H,C){var L=this.getText(H,C),O=this.scroll.line(H+C),D=o(O,2),P=D[0],Q=D[1],J=0,te=new u.default;P!=null&&(P instanceof g.default?J=P.newlineIndex(Q)-Q+1:J=P.length()-Q,te=P.delta().slice(Q,Q+J-1).insert(`
`));var z=this.getContents(H,C+J),ye=z.diff(new u.default().insert(L).concat(te)),re=new u.default().retain(H).concat(ye);return this.applyDelta(re)}},{key:"update",value:function(H){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,O=this.delta;if(C.length===1&&C[0].type==="characterData"&&C[0].target.data.match(q)&&d.default.find(C[0].target)){var D=d.default.find(C[0].target),P=(0,m.bubbleFormats)(D),Q=D.offset(this.scroll),J=C[0].oldValue.replace(p.default.CONTENTS,""),te=new u.default().insert(J),z=new u.default().insert(D.value()),ye=new u.default().retain(Q).concat(te.diff(z,L));H=ye.reduce(function(re,ke){return ke.insert?re.insert(ke.insert,P):re.push(ke)},new u.default),this.delta=O.compose(H)}else this.delta=this.getDelta(),(!H||!(0,E.default)(O.compose(H),this.delta))&&(H=O.diff(this.delta,L));return H}}]),M}();function X(M,G){return Object.keys(G).reduce(function(H,C){return M[C]==null||(G[C]===M[C]?H[C]=G[C]:Array.isArray(G[C])?G[C].indexOf(M[C])<0&&(H[C]=G[C].concat([M[C]])):H[C]=[G[C],M[C]]),H},{})}function W(M){return M.reduce(function(G,H){if(H.insert===1){var C=(0,_.default)(H.attributes);return delete C.image,G.insert({image:H.attributes.image},C)}if(H.attributes!=null&&(H.attributes.list===!0||H.attributes.bullet===!0)&&(H=(0,_.default)(H),H.attributes.list?H.attributes.list="ordered":(H.attributes.list="bullet",delete H.attributes.bullet)),typeof H.insert=="string"){var L=H.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return G.insert(L,H.attributes)}return G.push(H)},new u.default)}n.default=V},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=function(){function k(E,T){var S=[],j=!0,I=!1,U=void 0;try{for(var q=E[Symbol.iterator](),V;!(j=(V=q.next()).done)&&(S.push(V.value),!(T&&S.length===T));j=!0);}catch(X){I=!0,U=X}finally{try{!j&&q.return&&q.return()}finally{if(I)throw U}}return S}return function(E,T){if(Array.isArray(E))return E;if(Symbol.iterator in Object(E))return k(E,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(E,T){for(var S=0;S<T.length;S++){var j=T[S];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(E,j.key,j)}}return function(E,T,S){return T&&k(E.prototype,T),S&&k(E,S),E}}(),l=a(0),c=p(l),u=a(21),A=p(u),h=a(11),f=p(h),d=a(8),v=p(d),g=a(10),y=p(g);function p(k){return k&&k.__esModule?k:{default:k}}function m(k){if(Array.isArray(k)){for(var E=0,T=Array(k.length);E<k.length;E++)T[E]=k[E];return T}else return Array.from(k)}function w(k,E){if(!(k instanceof E))throw new TypeError("Cannot call a class as a function")}var x=(0,y.default)("quill:selection"),b=function k(E){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;w(this,k),this.index=E,this.length=T},B=function(){function k(E,T){var S=this;w(this,k),this.emitter=T,this.scroll=E,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=c.default.create("cursor",this),this.lastRange=this.savedRange=new b(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){S.mouseDown||setTimeout(S.update.bind(S,v.default.sources.USER),1)}),this.emitter.on(v.default.events.EDITOR_CHANGE,function(j,I){j===v.default.events.TEXT_CHANGE&&I.length()>0&&S.update(v.default.sources.SILENT)}),this.emitter.on(v.default.events.SCROLL_BEFORE_UPDATE,function(){if(S.hasFocus()){var j=S.getNativeRange();j!=null&&j.start.node!==S.cursor.textNode&&S.emitter.once(v.default.events.SCROLL_UPDATE,function(){try{S.setNativeRange(j.start.node,j.start.offset,j.end.node,j.end.offset)}catch{}})}}),this.emitter.on(v.default.events.SCROLL_OPTIMIZE,function(j,I){if(I.range){var U=I.range,q=U.startNode,V=U.startOffset,X=U.endNode,W=U.endOffset;S.setNativeRange(q,V,X,W)}}),this.update(v.default.sources.SILENT)}return o(k,[{key:"handleComposition",value:function(){var T=this;this.root.addEventListener("compositionstart",function(){T.composing=!0}),this.root.addEventListener("compositionend",function(){if(T.composing=!1,T.cursor.parent){var S=T.cursor.restore();if(!S)return;setTimeout(function(){T.setNativeRange(S.startNode,S.startOffset,S.endNode,S.endOffset)},1)}})}},{key:"handleDragging",value:function(){var T=this;this.emitter.listenDOM("mousedown",document.body,function(){T.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){T.mouseDown=!1,T.update(v.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(T,S){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[T])){this.scroll.update();var j=this.getNativeRange();if(!(j==null||!j.native.collapsed||c.default.query(T,c.default.Scope.BLOCK))){if(j.start.node!==this.cursor.textNode){var I=c.default.find(j.start.node,!1);if(I==null)return;if(I instanceof c.default.Leaf){var U=I.split(j.start.offset);I.parent.insertBefore(this.cursor,U)}else I.insertBefore(this.cursor,j.start.node);this.cursor.attach()}this.cursor.format(T,S),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(T){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,j=this.scroll.length();T=Math.min(T,j-1),S=Math.min(T+S,j-1)-T;var I=void 0,U=this.scroll.leaf(T),q=s(U,2),V=q[0],X=q[1];if(V==null)return null;var W=V.position(X,!0),M=s(W,2);I=M[0],X=M[1];var G=document.createRange();if(S>0){G.setStart(I,X);var H=this.scroll.leaf(T+S),C=s(H,2);if(V=C[0],X=C[1],V==null)return null;var L=V.position(X,!0),O=s(L,2);return I=O[0],X=O[1],G.setEnd(I,X),G.getBoundingClientRect()}else{var D="left",P=void 0;return I instanceof Text?(X<I.data.length?(G.setStart(I,X),G.setEnd(I,X+1)):(G.setStart(I,X-1),G.setEnd(I,X),D="right"),P=G.getBoundingClientRect()):(P=V.domNode.getBoundingClientRect(),X>0&&(D="right")),{bottom:P.top+P.height,height:P.height,left:P[D],right:P[D],top:P.top,width:0}}}},{key:"getNativeRange",value:function(){var T=document.getSelection();if(T==null||T.rangeCount<=0)return null;var S=T.getRangeAt(0);if(S==null)return null;var j=this.normalizeNative(S);return x.info("getNativeRange",j),j}},{key:"getRange",value:function(){var T=this.getNativeRange();if(T==null)return[null,null];var S=this.normalizedToRange(T);return[S,T]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(T){var S=this,j=[[T.start.node,T.start.offset]];T.native.collapsed||j.push([T.end.node,T.end.offset]);var I=j.map(function(V){var X=s(V,2),W=X[0],M=X[1],G=c.default.find(W,!0),H=G.offset(S.scroll);return M===0?H:G instanceof c.default.Container?H+G.length():H+G.index(W,M)}),U=Math.min(Math.max.apply(Math,m(I)),this.scroll.length()-1),q=Math.min.apply(Math,[U].concat(m(I)));return new b(q,U-q)}},{key:"normalizeNative",value:function(T){if(!_(this.root,T.startContainer)||!T.collapsed&&!_(this.root,T.endContainer))return null;var S={start:{node:T.startContainer,offset:T.startOffset},end:{node:T.endContainer,offset:T.endOffset},native:T};return[S.start,S.end].forEach(function(j){for(var I=j.node,U=j.offset;!(I instanceof Text)&&I.childNodes.length>0;)if(I.childNodes.length>U)I=I.childNodes[U],U=0;else if(I.childNodes.length===U)I=I.lastChild,U=I instanceof Text?I.data.length:I.childNodes.length+1;else break;j.node=I,j.offset=U}),S}},{key:"rangeToNative",value:function(T){var S=this,j=T.collapsed?[T.index]:[T.index,T.index+T.length],I=[],U=this.scroll.length();return j.forEach(function(q,V){q=Math.min(U-1,q);var X=void 0,W=S.scroll.leaf(q),M=s(W,2),G=M[0],H=M[1],C=G.position(H,V!==0),L=s(C,2);X=L[0],H=L[1],I.push(X,H)}),I.length<2&&(I=I.concat(I)),I}},{key:"scrollIntoView",value:function(T){var S=this.lastRange;if(S!=null){var j=this.getBounds(S.index,S.length);if(j!=null){var I=this.scroll.length()-1,U=this.scroll.line(Math.min(S.index,I)),q=s(U,1),V=q[0],X=V;if(S.length>0){var W=this.scroll.line(Math.min(S.index+S.length,I)),M=s(W,1);X=M[0]}if(!(V==null||X==null)){var G=T.getBoundingClientRect();j.top<G.top?T.scrollTop-=G.top-j.top:j.bottom>G.bottom&&(T.scrollTop+=j.bottom-G.bottom)}}}}},{key:"setNativeRange",value:function(T,S){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:T,I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:S,U=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(x.info("setNativeRange",T,S,j,I),!(T!=null&&(this.root.parentNode==null||T.parentNode==null||j.parentNode==null))){var q=document.getSelection();if(q!=null)if(T!=null){this.hasFocus()||this.root.focus();var V=(this.getNativeRange()||{}).native;if(V==null||U||T!==V.startContainer||S!==V.startOffset||j!==V.endContainer||I!==V.endOffset){T.tagName=="BR"&&(S=[].indexOf.call(T.parentNode.childNodes,T),T=T.parentNode),j.tagName=="BR"&&(I=[].indexOf.call(j.parentNode.childNodes,j),j=j.parentNode);var X=document.createRange();X.setStart(T,S),X.setEnd(j,I),q.removeAllRanges(),q.addRange(X)}}else q.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(T){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v.default.sources.API;if(typeof S=="string"&&(j=S,S=!1),x.info("setRange",T),T!=null){var I=this.rangeToNative(T);this.setNativeRange.apply(this,m(I).concat([S]))}else this.setNativeRange(null);this.update(j)}},{key:"update",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v.default.sources.USER,S=this.lastRange,j=this.getRange(),I=s(j,2),U=I[0],q=I[1];if(this.lastRange=U,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,f.default)(S,this.lastRange)){var V;!this.composing&&q!=null&&q.native.collapsed&&q.start.node!==this.cursor.textNode&&this.cursor.restore();var X=[v.default.events.SELECTION_CHANGE,(0,A.default)(this.lastRange),(0,A.default)(S),T];if((V=this.emitter).emit.apply(V,[v.default.events.EDITOR_CHANGE].concat(X)),T!==v.default.sources.SILENT){var W;(W=this.emitter).emit.apply(W,X)}}}}]),k}();function _(k,E){try{E.parentNode}catch{return!1}return E instanceof Text&&(E=E.parentNode),k.contains(E)}n.Range=b,n.default=B},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(g,y){for(var p=0;p<y.length;p++){var m=y[p];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(g,m.key,m)}}return function(g,y,p){return y&&v(g.prototype,y),p&&v(g,p),g}}(),o=function v(g,y,p){g===null&&(g=Function.prototype);var m=Object.getOwnPropertyDescriptor(g,y);if(m===void 0){var w=Object.getPrototypeOf(g);return w===null?void 0:v(w,y,p)}else{if("value"in m)return m.value;var x=m.get;return x===void 0?void 0:x.call(p)}},l=a(0),c=u(l);function u(v){return v&&v.__esModule?v:{default:v}}function A(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")}function h(v,g){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:v}function f(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);v.prototype=Object.create(g&&g.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(v,g):v.__proto__=g)}var d=function(v){f(g,v);function g(){return A(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"insertInto",value:function(p,m){p.children.length===0?o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"insertInto",this).call(this,p,m):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),g}(c.default.Embed);d.blotName="break",d.tagName="BR",n.default=d},function(r,n,a){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var v in d)d.hasOwnProperty(v)&&(f[v]=d[v])};return function(f,d){h(f,d);function v(){this.constructor=f}f.prototype=d===null?Object.create(d):(v.prototype=d.prototype,new v)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(44),l=a(30),c=a(1),u=function(h){s(f,h);function f(d){var v=h.call(this,d)||this;return v.build(),v}return f.prototype.appendChild=function(d){this.insertBefore(d)},f.prototype.attach=function(){h.prototype.attach.call(this),this.children.forEach(function(d){d.attach()})},f.prototype.build=function(){var d=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(v){try{var g=A(v);d.insertBefore(g,d.children.head||void 0)}catch(y){if(y instanceof c.ParchmentError)return;throw y}})},f.prototype.deleteAt=function(d,v){if(d===0&&v===this.length())return this.remove();this.children.forEachAt(d,v,function(g,y,p){g.deleteAt(y,p)})},f.prototype.descendant=function(d,v){var g=this.children.find(v),y=g[0],p=g[1];return d.blotName==null&&d(y)||d.blotName!=null&&y instanceof d?[y,p]:y instanceof f?y.descendant(d,p):[null,-1]},f.prototype.descendants=function(d,v,g){v===void 0&&(v=0),g===void 0&&(g=Number.MAX_VALUE);var y=[],p=g;return this.children.forEachAt(v,g,function(m,w,x){(d.blotName==null&&d(m)||d.blotName!=null&&m instanceof d)&&y.push(m),m instanceof f&&(y=y.concat(m.descendants(d,w,p))),p-=x}),y},f.prototype.detach=function(){this.children.forEach(function(d){d.detach()}),h.prototype.detach.call(this)},f.prototype.formatAt=function(d,v,g,y){this.children.forEachAt(d,v,function(p,m,w){p.formatAt(m,w,g,y)})},f.prototype.insertAt=function(d,v,g){var y=this.children.find(d),p=y[0],m=y[1];if(p)p.insertAt(m,v,g);else{var w=g==null?c.create("text",v):c.create(v,g);this.appendChild(w)}},f.prototype.insertBefore=function(d,v){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(g){return d instanceof g}))throw new c.ParchmentError("Cannot insert "+d.statics.blotName+" into "+this.statics.blotName);d.insertInto(this,v)},f.prototype.length=function(){return this.children.reduce(function(d,v){return d+v.length()},0)},f.prototype.moveChildren=function(d,v){this.children.forEach(function(g){d.insertBefore(g,v)})},f.prototype.optimize=function(d){if(h.prototype.optimize.call(this,d),this.children.length===0)if(this.statics.defaultChild!=null){var v=c.create(this.statics.defaultChild);this.appendChild(v),v.optimize(d)}else this.remove()},f.prototype.path=function(d,v){v===void 0&&(v=!1);var g=this.children.find(d,v),y=g[0],p=g[1],m=[[this,d]];return y instanceof f?m.concat(y.path(p,v)):(y!=null&&m.push([y,p]),m)},f.prototype.removeChild=function(d){this.children.remove(d)},f.prototype.replace=function(d){d instanceof f&&d.moveChildren(this),h.prototype.replace.call(this,d)},f.prototype.split=function(d,v){if(v===void 0&&(v=!1),!v){if(d===0)return this;if(d===this.length())return this.next}var g=this.clone();return this.parent.insertBefore(g,this.next),this.children.forEachAt(d,this.length(),function(y,p,m){y=y.split(p,v),g.appendChild(y)}),g},f.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},f.prototype.update=function(d,v){var g=this,y=[],p=[];d.forEach(function(m){m.target===g.domNode&&m.type==="childList"&&(y.push.apply(y,m.addedNodes),p.push.apply(p,m.removedNodes))}),p.forEach(function(m){if(!(m.parentNode!=null&&m.tagName!=="IFRAME"&&document.body.compareDocumentPosition(m)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var w=c.find(m);w!=null&&(w.domNode.parentNode==null||w.domNode.parentNode===g.domNode)&&w.detach()}}),y.filter(function(m){return m.parentNode==g.domNode}).sort(function(m,w){return m===w?0:m.compareDocumentPosition(w)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(m){var w=null;m.nextSibling!=null&&(w=c.find(m.nextSibling));var x=A(m);(x.next!=w||x.next==null)&&(x.parent!=null&&x.parent.removeChild(g),g.insertBefore(x,w||void 0))})},f}(l.default);function A(h){var f=c.find(h);if(f==null)try{f=c.create(h)}catch{f=c.create(c.Scope.INLINE),[].slice.call(h.childNodes).forEach(function(v){f.domNode.appendChild(v)}),h.parentNode&&h.parentNode.replaceChild(f.domNode,h),f.attach()}return f}n.default=u},function(r,n,a){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var v in d)d.hasOwnProperty(v)&&(f[v]=d[v])};return function(f,d){h(f,d);function v(){this.constructor=f}f.prototype=d===null?Object.create(d):(v.prototype=d.prototype,new v)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(12),l=a(31),c=a(17),u=a(1),A=function(h){s(f,h);function f(d){var v=h.call(this,d)||this;return v.attributes=new l.default(v.domNode),v}return f.formats=function(d){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return d.tagName.toLowerCase()},f.prototype.format=function(d,v){var g=u.query(d);g instanceof o.default?this.attributes.attribute(g,v):v&&g!=null&&(d!==this.statics.blotName||this.formats()[d]!==v)&&this.replaceWith(d,v)},f.prototype.formats=function(){var d=this.attributes.values(),v=this.statics.formats(this.domNode);return v!=null&&(d[this.statics.blotName]=v),d},f.prototype.replaceWith=function(d,v){var g=h.prototype.replaceWith.call(this,d,v);return this.attributes.copy(g),g},f.prototype.update=function(d,v){var g=this;h.prototype.update.call(this,d,v),d.some(function(y){return y.target===g.domNode&&y.type==="attributes"})&&this.attributes.build()},f.prototype.wrap=function(d,v){var g=h.prototype.wrap.call(this,d,v);return g instanceof f&&g.statics.scope===this.statics.scope&&this.attributes.move(g),g},f}(c.default);n.default=A},function(r,n,a){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,h){A.__proto__=h}||function(A,h){for(var f in h)h.hasOwnProperty(f)&&(A[f]=h[f])};return function(A,h){u(A,h);function f(){this.constructor=A}A.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(30),l=a(1),c=function(u){s(A,u);function A(){return u!==null&&u.apply(this,arguments)||this}return A.value=function(h){return!0},A.prototype.index=function(h,f){return this.domNode===h||this.domNode.compareDocumentPosition(h)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(f,1):-1},A.prototype.position=function(h,f){var d=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return h>0&&(d+=1),[this.parent.domNode,d]},A.prototype.value=function(){var h;return h={},h[this.statics.blotName]=this.statics.value(this.domNode)||!0,h},A.scope=l.Scope.INLINE_BLOT,A}(o.default);n.default=c},function(r,n,a){var s=a(11),o=a(3),l={attributes:{compose:function(u,A,h){typeof u!="object"&&(u={}),typeof A!="object"&&(A={});var f=o(!0,{},A);h||(f=Object.keys(f).reduce(function(v,g){return f[g]!=null&&(v[g]=f[g]),v},{}));for(var d in u)u[d]!==void 0&&A[d]===void 0&&(f[d]=u[d]);return Object.keys(f).length>0?f:void 0},diff:function(u,A){typeof u!="object"&&(u={}),typeof A!="object"&&(A={});var h=Object.keys(u).concat(Object.keys(A)).reduce(function(f,d){return s(u[d],A[d])||(f[d]=A[d]===void 0?null:A[d]),f},{});return Object.keys(h).length>0?h:void 0},transform:function(u,A,h){if(typeof u!="object")return A;if(typeof A=="object"){if(!h)return A;var f=Object.keys(A).reduce(function(d,v){return u[v]===void 0&&(d[v]=A[v]),d},{});return Object.keys(f).length>0?f:void 0}}},iterator:function(u){return new c(u)},length:function(u){return typeof u.delete=="number"?u.delete:typeof u.retain=="number"?u.retain:typeof u.insert=="string"?u.insert.length:1}};function c(u){this.ops=u,this.index=0,this.offset=0}c.prototype.hasNext=function(){return this.peekLength()<1/0},c.prototype.next=function(u){u||(u=1/0);var A=this.ops[this.index];if(A){var h=this.offset,f=l.length(A);if(u>=f-h?(u=f-h,this.index+=1,this.offset=0):this.offset+=u,typeof A.delete=="number")return{delete:u};var d={};return A.attributes&&(d.attributes=A.attributes),typeof A.retain=="number"?d.retain=u:typeof A.insert=="string"?d.insert=A.insert.substr(h,u):d.insert=A.insert,d}else return{retain:1/0}},c.prototype.peek=function(){return this.ops[this.index]},c.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},c.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},c.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var u=this.offset,A=this.index,h=this.next(),f=this.ops.slice(this.index);return this.offset=u,this.index=A,[h].concat(f)}else return[]},r.exports=l},function(r,n){var a=function(){function s(g,y){return y!=null&&g instanceof y}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var c;try{c=Promise}catch{c=function(){}}function u(g,y,p,m,w){typeof y=="object"&&(p=y.depth,m=y.prototype,w=y.includeNonEnumerable,y=y.circular);var x=[],b=[],B=typeof Buffer<"u";typeof y>"u"&&(y=!0),typeof p>"u"&&(p=1/0);function _(k,E){if(k===null)return null;if(E===0)return k;var T,S;if(typeof k!="object")return k;if(s(k,o))T=new o;else if(s(k,l))T=new l;else if(s(k,c))T=new c(function(G,H){k.then(function(C){G(_(C,E-1))},function(C){H(_(C,E-1))})});else if(u.__isArray(k))T=[];else if(u.__isRegExp(k))T=new RegExp(k.source,v(k)),k.lastIndex&&(T.lastIndex=k.lastIndex);else if(u.__isDate(k))T=new Date(k.getTime());else{if(B&&Buffer.isBuffer(k))return Buffer.allocUnsafe?T=Buffer.allocUnsafe(k.length):T=new Buffer(k.length),k.copy(T),T;s(k,Error)?T=Object.create(k):typeof m>"u"?(S=Object.getPrototypeOf(k),T=Object.create(S)):(T=Object.create(m),S=m)}if(y){var j=x.indexOf(k);if(j!=-1)return b[j];x.push(k),b.push(T)}s(k,o)&&k.forEach(function(G,H){var C=_(H,E-1),L=_(G,E-1);T.set(C,L)}),s(k,l)&&k.forEach(function(G){var H=_(G,E-1);T.add(H)});for(var I in k){var U;S&&(U=Object.getOwnPropertyDescriptor(S,I)),!(U&&U.set==null)&&(T[I]=_(k[I],E-1))}if(Object.getOwnPropertySymbols)for(var q=Object.getOwnPropertySymbols(k),I=0;I<q.length;I++){var V=q[I],X=Object.getOwnPropertyDescriptor(k,V);X&&!X.enumerable&&!w||(T[V]=_(k[V],E-1),X.enumerable||Object.defineProperty(T,V,{enumerable:!1}))}if(w)for(var W=Object.getOwnPropertyNames(k),I=0;I<W.length;I++){var M=W[I],X=Object.getOwnPropertyDescriptor(k,M);X&&X.enumerable||(T[M]=_(k[M],E-1),Object.defineProperty(T,M,{enumerable:!1}))}return T}return _(g,p)}u.clonePrototype=function(y){if(y===null)return null;var p=function(){};return p.prototype=y,new p};function A(g){return Object.prototype.toString.call(g)}u.__objToStr=A;function h(g){return typeof g=="object"&&A(g)==="[object Date]"}u.__isDate=h;function f(g){return typeof g=="object"&&A(g)==="[object Array]"}u.__isArray=f;function d(g){return typeof g=="object"&&A(g)==="[object RegExp]"}u.__isRegExp=d;function v(g){var y="";return g.global&&(y+="g"),g.ignoreCase&&(y+="i"),g.multiline&&(y+="m"),y}return u.__getRegExpFlags=v,u}();typeof r=="object"&&r.exports&&(r.exports=a)},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function T(S,j){var I=[],U=!0,q=!1,V=void 0;try{for(var X=S[Symbol.iterator](),W;!(U=(W=X.next()).done)&&(I.push(W.value),!(j&&I.length===j));U=!0);}catch(M){q=!0,V=M}finally{try{!U&&X.return&&X.return()}finally{if(q)throw V}}return I}return function(S,j){if(Array.isArray(S))return S;if(Symbol.iterator in Object(S))return T(S,j);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function T(S,j){for(var I=0;I<j.length;I++){var U=j[I];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(S,U.key,U)}}return function(S,j,I){return j&&T(S.prototype,j),I&&T(S,I),S}}(),l=function T(S,j,I){S===null&&(S=Function.prototype);var U=Object.getOwnPropertyDescriptor(S,j);if(U===void 0){var q=Object.getPrototypeOf(S);return q===null?void 0:T(q,j,I)}else{if("value"in U)return U.value;var V=U.get;return V===void 0?void 0:V.call(I)}},c=a(0),u=x(c),A=a(8),h=x(A),f=a(4),d=x(f),v=a(16),g=x(v),y=a(13),p=x(y),m=a(25),w=x(m);function x(T){return T&&T.__esModule?T:{default:T}}function b(T,S){if(!(T instanceof S))throw new TypeError("Cannot call a class as a function")}function B(T,S){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:T}function _(T,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);T.prototype=Object.create(S&&S.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(T,S):T.__proto__=S)}function k(T){return T instanceof d.default||T instanceof f.BlockEmbed}var E=function(T){_(S,T);function S(j,I){b(this,S);var U=B(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,j));return U.emitter=I.emitter,Array.isArray(I.whitelist)&&(U.whitelist=I.whitelist.reduce(function(q,V){return q[V]=!0,q},{})),U.domNode.addEventListener("DOMNodeInserted",function(){}),U.optimize(),U.enable(),U}return o(S,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(I,U){var q=this.line(I),V=s(q,2),X=V[0],W=V[1],M=this.line(I+U),G=s(M,1),H=G[0];if(l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"deleteAt",this).call(this,I,U),H!=null&&X!==H&&W>0){if(X instanceof f.BlockEmbed||H instanceof f.BlockEmbed){this.optimize();return}if(X instanceof p.default){var C=X.newlineIndex(X.length(),!0);if(C>-1&&(X=X.split(C+1),X===H)){this.optimize();return}}else if(H instanceof p.default){var L=H.newlineIndex(0);L>-1&&H.split(L+1)}var O=H.children.head instanceof g.default?null:H.children.head;X.moveChildren(H,O),X.remove()}this.optimize()}},{key:"enable",value:function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",I)}},{key:"formatAt",value:function(I,U,q,V){this.whitelist!=null&&!this.whitelist[q]||(l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"formatAt",this).call(this,I,U,q,V),this.optimize())}},{key:"insertAt",value:function(I,U,q){if(!(q!=null&&this.whitelist!=null&&!this.whitelist[U])){if(I>=this.length())if(q==null||u.default.query(U,u.default.Scope.BLOCK)==null){var V=u.default.create(this.statics.defaultChild);this.appendChild(V),q==null&&U.endsWith(`
`)&&(U=U.slice(0,-1)),V.insertAt(0,U,q)}else{var X=u.default.create(U,q);this.appendChild(X)}else l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertAt",this).call(this,I,U,q);this.optimize()}}},{key:"insertBefore",value:function(I,U){if(I.statics.scope===u.default.Scope.INLINE_BLOT){var q=u.default.create(this.statics.defaultChild);q.appendChild(I),I=q}l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertBefore",this).call(this,I,U)}},{key:"leaf",value:function(I){return this.path(I).pop()||[null,-1]}},{key:"line",value:function(I){return I===this.length()?this.line(I-1):this.descendant(k,I)}},{key:"lines",value:function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,q=function V(X,W,M){var G=[],H=M;return X.children.forEachAt(W,M,function(C,L,O){k(C)?G.push(C):C instanceof u.default.Container&&(G=G.concat(V(C,L,H))),H-=O}),G};return q(this,I,U)}},{key:"optimize",value:function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"optimize",this).call(this,I,U),I.length>0&&this.emitter.emit(h.default.events.SCROLL_OPTIMIZE,I,U))}},{key:"path",value:function(I){return l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"path",this).call(this,I).slice(1)}},{key:"update",value:function(I){if(this.batch!==!0){var U=h.default.sources.USER;typeof I=="string"&&(U=I),Array.isArray(I)||(I=this.observer.takeRecords()),I.length>0&&this.emitter.emit(h.default.events.SCROLL_BEFORE_UPDATE,U,I),l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"update",this).call(this,I.concat([])),I.length>0&&this.emitter.emit(h.default.events.SCROLL_UPDATE,U,I)}}}]),S}(u.default.Scroll);E.blotName="scroll",E.className="ql-editor",E.tagName="DIV",E.defaultChild="block",E.allowedChildren=[d.default,f.BlockEmbed,w.default],n.default=E},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},o=function(){function P(Q,J){var te=[],z=!0,ye=!1,re=void 0;try{for(var ke=Q[Symbol.iterator](),be;!(z=(be=ke.next()).done)&&(te.push(be.value),!(J&&te.length===J));z=!0);}catch(ae){ye=!0,re=ae}finally{try{!z&&ke.return&&ke.return()}finally{if(ye)throw re}}return te}return function(Q,J){if(Array.isArray(Q))return Q;if(Symbol.iterator in Object(Q))return P(Q,J);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function P(Q,J){for(var te=0;te<J.length;te++){var z=J[te];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(Q,z.key,z)}}return function(Q,J,te){return J&&P(Q.prototype,J),te&&P(Q,te),Q}}(),c=a(21),u=T(c),A=a(11),h=T(A),f=a(3),d=T(f),v=a(2),g=T(v),y=a(20),p=T(y),m=a(0),w=T(m),x=a(5),b=T(x),B=a(10),_=T(B),k=a(9),E=T(k);function T(P){return P&&P.__esModule?P:{default:P}}function S(P,Q,J){return Q in P?Object.defineProperty(P,Q,{value:J,enumerable:!0,configurable:!0,writable:!0}):P[Q]=J,P}function j(P,Q){if(!(P instanceof Q))throw new TypeError("Cannot call a class as a function")}function I(P,Q){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Q&&(typeof Q=="object"||typeof Q=="function")?Q:P}function U(P,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Q);P.prototype=Object.create(Q&&Q.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),Q&&(Object.setPrototypeOf?Object.setPrototypeOf(P,Q):P.__proto__=Q)}var q=(0,_.default)("quill:keyboard"),V=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",X=function(P){U(Q,P),l(Q,null,[{key:"match",value:function(te,z){return z=D(z),["altKey","ctrlKey","metaKey","shiftKey"].some(function(ye){return!!z[ye]!==te[ye]&&z[ye]!==null})?!1:z.key===(te.which||te.keyCode)}}]);function Q(J,te){j(this,Q);var z=I(this,(Q.__proto__||Object.getPrototypeOf(Q)).call(this,J,te));return z.bindings={},Object.keys(z.options.bindings).forEach(function(ye){ye==="list autofill"&&J.scroll.whitelist!=null&&!J.scroll.whitelist.list||z.options.bindings[ye]&&z.addBinding(z.options.bindings[ye])}),z.addBinding({key:Q.keys.ENTER,shiftKey:null},C),z.addBinding({key:Q.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(z.addBinding({key:Q.keys.BACKSPACE},{collapsed:!0},M),z.addBinding({key:Q.keys.DELETE},{collapsed:!0},G)):(z.addBinding({key:Q.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},M),z.addBinding({key:Q.keys.DELETE},{collapsed:!0,suffix:/^.?$/},G)),z.addBinding({key:Q.keys.BACKSPACE},{collapsed:!1},H),z.addBinding({key:Q.keys.DELETE},{collapsed:!1},H),z.addBinding({key:Q.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},M),z.listen(),z}return l(Q,[{key:"addBinding",value:function(te){var z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},re=D(te);if(re==null||re.key==null)return q.warn("Attempted to add invalid keyboard binding",re);typeof z=="function"&&(z={handler:z}),typeof ye=="function"&&(ye={handler:ye}),re=(0,d.default)(re,z,ye),this.bindings[re.key]=this.bindings[re.key]||[],this.bindings[re.key].push(re)}},{key:"listen",value:function(){var te=this;this.quill.root.addEventListener("keydown",function(z){if(!z.defaultPrevented){var ye=z.which||z.keyCode,re=(te.bindings[ye]||[]).filter(function(Qe){return Q.match(z,Qe)});if(re.length!==0){var ke=te.quill.getSelection();if(!(ke==null||!te.quill.hasFocus())){var be=te.quill.getLine(ke.index),ae=o(be,2),Ie=ae[0],De=ae[1],pe=te.quill.getLeaf(ke.index),we=o(pe,2),Te=we[0],he=we[1],ce=ke.length===0?[Te,he]:te.quill.getLeaf(ke.index+ke.length),Se=o(ce,2),Pe=Se[0],Le=Se[1],Xe=Te instanceof w.default.Text?Te.value().slice(0,he):"",fe=Pe instanceof w.default.Text?Pe.value().slice(Le):"",Ee={collapsed:ke.length===0,empty:ke.length===0&&Ie.length()<=1,format:te.quill.getFormat(ke),offset:De,prefix:Xe,suffix:fe},qe=re.some(function(Qe){if(Qe.collapsed!=null&&Qe.collapsed!==Ee.collapsed||Qe.empty!=null&&Qe.empty!==Ee.empty||Qe.offset!=null&&Qe.offset!==Ee.offset)return!1;if(Array.isArray(Qe.format)){if(Qe.format.every(function(Ye){return Ee.format[Ye]==null}))return!1}else if(s(Qe.format)==="object"&&!Object.keys(Qe.format).every(function(Ye){return Qe.format[Ye]===!0?Ee.format[Ye]!=null:Qe.format[Ye]===!1?Ee.format[Ye]==null:(0,h.default)(Qe.format[Ye],Ee.format[Ye])}))return!1;return Qe.prefix!=null&&!Qe.prefix.test(Ee.prefix)||Qe.suffix!=null&&!Qe.suffix.test(Ee.suffix)?!1:Qe.handler.call(te,ke,Ee)!==!0});qe&&z.preventDefault()}}}})}}]),Q}(E.default);X.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},X.DEFAULTS={bindings:{bold:O("bold"),italic:O("italic"),underline:O("underline"),indent:{key:X.keys.TAB,format:["blockquote","indent","list"],handler:function(Q,J){if(J.collapsed&&J.offset!==0)return!0;this.quill.format("indent","+1",b.default.sources.USER)}},outdent:{key:X.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(Q,J){if(J.collapsed&&J.offset!==0)return!0;this.quill.format("indent","-1",b.default.sources.USER)}},"outdent backspace":{key:X.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(Q,J){J.format.indent!=null?this.quill.format("indent","-1",b.default.sources.USER):J.format.list!=null&&this.quill.format("list",!1,b.default.sources.USER)}},"indent code-block":L(!0),"outdent code-block":L(!1),"remove tab":{key:X.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(Q){this.quill.deleteText(Q.index-1,1,b.default.sources.USER)}},tab:{key:X.keys.TAB,handler:function(Q){this.quill.history.cutoff();var J=new g.default().retain(Q.index).delete(Q.length).insert("	");this.quill.updateContents(J,b.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Q.index+1,b.default.sources.SILENT)}},"list empty enter":{key:X.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(Q,J){this.quill.format("list",!1,b.default.sources.USER),J.format.indent&&this.quill.format("indent",!1,b.default.sources.USER)}},"checklist enter":{key:X.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(Q){var J=this.quill.getLine(Q.index),te=o(J,2),z=te[0],ye=te[1],re=(0,d.default)({},z.formats(),{list:"checked"}),ke=new g.default().retain(Q.index).insert(`
`,re).retain(z.length()-ye-1).retain(1,{list:"unchecked"});this.quill.updateContents(ke,b.default.sources.USER),this.quill.setSelection(Q.index+1,b.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:X.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(Q,J){var te=this.quill.getLine(Q.index),z=o(te,2),ye=z[0],re=z[1],ke=new g.default().retain(Q.index).insert(`
`,J.format).retain(ye.length()-re-1).retain(1,{header:null});this.quill.updateContents(ke,b.default.sources.USER),this.quill.setSelection(Q.index+1,b.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(Q,J){var te=J.prefix.length,z=this.quill.getLine(Q.index),ye=o(z,2),re=ye[0],ke=ye[1];if(ke>te)return!0;var be=void 0;switch(J.prefix.trim()){case"[]":case"[ ]":be="unchecked";break;case"[x]":be="checked";break;case"-":case"*":be="bullet";break;default:be="ordered"}this.quill.insertText(Q.index," ",b.default.sources.USER),this.quill.history.cutoff();var ae=new g.default().retain(Q.index-ke).delete(te+1).retain(re.length()-2-ke).retain(1,{list:be});this.quill.updateContents(ae,b.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Q.index-te,b.default.sources.SILENT)}},"code exit":{key:X.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(Q){var J=this.quill.getLine(Q.index),te=o(J,2),z=te[0],ye=te[1],re=new g.default().retain(Q.index+z.length()-ye-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(re,b.default.sources.USER)}},"embed left":W(X.keys.LEFT,!1),"embed left shift":W(X.keys.LEFT,!0),"embed right":W(X.keys.RIGHT,!1),"embed right shift":W(X.keys.RIGHT,!0)}};function W(P,Q){var J,te=P===X.keys.LEFT?"prefix":"suffix";return J={key:P,shiftKey:Q,altKey:null},S(J,te,/^$/),S(J,"handler",function(ye){var re=ye.index;P===X.keys.RIGHT&&(re+=ye.length+1);var ke=this.quill.getLeaf(re),be=o(ke,1),ae=be[0];return ae instanceof w.default.Embed?(P===X.keys.LEFT?Q?this.quill.setSelection(ye.index-1,ye.length+1,b.default.sources.USER):this.quill.setSelection(ye.index-1,b.default.sources.USER):Q?this.quill.setSelection(ye.index,ye.length+1,b.default.sources.USER):this.quill.setSelection(ye.index+ye.length+1,b.default.sources.USER),!1):!0}),J}function M(P,Q){if(!(P.index===0||this.quill.getLength()<=1)){var J=this.quill.getLine(P.index),te=o(J,1),z=te[0],ye={};if(Q.offset===0){var re=this.quill.getLine(P.index-1),ke=o(re,1),be=ke[0];if(be!=null&&be.length()>1){var ae=z.formats(),Ie=this.quill.getFormat(P.index-1,1);ye=p.default.attributes.diff(ae,Ie)||{}}}var De=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(Q.prefix)?2:1;this.quill.deleteText(P.index-De,De,b.default.sources.USER),Object.keys(ye).length>0&&this.quill.formatLine(P.index-De,De,ye,b.default.sources.USER),this.quill.focus()}}function G(P,Q){var J=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(Q.suffix)?2:1;if(!(P.index>=this.quill.getLength()-J)){var te={},z=0,ye=this.quill.getLine(P.index),re=o(ye,1),ke=re[0];if(Q.offset>=ke.length()-1){var be=this.quill.getLine(P.index+1),ae=o(be,1),Ie=ae[0];if(Ie){var De=ke.formats(),pe=this.quill.getFormat(P.index,1);te=p.default.attributes.diff(De,pe)||{},z=Ie.length()}}this.quill.deleteText(P.index,J,b.default.sources.USER),Object.keys(te).length>0&&this.quill.formatLine(P.index+z-1,J,te,b.default.sources.USER)}}function H(P){var Q=this.quill.getLines(P),J={};if(Q.length>1){var te=Q[0].formats(),z=Q[Q.length-1].formats();J=p.default.attributes.diff(z,te)||{}}this.quill.deleteText(P,b.default.sources.USER),Object.keys(J).length>0&&this.quill.formatLine(P.index,1,J,b.default.sources.USER),this.quill.setSelection(P.index,b.default.sources.SILENT),this.quill.focus()}function C(P,Q){var J=this;P.length>0&&this.quill.scroll.deleteAt(P.index,P.length);var te=Object.keys(Q.format).reduce(function(z,ye){return w.default.query(ye,w.default.Scope.BLOCK)&&!Array.isArray(Q.format[ye])&&(z[ye]=Q.format[ye]),z},{});this.quill.insertText(P.index,`
`,te,b.default.sources.USER),this.quill.setSelection(P.index+1,b.default.sources.SILENT),this.quill.focus(),Object.keys(Q.format).forEach(function(z){te[z]==null&&(Array.isArray(Q.format[z])||z!=="link"&&J.quill.format(z,Q.format[z],b.default.sources.USER))})}function L(P){return{key:X.keys.TAB,shiftKey:!P,format:{"code-block":!0},handler:function(J){var te=w.default.query("code-block"),z=J.index,ye=J.length,re=this.quill.scroll.descendant(te,z),ke=o(re,2),be=ke[0],ae=ke[1];if(be!=null){var Ie=this.quill.getIndex(be),De=be.newlineIndex(ae,!0)+1,pe=be.newlineIndex(Ie+ae+ye),we=be.domNode.textContent.slice(De,pe).split(`
`);ae=0,we.forEach(function(Te,he){P?(be.insertAt(De+ae,te.TAB),ae+=te.TAB.length,he===0?z+=te.TAB.length:ye+=te.TAB.length):Te.startsWith(te.TAB)&&(be.deleteAt(De+ae,te.TAB.length),ae-=te.TAB.length,he===0?z-=te.TAB.length:ye-=te.TAB.length),ae+=Te.length+1}),this.quill.update(b.default.sources.USER),this.quill.setSelection(z,ye,b.default.sources.SILENT)}}}}function O(P){return{key:P[0].toUpperCase(),shortKey:!0,handler:function(J,te){this.quill.format(P,!te.format[P],b.default.sources.USER)}}}function D(P){if(typeof P=="string"||typeof P=="number")return D({key:P});if((typeof P>"u"?"undefined":s(P))==="object"&&(P=(0,u.default)(P,!1)),typeof P.key=="string")if(X.keys[P.key.toUpperCase()]!=null)P.key=X.keys[P.key.toUpperCase()];else if(P.key.length===1)P.key=P.key.toUpperCase().charCodeAt(0);else return null;return P.shortKey&&(P[V]=P.shortKey,delete P.shortKey),P}n.default=X,n.SHORTKEY=V},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function p(m,w){var x=[],b=!0,B=!1,_=void 0;try{for(var k=m[Symbol.iterator](),E;!(b=(E=k.next()).done)&&(x.push(E.value),!(w&&x.length===w));b=!0);}catch(T){B=!0,_=T}finally{try{!b&&k.return&&k.return()}finally{if(B)throw _}}return x}return function(m,w){if(Array.isArray(m))return m;if(Symbol.iterator in Object(m))return p(m,w);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function p(m,w,x){m===null&&(m=Function.prototype);var b=Object.getOwnPropertyDescriptor(m,w);if(b===void 0){var B=Object.getPrototypeOf(m);return B===null?void 0:p(B,w,x)}else{if("value"in b)return b.value;var _=b.get;return _===void 0?void 0:_.call(x)}},l=function(){function p(m,w){for(var x=0;x<w.length;x++){var b=w[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(m,b.key,b)}}return function(m,w,x){return w&&p(m.prototype,w),x&&p(m,x),m}}(),c=a(0),u=f(c),A=a(7),h=f(A);function f(p){return p&&p.__esModule?p:{default:p}}function d(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function v(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function g(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var y=function(p){g(m,p),l(m,null,[{key:"value",value:function(){}}]);function m(w,x){d(this,m);var b=v(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,w));return b.selection=x,b.textNode=document.createTextNode(m.CONTENTS),b.domNode.appendChild(b.textNode),b._length=0,b}return l(m,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(x,b){if(this._length!==0)return o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,x,b);for(var B=this,_=0;B!=null&&B.statics.scope!==u.default.Scope.BLOCK_BLOT;)_+=B.offset(B.parent),B=B.parent;B!=null&&(this._length=m.CONTENTS.length,B.optimize(),B.formatAt(_,m.CONTENTS.length,x,b),this._length=0)}},{key:"index",value:function(x,b){return x===this.textNode?0:o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"index",this).call(this,x,b)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var x=this.textNode,b=this.selection.getNativeRange(),B=void 0,_=void 0,k=void 0;if(b!=null&&b.start.node===x&&b.end.node===x){var E=[x,b.start.offset,b.end.offset];B=E[0],_=E[1],k=E[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==m.CONTENTS){var T=this.textNode.data.split(m.CONTENTS).join("");this.next instanceof h.default?(B=this.next.domNode,this.next.insertAt(0,T),this.textNode.data=m.CONTENTS):(this.textNode.data=T,this.parent.insertBefore(u.default.create(this.textNode),this),this.textNode=document.createTextNode(m.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),_!=null){var S=[_,k].map(function(I){return Math.max(0,Math.min(B.data.length,I-1))}),j=s(S,2);return _=j[0],k=j[1],{startNode:B,startOffset:_,endNode:B,endOffset:k}}}}},{key:"update",value:function(x,b){var B=this;if(x.some(function(k){return k.type==="characterData"&&k.target===B.textNode})){var _=this.restore();_&&(b.range=_)}}},{key:"value",value:function(){return""}}]),m}(u.default.Embed);y.blotName="cursor",y.className="ql-cursor",y.tagName="span",y.CONTENTS="\uFEFF",n.default=y},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(0),o=u(s),l=a(4),c=u(l);function u(v){return v&&v.__esModule?v:{default:v}}function A(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")}function h(v,g){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:v}function f(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);v.prototype=Object.create(g&&g.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(v,g):v.__proto__=g)}var d=function(v){f(g,v);function g(){return A(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g}(o.default.Container);d.allowedChildren=[c.default,l.BlockEmbed,d],n.default=d},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var s=function(){function y(p,m){for(var w=0;w<m.length;w++){var x=m[w];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,m,w){return m&&y(p.prototype,m),w&&y(p,w),p}}(),o=function y(p,m,w){p===null&&(p=Function.prototype);var x=Object.getOwnPropertyDescriptor(p,m);if(x===void 0){var b=Object.getPrototypeOf(p);return b===null?void 0:y(b,m,w)}else{if("value"in x)return x.value;var B=x.get;return B===void 0?void 0:B.call(w)}},l=a(0),c=u(l);function u(y){return y&&y.__esModule?y:{default:y}}function A(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}function h(y,p){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:y}function f(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}var d=function(y){f(p,y);function p(){return A(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return s(p,[{key:"value",value:function(w){var x=o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"value",this).call(this,w);return x.startsWith("rgb(")?(x=x.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+x.split(",").map(function(b){return("00"+parseInt(b).toString(16)).slice(-2)}).join("")):x}}]),p}(c.default.Attributor.Style),v=new c.default.Attributor.Class("color","ql-color",{scope:c.default.Scope.INLINE}),g=new d("color","color",{scope:c.default.Scope.INLINE});n.ColorAttributor=d,n.ColorClass=v,n.ColorStyle=g},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var s=function(){function g(y,p){for(var m=0;m<p.length;m++){var w=p[m];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,p,m){return p&&g(y.prototype,p),m&&g(y,m),y}}(),o=function g(y,p,m){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,p);if(w===void 0){var x=Object.getPrototypeOf(y);return x===null?void 0:g(x,p,m)}else{if("value"in w)return w.value;var b=w.get;return b===void 0?void 0:b.call(m)}},l=a(6),c=u(l);function u(g){return g&&g.__esModule?g:{default:g}}function A(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}function h(g,y){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:g}function f(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);g.prototype=Object.create(y&&y.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(g,y):g.__proto__=y)}var d=function(g){f(y,g);function y(){return A(this,y),h(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"format",value:function(m,w){if(m!==this.statics.blotName||!w)return o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"format",this).call(this,m,w);w=this.constructor.sanitize(w),this.domNode.setAttribute("href",w)}}],[{key:"create",value:function(m){var w=o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,m);return m=this.sanitize(m),w.setAttribute("href",m),w.setAttribute("rel","noopener noreferrer"),w.setAttribute("target","_blank"),w}},{key:"formats",value:function(m){return m.getAttribute("href")}},{key:"sanitize",value:function(m){return v(m,this.PROTOCOL_WHITELIST)?m:this.SANITIZED_URL}}]),y}(c.default);d.blotName="link",d.tagName="A",d.SANITIZED_URL="about:blank",d.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function v(g,y){var p=document.createElement("a");p.href=g;var m=p.href.slice(0,p.href.indexOf(":"));return y.indexOf(m)>-1}n.default=d,n.sanitize=v},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},o=function(){function y(p,m){for(var w=0;w<m.length;w++){var x=m[w];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,m,w){return m&&y(p.prototype,m),w&&y(p,w),p}}(),l=a(23),c=h(l),u=a(107),A=h(u);function h(y){return y&&y.__esModule?y:{default:y}}function f(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}var d=0;function v(y,p){y.setAttribute(p,y.getAttribute(p)!=="true")}var g=function(){function y(p){var m=this;f(this,y),this.select=p,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){m.togglePicker()}),this.label.addEventListener("keydown",function(w){switch(w.keyCode){case c.default.keys.ENTER:m.togglePicker();break;case c.default.keys.ESCAPE:m.escape(),w.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(y,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),v(this.label,"aria-expanded"),v(this.options,"aria-hidden")}},{key:"buildItem",value:function(m){var w=this,x=document.createElement("span");return x.tabIndex="0",x.setAttribute("role","button"),x.classList.add("ql-picker-item"),m.hasAttribute("value")&&x.setAttribute("data-value",m.getAttribute("value")),m.textContent&&x.setAttribute("data-label",m.textContent),x.addEventListener("click",function(){w.selectItem(x,!0)}),x.addEventListener("keydown",function(b){switch(b.keyCode){case c.default.keys.ENTER:w.selectItem(x,!0),b.preventDefault();break;case c.default.keys.ESCAPE:w.escape(),b.preventDefault();break}}),x}},{key:"buildLabel",value:function(){var m=document.createElement("span");return m.classList.add("ql-picker-label"),m.innerHTML=A.default,m.tabIndex="0",m.setAttribute("role","button"),m.setAttribute("aria-expanded","false"),this.container.appendChild(m),m}},{key:"buildOptions",value:function(){var m=this,w=document.createElement("span");w.classList.add("ql-picker-options"),w.setAttribute("aria-hidden","true"),w.tabIndex="-1",w.id="ql-picker-options-"+d,d+=1,this.label.setAttribute("aria-controls",w.id),this.options=w,[].slice.call(this.select.options).forEach(function(x){var b=m.buildItem(x);w.appendChild(b),x.selected===!0&&m.selectItem(b)}),this.container.appendChild(w)}},{key:"buildPicker",value:function(){var m=this;[].slice.call(this.select.attributes).forEach(function(w){m.container.setAttribute(w.name,w.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var m=this;this.close(),setTimeout(function(){return m.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(m){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,x=this.container.querySelector(".ql-selected");if(m!==x&&(x!=null&&x.classList.remove("ql-selected"),m!=null&&(m.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(m.parentNode.children,m),m.hasAttribute("data-value")?this.label.setAttribute("data-value",m.getAttribute("data-value")):this.label.removeAttribute("data-value"),m.hasAttribute("data-label")?this.label.setAttribute("data-label",m.getAttribute("data-label")):this.label.removeAttribute("data-label"),w))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var b=document.createEvent("Event");b.initEvent("change",!0,!0),this.select.dispatchEvent(b)}this.close()}}},{key:"update",value:function(){var m=void 0;if(this.select.selectedIndex>-1){var w=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];m=this.select.options[this.select.selectedIndex],this.selectItem(w)}else this.selectItem(null);var x=m!=null&&m!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",x)}}]),y}();n.default=g},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(0),o=q(s),l=a(5),c=q(l),u=a(4),A=q(u),h=a(16),f=q(h),d=a(25),v=q(d),g=a(24),y=q(g),p=a(35),m=q(p),w=a(6),x=q(w),b=a(22),B=q(b),_=a(7),k=q(_),E=a(55),T=q(E),S=a(42),j=q(S),I=a(23),U=q(I);function q(V){return V&&V.__esModule?V:{default:V}}c.default.register({"blots/block":A.default,"blots/block/embed":u.BlockEmbed,"blots/break":f.default,"blots/container":v.default,"blots/cursor":y.default,"blots/embed":m.default,"blots/inline":x.default,"blots/scroll":B.default,"blots/text":k.default,"modules/clipboard":T.default,"modules/history":j.default,"modules/keyboard":U.default}),o.default.register(A.default,f.default,y.default,x.default,B.default,k.default),n.default=c.default},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(1),o=function(){function l(c){this.domNode=c,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(l.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),l.create=function(c){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var u;return Array.isArray(this.tagName)?(typeof c=="string"&&(c=c.toUpperCase(),parseInt(c).toString()===c&&(c=parseInt(c))),typeof c=="number"?u=document.createElement(this.tagName[c-1]):this.tagName.indexOf(c)>-1?u=document.createElement(c):u=document.createElement(this.tagName[0])):u=document.createElement(this.tagName),this.className&&u.classList.add(this.className),u},l.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},l.prototype.clone=function(){var c=this.domNode.cloneNode(!1);return s.create(c)},l.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},l.prototype.deleteAt=function(c,u){var A=this.isolate(c,u);A.remove()},l.prototype.formatAt=function(c,u,A,h){var f=this.isolate(c,u);if(s.query(A,s.Scope.BLOT)!=null&&h)f.wrap(A,h);else if(s.query(A,s.Scope.ATTRIBUTE)!=null){var d=s.create(this.statics.scope);f.wrap(d),d.format(A,h)}},l.prototype.insertAt=function(c,u,A){var h=A==null?s.create("text",u):s.create(u,A),f=this.split(c);this.parent.insertBefore(h,f)},l.prototype.insertInto=function(c,u){u===void 0&&(u=null),this.parent!=null&&this.parent.children.remove(this);var A=null;c.children.insertBefore(this,u),u!=null&&(A=u.domNode),(this.domNode.parentNode!=c.domNode||this.domNode.nextSibling!=A)&&c.domNode.insertBefore(this.domNode,A),this.parent=c,this.attach()},l.prototype.isolate=function(c,u){var A=this.split(c);return A.split(u),A},l.prototype.length=function(){return 1},l.prototype.offset=function(c){return c===void 0&&(c=this.parent),this.parent==null||this==c?0:this.parent.children.offset(this)+this.parent.offset(c)},l.prototype.optimize=function(c){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},l.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},l.prototype.replace=function(c){c.parent!=null&&(c.parent.insertBefore(this,c.next),c.remove())},l.prototype.replaceWith=function(c,u){var A=typeof c=="string"?s.create(c,u):c;return A.replace(this),A},l.prototype.split=function(c,u){return c===0?this:this.next},l.prototype.update=function(c,u){},l.prototype.wrap=function(c,u){var A=typeof c=="string"?s.create(c,u):c;return this.parent!=null&&this.parent.insertBefore(A,this.next),A.appendChild(this),A},l.blotName="abstract",l}();n.default=o},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(12),o=a(32),l=a(33),c=a(1),u=function(){function A(h){this.attributes={},this.domNode=h,this.build()}return A.prototype.attribute=function(h,f){f?h.add(this.domNode,f)&&(h.value(this.domNode)!=null?this.attributes[h.attrName]=h:delete this.attributes[h.attrName]):(h.remove(this.domNode),delete this.attributes[h.attrName])},A.prototype.build=function(){var h=this;this.attributes={};var f=s.default.keys(this.domNode),d=o.default.keys(this.domNode),v=l.default.keys(this.domNode);f.concat(d).concat(v).forEach(function(g){var y=c.query(g,c.Scope.ATTRIBUTE);y instanceof s.default&&(h.attributes[y.attrName]=y)})},A.prototype.copy=function(h){var f=this;Object.keys(this.attributes).forEach(function(d){var v=f.attributes[d].value(f.domNode);h.format(d,v)})},A.prototype.move=function(h){var f=this;this.copy(h),Object.keys(this.attributes).forEach(function(d){f.attributes[d].remove(f.domNode)}),this.attributes={}},A.prototype.values=function(){var h=this;return Object.keys(this.attributes).reduce(function(f,d){return f[d]=h.attributes[d].value(h.domNode),f},{})},A}();n.default=u},function(r,n,a){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,h){A.__proto__=h}||function(A,h){for(var f in h)h.hasOwnProperty(f)&&(A[f]=h[f])};return function(A,h){u(A,h);function f(){this.constructor=A}A.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(12);function l(u,A){var h=u.getAttribute("class")||"";return h.split(/\s+/).filter(function(f){return f.indexOf(A+"-")===0})}var c=function(u){s(A,u);function A(){return u!==null&&u.apply(this,arguments)||this}return A.keys=function(h){return(h.getAttribute("class")||"").split(/\s+/).map(function(f){return f.split("-").slice(0,-1).join("-")})},A.prototype.add=function(h,f){return this.canAdd(h,f)?(this.remove(h),h.classList.add(this.keyName+"-"+f),!0):!1},A.prototype.remove=function(h){var f=l(h,this.keyName);f.forEach(function(d){h.classList.remove(d)}),h.classList.length===0&&h.removeAttribute("class")},A.prototype.value=function(h){var f=l(h,this.keyName)[0]||"",d=f.slice(this.keyName.length+1);return this.canAdd(h,d)?d:""},A}(o.default);n.default=c},function(r,n,a){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,h){A.__proto__=h}||function(A,h){for(var f in h)h.hasOwnProperty(f)&&(A[f]=h[f])};return function(A,h){u(A,h);function f(){this.constructor=A}A.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(12);function l(u){var A=u.split("-"),h=A.slice(1).map(function(f){return f[0].toUpperCase()+f.slice(1)}).join("");return A[0]+h}var c=function(u){s(A,u);function A(){return u!==null&&u.apply(this,arguments)||this}return A.keys=function(h){return(h.getAttribute("style")||"").split(";").map(function(f){var d=f.split(":");return d[0].trim()})},A.prototype.add=function(h,f){return this.canAdd(h,f)?(h.style[l(this.keyName)]=f,!0):!1},A.prototype.remove=function(h){h.style[l(this.keyName)]="",h.getAttribute("style")||h.removeAttribute("style")},A.prototype.value=function(h){var f=h.style[l(this.keyName)];return this.canAdd(h,f)?f:""},A}(o.default);n.default=c},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function c(u,A){for(var h=0;h<A.length;h++){var f=A[h];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(u,f.key,f)}}return function(u,A,h){return A&&c(u.prototype,A),h&&c(u,h),u}}();function o(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}var l=function(){function c(u,A){o(this,c),this.quill=u,this.options=A,this.modules={}}return s(c,[{key:"init",value:function(){var A=this;Object.keys(this.options.modules).forEach(function(h){A.modules[h]==null&&A.addModule(h)})}},{key:"addModule",value:function(A){var h=this.quill.constructor.import("modules/"+A);return this.modules[A]=new h(this.quill,this.options.modules[A]||{}),this.modules[A]}}]),c}();l.DEFAULTS={modules:{}},l.themes={default:l},n.default=l},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function p(m,w){for(var x=0;x<w.length;x++){var b=w[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(m,b.key,b)}}return function(m,w,x){return w&&p(m.prototype,w),x&&p(m,x),m}}(),o=function p(m,w,x){m===null&&(m=Function.prototype);var b=Object.getOwnPropertyDescriptor(m,w);if(b===void 0){var B=Object.getPrototypeOf(m);return B===null?void 0:p(B,w,x)}else{if("value"in b)return b.value;var _=b.get;return _===void 0?void 0:_.call(x)}},l=a(0),c=h(l),u=a(7),A=h(u);function h(p){return p&&p.__esModule?p:{default:p}}function f(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function d(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function v(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var g="\uFEFF",y=function(p){v(m,p);function m(w){f(this,m);var x=d(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,w));return x.contentNode=document.createElement("span"),x.contentNode.setAttribute("contenteditable",!1),[].slice.call(x.domNode.childNodes).forEach(function(b){x.contentNode.appendChild(b)}),x.leftGuard=document.createTextNode(g),x.rightGuard=document.createTextNode(g),x.domNode.appendChild(x.leftGuard),x.domNode.appendChild(x.contentNode),x.domNode.appendChild(x.rightGuard),x}return s(m,[{key:"index",value:function(x,b){return x===this.leftGuard?0:x===this.rightGuard?1:o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"index",this).call(this,x,b)}},{key:"restore",value:function(x){var b=void 0,B=void 0,_=x.data.split(g).join("");if(x===this.leftGuard)if(this.prev instanceof A.default){var k=this.prev.length();this.prev.insertAt(k,_),b={startNode:this.prev.domNode,startOffset:k+_.length}}else B=document.createTextNode(_),this.parent.insertBefore(c.default.create(B),this),b={startNode:B,startOffset:_.length};else x===this.rightGuard&&(this.next instanceof A.default?(this.next.insertAt(0,_),b={startNode:this.next.domNode,startOffset:_.length}):(B=document.createTextNode(_),this.parent.insertBefore(c.default.create(B),this.next),b={startNode:B,startOffset:_.length}));return x.data=g,b}},{key:"update",value:function(x,b){var B=this;x.forEach(function(_){if(_.type==="characterData"&&(_.target===B.leftGuard||_.target===B.rightGuard)){var k=B.restore(_.target);k&&(b.range=k)}})}}]),m}(c.default.Embed);n.default=y},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var s=a(0),o=l(s);function l(f){return f&&f.__esModule?f:{default:f}}var c={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},u=new o.default.Attributor.Attribute("align","align",c),A=new o.default.Attributor.Class("align","ql-align",c),h=new o.default.Attributor.Style("align","text-align",c);n.AlignAttribute=u,n.AlignClass=A,n.AlignStyle=h},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var s=a(0),o=c(s),l=a(26);function c(h){return h&&h.__esModule?h:{default:h}}var u=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),A=new l.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=u,n.BackgroundStyle=A},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var s=a(0),o=l(s);function l(f){return f&&f.__esModule?f:{default:f}}var c={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},u=new o.default.Attributor.Attribute("direction","dir",c),A=new o.default.Attributor.Class("direction","ql-direction",c),h=new o.default.Attributor.Style("direction","direction",c);n.DirectionAttribute=u,n.DirectionClass=A,n.DirectionStyle=h},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var s=function(){function p(m,w){for(var x=0;x<w.length;x++){var b=w[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(m,b.key,b)}}return function(m,w,x){return w&&p(m.prototype,w),x&&p(m,x),m}}(),o=function p(m,w,x){m===null&&(m=Function.prototype);var b=Object.getOwnPropertyDescriptor(m,w);if(b===void 0){var B=Object.getPrototypeOf(m);return B===null?void 0:p(B,w,x)}else{if("value"in b)return b.value;var _=b.get;return _===void 0?void 0:_.call(x)}},l=a(0),c=u(l);function u(p){return p&&p.__esModule?p:{default:p}}function A(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function h(p,m){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:p}function f(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);p.prototype=Object.create(m&&m.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(p,m):p.__proto__=m)}var d={scope:c.default.Scope.INLINE,whitelist:["serif","monospace"]},v=new c.default.Attributor.Class("font","ql-font",d),g=function(p){f(m,p);function m(){return A(this,m),h(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"value",value:function(x){return o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"value",this).call(this,x).replace(/["']/g,"")}}]),m}(c.default.Attributor.Style),y=new g("font","font-family",d);n.FontStyle=y,n.FontClass=v},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var s=a(0),o=l(s);function l(A){return A&&A.__esModule?A:{default:A}}var c=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),u=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=c,n.SizeStyle=u},function(r,n,a){r.exports={align:{"":a(76),center:a(77),right:a(78),justify:a(79)},background:a(80),blockquote:a(81),bold:a(82),clean:a(83),code:a(58),"code-block":a(58),color:a(84),direction:{"":a(85),rtl:a(86)},float:{center:a(87),full:a(88),left:a(89),right:a(90)},formula:a(91),header:{1:a(92),2:a(93)},italic:a(94),image:a(95),indent:{"+1":a(96),"-1":a(97)},link:a(98),list:{ordered:a(99),bullet:a(100),check:a(101)},script:{sub:a(102),super:a(103)},strike:a(104),underline:a(105),video:a(106)}},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var s=function(){function w(x,b){for(var B=0;B<b.length;B++){var _=b[B];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,_.key,_)}}return function(x,b,B){return b&&w(x.prototype,b),B&&w(x,B),x}}(),o=a(0),l=f(o),c=a(5),u=f(c),A=a(9),h=f(A);function f(w){return w&&w.__esModule?w:{default:w}}function d(w,x){if(!(w instanceof x))throw new TypeError("Cannot call a class as a function")}function v(w,x){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:w}function g(w,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);w.prototype=Object.create(x&&x.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(w,x):w.__proto__=x)}var y=function(w){g(x,w);function x(b,B){d(this,x);var _=v(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,b,B));return _.lastRecorded=0,_.ignoreChange=!1,_.clear(),_.quill.on(u.default.events.EDITOR_CHANGE,function(k,E,T,S){k!==u.default.events.TEXT_CHANGE||_.ignoreChange||(!_.options.userOnly||S===u.default.sources.USER?_.record(E,T):_.transform(E))}),_.quill.keyboard.addBinding({key:"Z",shortKey:!0},_.undo.bind(_)),_.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},_.redo.bind(_)),/Win/i.test(navigator.platform)&&_.quill.keyboard.addBinding({key:"Y",shortKey:!0},_.redo.bind(_)),_}return s(x,[{key:"change",value:function(B,_){if(this.stack[B].length!==0){var k=this.stack[B].pop();this.stack[_].push(k),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(k[B],u.default.sources.USER),this.ignoreChange=!1;var E=m(k[B]);this.quill.setSelection(E)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(B,_){if(B.ops.length!==0){this.stack.redo=[];var k=this.quill.getContents().diff(_),E=Date.now();if(this.lastRecorded+this.options.delay>E&&this.stack.undo.length>0){var T=this.stack.undo.pop();k=k.compose(T.undo),B=T.redo.compose(B)}else this.lastRecorded=E;this.stack.undo.push({redo:B,undo:k}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(B){this.stack.undo.forEach(function(_){_.undo=B.transform(_.undo,!0),_.redo=B.transform(_.redo,!0)}),this.stack.redo.forEach(function(_){_.undo=B.transform(_.undo,!0),_.redo=B.transform(_.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),x}(h.default);y.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function p(w){var x=w.ops[w.ops.length-1];return x==null?!1:x.insert!=null?typeof x.insert=="string"&&x.insert.endsWith(`
`):x.attributes!=null?Object.keys(x.attributes).some(function(b){return l.default.query(b,l.default.Scope.BLOCK)!=null}):!1}function m(w){var x=w.reduce(function(B,_){return B+=_.delete||0,B},0),b=w.length()-x;return p(w)&&(b-=1),b}n.default=y,n.getLastChangeIndex=m},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=function(){function C(L,O){for(var D=0;D<O.length;D++){var P=O[D];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(L,P.key,P)}}return function(L,O,D){return O&&C(L.prototype,O),D&&C(L,D),L}}(),o=function C(L,O,D){L===null&&(L=Function.prototype);var P=Object.getOwnPropertyDescriptor(L,O);if(P===void 0){var Q=Object.getPrototypeOf(L);return Q===null?void 0:C(Q,O,D)}else{if("value"in P)return P.value;var J=P.get;return J===void 0?void 0:J.call(D)}},l=a(3),c=E(l),u=a(2),A=E(u),h=a(8),f=E(h),d=a(23),v=E(d),g=a(34),y=E(g),p=a(59),m=E(p),w=a(60),x=E(w),b=a(28),B=E(b),_=a(61),k=E(_);function E(C){return C&&C.__esModule?C:{default:C}}function T(C,L){if(!(C instanceof L))throw new TypeError("Cannot call a class as a function")}function S(C,L){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L&&(typeof L=="object"||typeof L=="function")?L:C}function j(C,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof L);C.prototype=Object.create(L&&L.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),L&&(Object.setPrototypeOf?Object.setPrototypeOf(C,L):C.__proto__=L)}var I=[!1,"center","right","justify"],U=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],q=[!1,"serif","monospace"],V=["1","2","3",!1],X=["small",!1,"large","huge"],W=function(C){j(L,C);function L(O,D){T(this,L);var P=S(this,(L.__proto__||Object.getPrototypeOf(L)).call(this,O,D)),Q=function J(te){if(!document.body.contains(O.root))return document.body.removeEventListener("click",J);P.tooltip!=null&&!P.tooltip.root.contains(te.target)&&document.activeElement!==P.tooltip.textbox&&!P.quill.hasFocus()&&P.tooltip.hide(),P.pickers!=null&&P.pickers.forEach(function(z){z.container.contains(te.target)||z.close()})};return O.emitter.listenDOM("click",document.body,Q),P}return s(L,[{key:"addModule",value:function(D){var P=o(L.prototype.__proto__||Object.getPrototypeOf(L.prototype),"addModule",this).call(this,D);return D==="toolbar"&&this.extendToolbar(P),P}},{key:"buildButtons",value:function(D,P){D.forEach(function(Q){var J=Q.getAttribute("class")||"";J.split(/\s+/).forEach(function(te){if(te.startsWith("ql-")&&(te=te.slice(3),P[te]!=null))if(te==="direction")Q.innerHTML=P[te][""]+P[te].rtl;else if(typeof P[te]=="string")Q.innerHTML=P[te];else{var z=Q.value||"";z!=null&&P[te][z]&&(Q.innerHTML=P[te][z])}})})}},{key:"buildPickers",value:function(D,P){var Q=this;this.pickers=D.map(function(te){if(te.classList.contains("ql-align"))return te.querySelector("option")==null&&H(te,I),new x.default(te,P.align);if(te.classList.contains("ql-background")||te.classList.contains("ql-color")){var z=te.classList.contains("ql-background")?"background":"color";return te.querySelector("option")==null&&H(te,U,z==="background"?"#ffffff":"#000000"),new m.default(te,P[z])}else return te.querySelector("option")==null&&(te.classList.contains("ql-font")?H(te,q):te.classList.contains("ql-header")?H(te,V):te.classList.contains("ql-size")&&H(te,X)),new B.default(te)});var J=function(){Q.pickers.forEach(function(z){z.update()})};this.quill.on(f.default.events.EDITOR_CHANGE,J)}}]),L}(y.default);W.DEFAULTS=(0,c.default)(!0,{},y.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var L=this,O=this.container.querySelector("input.ql-image[type=file]");O==null&&(O=document.createElement("input"),O.setAttribute("type","file"),O.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),O.classList.add("ql-image"),O.addEventListener("change",function(){if(O.files!=null&&O.files[0]!=null){var D=new FileReader;D.onload=function(P){var Q=L.quill.getSelection(!0);L.quill.updateContents(new A.default().retain(Q.index).delete(Q.length).insert({image:P.target.result}),f.default.sources.USER),L.quill.setSelection(Q.index+1,f.default.sources.SILENT),O.value=""},D.readAsDataURL(O.files[0])}}),this.container.appendChild(O)),O.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var M=function(C){j(L,C);function L(O,D){T(this,L);var P=S(this,(L.__proto__||Object.getPrototypeOf(L)).call(this,O,D));return P.textbox=P.root.querySelector('input[type="text"]'),P.listen(),P}return s(L,[{key:"listen",value:function(){var D=this;this.textbox.addEventListener("keydown",function(P){v.default.match(P,"enter")?(D.save(),P.preventDefault()):v.default.match(P,"escape")&&(D.cancel(),P.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),P!=null?this.textbox.value=P:D!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+D)||""),this.root.setAttribute("data-mode",D)}},{key:"restoreFocus",value:function(){var D=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=D}},{key:"save",value:function(){var D=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var P=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",D,f.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",D,f.default.sources.USER)),this.quill.root.scrollTop=P;break}case"video":D=G(D);case"formula":{if(!D)break;var Q=this.quill.getSelection(!0);if(Q!=null){var J=Q.index+Q.length;this.quill.insertEmbed(J,this.root.getAttribute("data-mode"),D,f.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(J+1," ",f.default.sources.USER),this.quill.setSelection(J+2,f.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),L}(k.default);function G(C){var L=C.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||C.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return L?(L[1]||"https")+"://www.youtube.com/embed/"+L[2]+"?showinfo=0":(L=C.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(L[1]||"https")+"://player.vimeo.com/video/"+L[2]+"/":C}function H(C,L){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;L.forEach(function(D){var P=document.createElement("option");D===O?P.setAttribute("selected","selected"):P.setAttribute("value",D),C.appendChild(P)})}n.BaseTooltip=M,n.default=W},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var c,u=this.iterator();c=u();)if(c===l)return!0;return!1},o.prototype.insertBefore=function(l,c){l&&(l.next=c,c!=null?(l.prev=c.prev,c.prev!=null&&(c.prev.next=l),c.prev=l,c===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var c=0,u=this.head;u!=null;){if(u===l)return c;c+=u.length(),u=u.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var c=l;return l!=null&&(l=l.next),c}},o.prototype.find=function(l,c){c===void 0&&(c=!1);for(var u,A=this.iterator();u=A();){var h=u.length();if(l<h||c&&l===h&&(u.next==null||u.next.length()!==0))return[u,l];l-=h}return[null,0]},o.prototype.forEach=function(l){for(var c,u=this.iterator();c=u();)l(c)},o.prototype.forEachAt=function(l,c,u){if(!(c<=0))for(var A=this.find(l),h=A[0],f=A[1],d,v=l-f,g=this.iterator(h);(d=g())&&v<l+c;){var y=d.length();l>v?u(d,l-v,Math.min(c,v+y-l)):u(d,0,Math.min(y,l+c-v)),v+=y}},o.prototype.map=function(l){return this.reduce(function(c,u){return c.push(l(u)),c},[])},o.prototype.reduce=function(l,c){for(var u,A=this.iterator();u=A();)c=l(c,u);return c},o}();n.default=s},function(r,n,a){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,d){f.__proto__=d}||function(f,d){for(var v in d)d.hasOwnProperty(v)&&(f[v]=d[v])};return function(f,d){h(f,d);function v(){this.constructor=f}f.prototype=d===null?Object.create(d):(v.prototype=d.prototype,new v)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(17),l=a(1),c={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},u=100,A=function(h){s(f,h);function f(d){var v=h.call(this,d)||this;return v.scroll=v,v.observer=new MutationObserver(function(g){v.update(g)}),v.observer.observe(v.domNode,c),v.attach(),v}return f.prototype.detach=function(){h.prototype.detach.call(this),this.observer.disconnect()},f.prototype.deleteAt=function(d,v){this.update(),d===0&&v===this.length()?this.children.forEach(function(g){g.remove()}):h.prototype.deleteAt.call(this,d,v)},f.prototype.formatAt=function(d,v,g,y){this.update(),h.prototype.formatAt.call(this,d,v,g,y)},f.prototype.insertAt=function(d,v,g){this.update(),h.prototype.insertAt.call(this,d,v,g)},f.prototype.optimize=function(d,v){var g=this;d===void 0&&(d=[]),v===void 0&&(v={}),h.prototype.optimize.call(this,v);for(var y=[].slice.call(this.observer.takeRecords());y.length>0;)d.push(y.pop());for(var p=function(b,B){B===void 0&&(B=!0),!(b==null||b===g)&&b.domNode.parentNode!=null&&(b.domNode[l.DATA_KEY].mutations==null&&(b.domNode[l.DATA_KEY].mutations=[]),B&&p(b.parent))},m=function(b){b.domNode[l.DATA_KEY]==null||b.domNode[l.DATA_KEY].mutations==null||(b instanceof o.default&&b.children.forEach(m),b.optimize(v))},w=d,x=0;w.length>0;x+=1){if(x>=u)throw new Error("[Parchment] Maximum optimize iterations reached");for(w.forEach(function(b){var B=l.find(b.target,!0);B!=null&&(B.domNode===b.target&&(b.type==="childList"?(p(l.find(b.previousSibling,!1)),[].forEach.call(b.addedNodes,function(_){var k=l.find(_,!1);p(k,!1),k instanceof o.default&&k.children.forEach(function(E){p(E,!1)})})):b.type==="attributes"&&p(B.prev)),p(B))}),this.children.forEach(m),w=[].slice.call(this.observer.takeRecords()),y=w.slice();y.length>0;)d.push(y.pop())}},f.prototype.update=function(d,v){var g=this;v===void 0&&(v={}),d=d||this.observer.takeRecords(),d.map(function(y){var p=l.find(y.target,!0);return p==null?null:p.domNode[l.DATA_KEY].mutations==null?(p.domNode[l.DATA_KEY].mutations=[y],p):(p.domNode[l.DATA_KEY].mutations.push(y),null)}).forEach(function(y){y==null||y===g||y.domNode[l.DATA_KEY]==null||y.update(y.domNode[l.DATA_KEY].mutations||[],v)}),this.domNode[l.DATA_KEY].mutations!=null&&h.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,v),this.optimize(d,v)},f.blotName="scroll",f.defaultChild="block",f.scope=l.Scope.BLOCK_BLOT,f.tagName="DIV",f}(o.default);n.default=A},function(r,n,a){var s=this&&this.__extends||function(){var A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,f){h.__proto__=f}||function(h,f){for(var d in f)f.hasOwnProperty(d)&&(h[d]=f[d])};return function(h,f){A(h,f);function d(){this.constructor=h}h.prototype=f===null?Object.create(f):(d.prototype=f.prototype,new d)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(18),l=a(1);function c(A,h){if(Object.keys(A).length!==Object.keys(h).length)return!1;for(var f in A)if(A[f]!==h[f])return!1;return!0}var u=function(A){s(h,A);function h(){return A!==null&&A.apply(this,arguments)||this}return h.formats=function(f){if(f.tagName!==h.tagName)return A.formats.call(this,f)},h.prototype.format=function(f,d){var v=this;f===this.statics.blotName&&!d?(this.children.forEach(function(g){g instanceof o.default||(g=g.wrap(h.blotName,!0)),v.attributes.copy(g)}),this.unwrap()):A.prototype.format.call(this,f,d)},h.prototype.formatAt=function(f,d,v,g){if(this.formats()[v]!=null||l.query(v,l.Scope.ATTRIBUTE)){var y=this.isolate(f,d);y.format(v,g)}else A.prototype.formatAt.call(this,f,d,v,g)},h.prototype.optimize=function(f){A.prototype.optimize.call(this,f);var d=this.formats();if(Object.keys(d).length===0)return this.unwrap();var v=this.next;v instanceof h&&v.prev===this&&c(d,v.formats())&&(v.moveChildren(this),v.remove())},h.blotName="inline",h.scope=l.Scope.INLINE_BLOT,h.tagName="SPAN",h}(o.default);n.default=u},function(r,n,a){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,h){A.__proto__=h}||function(A,h){for(var f in h)h.hasOwnProperty(f)&&(A[f]=h[f])};return function(A,h){u(A,h);function f(){this.constructor=A}A.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(18),l=a(1),c=function(u){s(A,u);function A(){return u!==null&&u.apply(this,arguments)||this}return A.formats=function(h){var f=l.query(A.blotName).tagName;if(h.tagName!==f)return u.formats.call(this,h)},A.prototype.format=function(h,f){l.query(h,l.Scope.BLOCK)!=null&&(h===this.statics.blotName&&!f?this.replaceWith(A.blotName):u.prototype.format.call(this,h,f))},A.prototype.formatAt=function(h,f,d,v){l.query(d,l.Scope.BLOCK)!=null?this.format(d,v):u.prototype.formatAt.call(this,h,f,d,v)},A.prototype.insertAt=function(h,f,d){if(d==null||l.query(f,l.Scope.INLINE)!=null)u.prototype.insertAt.call(this,h,f,d);else{var v=this.split(h),g=l.create(f,d);v.parent.insertBefore(g,v)}},A.prototype.update=function(h,f){navigator.userAgent.match(/Trident/)?this.build():u.prototype.update.call(this,h,f)},A.blotName="block",A.scope=l.Scope.BLOCK_BLOT,A.tagName="P",A}(o.default);n.default=c},function(r,n,a){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,A){u.__proto__=A}||function(u,A){for(var h in A)A.hasOwnProperty(h)&&(u[h]=A[h])};return function(u,A){c(u,A);function h(){this.constructor=u}u.prototype=A===null?Object.create(A):(h.prototype=A.prototype,new h)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(19),l=function(c){s(u,c);function u(){return c!==null&&c.apply(this,arguments)||this}return u.formats=function(A){},u.prototype.format=function(A,h){c.prototype.formatAt.call(this,0,this.length(),A,h)},u.prototype.formatAt=function(A,h,f,d){A===0&&h===this.length()?this.format(f,d):c.prototype.formatAt.call(this,A,h,f,d)},u.prototype.formats=function(){return this.statics.formats(this.domNode)},u}(o.default);n.default=l},function(r,n,a){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,h){A.__proto__=h}||function(A,h){for(var f in h)h.hasOwnProperty(f)&&(A[f]=h[f])};return function(A,h){u(A,h);function f(){this.constructor=A}A.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=a(19),l=a(1),c=function(u){s(A,u);function A(h){var f=u.call(this,h)||this;return f.text=f.statics.value(f.domNode),f}return A.create=function(h){return document.createTextNode(h)},A.value=function(h){var f=h.data;return f.normalize&&(f=f.normalize()),f},A.prototype.deleteAt=function(h,f){this.domNode.data=this.text=this.text.slice(0,h)+this.text.slice(h+f)},A.prototype.index=function(h,f){return this.domNode===h?f:-1},A.prototype.insertAt=function(h,f,d){d==null?(this.text=this.text.slice(0,h)+f+this.text.slice(h),this.domNode.data=this.text):u.prototype.insertAt.call(this,h,f,d)},A.prototype.length=function(){return this.text.length},A.prototype.optimize=function(h){u.prototype.optimize.call(this,h),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof A&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},A.prototype.position=function(h,f){return[this.domNode,h]},A.prototype.split=function(h,f){if(f===void 0&&(f=!1),!f){if(h===0)return this;if(h===this.length())return this.next}var d=l.create(this.domNode.splitText(h));return this.parent.insertBefore(d,this.next),this.text=this.statics.value(this.domNode),d},A.prototype.update=function(h,f){var d=this;h.some(function(v){return v.type==="characterData"&&v.target===d.domNode})&&(this.text=this.statics.value(this.domNode))},A.prototype.value=function(){return this.text},A.blotName="text",A.scope=l.Scope.INLINE_BLOT,A}(o.default);n.default=c},function(r,n,a){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,c){return arguments.length>1&&!this.contains(l)==!c?c:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,c){return c=c||0,this.substr(c,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,c){var u=this.toString();(typeof c!="number"||!isFinite(c)||Math.floor(c)!==c||c>u.length)&&(c=u.length),c-=l.length;var A=u.indexOf(l,c);return A!==-1&&A===c}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(c){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof c!="function")throw new TypeError("predicate must be a function");for(var u=Object(this),A=u.length>>>0,h=arguments[1],f,d=0;d<A;d++)if(f=u[d],c.call(h,f,d,u))return f}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(r,n){var a=-1,s=1,o=0;function l(x,b,B){if(x==b)return x?[[o,x]]:[];(B<0||x.length<B)&&(B=null);var _=h(x,b),k=x.substring(0,_);x=x.substring(_),b=b.substring(_),_=f(x,b);var E=x.substring(x.length-_);x=x.substring(0,x.length-_),b=b.substring(0,b.length-_);var T=c(x,b);return k&&T.unshift([o,k]),E&&T.push([o,E]),v(T),B!=null&&(T=p(T,B)),T=m(T),T}function c(x,b){var B;if(!x)return[[s,b]];if(!b)return[[a,x]];var _=x.length>b.length?x:b,k=x.length>b.length?b:x,E=_.indexOf(k);if(E!=-1)return B=[[s,_.substring(0,E)],[o,k],[s,_.substring(E+k.length)]],x.length>b.length&&(B[0][0]=B[2][0]=a),B;if(k.length==1)return[[a,x],[s,b]];var T=d(x,b);if(T){var S=T[0],j=T[1],I=T[2],U=T[3],q=T[4],V=l(S,I),X=l(j,U);return V.concat([[o,q]],X)}return u(x,b)}function u(x,b){for(var B=x.length,_=b.length,k=Math.ceil((B+_)/2),E=k,T=2*k,S=new Array(T),j=new Array(T),I=0;I<T;I++)S[I]=-1,j[I]=-1;S[E+1]=0,j[E+1]=0;for(var U=B-_,q=U%2!=0,V=0,X=0,W=0,M=0,G=0;G<k;G++){for(var H=-G+V;H<=G-X;H+=2){var C=E+H,L;H==-G||H!=G&&S[C-1]<S[C+1]?L=S[C+1]:L=S[C-1]+1;for(var O=L-H;L<B&&O<_&&x.charAt(L)==b.charAt(O);)L++,O++;if(S[C]=L,L>B)X+=2;else if(O>_)V+=2;else if(q){var D=E+U-H;if(D>=0&&D<T&&j[D]!=-1){var P=B-j[D];if(L>=P)return A(x,b,L,O)}}}for(var Q=-G+W;Q<=G-M;Q+=2){var D=E+Q,P;Q==-G||Q!=G&&j[D-1]<j[D+1]?P=j[D+1]:P=j[D-1]+1;for(var J=P-Q;P<B&&J<_&&x.charAt(B-P-1)==b.charAt(_-J-1);)P++,J++;if(j[D]=P,P>B)M+=2;else if(J>_)W+=2;else if(!q){var C=E+U-Q;if(C>=0&&C<T&&S[C]!=-1){var L=S[C],O=E+L-C;if(P=B-P,L>=P)return A(x,b,L,O)}}}}return[[a,x],[s,b]]}function A(x,b,B,_){var k=x.substring(0,B),E=b.substring(0,_),T=x.substring(B),S=b.substring(_),j=l(k,E),I=l(T,S);return j.concat(I)}function h(x,b){if(!x||!b||x.charAt(0)!=b.charAt(0))return 0;for(var B=0,_=Math.min(x.length,b.length),k=_,E=0;B<k;)x.substring(E,k)==b.substring(E,k)?(B=k,E=B):_=k,k=Math.floor((_-B)/2+B);return k}function f(x,b){if(!x||!b||x.charAt(x.length-1)!=b.charAt(b.length-1))return 0;for(var B=0,_=Math.min(x.length,b.length),k=_,E=0;B<k;)x.substring(x.length-k,x.length-E)==b.substring(b.length-k,b.length-E)?(B=k,E=B):_=k,k=Math.floor((_-B)/2+B);return k}function d(x,b){var B=x.length>b.length?x:b,_=x.length>b.length?b:x;if(B.length<4||_.length*2<B.length)return null;function k(X,W,M){for(var G=X.substring(M,M+Math.floor(X.length/4)),H=-1,C="",L,O,D,P;(H=W.indexOf(G,H+1))!=-1;){var Q=h(X.substring(M),W.substring(H)),J=f(X.substring(0,M),W.substring(0,H));C.length<J+Q&&(C=W.substring(H-J,H)+W.substring(H,H+Q),L=X.substring(0,M-J),O=X.substring(M+Q),D=W.substring(0,H-J),P=W.substring(H+Q))}return C.length*2>=X.length?[L,O,D,P,C]:null}var E=k(B,_,Math.ceil(B.length/4)),T=k(B,_,Math.ceil(B.length/2)),S;if(!E&&!T)return null;T?E?S=E[4].length>T[4].length?E:T:S=T:S=E;var j,I,U,q;x.length>b.length?(j=S[0],I=S[1],U=S[2],q=S[3]):(U=S[0],q=S[1],j=S[2],I=S[3]);var V=S[4];return[j,I,U,q,V]}function v(x){x.push([o,""]);for(var b=0,B=0,_=0,k="",E="",T;b<x.length;)switch(x[b][0]){case s:_++,E+=x[b][1],b++;break;case a:B++,k+=x[b][1],b++;break;case o:B+_>1?(B!==0&&_!==0&&(T=h(E,k),T!==0&&(b-B-_>0&&x[b-B-_-1][0]==o?x[b-B-_-1][1]+=E.substring(0,T):(x.splice(0,0,[o,E.substring(0,T)]),b++),E=E.substring(T),k=k.substring(T)),T=f(E,k),T!==0&&(x[b][1]=E.substring(E.length-T)+x[b][1],E=E.substring(0,E.length-T),k=k.substring(0,k.length-T))),B===0?x.splice(b-_,B+_,[s,E]):_===0?x.splice(b-B,B+_,[a,k]):x.splice(b-B-_,B+_,[a,k],[s,E]),b=b-B-_+(B?1:0)+(_?1:0)+1):b!==0&&x[b-1][0]==o?(x[b-1][1]+=x[b][1],x.splice(b,1)):b++,_=0,B=0,k="",E="";break}x[x.length-1][1]===""&&x.pop();var S=!1;for(b=1;b<x.length-1;)x[b-1][0]==o&&x[b+1][0]==o&&(x[b][1].substring(x[b][1].length-x[b-1][1].length)==x[b-1][1]?(x[b][1]=x[b-1][1]+x[b][1].substring(0,x[b][1].length-x[b-1][1].length),x[b+1][1]=x[b-1][1]+x[b+1][1],x.splice(b-1,1),S=!0):x[b][1].substring(0,x[b+1][1].length)==x[b+1][1]&&(x[b-1][1]+=x[b+1][1],x[b][1]=x[b][1].substring(x[b+1][1].length)+x[b+1][1],x.splice(b+1,1),S=!0)),b++;S&&v(x)}var g=l;g.INSERT=s,g.DELETE=a,g.EQUAL=o,r.exports=g;function y(x,b){if(b===0)return[o,x];for(var B=0,_=0;_<x.length;_++){var k=x[_];if(k[0]===a||k[0]===o){var E=B+k[1].length;if(b===E)return[_+1,x];if(b<E){x=x.slice();var T=b-B,S=[k[0],k[1].slice(0,T)],j=[k[0],k[1].slice(T)];return x.splice(_,1,S,j),[_+1,x]}else B=E}}throw new Error("cursor_pos is out of bounds!")}function p(x,b){var B=y(x,b),_=B[1],k=B[0],E=_[k],T=_[k+1];if(E==null)return x;if(E[0]!==o)return x;if(T!=null&&E[1]+T[1]===T[1]+E[1])return _.splice(k,2,T,E),w(_,k,2);if(T!=null&&T[1].indexOf(E[1])===0){_.splice(k,2,[T[0],E[1]],[0,E[1]]);var S=T[1].slice(E[1].length);return S.length>0&&_.splice(k+2,0,[T[0],S]),w(_,k,3)}else return x}function m(x){for(var b=!1,B=function(T){return T.charCodeAt(0)>=56320&&T.charCodeAt(0)<=57343},_=function(T){return T.charCodeAt(T.length-1)>=55296&&T.charCodeAt(T.length-1)<=56319},k=2;k<x.length;k+=1)x[k-2][0]===o&&_(x[k-2][1])&&x[k-1][0]===a&&B(x[k-1][1])&&x[k][0]===s&&B(x[k][1])&&(b=!0,x[k-1][1]=x[k-2][1].slice(-1)+x[k-1][1],x[k][1]=x[k-2][1].slice(-1)+x[k][1],x[k-2][1]=x[k-2][1].slice(0,-1));if(!b)return x;for(var E=[],k=0;k<x.length;k+=1)x[k][1].length>0&&E.push(x[k]);return E}function w(x,b,B){for(var _=b+B-1;_>=0&&_>=b-1;_--)if(_+1<x.length){var k=x[_],E=x[_+1];k[0]===E[1]&&x.splice(_,2,[k[0],k[1]+E[1]])}return x}},function(r,n){n=r.exports=typeof Object.keys=="function"?Object.keys:a,n.shim=a;function a(s){var o=[];for(var l in s)o.push(l);return o}},function(r,n){var a=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=r.exports=a?s:o,n.supported=s;function s(l){return Object.prototype.toString.call(l)=="[object Arguments]"}n.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}},function(r,n){var a=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function l(u,A,h){this.fn=u,this.context=A,this.once=h||!1}function c(){this._events=new o,this._eventsCount=0}c.prototype.eventNames=function(){var A=[],h,f;if(this._eventsCount===0)return A;for(f in h=this._events)a.call(h,f)&&A.push(s?f.slice(1):f);return Object.getOwnPropertySymbols?A.concat(Object.getOwnPropertySymbols(h)):A},c.prototype.listeners=function(A,h){var f=s?s+A:A,d=this._events[f];if(h)return!!d;if(!d)return[];if(d.fn)return[d.fn];for(var v=0,g=d.length,y=new Array(g);v<g;v++)y[v]=d[v].fn;return y},c.prototype.emit=function(A,h,f,d,v,g){var y=s?s+A:A;if(!this._events[y])return!1;var p=this._events[y],m=arguments.length,w,x;if(p.fn){switch(p.once&&this.removeListener(A,p.fn,void 0,!0),m){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,h),!0;case 3:return p.fn.call(p.context,h,f),!0;case 4:return p.fn.call(p.context,h,f,d),!0;case 5:return p.fn.call(p.context,h,f,d,v),!0;case 6:return p.fn.call(p.context,h,f,d,v,g),!0}for(x=1,w=new Array(m-1);x<m;x++)w[x-1]=arguments[x];p.fn.apply(p.context,w)}else{var b=p.length,B;for(x=0;x<b;x++)switch(p[x].once&&this.removeListener(A,p[x].fn,void 0,!0),m){case 1:p[x].fn.call(p[x].context);break;case 2:p[x].fn.call(p[x].context,h);break;case 3:p[x].fn.call(p[x].context,h,f);break;case 4:p[x].fn.call(p[x].context,h,f,d);break;default:if(!w)for(B=1,w=new Array(m-1);B<m;B++)w[B-1]=arguments[B];p[x].fn.apply(p[x].context,w)}}return!0},c.prototype.on=function(A,h,f){var d=new l(h,f||this),v=s?s+A:A;return this._events[v]?this._events[v].fn?this._events[v]=[this._events[v],d]:this._events[v].push(d):(this._events[v]=d,this._eventsCount++),this},c.prototype.once=function(A,h,f){var d=new l(h,f||this,!0),v=s?s+A:A;return this._events[v]?this._events[v].fn?this._events[v]=[this._events[v],d]:this._events[v].push(d):(this._events[v]=d,this._eventsCount++),this},c.prototype.removeListener=function(A,h,f,d){var v=s?s+A:A;if(!this._events[v])return this;if(!h)return--this._eventsCount===0?this._events=new o:delete this._events[v],this;var g=this._events[v];if(g.fn)g.fn===h&&(!d||g.once)&&(!f||g.context===f)&&(--this._eventsCount===0?this._events=new o:delete this._events[v]);else{for(var y=0,p=[],m=g.length;y<m;y++)(g[y].fn!==h||d&&!g[y].once||f&&g[y].context!==f)&&p.push(g[y]);p.length?this._events[v]=p.length===1?p[0]:p:--this._eventsCount===0?this._events=new o:delete this._events[v]}return this},c.prototype.removeAllListeners=function(A){var h;return A?(h=s?s+A:A,this._events[h]&&(--this._eventsCount===0?this._events=new o:delete this._events[h])):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prototype.setMaxListeners=function(){return this},c.prefixed=s,c.EventEmitter=c,typeof r<"u"&&(r.exports=c)},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(pe){return typeof pe}:function(pe){return pe&&typeof Symbol=="function"&&pe.constructor===Symbol&&pe!==Symbol.prototype?"symbol":typeof pe},o=function(){function pe(we,Te){var he=[],ce=!0,Se=!1,Pe=void 0;try{for(var Le=we[Symbol.iterator](),Xe;!(ce=(Xe=Le.next()).done)&&(he.push(Xe.value),!(Te&&he.length===Te));ce=!0);}catch(fe){Se=!0,Pe=fe}finally{try{!ce&&Le.return&&Le.return()}finally{if(Se)throw Pe}}return he}return function(we,Te){if(Array.isArray(we))return we;if(Symbol.iterator in Object(we))return pe(we,Te);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function pe(we,Te){for(var he=0;he<Te.length;he++){var ce=Te[he];ce.enumerable=ce.enumerable||!1,ce.configurable=!0,"value"in ce&&(ce.writable=!0),Object.defineProperty(we,ce.key,ce)}}return function(we,Te,he){return Te&&pe(we.prototype,Te),he&&pe(we,he),we}}(),c=a(3),u=j(c),A=a(2),h=j(A),f=a(0),d=j(f),v=a(5),g=j(v),y=a(10),p=j(y),m=a(9),w=j(m),x=a(36),b=a(37),B=a(13),_=j(B),k=a(26),E=a(38),T=a(39),S=a(40);function j(pe){return pe&&pe.__esModule?pe:{default:pe}}function I(pe,we,Te){return we in pe?Object.defineProperty(pe,we,{value:Te,enumerable:!0,configurable:!0,writable:!0}):pe[we]=Te,pe}function U(pe,we){if(!(pe instanceof we))throw new TypeError("Cannot call a class as a function")}function q(pe,we){if(!pe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return we&&(typeof we=="object"||typeof we=="function")?we:pe}function V(pe,we){if(typeof we!="function"&&we!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof we);pe.prototype=Object.create(we&&we.prototype,{constructor:{value:pe,enumerable:!1,writable:!0,configurable:!0}}),we&&(Object.setPrototypeOf?Object.setPrototypeOf(pe,we):pe.__proto__=we)}var X=(0,p.default)("quill:clipboard"),W="__ql-matcher",M=[[Node.TEXT_NODE,De],[Node.TEXT_NODE,be],["br",ye],[Node.ELEMENT_NODE,be],[Node.ELEMENT_NODE,z],[Node.ELEMENT_NODE,ae],[Node.ELEMENT_NODE,te],[Node.ELEMENT_NODE,Ie],["li",ke],["b",J.bind(J,"bold")],["i",J.bind(J,"italic")],["style",re]],G=[x.AlignAttribute,E.DirectionAttribute].reduce(function(pe,we){return pe[we.keyName]=we,pe},{}),H=[x.AlignStyle,b.BackgroundStyle,k.ColorStyle,E.DirectionStyle,T.FontStyle,S.SizeStyle].reduce(function(pe,we){return pe[we.keyName]=we,pe},{}),C=function(pe){V(we,pe);function we(Te,he){U(this,we);var ce=q(this,(we.__proto__||Object.getPrototypeOf(we)).call(this,Te,he));return ce.quill.root.addEventListener("paste",ce.onPaste.bind(ce)),ce.container=ce.quill.addContainer("ql-clipboard"),ce.container.setAttribute("contenteditable",!0),ce.container.setAttribute("tabindex",-1),ce.matchers=[],M.concat(ce.options.matchers).forEach(function(Se){var Pe=o(Se,2),Le=Pe[0],Xe=Pe[1];!he.matchVisual&&Xe===ae||ce.addMatcher(Le,Xe)}),ce}return l(we,[{key:"addMatcher",value:function(he,ce){this.matchers.push([he,ce])}},{key:"convert",value:function(he){if(typeof he=="string")return this.container.innerHTML=he.replace(/\>\r?\n +\</g,"><"),this.convert();var ce=this.quill.getFormat(this.quill.selection.savedRange.index);if(ce[_.default.blotName]){var Se=this.container.innerText;return this.container.innerHTML="",new h.default().insert(Se,I({},_.default.blotName,ce[_.default.blotName]))}var Pe=this.prepareMatching(),Le=o(Pe,2),Xe=Le[0],fe=Le[1],Ee=Q(this.container,Xe,fe);return D(Ee,`
`)&&Ee.ops[Ee.ops.length-1].attributes==null&&(Ee=Ee.compose(new h.default().retain(Ee.length()-1).delete(1))),X.log("convert",this.container.innerHTML,Ee),this.container.innerHTML="",Ee}},{key:"dangerouslyPasteHTML",value:function(he,ce){var Se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.default.sources.API;if(typeof he=="string")this.quill.setContents(this.convert(he),ce),this.quill.setSelection(0,g.default.sources.SILENT);else{var Pe=this.convert(ce);this.quill.updateContents(new h.default().retain(he).concat(Pe),Se),this.quill.setSelection(he+Pe.length(),g.default.sources.SILENT)}}},{key:"onPaste",value:function(he){var ce=this;if(!(he.defaultPrevented||!this.quill.isEnabled())){var Se=this.quill.getSelection(),Pe=new h.default().retain(Se.index),Le=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(g.default.sources.SILENT),setTimeout(function(){Pe=Pe.concat(ce.convert()).delete(Se.length),ce.quill.updateContents(Pe,g.default.sources.USER),ce.quill.setSelection(Pe.length()-Se.length,g.default.sources.SILENT),ce.quill.scrollingContainer.scrollTop=Le,ce.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var he=this,ce=[],Se=[];return this.matchers.forEach(function(Pe){var Le=o(Pe,2),Xe=Le[0],fe=Le[1];switch(Xe){case Node.TEXT_NODE:Se.push(fe);break;case Node.ELEMENT_NODE:ce.push(fe);break;default:[].forEach.call(he.container.querySelectorAll(Xe),function(Ee){Ee[W]=Ee[W]||[],Ee[W].push(fe)});break}}),[ce,Se]}}]),we}(w.default);C.DEFAULTS={matchers:[],matchVisual:!0};function L(pe,we,Te){return(typeof we>"u"?"undefined":s(we))==="object"?Object.keys(we).reduce(function(he,ce){return L(he,ce,we[ce])},pe):pe.reduce(function(he,ce){return ce.attributes&&ce.attributes[we]?he.push(ce):he.insert(ce.insert,(0,u.default)({},I({},we,Te),ce.attributes))},new h.default)}function O(pe){if(pe.nodeType!==Node.ELEMENT_NODE)return{};var we="__ql-computed-style";return pe[we]||(pe[we]=window.getComputedStyle(pe))}function D(pe,we){for(var Te="",he=pe.ops.length-1;he>=0&&Te.length<we.length;--he){var ce=pe.ops[he];if(typeof ce.insert!="string")break;Te=ce.insert+Te}return Te.slice(-1*we.length)===we}function P(pe){if(pe.childNodes.length===0)return!1;var we=O(pe);return["block","list-item"].indexOf(we.display)>-1}function Q(pe,we,Te){return pe.nodeType===pe.TEXT_NODE?Te.reduce(function(he,ce){return ce(pe,he)},new h.default):pe.nodeType===pe.ELEMENT_NODE?[].reduce.call(pe.childNodes||[],function(he,ce){var Se=Q(ce,we,Te);return ce.nodeType===pe.ELEMENT_NODE&&(Se=we.reduce(function(Pe,Le){return Le(ce,Pe)},Se),Se=(ce[W]||[]).reduce(function(Pe,Le){return Le(ce,Pe)},Se)),he.concat(Se)},new h.default):new h.default}function J(pe,we,Te){return L(Te,pe,!0)}function te(pe,we){var Te=d.default.Attributor.Attribute.keys(pe),he=d.default.Attributor.Class.keys(pe),ce=d.default.Attributor.Style.keys(pe),Se={};return Te.concat(he).concat(ce).forEach(function(Pe){var Le=d.default.query(Pe,d.default.Scope.ATTRIBUTE);Le!=null&&(Se[Le.attrName]=Le.value(pe),Se[Le.attrName])||(Le=G[Pe],Le!=null&&(Le.attrName===Pe||Le.keyName===Pe)&&(Se[Le.attrName]=Le.value(pe)||void 0),Le=H[Pe],Le!=null&&(Le.attrName===Pe||Le.keyName===Pe)&&(Le=H[Pe],Se[Le.attrName]=Le.value(pe)||void 0))}),Object.keys(Se).length>0&&(we=L(we,Se)),we}function z(pe,we){var Te=d.default.query(pe);if(Te==null)return we;if(Te.prototype instanceof d.default.Embed){var he={},ce=Te.value(pe);ce!=null&&(he[Te.blotName]=ce,we=new h.default().insert(he,Te.formats(pe)))}else typeof Te.formats=="function"&&(we=L(we,Te.blotName,Te.formats(pe)));return we}function ye(pe,we){return D(we,`
`)||we.insert(`
`),we}function re(){return new h.default}function ke(pe,we){var Te=d.default.query(pe);if(Te==null||Te.blotName!=="list-item"||!D(we,`
`))return we;for(var he=-1,ce=pe.parentNode;!ce.classList.contains("ql-clipboard");)(d.default.query(ce)||{}).blotName==="list"&&(he+=1),ce=ce.parentNode;return he<=0?we:we.compose(new h.default().retain(we.length()-1).retain(1,{indent:he}))}function be(pe,we){return D(we,`
`)||(P(pe)||we.length()>0&&pe.nextSibling&&P(pe.nextSibling))&&we.insert(`
`),we}function ae(pe,we){if(P(pe)&&pe.nextElementSibling!=null&&!D(we,`

`)){var Te=pe.offsetHeight+parseFloat(O(pe).marginTop)+parseFloat(O(pe).marginBottom);pe.nextElementSibling.offsetTop>pe.offsetTop+Te*1.5&&we.insert(`
`)}return we}function Ie(pe,we){var Te={},he=pe.style||{};return he.fontStyle&&O(pe).fontStyle==="italic"&&(Te.italic=!0),he.fontWeight&&(O(pe).fontWeight.startsWith("bold")||parseInt(O(pe).fontWeight)>=700)&&(Te.bold=!0),Object.keys(Te).length>0&&(we=L(we,Te)),parseFloat(he.textIndent||0)>0&&(we=new h.default().insert("	").concat(we)),we}function De(pe,we){var Te=pe.data;if(pe.parentNode.tagName==="O:P")return we.insert(Te.trim());if(Te.trim().length===0&&pe.parentNode.classList.contains("ql-clipboard"))return we;if(!O(pe.parentNode).whiteSpace.startsWith("pre")){var he=function(Se,Pe){return Pe=Pe.replace(/[^\u00a0]/g,""),Pe.length<1&&Se?" ":Pe};Te=Te.replace(/\r\n/g," ").replace(/\n/g," "),Te=Te.replace(/\s\s+/g,he.bind(he,!0)),(pe.previousSibling==null&&P(pe.parentNode)||pe.previousSibling!=null&&P(pe.previousSibling))&&(Te=Te.replace(/^\s+/,he.bind(he,!1))),(pe.nextSibling==null&&P(pe.parentNode)||pe.nextSibling!=null&&P(pe.nextSibling))&&(Te=Te.replace(/\s+$/,he.bind(he,!1)))}return we.insert(Te)}n.default=C,n.matchAttributor=te,n.matchBlot=z,n.matchNewline=be,n.matchSpacing=ae,n.matchText=De},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(g,y){for(var p=0;p<y.length;p++){var m=y[p];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(g,m.key,m)}}return function(g,y,p){return y&&v(g.prototype,y),p&&v(g,p),g}}(),o=function v(g,y,p){g===null&&(g=Function.prototype);var m=Object.getOwnPropertyDescriptor(g,y);if(m===void 0){var w=Object.getPrototypeOf(g);return w===null?void 0:v(w,y,p)}else{if("value"in m)return m.value;var x=m.get;return x===void 0?void 0:x.call(p)}},l=a(6),c=u(l);function u(v){return v&&v.__esModule?v:{default:v}}function A(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")}function h(v,g){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:v}function f(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);v.prototype=Object.create(g&&g.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(v,g):v.__proto__=g)}var d=function(v){f(g,v);function g(){return A(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"optimize",value:function(p){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"optimize",this).call(this,p),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),g}(c.default);d.blotName="bold",d.tagName=["STRONG","B"],n.default=d},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function S(j,I){var U=[],q=!0,V=!1,X=void 0;try{for(var W=j[Symbol.iterator](),M;!(q=(M=W.next()).done)&&(U.push(M.value),!(I&&U.length===I));q=!0);}catch(G){V=!0,X=G}finally{try{!q&&W.return&&W.return()}finally{if(V)throw X}}return U}return function(j,I){if(Array.isArray(j))return j;if(Symbol.iterator in Object(j))return S(j,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function S(j,I){for(var U=0;U<I.length;U++){var q=I[U];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(j,q.key,q)}}return function(j,I,U){return I&&S(j.prototype,I),U&&S(j,U),j}}(),l=a(2),c=p(l),u=a(0),A=p(u),h=a(5),f=p(h),d=a(10),v=p(d),g=a(9),y=p(g);function p(S){return S&&S.__esModule?S:{default:S}}function m(S,j,I){return j in S?Object.defineProperty(S,j,{value:I,enumerable:!0,configurable:!0,writable:!0}):S[j]=I,S}function w(S,j){if(!(S instanceof j))throw new TypeError("Cannot call a class as a function")}function x(S,j){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:S}function b(S,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);S.prototype=Object.create(j&&j.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(S,j):S.__proto__=j)}var B=(0,v.default)("quill:toolbar"),_=function(S){b(j,S);function j(I,U){w(this,j);var q=x(this,(j.__proto__||Object.getPrototypeOf(j)).call(this,I,U));if(Array.isArray(q.options.container)){var V=document.createElement("div");E(V,q.options.container),I.container.parentNode.insertBefore(V,I.container),q.container=V}else typeof q.options.container=="string"?q.container=document.querySelector(q.options.container):q.container=q.options.container;if(!(q.container instanceof HTMLElement)){var X;return X=B.error("Container required for toolbar",q.options),x(q,X)}return q.container.classList.add("ql-toolbar"),q.controls=[],q.handlers={},Object.keys(q.options.handlers).forEach(function(W){q.addHandler(W,q.options.handlers[W])}),[].forEach.call(q.container.querySelectorAll("button, select"),function(W){q.attach(W)}),q.quill.on(f.default.events.EDITOR_CHANGE,function(W,M){W===f.default.events.SELECTION_CHANGE&&q.update(M)}),q.quill.on(f.default.events.SCROLL_OPTIMIZE,function(){var W=q.quill.selection.getRange(),M=s(W,1),G=M[0];q.update(G)}),q}return o(j,[{key:"addHandler",value:function(U,q){this.handlers[U]=q}},{key:"attach",value:function(U){var q=this,V=[].find.call(U.classList,function(W){return W.indexOf("ql-")===0});if(V){if(V=V.slice(3),U.tagName==="BUTTON"&&U.setAttribute("type","button"),this.handlers[V]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[V]==null){B.warn("ignoring attaching to disabled format",V,U);return}if(A.default.query(V)==null){B.warn("ignoring attaching to nonexistent format",V,U);return}}var X=U.tagName==="SELECT"?"change":"click";U.addEventListener(X,function(W){var M=void 0;if(U.tagName==="SELECT"){if(U.selectedIndex<0)return;var G=U.options[U.selectedIndex];G.hasAttribute("selected")?M=!1:M=G.value||!1}else U.classList.contains("ql-active")?M=!1:M=U.value||!U.hasAttribute("value"),W.preventDefault();q.quill.focus();var H=q.quill.selection.getRange(),C=s(H,1),L=C[0];if(q.handlers[V]!=null)q.handlers[V].call(q,M);else if(A.default.query(V).prototype instanceof A.default.Embed){if(M=prompt("Enter "+V),!M)return;q.quill.updateContents(new c.default().retain(L.index).delete(L.length).insert(m({},V,M)),f.default.sources.USER)}else q.quill.format(V,M,f.default.sources.USER);q.update(L)}),this.controls.push([V,U])}}},{key:"update",value:function(U){var q=U==null?{}:this.quill.getFormat(U);this.controls.forEach(function(V){var X=s(V,2),W=X[0],M=X[1];if(M.tagName==="SELECT"){var G=void 0;if(U==null)G=null;else if(q[W]==null)G=M.querySelector("option[selected]");else if(!Array.isArray(q[W])){var H=q[W];typeof H=="string"&&(H=H.replace(/\"/g,'\\"')),G=M.querySelector('option[value="'+H+'"]')}G==null?(M.value="",M.selectedIndex=-1):G.selected=!0}else if(U==null)M.classList.remove("ql-active");else if(M.hasAttribute("value")){var C=q[W]===M.getAttribute("value")||q[W]!=null&&q[W].toString()===M.getAttribute("value")||q[W]==null&&!M.getAttribute("value");M.classList.toggle("ql-active",C)}else M.classList.toggle("ql-active",q[W]!=null)})}}]),j}(y.default);_.DEFAULTS={};function k(S,j,I){var U=document.createElement("button");U.setAttribute("type","button"),U.classList.add("ql-"+j),I!=null&&(U.value=I),S.appendChild(U)}function E(S,j){Array.isArray(j[0])||(j=[j]),j.forEach(function(I){var U=document.createElement("span");U.classList.add("ql-formats"),I.forEach(function(q){if(typeof q=="string")k(U,q);else{var V=Object.keys(q)[0],X=q[V];Array.isArray(X)?T(U,V,X):k(U,V,X)}}),S.appendChild(U)})}function T(S,j,I){var U=document.createElement("select");U.classList.add("ql-"+j),I.forEach(function(q){var V=document.createElement("option");q!==!1?V.setAttribute("value",q):V.setAttribute("selected","selected"),U.appendChild(V)}),S.appendChild(U)}_.DEFAULTS={container:null,handlers:{clean:function(){var j=this,I=this.quill.getSelection();if(I!=null)if(I.length==0){var U=this.quill.getFormat();Object.keys(U).forEach(function(q){A.default.query(q,A.default.Scope.INLINE)!=null&&j.quill.format(q,!1)})}else this.quill.removeFormat(I,f.default.sources.USER)},direction:function(j){var I=this.quill.getFormat().align;j==="rtl"&&I==null?this.quill.format("align","right",f.default.sources.USER):!j&&I==="right"&&this.quill.format("align",!1,f.default.sources.USER),this.quill.format("direction",j,f.default.sources.USER)},indent:function(j){var I=this.quill.getSelection(),U=this.quill.getFormat(I),q=parseInt(U.indent||0);if(j==="+1"||j==="-1"){var V=j==="+1"?1:-1;U.direction==="rtl"&&(V*=-1),this.quill.format("indent",q+V,f.default.sources.USER)}},link:function(j){j===!0&&(j=prompt("Enter link URL:")),this.quill.format("link",j,f.default.sources.USER)},list:function(j){var I=this.quill.getSelection(),U=this.quill.getFormat(I);j==="check"?U.list==="checked"||U.list==="unchecked"?this.quill.format("list",!1,f.default.sources.USER):this.quill.format("list","unchecked",f.default.sources.USER):this.quill.format("list",j,f.default.sources.USER)}}},n.default=_,n.addControls=E},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(g,y){for(var p=0;p<y.length;p++){var m=y[p];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(g,m.key,m)}}return function(g,y,p){return y&&v(g.prototype,y),p&&v(g,p),g}}(),o=function v(g,y,p){g===null&&(g=Function.prototype);var m=Object.getOwnPropertyDescriptor(g,y);if(m===void 0){var w=Object.getPrototypeOf(g);return w===null?void 0:v(w,y,p)}else{if("value"in m)return m.value;var x=m.get;return x===void 0?void 0:x.call(p)}},l=a(28),c=u(l);function u(v){return v&&v.__esModule?v:{default:v}}function A(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")}function h(v,g){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:v}function f(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);v.prototype=Object.create(g&&g.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(v,g):v.__proto__=g)}var d=function(v){f(g,v);function g(y,p){A(this,g);var m=h(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return m.label.innerHTML=p,m.container.classList.add("ql-color-picker"),[].slice.call(m.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(w){w.classList.add("ql-primary")}),m}return s(g,[{key:"buildItem",value:function(p){var m=o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"buildItem",this).call(this,p);return m.style.backgroundColor=p.getAttribute("value")||"",m}},{key:"selectItem",value:function(p,m){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"selectItem",this).call(this,p,m);var w=this.label.querySelector(".ql-color-label"),x=p&&p.getAttribute("data-value")||"";w&&(w.tagName==="line"?w.style.stroke=x:w.style.fill=x)}}]),g}(c.default);n.default=d},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(g,y){for(var p=0;p<y.length;p++){var m=y[p];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(g,m.key,m)}}return function(g,y,p){return y&&v(g.prototype,y),p&&v(g,p),g}}(),o=function v(g,y,p){g===null&&(g=Function.prototype);var m=Object.getOwnPropertyDescriptor(g,y);if(m===void 0){var w=Object.getPrototypeOf(g);return w===null?void 0:v(w,y,p)}else{if("value"in m)return m.value;var x=m.get;return x===void 0?void 0:x.call(p)}},l=a(28),c=u(l);function u(v){return v&&v.__esModule?v:{default:v}}function A(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")}function h(v,g){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:v}function f(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);v.prototype=Object.create(g&&g.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(v,g):v.__proto__=g)}var d=function(v){f(g,v);function g(y,p){A(this,g);var m=h(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return m.container.classList.add("ql-icon-picker"),[].forEach.call(m.container.querySelectorAll(".ql-picker-item"),function(w){w.innerHTML=p[w.getAttribute("data-value")||""]}),m.defaultItem=m.container.querySelector(".ql-selected"),m.selectItem(m.defaultItem),m}return s(g,[{key:"selectItem",value:function(p,m){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"selectItem",this).call(this,p,m),p=p||this.defaultItem,this.label.innerHTML=p.innerHTML}}]),g}(c.default);n.default=d},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function c(u,A){for(var h=0;h<A.length;h++){var f=A[h];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(u,f.key,f)}}return function(u,A,h){return A&&c(u.prototype,A),h&&c(u,h),u}}();function o(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}var l=function(){function c(u,A){var h=this;o(this,c),this.quill=u,this.boundsContainer=A||document.body,this.root=u.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){h.root.style.marginTop=-1*h.quill.root.scrollTop+"px"}),this.hide()}return s(c,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(A){var h=A.left+A.width/2-this.root.offsetWidth/2,f=A.bottom+this.quill.root.scrollTop;this.root.style.left=h+"px",this.root.style.top=f+"px",this.root.classList.remove("ql-flip");var d=this.boundsContainer.getBoundingClientRect(),v=this.root.getBoundingClientRect(),g=0;if(v.right>d.right&&(g=d.right-v.right,this.root.style.left=h+g+"px"),v.left<d.left&&(g=d.left-v.left,this.root.style.left=h+g+"px"),v.bottom>d.bottom){var y=v.bottom-v.top,p=A.bottom-A.top+y;this.root.style.top=f-p+"px",this.root.classList.add("ql-flip")}return g}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),c}();n.default=l},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function T(S,j){var I=[],U=!0,q=!1,V=void 0;try{for(var X=S[Symbol.iterator](),W;!(U=(W=X.next()).done)&&(I.push(W.value),!(j&&I.length===j));U=!0);}catch(M){q=!0,V=M}finally{try{!U&&X.return&&X.return()}finally{if(q)throw V}}return I}return function(S,j){if(Array.isArray(S))return S;if(Symbol.iterator in Object(S))return T(S,j);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function T(S,j,I){S===null&&(S=Function.prototype);var U=Object.getOwnPropertyDescriptor(S,j);if(U===void 0){var q=Object.getPrototypeOf(S);return q===null?void 0:T(q,j,I)}else{if("value"in U)return U.value;var V=U.get;return V===void 0?void 0:V.call(I)}},l=function(){function T(S,j){for(var I=0;I<j.length;I++){var U=j[I];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(S,U.key,U)}}return function(S,j,I){return j&&T(S.prototype,j),I&&T(S,I),S}}(),c=a(3),u=w(c),A=a(8),h=w(A),f=a(43),d=w(f),v=a(27),g=w(v),y=a(15),p=a(41),m=w(p);function w(T){return T&&T.__esModule?T:{default:T}}function x(T,S){if(!(T instanceof S))throw new TypeError("Cannot call a class as a function")}function b(T,S){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:T}function B(T,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);T.prototype=Object.create(S&&S.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(T,S):T.__proto__=S)}var _=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],k=function(T){B(S,T);function S(j,I){x(this,S),I.modules.toolbar!=null&&I.modules.toolbar.container==null&&(I.modules.toolbar.container=_);var U=b(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,j,I));return U.quill.container.classList.add("ql-snow"),U}return l(S,[{key:"extendToolbar",value:function(I){I.container.classList.add("ql-snow"),this.buildButtons([].slice.call(I.container.querySelectorAll("button")),m.default),this.buildPickers([].slice.call(I.container.querySelectorAll("select")),m.default),this.tooltip=new E(this.quill,this.options.bounds),I.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(U,q){I.handlers.link.call(I,!q.format.link)})}}]),S}(d.default);k.DEFAULTS=(0,u.default)(!0,{},d.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(S){if(S){var j=this.quill.getSelection();if(j==null||j.length==0)return;var I=this.quill.getText(j);/^\S+@\S+\.\S+$/.test(I)&&I.indexOf("mailto:")!==0&&(I="mailto:"+I);var U=this.quill.theme.tooltip;U.edit("link",I)}else this.quill.format("link",!1)}}}}});var E=function(T){B(S,T);function S(j,I){x(this,S);var U=b(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,j,I));return U.preview=U.root.querySelector("a.ql-preview"),U}return l(S,[{key:"listen",value:function(){var I=this;o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(U){I.root.classList.contains("ql-editing")?I.save():I.edit("link",I.preview.textContent),U.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(U){if(I.linkRange!=null){var q=I.linkRange;I.restoreFocus(),I.quill.formatText(q,"link",!1,h.default.sources.USER),delete I.linkRange}U.preventDefault(),I.hide()}),this.quill.on(h.default.events.SELECTION_CHANGE,function(U,q,V){if(U!=null){if(U.length===0&&V===h.default.sources.USER){var X=I.quill.scroll.descendant(g.default,U.index),W=s(X,2),M=W[0],G=W[1];if(M!=null){I.linkRange=new y.Range(U.index-G,M.length());var H=g.default.formats(M.domNode);I.preview.textContent=H,I.preview.setAttribute("href",H),I.show(),I.position(I.quill.getBounds(I.linkRange));return}}else delete I.linkRange;I.hide()}})}},{key:"show",value:function(){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),S}(f.BaseTooltip);E.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=k},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(29),o=ce(s),l=a(36),c=a(38),u=a(64),A=a(65),h=ce(A),f=a(66),d=ce(f),v=a(67),g=ce(v),y=a(37),p=a(26),m=a(39),w=a(40),x=a(56),b=ce(x),B=a(68),_=ce(B),k=a(27),E=ce(k),T=a(69),S=ce(T),j=a(70),I=ce(j),U=a(71),q=ce(U),V=a(72),X=ce(V),W=a(73),M=ce(W),G=a(13),H=ce(G),C=a(74),L=ce(C),O=a(75),D=ce(O),P=a(57),Q=ce(P),J=a(41),te=ce(J),z=a(28),ye=ce(z),re=a(59),ke=ce(re),be=a(60),ae=ce(be),Ie=a(61),De=ce(Ie),pe=a(108),we=ce(pe),Te=a(62),he=ce(Te);function ce(Se){return Se&&Se.__esModule?Se:{default:Se}}o.default.register({"attributors/attribute/direction":c.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":y.BackgroundClass,"attributors/class/color":p.ColorClass,"attributors/class/direction":c.DirectionClass,"attributors/class/font":m.FontClass,"attributors/class/size":w.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":y.BackgroundStyle,"attributors/style/color":p.ColorStyle,"attributors/style/direction":c.DirectionStyle,"attributors/style/font":m.FontStyle,"attributors/style/size":w.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":c.DirectionClass,"formats/indent":u.IndentClass,"formats/background":y.BackgroundStyle,"formats/color":p.ColorStyle,"formats/font":m.FontClass,"formats/size":w.SizeClass,"formats/blockquote":h.default,"formats/code-block":H.default,"formats/header":d.default,"formats/list":g.default,"formats/bold":b.default,"formats/code":G.Code,"formats/italic":_.default,"formats/link":E.default,"formats/script":S.default,"formats/strike":I.default,"formats/underline":q.default,"formats/image":X.default,"formats/video":M.default,"formats/list/item":v.ListItem,"modules/formula":L.default,"modules/syntax":D.default,"modules/toolbar":Q.default,"themes/bubble":we.default,"themes/snow":he.default,"ui/icons":te.default,"ui/picker":ye.default,"ui/icon-picker":ae.default,"ui/color-picker":ke.default,"ui/tooltip":De.default},!0),n.default=o.default},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function g(y,p){for(var m=0;m<p.length;m++){var w=p[m];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,p,m){return p&&g(y.prototype,p),m&&g(y,m),y}}(),o=function g(y,p,m){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,p);if(w===void 0){var x=Object.getPrototypeOf(y);return x===null?void 0:g(x,p,m)}else{if("value"in w)return w.value;var b=w.get;return b===void 0?void 0:b.call(m)}},l=a(0),c=u(l);function u(g){return g&&g.__esModule?g:{default:g}}function A(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}function h(g,y){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:g}function f(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);g.prototype=Object.create(y&&y.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(g,y):g.__proto__=y)}var d=function(g){f(y,g);function y(){return A(this,y),h(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"add",value:function(m,w){if(w==="+1"||w==="-1"){var x=this.value(m)||0;w=w==="+1"?x+1:x-1}return w===0?(this.remove(m),!0):o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"add",this).call(this,m,w)}},{key:"canAdd",value:function(m,w){return o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"canAdd",this).call(this,m,w)||o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"canAdd",this).call(this,m,parseInt(w))}},{key:"value",value:function(m){return parseInt(o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"value",this).call(this,m))||void 0}}]),y}(c.default.Attributor.Class),v=new d("indent","ql-indent",{scope:c.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=v},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(4),o=l(s);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")}function u(f,d){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:f}function A(f,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);f.prototype=Object.create(d&&d.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(f,d):f.__proto__=d)}var h=function(f){A(d,f);function d(){return c(this,d),u(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(o.default);h.blotName="blockquote",h.tagName="blockquote",n.default=h},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function d(v,g){for(var y=0;y<g.length;y++){var p=g[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(v,p.key,p)}}return function(v,g,y){return g&&d(v.prototype,g),y&&d(v,y),v}}(),o=a(4),l=c(o);function c(d){return d&&d.__esModule?d:{default:d}}function u(d,v){if(!(d instanceof v))throw new TypeError("Cannot call a class as a function")}function A(d,v){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:d}function h(d,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);d.prototype=Object.create(v&&v.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(d,v):d.__proto__=v)}var f=function(d){h(v,d);function v(){return u(this,v),A(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return s(v,null,[{key:"formats",value:function(y){return this.tagName.indexOf(y.tagName)+1}}]),v}(l.default);f.blotName="header",f.tagName=["H1","H2","H3","H4","H5","H6"],n.default=f},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function x(b,B){for(var _=0;_<B.length;_++){var k=B[_];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(b,k.key,k)}}return function(b,B,_){return B&&x(b.prototype,B),_&&x(b,_),b}}(),o=function x(b,B,_){b===null&&(b=Function.prototype);var k=Object.getOwnPropertyDescriptor(b,B);if(k===void 0){var E=Object.getPrototypeOf(b);return E===null?void 0:x(E,B,_)}else{if("value"in k)return k.value;var T=k.get;return T===void 0?void 0:T.call(_)}},l=a(0),c=d(l),u=a(4),A=d(u),h=a(25),f=d(h);function d(x){return x&&x.__esModule?x:{default:x}}function v(x,b,B){return b in x?Object.defineProperty(x,b,{value:B,enumerable:!0,configurable:!0,writable:!0}):x[b]=B,x}function g(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function y(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function p(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var m=function(x){p(b,x);function b(){return g(this,b),y(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"format",value:function(_,k){_===w.blotName&&!k?this.replaceWith(c.default.create(this.statics.scope)):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,_,k)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(_,k){return this.parent.isolate(this.offset(this.parent),this.length()),_===this.parent.statics.blotName?(this.parent.replaceWith(_,k),this):(this.parent.unwrap(),o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"replaceWith",this).call(this,_,k))}}],[{key:"formats",value:function(_){return _.tagName===this.tagName?void 0:o(b.__proto__||Object.getPrototypeOf(b),"formats",this).call(this,_)}}]),b}(A.default);m.blotName="list-item",m.tagName="LI";var w=function(x){p(b,x),s(b,null,[{key:"create",value:function(_){var k=_==="ordered"?"OL":"UL",E=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,k);return(_==="checked"||_==="unchecked")&&E.setAttribute("data-checked",_==="checked"),E}},{key:"formats",value:function(_){if(_.tagName==="OL")return"ordered";if(_.tagName==="UL")return _.hasAttribute("data-checked")?_.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function b(B){g(this,b);var _=y(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,B)),k=function(T){if(T.target.parentNode===B){var S=_.statics.formats(B),j=c.default.find(T.target);S==="checked"?j.format("list","unchecked"):S==="unchecked"&&j.format("list","checked")}};return B.addEventListener("touchstart",k),B.addEventListener("mousedown",k),_}return s(b,[{key:"format",value:function(_,k){this.children.length>0&&this.children.tail.format(_,k)}},{key:"formats",value:function(){return v({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(_,k){if(_ instanceof m)o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"insertBefore",this).call(this,_,k);else{var E=k==null?this.length():k.offset(this),T=this.split(E);T.parent.insertBefore(_,T)}}},{key:"optimize",value:function(_){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"optimize",this).call(this,_);var k=this.next;k!=null&&k.prev===this&&k.statics.blotName===this.statics.blotName&&k.domNode.tagName===this.domNode.tagName&&k.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(k.moveChildren(this),k.remove())}},{key:"replace",value:function(_){if(_.statics.blotName!==this.statics.blotName){var k=c.default.create(this.statics.defaultChild);_.moveChildren(k),this.appendChild(k)}o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"replace",this).call(this,_)}}]),b}(f.default);w.blotName="list",w.scope=c.default.Scope.BLOCK_BLOT,w.tagName=["OL","UL"],w.defaultChild="list-item",w.allowedChildren=[m],n.ListItem=m,n.default=w},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(56),o=l(s);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")}function u(f,d){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:f}function A(f,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);f.prototype=Object.create(d&&d.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(f,d):f.__proto__=d)}var h=function(f){A(d,f);function d(){return c(this,d),u(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(o.default);h.blotName="italic",h.tagName=["EM","I"],n.default=h},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(g,y){for(var p=0;p<y.length;p++){var m=y[p];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(g,m.key,m)}}return function(g,y,p){return y&&v(g.prototype,y),p&&v(g,p),g}}(),o=function v(g,y,p){g===null&&(g=Function.prototype);var m=Object.getOwnPropertyDescriptor(g,y);if(m===void 0){var w=Object.getPrototypeOf(g);return w===null?void 0:v(w,y,p)}else{if("value"in m)return m.value;var x=m.get;return x===void 0?void 0:x.call(p)}},l=a(6),c=u(l);function u(v){return v&&v.__esModule?v:{default:v}}function A(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")}function h(v,g){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:v}function f(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);v.prototype=Object.create(g&&g.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(v,g):v.__proto__=g)}var d=function(v){f(g,v);function g(){return A(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,null,[{key:"create",value:function(p){return p==="super"?document.createElement("sup"):p==="sub"?document.createElement("sub"):o(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this,p)}},{key:"formats",value:function(p){if(p.tagName==="SUB")return"sub";if(p.tagName==="SUP")return"super"}}]),g}(c.default);d.blotName="script",d.tagName=["SUB","SUP"],n.default=d},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(6),o=l(s);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")}function u(f,d){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:f}function A(f,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);f.prototype=Object.create(d&&d.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(f,d):f.__proto__=d)}var h=function(f){A(d,f);function d(){return c(this,d),u(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(o.default);h.blotName="strike",h.tagName="S",n.default=h},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=a(6),o=l(s);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")}function u(f,d){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:f}function A(f,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);f.prototype=Object.create(d&&d.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(f,d):f.__proto__=d)}var h=function(f){A(d,f);function d(){return c(this,d),u(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(o.default);h.blotName="underline",h.tagName="U",n.default=h},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function y(p,m){for(var w=0;w<m.length;w++){var x=m[w];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,m,w){return m&&y(p.prototype,m),w&&y(p,w),p}}(),o=function y(p,m,w){p===null&&(p=Function.prototype);var x=Object.getOwnPropertyDescriptor(p,m);if(x===void 0){var b=Object.getPrototypeOf(p);return b===null?void 0:y(b,m,w)}else{if("value"in x)return x.value;var B=x.get;return B===void 0?void 0:B.call(w)}},l=a(0),c=A(l),u=a(27);function A(y){return y&&y.__esModule?y:{default:y}}function h(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}function f(y,p){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:y}function d(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}var v=["alt","height","width"],g=function(y){d(p,y);function p(){return h(this,p),f(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return s(p,[{key:"format",value:function(w,x){v.indexOf(w)>-1?x?this.domNode.setAttribute(w,x):this.domNode.removeAttribute(w):o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"format",this).call(this,w,x)}}],[{key:"create",value:function(w){var x=o(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this,w);return typeof w=="string"&&x.setAttribute("src",this.sanitize(w)),x}},{key:"formats",value:function(w){return v.reduce(function(x,b){return w.hasAttribute(b)&&(x[b]=w.getAttribute(b)),x},{})}},{key:"match",value:function(w){return/\.(jpe?g|gif|png)$/.test(w)||/^data:image\/.+;base64/.test(w)}},{key:"sanitize",value:function(w){return(0,u.sanitize)(w,["http","https","data"])?w:"//:0"}},{key:"value",value:function(w){return w.getAttribute("src")}}]),p}(c.default.Embed);g.blotName="image",g.tagName="IMG",n.default=g},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function y(p,m){for(var w=0;w<m.length;w++){var x=m[w];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,m,w){return m&&y(p.prototype,m),w&&y(p,w),p}}(),o=function y(p,m,w){p===null&&(p=Function.prototype);var x=Object.getOwnPropertyDescriptor(p,m);if(x===void 0){var b=Object.getPrototypeOf(p);return b===null?void 0:y(b,m,w)}else{if("value"in x)return x.value;var B=x.get;return B===void 0?void 0:B.call(w)}},l=a(4),c=a(27),u=A(c);function A(y){return y&&y.__esModule?y:{default:y}}function h(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}function f(y,p){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:y}function d(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}var v=["height","width"],g=function(y){d(p,y);function p(){return h(this,p),f(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return s(p,[{key:"format",value:function(w,x){v.indexOf(w)>-1?x?this.domNode.setAttribute(w,x):this.domNode.removeAttribute(w):o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"format",this).call(this,w,x)}}],[{key:"create",value:function(w){var x=o(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this,w);return x.setAttribute("frameborder","0"),x.setAttribute("allowfullscreen",!0),x.setAttribute("src",this.sanitize(w)),x}},{key:"formats",value:function(w){return v.reduce(function(x,b){return w.hasAttribute(b)&&(x[b]=w.getAttribute(b)),x},{})}},{key:"sanitize",value:function(w){return u.default.sanitize(w)}},{key:"value",value:function(w){return w.getAttribute("src")}}]),p}(l.BlockEmbed);g.blotName="video",g.className="ql-video",g.tagName="IFRAME",n.default=g},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function w(x,b){for(var B=0;B<b.length;B++){var _=b[B];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,_.key,_)}}return function(x,b,B){return b&&w(x.prototype,b),B&&w(x,B),x}}(),o=function w(x,b,B){x===null&&(x=Function.prototype);var _=Object.getOwnPropertyDescriptor(x,b);if(_===void 0){var k=Object.getPrototypeOf(x);return k===null?void 0:w(k,b,B)}else{if("value"in _)return _.value;var E=_.get;return E===void 0?void 0:E.call(B)}},l=a(35),c=d(l),u=a(5),A=d(u),h=a(9),f=d(h);function d(w){return w&&w.__esModule?w:{default:w}}function v(w,x){if(!(w instanceof x))throw new TypeError("Cannot call a class as a function")}function g(w,x){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:w}function y(w,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);w.prototype=Object.create(x&&x.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(w,x):w.__proto__=x)}var p=function(w){y(x,w);function x(){return v(this,x),g(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,null,[{key:"create",value:function(B){var _=o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,B);return typeof B=="string"&&(window.katex.render(B,_,{throwOnError:!1,errorColor:"#f00"}),_.setAttribute("data-value",B)),_}},{key:"value",value:function(B){return B.getAttribute("data-value")}}]),x}(c.default);p.blotName="formula",p.className="ql-formula",p.tagName="SPAN";var m=function(w){y(x,w),s(x,null,[{key:"register",value:function(){A.default.register(p,!0)}}]);function x(){v(this,x);var b=g(this,(x.__proto__||Object.getPrototypeOf(x)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return b}return x}(f.default);n.FormulaBlot=p,n.default=m},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function B(_,k){for(var E=0;E<k.length;E++){var T=k[E];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(_,T.key,T)}}return function(_,k,E){return k&&B(_.prototype,k),E&&B(_,E),_}}(),o=function B(_,k,E){_===null&&(_=Function.prototype);var T=Object.getOwnPropertyDescriptor(_,k);if(T===void 0){var S=Object.getPrototypeOf(_);return S===null?void 0:B(S,k,E)}else{if("value"in T)return T.value;var j=T.get;return j===void 0?void 0:j.call(E)}},l=a(0),c=g(l),u=a(5),A=g(u),h=a(9),f=g(h),d=a(13),v=g(d);function g(B){return B&&B.__esModule?B:{default:B}}function y(B,_){if(!(B instanceof _))throw new TypeError("Cannot call a class as a function")}function p(B,_){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:B}function m(B,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);B.prototype=Object.create(_&&_.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(B,_):B.__proto__=_)}var w=function(B){m(_,B);function _(){return y(this,_),p(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return s(_,[{key:"replaceWith",value:function(E){this.domNode.textContent=this.domNode.textContent,this.attach(),o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"replaceWith",this).call(this,E)}},{key:"highlight",value:function(E){var T=this.domNode.textContent;this.cachedText!==T&&((T.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=E(T),this.domNode.normalize(),this.attach()),this.cachedText=T)}}]),_}(v.default);w.className="ql-syntax";var x=new c.default.Attributor.Class("token","hljs",{scope:c.default.Scope.INLINE}),b=function(B){m(_,B),s(_,null,[{key:"register",value:function(){A.default.register(x,!0),A.default.register(w,!0)}}]);function _(k,E){y(this,_);var T=p(this,(_.__proto__||Object.getPrototypeOf(_)).call(this,k,E));if(typeof T.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var S=null;return T.quill.on(A.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(S),S=setTimeout(function(){T.highlight(),S=null},T.options.interval)}),T.highlight(),T}return s(_,[{key:"highlight",value:function(){var E=this;if(!this.quill.selection.composing){this.quill.update(A.default.sources.USER);var T=this.quill.getSelection();this.quill.scroll.descendants(w).forEach(function(S){S.highlight(E.options.highlight)}),this.quill.update(A.default.sources.SILENT),T!=null&&this.quill.setSelection(T,A.default.sources.SILENT)}}}]),_}(f.default);b.DEFAULTS={highlight:function(){return window.hljs==null?null:function(B){var _=window.hljs.highlightAuto(B);return _.value}}(),interval:1e3},n.CodeBlock=w,n.CodeToken=x,n.default=b},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(r,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function _(k,E,T){k===null&&(k=Function.prototype);var S=Object.getOwnPropertyDescriptor(k,E);if(S===void 0){var j=Object.getPrototypeOf(k);return j===null?void 0:_(j,E,T)}else{if("value"in S)return S.value;var I=S.get;return I===void 0?void 0:I.call(T)}},o=function(){function _(k,E){for(var T=0;T<E.length;T++){var S=E[T];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(k,S.key,S)}}return function(k,E,T){return E&&_(k.prototype,E),T&&_(k,T),k}}(),l=a(3),c=y(l),u=a(8),A=y(u),h=a(43),f=y(h),d=a(15),v=a(41),g=y(v);function y(_){return _&&_.__esModule?_:{default:_}}function p(_,k){if(!(_ instanceof k))throw new TypeError("Cannot call a class as a function")}function m(_,k){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:_}function w(_,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);_.prototype=Object.create(k&&k.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(_,k):_.__proto__=k)}var x=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],b=function(_){w(k,_);function k(E,T){p(this,k),T.modules.toolbar!=null&&T.modules.toolbar.container==null&&(T.modules.toolbar.container=x);var S=m(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,E,T));return S.quill.container.classList.add("ql-bubble"),S}return o(k,[{key:"extendToolbar",value:function(T){this.tooltip=new B(this.quill,this.options.bounds),this.tooltip.root.appendChild(T.container),this.buildButtons([].slice.call(T.container.querySelectorAll("button")),g.default),this.buildPickers([].slice.call(T.container.querySelectorAll("select")),g.default)}}]),k}(f.default);b.DEFAULTS=(0,c.default)(!0,{},f.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(k){k?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var B=function(_){w(k,_);function k(E,T){p(this,k);var S=m(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,E,T));return S.quill.on(A.default.events.EDITOR_CHANGE,function(j,I,U,q){if(j===A.default.events.SELECTION_CHANGE)if(I!=null&&I.length>0&&q===A.default.sources.USER){S.show(),S.root.style.left="0px",S.root.style.width="",S.root.style.width=S.root.offsetWidth+"px";var V=S.quill.getLines(I.index,I.length);if(V.length===1)S.position(S.quill.getBounds(I));else{var X=V[V.length-1],W=S.quill.getIndex(X),M=Math.min(X.length()-1,I.index+I.length-W),G=S.quill.getBounds(new d.Range(W,M));S.position(G)}}else document.activeElement!==S.textbox&&S.quill.hasFocus()&&S.hide()}),S}return o(k,[{key:"listen",value:function(){var T=this;s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){T.root.classList.remove("ql-editing")}),this.quill.on(A.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!T.root.classList.contains("ql-hidden")){var S=T.quill.getSelection();S!=null&&T.position(T.quill.getBounds(S))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(T){var S=s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"position",this).call(this,T),j=this.root.querySelector(".ql-tooltip-arrow");if(j.style.marginLeft="",S===0)return S;j.style.marginLeft=-1*S-j.offsetWidth/2+"px"}}]),k}(h.BaseTooltip);B.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=B,n.default=b},function(r,n,a){r.exports=a(63)}]).default})})(DF);var zK=DF.exports,XK=ti&&ti.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Og=ti&&ti.__assign||function(){return Og=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Og.apply(this,arguments)},YK=ti&&ti.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var s=arguments[t],o=0,l=s.length;o<l;o++,a++)n[a]=s[o];return n},Ox=ti&&ti.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_o=Ox(Z),JK=Ox(Y3),jf=Ox(WK),eB=Ox(zK),ZK=function(e){XK(t,e);function t(r){var n=e.call(this,r)||this;n.dirtyProps=["modules","formats","bounds","theme","children"],n.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],n.state={generation:0},n.selection=null,n.onEditorChange=function(s,o,l,c){var u,A,h,f;s==="text-change"?(A=(u=n).onEditorChangeText)===null||A===void 0||A.call(u,n.editor.root.innerHTML,o,c,n.unprivilegedEditor):s==="selection-change"&&((f=(h=n).onEditorChangeSelection)===null||f===void 0||f.call(h,o,c,n.unprivilegedEditor))};var a=n.isControlled()?r.value:r.defaultValue;return n.value=a??"",n}return t.prototype.validateProps=function(r){var n;if(_o.default.Children.count(r.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(_o.default.Children.count(r.children)){var a=_o.default.Children.only(r.children);if(((n=a)===null||n===void 0?void 0:n.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&r.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},t.prototype.shouldComponentUpdate=function(r,n){var a=this,s;if(this.validateProps(r),!this.editor||this.state.generation!==n.generation)return!0;if("value"in r){var o=this.getEditorContents(),l=(s=r.value,s??"");this.isEqualValue(l,o)||this.setEditorContents(this.editor,l)}return r.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,r.readOnly),YK(this.cleanProps,this.dirtyProps).some(function(c){return!jf.default(r[c],a.props[c])})},t.prototype.shouldComponentRegenerate=function(r){var n=this;return this.dirtyProps.some(function(a){return!jf.default(r[a],n.props[a])})},t.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},t.prototype.componentWillUnmount=function(){this.destroyEditor()},t.prototype.componentDidUpdate=function(r,n){var a=this;if(this.editor&&this.shouldComponentRegenerate(r)){var s=this.editor.getContents(),o=this.editor.getSelection();this.regenerationSnapshot={delta:s,selection:o},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==n.generation){var l=this.regenerationSnapshot,s=l.delta,c=l.selection;delete this.regenerationSnapshot,this.instantiateEditor();var u=this.editor;u.setContents(s),tB(function(){return a.setEditorSelection(u,c)})}},t.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},t.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},t.prototype.isControlled=function(){return"value"in this.props},t.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},t.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},t.prototype.createEditor=function(r,n){var a=new eB.default(r,n);return n.tabIndex!=null&&this.setEditorTabIndex(a,n.tabIndex),this.hookEditor(a),a},t.prototype.hookEditor=function(r){this.unprivilegedEditor=this.makeUnprivilegedEditor(r),r.on("editor-change",this.onEditorChange)},t.prototype.unhookEditor=function(r){r.off("editor-change",this.onEditorChange)},t.prototype.getEditorContents=function(){return this.value},t.prototype.getEditorSelection=function(){return this.selection},t.prototype.isDelta=function(r){return r&&r.ops},t.prototype.isEqualValue=function(r,n){return this.isDelta(r)&&this.isDelta(n)?jf.default(r.ops,n.ops):jf.default(r,n)},t.prototype.setEditorContents=function(r,n){var a=this;this.value=n;var s=this.getEditorSelection();typeof n=="string"?r.setContents(r.clipboard.convert(n)):r.setContents(n),tB(function(){return a.setEditorSelection(r,s)})},t.prototype.setEditorSelection=function(r,n){if(this.selection=n,n){var a=r.getLength();n.index=Math.max(0,Math.min(n.index,a-1)),n.length=Math.max(0,Math.min(n.length,a-1-n.index)),r.setSelection(n)}},t.prototype.setEditorTabIndex=function(r,n){var a,s;!((s=(a=r)===null||a===void 0?void 0:a.scroll)===null||s===void 0)&&s.domNode&&(r.scroll.domNode.tabIndex=n)},t.prototype.setEditorReadOnly=function(r,n){n?r.disable():r.enable()},t.prototype.makeUnprivilegedEditor=function(r){var n=r;return{getHTML:function(){return n.root.innerHTML},getLength:n.getLength.bind(n),getText:n.getText.bind(n),getContents:n.getContents.bind(n),getSelection:n.getSelection.bind(n),getBounds:n.getBounds.bind(n)}},t.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var r=JK.default.findDOMNode(this.editingArea);if(!r)throw new Error("Cannot find element for editing area");if(r.nodeType===3)throw new Error("Editing area cannot be a text node");return r},t.prototype.renderEditingArea=function(){var r=this,n=this.props,a=n.children,s=n.preserveWhitespace,o=this.state.generation,l={key:o,ref:function(c){r.editingArea=c}};return _o.default.Children.count(a)?_o.default.cloneElement(_o.default.Children.only(a),l):s?_o.default.createElement("pre",Og({},l)):_o.default.createElement("div",Og({},l))},t.prototype.render=function(){var r;return _o.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(r=this.props.className,r??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},t.prototype.onEditorChangeText=function(r,n,a,s){var o,l;if(this.editor){var c=this.isDelta(this.value)?s.getContents():s.getHTML();c!==this.getEditorContents()&&(this.lastDeltaChangeSet=n,this.value=c,(l=(o=this.props).onChange)===null||l===void 0||l.call(o,r,n,a,s))}},t.prototype.onEditorChangeSelection=function(r,n,a){var s,o,l,c,u,A;if(this.editor){var h=this.getEditorSelection(),f=!h&&r,d=h&&!r;jf.default(r,h)||(this.selection=r,(o=(s=this.props).onChangeSelection)===null||o===void 0||o.call(s,r,n,a),f?(c=(l=this.props).onFocus)===null||c===void 0||c.call(l,r,n,a):d&&((A=(u=this.props).onBlur)===null||A===void 0||A.call(u,h,n,a)))}},t.prototype.focus=function(){this.editor&&this.editor.focus()},t.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},t.displayName="React Quill",t.Quill=eB.default,t.defaultProps={theme:"snow",modules:{},readOnly:!1},t}(_o.default.Component);function tB(e){Promise.resolve().then(e)}var e$=ZK;const t$=DS(e$);function r$({isOpen:e,onClose:t,mode:r="compose",replyTo:n,onSend:a}){const[s,o]=Z.useState([]),[l,c]=Z.useState([]),[u,A]=Z.useState([]),[h,f]=Z.useState(!1),[d,v]=Z.useState(!1),[g,y]=Z.useState(""),[p,m]=Z.useState(""),[w,x]=Z.useState(""),[b,B]=Z.useState(""),[_,k]=Z.useState(""),[E,T]=Z.useState([]),[S,j]=Z.useState(!1),[I,U]=Z.useState(!1),[q,V]=Z.useState(!1),[X,W]=Z.useState([]),[M,G]=Z.useState(!1),[H,C]=Z.useState(null),[L,O]=Z.useState(!1),D=Z.useRef(null),P=Z.useRef(null),Q=Z.useRef(null),J=Z.useRef(null);Z.useEffect(()=>{if(r==="reply"&&n){B(n.subject.startsWith("Re: ")?n.subject:`Re: ${n.subject}`),o([{name:n.from,email:n.fromEmail}]);const ce=te(n);k(ce)}else if(r==="forward"&&n){B(n.subject.startsWith("Fwd: ")?n.subject:`Fwd: ${n.subject}`);const ce=z(n);k(ce)}},[r,n]),Z.useEffect(()=>{const ce=Se=>{J.current&&!J.current.contains(Se.target)&&G(!1)};if(M)return document.addEventListener("mousedown",ce),()=>document.removeEventListener("mousedown",ce)},[M]);const te=ce=>{var fe;if(!ce)return"";const Se=ce.date.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),Pe=ce.date.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),Le=`<div style="margin-top: 20px; color: #666;">On ${Se} at ${Pe}, ${ce.from} &lt;${ce.fromEmail}&gt; wrote:</div>`,Xe=`<blockquote style="margin: 10px 0 0 0; padding-left: 16px; border-left: 4px solid #ccc; color: #666;">${ce.htmlBody||((fe=ce.body)==null?void 0:fe.replace(/\n/g,"<br>"))||""}</blockquote>`;return`<p><br></p><p><br></p>${Le}${Xe}`},z=ce=>{var Le;if(!ce)return"";const Se=ce.date.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});return`<p><br></p><p><br></p>${`<div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ccc;">
      <div style="color: #666; margin-bottom: 10px;">---------- Forwarded message ---------</div>
      <div style="color: #666;"><strong>From:</strong> ${ce.from} &lt;${ce.fromEmail}&gt;</div>
      <div style="color: #666;"><strong>Date:</strong> ${Se}</div>
      <div style="color: #666;"><strong>Subject:</strong> ${ce.subject}</div>
      <div style="margin-top: 15px;">${ce.htmlBody||((Le=ce.body)==null?void 0:Le.replace(/\n/g,"<br>"))||""}</div>
    </div>`}`},ye=Z.useCallback(async ce=>{if(!ce||ce.length<2){W([]);return}try{const{data:Se}=await de.from("customers").select("customer_name, email, company_name").eq("is_active",!0).or(`customer_name.ilike.%${ce}%,email.ilike.%${ce}%,company_name.ilike.%${ce}%`).limit(5),{data:Pe}=await de.from("crm_contacts").select("contact_person, email, company_name").eq("is_active",!0).or(`contact_person.ilike.%${ce}%,email.ilike.%${ce}%,company_name.ilike.%${ce}%`).limit(5),Le=[...(Se||[]).map(Xe=>({name:Xe.customer_name,email:Xe.email,company:Xe.company_name})),...(Pe||[]).map(Xe=>({name:Xe.contact_person,email:Xe.email,company:Xe.company_name}))];W(Le),G(Le.length>0)}catch(Se){console.error("Error searching customers:",Se)}},[]),re=(ce,Se)=>{Se==="to"?y(ce):Se==="cc"?m(ce):x(ce),C(Se),ye(ce)},ke=(ce,Se)=>{const Pe={name:ce.name,email:ce.email};Se==="to"?(o([...s,Pe]),y("")):Se==="cc"?(c([...l,Pe]),m("")):(A([...u,Pe]),x("")),G(!1),W([])},be=(ce,Se)=>{Se==="to"?o(s.filter((Pe,Le)=>Le!==ce)):Se==="cc"?c(l.filter((Pe,Le)=>Le!==ce)):A(u.filter((Pe,Le)=>Le!==ce))},ae=(ce,Se)=>{const Pe=Se==="to"?g:Se==="cc"?p:w;if((ce.key==="Enter"||ce.key===","||ce.key===" ")&&Pe.trim()){if(ce.preventDefault(),Ie(Pe.trim())){const Le={name:Pe.trim(),email:Pe.trim()};Se==="to"?(o([...s,Le]),y("")):Se==="cc"?(c([...l,Le]),m("")):(A([...u,Le]),x("")),G(!1)}}else ce.key==="Backspace"&&!Pe&&(Se==="to"&&s.length>0?o(s.slice(0,-1)):Se==="cc"&&l.length>0?c(l.slice(0,-1)):Se==="bcc"&&u.length>0&&A(u.slice(0,-1)))},Ie=ce=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ce),De=ce=>{const Se=ce.target.files;if(!Se)return;const Pe=[];for(let Le=0;Le<Se.length;Le++){const Xe=Se[Le];if(Xe.size>25*1024*1024){alert(`File ${Xe.name} is too large. Maximum size is 25MB.`);continue}Pe.push({file:Xe,name:Xe.name,size:Xe.size})}T(Le=>[...Le,...Pe])},pe=ce=>{T(Se=>Se.filter((Pe,Le)=>Le!==ce))},we=ce=>ce<1024?ce+" B":ce<1024*1024?(ce/1024).toFixed(1)+" KB":(ce/(1024*1024)).toFixed(1)+" MB",Te=async()=>{const ce=[...s.map(Le=>Le.email)],Se=[...l.map(Le=>Le.email)],Pe=[...u.map(Le=>Le.email)];if(g.trim()&&Ie(g.trim())&&ce.push(g.trim()),p.trim()&&Ie(p.trim())&&Se.push(p.trim()),w.trim()&&Ie(w.trim())&&Pe.push(w.trim()),ce.length===0||!b||!_){alert("Please fill in recipient, subject, and message");return}j(!0);try{a&&await a({to:ce,cc:Se,bcc:Pe,subject:b,body:_,attachments:E.map(Le=>Le.file)}),alert("Email sent successfully!"),t()}catch(Le){console.error("Error sending email:",Le),alert("Failed to send email. Please try again.")}finally{j(!1)}},he={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","image"],["clean"]]};return e?I?i.jsx("div",{className:"fixed bottom-0 right-4 w-64 bg-gray-800 text-white rounded-t-lg shadow-xl z-50",children:i.jsxs("div",{className:"flex items-center justify-between px-4 py-2 cursor-pointer",onClick:()=>U(!1),children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Ii,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium truncate",children:b||"New Message"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:ce=>{ce.stopPropagation(),U(!1)},className:"p-1 hover:bg-gray-700 rounded",children:i.jsx(bN,{className:"w-4 h-4"})}),i.jsx("button",{onClick:ce=>{ce.stopPropagation(),t()},className:"p-1 hover:bg-gray-700 rounded",children:i.jsx(An,{className:"w-4 h-4"})})]})]})}):i.jsxs("div",{className:`fixed ${q?"inset-0":"bottom-0 right-6 w-[480px] h-[600px]"} bg-white rounded-t-lg shadow-2xl z-40 flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-50 border-b border-gray-200 rounded-t-lg",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:r==="reply"?"Reply":r==="forward"?"Forward":"New Message"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:()=>U(!0),className:"p-1.5 hover:bg-gray-200 rounded transition",title:"Minimize",children:i.jsx(kg,{className:"w-4 h-4 text-gray-600"})}),i.jsx("button",{onClick:()=>V(!q),className:"p-1.5 hover:bg-gray-200 rounded transition",title:q?"Exit fullscreen":"Fullscreen",children:q?i.jsx(sR,{className:"w-4 h-4 text-gray-600"}):i.jsx(bN,{className:"w-4 h-4 text-gray-600"})}),i.jsx("button",{onClick:t,className:"p-1.5 hover:bg-gray-200 rounded transition",title:"Close",children:i.jsx(An,{className:"w-4 h-4 text-gray-600"})})]})]}),i.jsxs("div",{className:"border-b border-gray-200 bg-white",children:[i.jsxs("div",{className:"flex items-start px-4 py-2 border-b border-gray-100",children:[i.jsx("span",{className:"text-sm text-gray-600 w-12 pt-1",children:"To"}),i.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1",children:[s.map((ce,Se)=>i.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:[i.jsx("span",{children:ce.name}),i.jsx("button",{onClick:()=>be(Se,"to"),className:"hover:text-blue-900",children:i.jsx(An,{className:"w-3 h-3"})})]},Se)),i.jsx("input",{ref:Q,type:"text",value:g,onChange:ce=>re(ce.target.value,"to"),onKeyDown:ce=>ae(ce,"to"),onFocus:()=>C("to"),onBlur:()=>{setTimeout(()=>G(!1),200)},placeholder:s.length===0?"Type or search recipients":"",className:"flex-1 min-w-[120px] outline-none text-sm py-1"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs ml-2",children:[!h&&i.jsx("button",{onClick:()=>f(!0),className:"text-blue-600 hover:text-blue-700",children:"Cc"}),!d&&i.jsx("button",{onClick:()=>v(!0),className:"text-blue-600 hover:text-blue-700",children:"Bcc"})]})]}),h&&i.jsxs("div",{className:"flex items-start px-4 py-2 border-b border-gray-100",children:[i.jsx("span",{className:"text-sm text-gray-600 w-12 pt-1",children:"Cc"}),i.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1",children:[l.map((ce,Se)=>i.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:[i.jsx("span",{children:ce.name}),i.jsx("button",{onClick:()=>be(Se,"cc"),className:"hover:text-blue-900",children:i.jsx(An,{className:"w-3 h-3"})})]},Se)),i.jsx("input",{type:"text",value:p,onChange:ce=>re(ce.target.value,"cc"),onKeyDown:ce=>ae(ce,"cc"),onFocus:()=>C("cc"),onBlur:()=>{setTimeout(()=>G(!1),200)},placeholder:l.length===0?"Type or search Cc recipients":"",className:"flex-1 min-w-[120px] outline-none text-sm py-1"})]})]}),d&&i.jsxs("div",{className:"flex items-start px-4 py-2 border-b border-gray-100",children:[i.jsx("span",{className:"text-sm text-gray-600 w-12 pt-1",children:"Bcc"}),i.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1",children:[u.map((ce,Se)=>i.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:[i.jsx("span",{children:ce.name}),i.jsx("button",{onClick:()=>be(Se,"bcc"),className:"hover:text-blue-900",children:i.jsx(An,{className:"w-3 h-3"})})]},Se)),i.jsx("input",{type:"text",value:w,onChange:ce=>re(ce.target.value,"bcc"),onKeyDown:ce=>ae(ce,"bcc"),onFocus:()=>C("bcc"),onBlur:()=>{setTimeout(()=>G(!1),200)},placeholder:u.length===0?"Type or search Bcc recipients":"",className:"flex-1 min-w-[120px] outline-none text-sm py-1"})]})]}),M&&X.length>0&&H&&i.jsx("div",{ref:J,className:"absolute bg-white border border-gray-200 shadow-lg rounded-lg mt-1 max-h-48 overflow-y-auto z-50 w-96 ml-16",children:X.map((ce,Se)=>i.jsxs("button",{onMouseDown:Pe=>{Pe.preventDefault(),ke(ce,H)},className:"w-full px-4 py-2 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:ce.name}),i.jsx("div",{className:"text-xs text-gray-500",children:ce.email}),ce.company&&i.jsx("div",{className:"text-xs text-gray-400",children:ce.company})]},Se))}),i.jsx("div",{className:"px-4 pb-2 text-[11px] text-gray-500 italic",children:"Tip: Type email addresses and press Enter, comma, or space to add. Or search from contacts."}),i.jsxs("div",{className:"flex items-center px-4 py-2",children:[i.jsx("span",{className:"text-sm text-gray-600 w-12",children:"Subject"}),i.jsx("input",{type:"text",value:b,onChange:ce=>B(ce.target.value),placeholder:"Subject",className:"flex-1 outline-none text-sm"})]})]}),i.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[i.jsx("style",{children:`
          .quill-editor-container .ql-container {
            font-size: 14px;
            font-family: Arial, sans-serif;
            overflow-y: auto !important;
            max-height: 100%;
          }
          .quill-editor-container .ql-editor {
            min-height: 200px;
            overflow-y: auto !important;
          }
          .quill-editor-container .ql-editor table {
            border-collapse: collapse;
            width: 100%;
            margin: 12px 0;
          }
          .quill-editor-container .ql-editor table td,
          .quill-editor-container .ql-editor table th {
            border: 1px solid #ddd;
            padding: 8px;
          }
          .quill-editor-container .ql-editor blockquote {
            border-left: 4px solid #ccc;
            padding-left: 16px;
            color: #666;
            margin: 10px 0;
          }
          .quill-editor-container .ql-editor img {
            max-width: 100%;
            height: auto;
          }
        `}),i.jsx(t$,{ref:P,theme:"snow",value:_,onChange:k,modules:he,className:"quill-editor-container flex-1",style:{display:"flex",flexDirection:"column",height:"100%"}})]}),E.length>0&&i.jsx("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50 max-h-32 overflow-y-auto",children:i.jsx("div",{className:"space-y-1",children:E.map((ce,Se)=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[i.jsx(ki,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),i.jsx("span",{className:"text-sm text-gray-700 truncate",children:ce.name}),i.jsxs("span",{className:"text-xs text-gray-500 flex-shrink-0",children:["(",we(ce.size),")"]})]}),i.jsx("button",{onClick:()=>pe(Se),className:"text-red-600 hover:text-red-700 ml-2",children:i.jsx(An,{className:"w-4 h-4"})})]},Se))})}),i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white rounded-b-lg",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:Te,disabled:S||s.length===0&&(!g.trim()||!Ie(g.trim()))||!b||!_,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Do,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ii,{className:"w-4 h-4"}),"Send"]})}),i.jsx("input",{ref:D,type:"file",multiple:!0,onChange:De,className:"hidden"}),i.jsx("button",{onClick:()=>{var ce;return(ce=D.current)==null?void 0:ce.click()},className:"p-2 hover:bg-gray-100 rounded transition",title:"Attach files",children:i.jsx(ki,{className:"w-5 h-5 text-gray-600"})})]}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded transition",title:"Discard",children:i.jsx(wa,{className:"w-5 h-5 text-gray-600"})})]})]}):null}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:RF,setPrototypeOf:rB,isFrozen:n$,getPrototypeOf:a$,getOwnPropertyDescriptor:s$}=Object;let{freeze:ys,seal:Li,create:Xw}=Object,{apply:Yw,construct:Jw}=typeof Reflect<"u"&&Reflect;ys||(ys=function(t){return t});Li||(Li=function(t){return t});Yw||(Yw=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];return t.apply(r,a)});Jw||(Jw=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return new t(...n)});const Dp=ws(Array.prototype.forEach),i$=ws(Array.prototype.lastIndexOf),nB=ws(Array.prototype.pop),Ff=ws(Array.prototype.push),o$=ws(Array.prototype.splice),Hm=ws(String.prototype.toLowerCase),Nv=ws(String.prototype.toString),Bv=ws(String.prototype.match),Tf=ws(String.prototype.replace),l$=ws(String.prototype.indexOf),c$=ws(String.prototype.trim),zi=ws(Object.prototype.hasOwnProperty),As=ws(RegExp.prototype.test),If=u$(TypeError);function ws(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return Yw(e,t,n)}}function u$(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Jw(e,r)}}function dr(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Hm;rB&&rB(e,null);let n=t.length;for(;n--;){let a=t[n];if(typeof a=="string"){const s=r(a);s!==a&&(n$(t)||(t[n]=s),a=s)}e[a]=!0}return e}function A$(e){for(let t=0;t<e.length;t++)zi(e,t)||(e[t]=null);return e}function dl(e){const t=Xw(null);for(const[r,n]of RF(e))zi(e,r)&&(Array.isArray(n)?t[r]=A$(n):n&&typeof n=="object"&&n.constructor===Object?t[r]=dl(n):t[r]=n);return t}function Lf(e,t){for(;e!==null;){const n=s$(e,t);if(n){if(n.get)return ws(n.get);if(typeof n.value=="function")return ws(n.value)}e=a$(e)}function r(){return null}return r}const aB=ys(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Cv=ys(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ev=ys(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),d$=ys(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Sv=ys(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),f$=ys(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),sB=ys(["#text"]),iB=ys(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),kv=ys(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),oB=ys(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Rp=ys(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),h$=Li(/\{\{[\w\W]*|[\w\W]*\}\}/gm),p$=Li(/<%[\w\W]*|[\w\W]*%>/gm),m$=Li(/\$\{[\w\W]*/gm),g$=Li(/^data-[\-\w.\u00B7-\uFFFF]+$/),x$=Li(/^aria-[\-\w]+$/),QF=Li(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),v$=Li(/^(?:\w+script|data):/i),y$=Li(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),MF=Li(/^html$/i),w$=Li(/^[a-z][.\w]*(-[.\w]+)+$/i);var lB=Object.freeze({__proto__:null,ARIA_ATTR:x$,ATTR_WHITESPACE:y$,CUSTOM_ELEMENT:w$,DATA_ATTR:g$,DOCTYPE_NAME:MF,ERB_EXPR:p$,IS_ALLOWED_URI:QF,IS_SCRIPT_OR_DATA:v$,MUSTACHE_EXPR:h$,TMPLIT_EXPR:m$});const Of={element:1,text:3,progressingInstruction:7,comment:8,document:9},b$=function(){return typeof window>"u"?null:window},_$=function(t,r){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let n=null;const a="data-tt-policy-suffix";r&&r.hasAttribute(a)&&(n=r.getAttribute(a));const s="dompurify"+(n?"#"+n:"");try{return t.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},cB=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function HF(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b$();const t=je=>HF(je);if(t.version="3.3.0",t.removed=[],!e||!e.document||e.document.nodeType!==Of.document||!e.Element)return t.isSupported=!1,t;let{document:r}=e;const n=r,a=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:l,Element:c,NodeFilter:u,NamedNodeMap:A=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:d}=e,v=c.prototype,g=Lf(v,"cloneNode"),y=Lf(v,"remove"),p=Lf(v,"nextSibling"),m=Lf(v,"childNodes"),w=Lf(v,"parentNode");if(typeof o=="function"){const je=r.createElement("template");je.content&&je.content.ownerDocument&&(r=je.content.ownerDocument)}let x,b="";const{implementation:B,createNodeIterator:_,createDocumentFragment:k,getElementsByTagName:E}=r,{importNode:T}=n;let S=cB();t.isSupported=typeof RF=="function"&&typeof w=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:j,ERB_EXPR:I,TMPLIT_EXPR:U,DATA_ATTR:q,ARIA_ATTR:V,IS_SCRIPT_OR_DATA:X,ATTR_WHITESPACE:W,CUSTOM_ELEMENT:M}=lB;let{IS_ALLOWED_URI:G}=lB,H=null;const C=dr({},[...aB,...Cv,...Ev,...Sv,...sB]);let L=null;const O=dr({},[...iB,...kv,...oB,...Rp]);let D=Object.seal(Xw(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),P=null,Q=null;const J=Object.seal(Xw(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let te=!0,z=!0,ye=!1,re=!0,ke=!1,be=!0,ae=!1,Ie=!1,De=!1,pe=!1,we=!1,Te=!1,he=!0,ce=!1;const Se="user-content-";let Pe=!0,Le=!1,Xe={},fe=null;const Ee=dr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let qe=null;const Qe=dr({},["audio","video","img","source","image","track"]);let Ye=null;const Nt=dr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),xt="http://www.w3.org/1998/Math/MathML",it="http://www.w3.org/2000/svg",ut="http://www.w3.org/1999/xhtml";let Mt=ut,ht=!1,Et=null;const mt=dr({},[xt,it,ut],Nv);let _t=dr({},["mi","mo","mn","ms","mtext"]),Ht=dr({},["annotation-xml"]);const bt=dr({},["title","style","font","a","script"]);let Ct=null;const or=["application/xhtml+xml","text/html"],Ra="text/html";let er=null,on=null;const zn=r.createElement("form"),Lt=function(_e){return _e instanceof RegExp||_e instanceof Function},Dn=function(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(on&&on===_e)){if((!_e||typeof _e!="object")&&(_e={}),_e=dl(_e),Ct=or.indexOf(_e.PARSER_MEDIA_TYPE)===-1?Ra:_e.PARSER_MEDIA_TYPE,er=Ct==="application/xhtml+xml"?Nv:Hm,H=zi(_e,"ALLOWED_TAGS")?dr({},_e.ALLOWED_TAGS,er):C,L=zi(_e,"ALLOWED_ATTR")?dr({},_e.ALLOWED_ATTR,er):O,Et=zi(_e,"ALLOWED_NAMESPACES")?dr({},_e.ALLOWED_NAMESPACES,Nv):mt,Ye=zi(_e,"ADD_URI_SAFE_ATTR")?dr(dl(Nt),_e.ADD_URI_SAFE_ATTR,er):Nt,qe=zi(_e,"ADD_DATA_URI_TAGS")?dr(dl(Qe),_e.ADD_DATA_URI_TAGS,er):Qe,fe=zi(_e,"FORBID_CONTENTS")?dr({},_e.FORBID_CONTENTS,er):Ee,P=zi(_e,"FORBID_TAGS")?dr({},_e.FORBID_TAGS,er):dl({}),Q=zi(_e,"FORBID_ATTR")?dr({},_e.FORBID_ATTR,er):dl({}),Xe=zi(_e,"USE_PROFILES")?_e.USE_PROFILES:!1,te=_e.ALLOW_ARIA_ATTR!==!1,z=_e.ALLOW_DATA_ATTR!==!1,ye=_e.ALLOW_UNKNOWN_PROTOCOLS||!1,re=_e.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ke=_e.SAFE_FOR_TEMPLATES||!1,be=_e.SAFE_FOR_XML!==!1,ae=_e.WHOLE_DOCUMENT||!1,pe=_e.RETURN_DOM||!1,we=_e.RETURN_DOM_FRAGMENT||!1,Te=_e.RETURN_TRUSTED_TYPE||!1,De=_e.FORCE_BODY||!1,he=_e.SANITIZE_DOM!==!1,ce=_e.SANITIZE_NAMED_PROPS||!1,Pe=_e.KEEP_CONTENT!==!1,Le=_e.IN_PLACE||!1,G=_e.ALLOWED_URI_REGEXP||QF,Mt=_e.NAMESPACE||ut,_t=_e.MATHML_TEXT_INTEGRATION_POINTS||_t,Ht=_e.HTML_INTEGRATION_POINTS||Ht,D=_e.CUSTOM_ELEMENT_HANDLING||{},_e.CUSTOM_ELEMENT_HANDLING&&Lt(_e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(D.tagNameCheck=_e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),_e.CUSTOM_ELEMENT_HANDLING&&Lt(_e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(D.attributeNameCheck=_e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),_e.CUSTOM_ELEMENT_HANDLING&&typeof _e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(D.allowCustomizedBuiltInElements=_e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ke&&(z=!1),we&&(pe=!0),Xe&&(H=dr({},sB),L=[],Xe.html===!0&&(dr(H,aB),dr(L,iB)),Xe.svg===!0&&(dr(H,Cv),dr(L,kv),dr(L,Rp)),Xe.svgFilters===!0&&(dr(H,Ev),dr(L,kv),dr(L,Rp)),Xe.mathMl===!0&&(dr(H,Sv),dr(L,oB),dr(L,Rp))),_e.ADD_TAGS&&(typeof _e.ADD_TAGS=="function"?J.tagCheck=_e.ADD_TAGS:(H===C&&(H=dl(H)),dr(H,_e.ADD_TAGS,er))),_e.ADD_ATTR&&(typeof _e.ADD_ATTR=="function"?J.attributeCheck=_e.ADD_ATTR:(L===O&&(L=dl(L)),dr(L,_e.ADD_ATTR,er))),_e.ADD_URI_SAFE_ATTR&&dr(Ye,_e.ADD_URI_SAFE_ATTR,er),_e.FORBID_CONTENTS&&(fe===Ee&&(fe=dl(fe)),dr(fe,_e.FORBID_CONTENTS,er)),Pe&&(H["#text"]=!0),ae&&dr(H,["html","head","body"]),H.table&&(dr(H,["tbody"]),delete P.tbody),_e.TRUSTED_TYPES_POLICY){if(typeof _e.TRUSTED_TYPES_POLICY.createHTML!="function")throw If('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof _e.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw If('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=_e.TRUSTED_TYPES_POLICY,b=x.createHTML("")}else x===void 0&&(x=_$(d,a)),x!==null&&typeof b=="string"&&(b=x.createHTML(""));ys&&ys(_e),on=_e}},Xn=dr({},[...Cv,...Ev,...d$]),Nn=dr({},[...Sv,...f$]),da=function(_e){let He=w(_e);(!He||!He.tagName)&&(He={namespaceURI:Mt,tagName:"template"});const Je=Hm(_e.tagName),st=Hm(He.tagName);return Et[_e.namespaceURI]?_e.namespaceURI===it?He.namespaceURI===ut?Je==="svg":He.namespaceURI===xt?Je==="svg"&&(st==="annotation-xml"||_t[st]):!!Xn[Je]:_e.namespaceURI===xt?He.namespaceURI===ut?Je==="math":He.namespaceURI===it?Je==="math"&&Ht[st]:!!Nn[Je]:_e.namespaceURI===ut?He.namespaceURI===it&&!Ht[st]||He.namespaceURI===xt&&!_t[st]?!1:!Nn[Je]&&(bt[Je]||!Xn[Je]):!!(Ct==="application/xhtml+xml"&&Et[_e.namespaceURI]):!1},Ar=function(_e){Ff(t.removed,{element:_e});try{w(_e).removeChild(_e)}catch{y(_e)}},Br=function(_e,He){try{Ff(t.removed,{attribute:He.getAttributeNode(_e),from:He})}catch{Ff(t.removed,{attribute:null,from:He})}if(He.removeAttribute(_e),_e==="is")if(pe||we)try{Ar(He)}catch{}else try{He.setAttribute(_e,"")}catch{}},le=function(_e){let He=null,Je=null;if(De)_e="<remove></remove>"+_e;else{const yt=Bv(_e,/^[\r\n\t ]+/);Je=yt&&yt[0]}Ct==="application/xhtml+xml"&&Mt===ut&&(_e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+_e+"</body></html>");const st=x?x.createHTML(_e):_e;if(Mt===ut)try{He=new f().parseFromString(st,Ct)}catch{}if(!He||!He.documentElement){He=B.createDocument(Mt,"template",null);try{He.documentElement.innerHTML=ht?b:st}catch{}}const tt=He.body||He.documentElement;return _e&&Je&&tt.insertBefore(r.createTextNode(Je),tt.childNodes[0]||null),Mt===ut?E.call(He,ae?"html":"body")[0]:ae?He.documentElement:tt},ee=function(_e){return _.call(_e.ownerDocument||_e,_e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},se=function(_e){return _e instanceof h&&(typeof _e.nodeName!="string"||typeof _e.textContent!="string"||typeof _e.removeChild!="function"||!(_e.attributes instanceof A)||typeof _e.removeAttribute!="function"||typeof _e.setAttribute!="function"||typeof _e.namespaceURI!="string"||typeof _e.insertBefore!="function"||typeof _e.hasChildNodes!="function")},ne=function(_e){return typeof l=="function"&&_e instanceof l};function xe(je,_e,He){Dp(je,Je=>{Je.call(t,_e,He,on)})}const me=function(_e){let He=null;if(xe(S.beforeSanitizeElements,_e,null),se(_e))return Ar(_e),!0;const Je=er(_e.nodeName);if(xe(S.uponSanitizeElement,_e,{tagName:Je,allowedTags:H}),be&&_e.hasChildNodes()&&!ne(_e.firstElementChild)&&As(/<[/\w!]/g,_e.innerHTML)&&As(/<[/\w!]/g,_e.textContent)||_e.nodeType===Of.progressingInstruction||be&&_e.nodeType===Of.comment&&As(/<[/\w]/g,_e.data))return Ar(_e),!0;if(!(J.tagCheck instanceof Function&&J.tagCheck(Je))&&(!H[Je]||P[Je])){if(!P[Je]&&Me(Je)&&(D.tagNameCheck instanceof RegExp&&As(D.tagNameCheck,Je)||D.tagNameCheck instanceof Function&&D.tagNameCheck(Je)))return!1;if(Pe&&!fe[Je]){const st=w(_e)||_e.parentNode,tt=m(_e)||_e.childNodes;if(tt&&st){const yt=tt.length;for(let zt=yt-1;zt>=0;--zt){const $t=g(tt[zt],!0);$t.__removalCount=(_e.__removalCount||0)+1,st.insertBefore($t,p(_e))}}}return Ar(_e),!0}return _e instanceof c&&!da(_e)||(Je==="noscript"||Je==="noembed"||Je==="noframes")&&As(/<\/no(script|embed|frames)/i,_e.innerHTML)?(Ar(_e),!0):(ke&&_e.nodeType===Of.text&&(He=_e.textContent,Dp([j,I,U],st=>{He=Tf(He,st," ")}),_e.textContent!==He&&(Ff(t.removed,{element:_e.cloneNode()}),_e.textContent=He)),xe(S.afterSanitizeElements,_e,null),!1)},Ue=function(_e,He,Je){if(he&&(He==="id"||He==="name")&&(Je in r||Je in zn))return!1;if(!(z&&!Q[He]&&As(q,He))){if(!(te&&As(V,He))){if(!(J.attributeCheck instanceof Function&&J.attributeCheck(He,_e))){if(!L[He]||Q[He]){if(!(Me(_e)&&(D.tagNameCheck instanceof RegExp&&As(D.tagNameCheck,_e)||D.tagNameCheck instanceof Function&&D.tagNameCheck(_e))&&(D.attributeNameCheck instanceof RegExp&&As(D.attributeNameCheck,He)||D.attributeNameCheck instanceof Function&&D.attributeNameCheck(He,_e))||He==="is"&&D.allowCustomizedBuiltInElements&&(D.tagNameCheck instanceof RegExp&&As(D.tagNameCheck,Je)||D.tagNameCheck instanceof Function&&D.tagNameCheck(Je))))return!1}else if(!Ye[He]){if(!As(G,Tf(Je,W,""))){if(!((He==="src"||He==="xlink:href"||He==="href")&&_e!=="script"&&l$(Je,"data:")===0&&qe[_e])){if(!(ye&&!As(X,Tf(Je,W,"")))){if(Je)return!1}}}}}}}return!0},Me=function(_e){return _e!=="annotation-xml"&&Bv(_e,M)},$e=function(_e){xe(S.beforeSanitizeAttributes,_e,null);const{attributes:He}=_e;if(!He||se(_e))return;const Je={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:L,forceKeepAttr:void 0};let st=He.length;for(;st--;){const tt=He[st],{name:yt,namespaceURI:zt,value:$t}=tt,_r=er(yt),_a=$t;let lr=yt==="value"?_a:c$(_a);if(Je.attrName=_r,Je.attrValue=lr,Je.keepAttr=!0,Je.forceKeepAttr=void 0,xe(S.uponSanitizeAttribute,_e,Je),lr=Je.attrValue,ce&&(_r==="id"||_r==="name")&&(Br(yt,_e),lr=Se+lr),be&&As(/((--!?|])>)|<\/(style|title|textarea)/i,lr)){Br(yt,_e);continue}if(_r==="attributename"&&Bv(lr,"href")){Br(yt,_e);continue}if(Je.forceKeepAttr)continue;if(!Je.keepAttr){Br(yt,_e);continue}if(!re&&As(/\/>/i,lr)){Br(yt,_e);continue}ke&&Dp([j,I,U],Rr=>{lr=Tf(lr,Rr," ")});const Wr=er(_e.nodeName);if(!Ue(Wr,_r,lr)){Br(yt,_e);continue}if(x&&typeof d=="object"&&typeof d.getAttributeType=="function"&&!zt)switch(d.getAttributeType(Wr,_r)){case"TrustedHTML":{lr=x.createHTML(lr);break}case"TrustedScriptURL":{lr=x.createScriptURL(lr);break}}if(lr!==_a)try{zt?_e.setAttributeNS(zt,yt,lr):_e.setAttribute(yt,lr),se(_e)?Ar(_e):nB(t.removed)}catch{Br(yt,_e)}}xe(S.afterSanitizeAttributes,_e,null)},Ge=function je(_e){let He=null;const Je=ee(_e);for(xe(S.beforeSanitizeShadowDOM,_e,null);He=Je.nextNode();)xe(S.uponSanitizeShadowNode,He,null),me(He),$e(He),He.content instanceof s&&je(He.content);xe(S.afterSanitizeShadowDOM,_e,null)};return t.sanitize=function(je){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},He=null,Je=null,st=null,tt=null;if(ht=!je,ht&&(je="<!-->"),typeof je!="string"&&!ne(je))if(typeof je.toString=="function"){if(je=je.toString(),typeof je!="string")throw If("dirty is not a string, aborting")}else throw If("toString is not a function");if(!t.isSupported)return je;if(Ie||Dn(_e),t.removed=[],typeof je=="string"&&(Le=!1),Le){if(je.nodeName){const $t=er(je.nodeName);if(!H[$t]||P[$t])throw If("root node is forbidden and cannot be sanitized in-place")}}else if(je instanceof l)He=le("<!---->"),Je=He.ownerDocument.importNode(je,!0),Je.nodeType===Of.element&&Je.nodeName==="BODY"||Je.nodeName==="HTML"?He=Je:He.appendChild(Je);else{if(!pe&&!ke&&!ae&&je.indexOf("<")===-1)return x&&Te?x.createHTML(je):je;if(He=le(je),!He)return pe?null:Te?b:""}He&&De&&Ar(He.firstChild);const yt=ee(Le?je:He);for(;st=yt.nextNode();)me(st),$e(st),st.content instanceof s&&Ge(st.content);if(Le)return je;if(pe){if(we)for(tt=k.call(He.ownerDocument);He.firstChild;)tt.appendChild(He.firstChild);else tt=He;return(L.shadowroot||L.shadowrootmode)&&(tt=T.call(n,tt,!0)),tt}let zt=ae?He.outerHTML:He.innerHTML;return ae&&H["!doctype"]&&He.ownerDocument&&He.ownerDocument.doctype&&He.ownerDocument.doctype.name&&As(MF,He.ownerDocument.doctype.name)&&(zt="<!DOCTYPE "+He.ownerDocument.doctype.name+`>
`+zt),ke&&Dp([j,I,U],$t=>{zt=Tf(zt,$t," ")}),x&&Te?x.createHTML(zt):zt},t.setConfig=function(){let je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Dn(je),Ie=!0},t.clearConfig=function(){on=null,Ie=!1},t.isValidAttribute=function(je,_e,He){on||Dn({});const Je=er(je),st=er(_e);return Ue(Je,st,He)},t.addHook=function(je,_e){typeof _e=="function"&&Ff(S[je],_e)},t.removeHook=function(je,_e){if(_e!==void 0){const He=i$(S[je],_e);return He===-1?void 0:o$(S[je],He,1)[0]}return nB(S[je])},t.removeHooks=function(je){S[je]=[]},t.removeAllHooks=function(){S=cB()},t}var qF=HF();const N$=Object.freeze(Object.defineProperty({__proto__:null,default:qF},Symbol.toStringTag,{value:"Module"}));function KF({htmlContent:e,className:t=""}){const r=Z.useRef(null),[n,a]=Z.useState(500),[s,o]=Z.useState({});return Z.useEffect(()=>{var m;if(!r.current||!e)return;const l=r.current;let A=(w=>{const x=document.createElement("textarea");return x.innerHTML=w,x.value})(e);A=A.replace(/<blockquote[^>]*>([\s\S]*?)<\/blockquote>/gi,(w,x,b)=>{const B=Math.random().toString(36).substr(2,9);return`<div class="quoted-section" data-quote-id="${B}">
          <div class="quoted-toggle" onclick="toggleQuote('${B}')">
            <span class="toggle-icon">...</span>
          </div>
          <blockquote class="quoted-content" id="quote-${B}" style="display: none;">${x}</blockquote>
        </div>`});const d=`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="UTF-8">
          <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          
      <style>
        * {
          box-sizing: border-box;
        }
        body {
          font-family: Arial, sans-serif;
          font-size: 14px;
          line-height: 1.6;
          color: #202124;
          margin: 0;
          padding: 16px;
          background: white;
          overflow-x: hidden;
          word-wrap: break-word;
        }

        /* Table styling - Gmail style */
        table {
          border-collapse: collapse !important;
          width: auto !important;
          max-width: 100%;
          margin: 12px 0;
          font-size: 13px;
        }

        table, th, td {
          border: 1px solid #000 !important;
        }

        th, td {
          padding: 6px 10px !important;
          text-align: left;
          vertical-align: top;
          word-break: break-word;
        }

        th {
          font-weight: 700 !important;
        }

        /* Preserve inline styles and colors */
        th[bgcolor], td[bgcolor] {
          /* Browser will apply bgcolor attribute */
        }

        /* Common email table colors */
        [bgcolor="#FFFF00"], [bgcolor="yellow"], [style*="background:yellow"], [style*="background-color:yellow"] {
          background-color: #FFFF00 !important;
        }

        [bgcolor="#E6E6FA"], [bgcolor="lavender"], [style*="background:lavender"], [style*="background-color:lavender"] {
          background-color: #E6E6FA !important;
        }

        [style*="color:blue"], [style*="color:#0000FF"] {
          color: #0000FF !important;
        }

        [style*="color:darkblue"], [style*="color:#00008B"] {
          color: #00008B !important;
        }

        /* Typography */
        p {
          margin: 8px 0;
        }

        a {
          color: #1a73e8;
          text-decoration: none;
        }

        a:hover {
          text-decoration: underline;
        }

        strong, b {
          font-weight: 700;
        }

        em, i {
          font-style: italic;
        }

        /* Lists */
        ul, ol {
          margin: 8px 0;
          padding-left: 24px;
        }

        li {
          margin: 4px 0;
        }

        /* Blockquotes */
        blockquote {
          margin: 8px 0;
          padding-left: 16px;
          border-left: 4px solid #ccc;
          color: #666;
        }

        /* Quoted section styling */
        .quoted-section {
          margin: 12px 0;
        }

        .quoted-toggle {
          display: inline-block;
          color: #1a73e8;
          cursor: pointer;
          font-size: 13px;
          padding: 4px 8px;
          border-radius: 4px;
          user-select: none;
        }

        .quoted-toggle:hover {
          background-color: #f0f0f0;
        }

        .toggle-icon {
          display: inline-block;
          font-weight: bold;
        }

        .quoted-content {
          margin-top: 8px;
          padding-left: 16px;
          border-left: 4px solid #ccc;
          color: #666;
        }

        /* Headers */
        h1, h2, h3, h4, h5, h6 {
          margin: 12px 0 8px 0;
          font-weight: 700;
          line-height: 1.3;
        }

        /* Images */
        img {
          max-width: 100%;
          height: auto;
        }

        /* Horizontal rules */
        hr {
          border: none;
          border-top: 1px solid #dadce0;
          margin: 16px 0;
        }

        /* Prevent overflow */
        pre {
          white-space: pre-wrap;
          word-wrap: break-word;
          overflow-x: auto;
        }

        /* Center tag support */
        center {
          text-align: center;
        }
      </style>
    
          <script>
            function toggleQuote(id) {
              const content = document.getElementById('quote-' + id);
              const toggle = content.previousElementSibling.querySelector('.toggle-icon');

              if (content.style.display === 'none') {
                content.style.display = 'block';
                toggle.textContent = '';
              } else {
                content.style.display = 'none';
                toggle.textContent = '...';
              }
            }
          <\/script>
        </head>
        <body>
          ${qF.sanitize(A,{ALLOWED_TAGS:["html","head","body","meta","title","style","p","br","div","span","a","img","strong","em","u","b","i","s","strike","h1","h2","h3","h4","h5","h6","ul","ol","li","table","thead","tbody","tfoot","tr","th","td","font","center","blockquote","pre","code","hr","sup","sub"],ALLOWED_ATTR:["style","class","id","href","target","rel","src","alt","title","width","height","align","valign","border","cellpadding","cellspacing","bgcolor","color","face","size","data-quote-id","onclick"],ALLOW_DATA_ATTR:!0,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i})}
        </body>
      </html>
    `,v=new Blob([d],{type:"text/html; charset=UTF-8"}),g=URL.createObjectURL(v);if(l.src=g,!(l.contentDocument||((m=l.contentWindow)==null?void 0:m.document)))return;const p=()=>{var w;try{const x=l.contentDocument||((w=l.contentWindow)==null?void 0:w.document);if(!x)return;const b=()=>{const _=x.body,k=x.documentElement,E=Math.max((_==null?void 0:_.scrollHeight)||0,(_==null?void 0:_.offsetHeight)||0,(k==null?void 0:k.clientHeight)||0,(k==null?void 0:k.scrollHeight)||0,(k==null?void 0:k.offsetHeight)||0);a(Math.max(E+20,100))};b();const B=new ResizeObserver(b);x.body&&B.observe(x.body),setTimeout(b,150),l.__cleanup=()=>{B.disconnect(),URL.revokeObjectURL(g)}}catch(x){console.error("Error measuring iframe height:",x)}};return l.addEventListener("load",p),()=>{l.removeEventListener("load",p),l.__cleanup&&l.__cleanup(),URL.revokeObjectURL(g)}},[e]),!e||e.trim()===""?i.jsx("div",{className:`text-gray-500 italic p-4 ${t}`,children:"No email content available"}):i.jsx("iframe",{ref:r,title:"Email Content",className:`w-full border-0 ${t}`,style:{height:`${n}px`,minHeight:"100px",maxHeight:"800px"},sandbox:"allow-same-origin",loading:"lazy"})}function B$(){const{setCurrentPage:e}=Mo(),[t,r]=Z.useState(null),[n,a]=Z.useState(!0),[s,o]=Z.useState(!1),[l,c]=Z.useState([]),[u,A]=Z.useState(null),[h,f]=Z.useState("INBOX"),[d,v]=Z.useState(""),[g,y]=Z.useState(null),[p,m]=Z.useState(null),[w,x]=Z.useState(!1),[b,B]=Z.useState(!1),[_,k]=Z.useState("compose"),[E,T]=Z.useState(null),[S,j]=Z.useState(null),I=Z.useRef(null);Z.useEffect(()=>{U()},[]),Z.useEffect(()=>{t&&X()},[t,h]),Z.useEffect(()=>{const be=ae=>{I.current&&!I.current.contains(ae.target)&&j(null)};if(S)return document.addEventListener("mousedown",be),()=>document.removeEventListener("mousedown",be)},[S]);const U=async()=>{try{const{data:{user:be}}=await de.auth.getUser();if(!be){y("Not authenticated"),a(!1);return}const{data:ae,error:Ie}=await de.from("gmail_connections").select("*").eq("user_id",be.id).eq("is_connected",!0).maybeSingle();if(Ie)throw Ie;if(!ae){y("No Gmail account connected. Please connect your Gmail account in Settings."),a(!1);return}r(ae)}catch(be){console.error("Error loading Gmail connection:",be),y("Failed to load Gmail connection")}finally{a(!1)}},q=async be=>{if(new Date(be.access_token_expires_at)>new Date)return be.access_token;const Ie=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:void 0,client_secret:void 0,refresh_token:be.refresh_token,grant_type:"refresh_token"})});if(!Ie.ok)throw new Error("Failed to refresh token");const De=await Ie.json(),pe=De.access_token,we=new Date(Date.now()+De.expires_in*1e3).toISOString();return await de.from("gmail_connections").update({access_token:pe,access_token_expires_at:we}).eq("id",be.id),r({...be,access_token:pe,access_token_expires_at:we}),pe},V=be=>{switch(be){case"INBOX":return"in:inbox";case"SENT":return"in:sent";case"STARRED":return"is:starred";case"TRASH":return"in:trash";case"DRAFT":return"in:drafts";case"ALL":return"in:anywhere";default:return"in:inbox"}},X=async be=>{if(t){o(!0),y(null);try{const ae=await q(t),Ie=V(h);let pe=`https://gmail.googleapis.com/gmail/v1/users/me/messages?maxResults=50&q=${encodeURIComponent(Ie)}`;be&&(pe+=`&pageToken=${be}`);const we=await fetch(pe,{headers:{Authorization:`Bearer ${ae}`}});if(!we.ok)throw new Error("Failed to fetch emails from Gmail");const Te=await we.json(),he=Te.messages||[];m(Te.nextPageToken||null);const ce=he.map(async Le=>{const Xe=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${Le.id}?format=full`,{headers:{Authorization:`Bearer ${ae}`}});if(!Xe.ok)return null;const fe=await Xe.json();return W(fe)}),Pe=(await Promise.all(ce)).filter(Le=>Le!==null);c(be?[...l,...Pe]:Pe)}catch(ae){console.error("Error loading emails:",ae),y("Failed to load emails from Gmail")}finally{o(!1)}}},W=be=>{var ae,Ie,De;try{const pe=be.payload.headers,we=M(pe,"subject")||"(No Subject)",Te=M(pe,"from")||"",he=M(pe,"to")||"",ce=M(pe,"cc")||"",Se=((ae=Te.match(/<(.+?)>/))==null?void 0:ae[1])||Te,Pe=Te.replace(/<.+?>/,"").trim()||Se,Le=new Date(parseInt(be.internalDate)),Xe=((Ie=be.labelIds)==null?void 0:Ie.includes("UNREAD"))||!1,fe=((De=be.labelIds)==null?void 0:De.includes("STARRED"))||!1,{text:Ee,html:qe,attachments:Qe}=H(be.payload);return{id:be.id,threadId:be.threadId,subject:we,from:Pe,fromEmail:Se,to:he,cc:ce,snippet:be.snippet||"",body:Ee,htmlBody:qe,date:Le,isUnread:Xe,isStarred:fe,labels:be.labelIds||[],attachments:Qe.length>0?Qe:void 0}}catch(pe){return console.error("Error parsing email:",pe),null}},M=(be,ae)=>{const Ie=be.find(De=>De.name.toLowerCase()===ae.toLowerCase());return(Ie==null?void 0:Ie.value)||""},G=be=>{const ae=document.createElement("DIV");return ae.innerHTML=be,ae.textContent||ae.innerText||""},H=be=>{var ce;let ae="",Ie="";const De=[],pe=Se=>{try{const Pe=Se.replace(/-/g,"+").replace(/_/g,"/"),Le=atob(Pe),Xe=new Uint8Array(Le.length);for(let fe=0;fe<Le.length;fe++)Xe[fe]=Le.charCodeAt(fe);return new TextDecoder("utf-8").decode(Xe)}catch{try{return atob(Se.replace(/-/g,"+").replace(/_/g,"/"))}catch{return Se}}},we=Se=>{var Pe,Le,Xe;for(const fe of Se)fe.filename&&((Pe=fe.body)!=null&&Pe.attachmentId)&&De.push({filename:fe.filename,mimeType:fe.mimeType,size:fe.body.size,attachmentId:fe.body.attachmentId}),fe.mimeType==="text/html"&&((Le=fe.body)!=null&&Le.data)?Ie=pe(fe.body.data):fe.mimeType==="text/plain"&&((Xe=fe.body)!=null&&Xe.data)?ae=pe(fe.body.data):fe.parts&&we(fe.parts)};if((ce=be.body)!=null&&ce.data){const Se=pe(be.body.data);be.mimeType==="text/html"?Ie=Se:ae=Se}else be.parts&&we(be.parts);const Te=ae||(Ie?G(Ie):""),he=Ie||ae.replace(/\n/g,"<br>");return{text:Te,html:he,attachments:De}},C=async be=>{if(A(be),be.isUnread&&L(be.id),!be.body&&t){x(!0);try{const ae=await q(t),Ie=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${be.id}?format=full`,{headers:{Authorization:`Bearer ${ae}`}});if(Ie.ok){const De=await Ie.json(),{text:pe,html:we,attachments:Te}=H(De.payload),he=De.payload.headers,ce=M(he,"to")||"",Se=M(he,"cc")||"",Pe={...be,body:pe,htmlBody:we,to:ce,cc:Se,attachments:Te.length>0?Te:void 0};A(Pe),c(l.map(Le=>Le.id===be.id?Pe:Le))}}catch(ae){console.error("Error loading email body:",ae)}finally{x(!1)}}},L=async be=>{if(t)try{const ae=await q(t);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${be}/modify`,{method:"POST",headers:{Authorization:`Bearer ${ae}`,"Content-Type":"application/json"},body:JSON.stringify({removeLabelIds:["UNREAD"]})}),c(l.map(Ie=>Ie.id===be?{...Ie,isUnread:!1}:Ie)),(u==null?void 0:u.id)===be&&A({...u,isUnread:!1})}catch(ae){console.error("Error marking as read:",ae)}},O=async(be,ae)=>{if(t)try{const Ie=await q(t);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${be}/modify`,{method:"POST",headers:{Authorization:`Bearer ${Ie}`,"Content-Type":"application/json"},body:JSON.stringify({addLabelIds:ae?[]:["STARRED"],removeLabelIds:ae?["STARRED"]:[]})}),c(l.map(De=>De.id===be?{...De,isStarred:!ae}:De)),(u==null?void 0:u.id)===be&&A({...u,isStarred:!ae})}catch(Ie){console.error("Error toggling star:",Ie)}},D=(be,ae=!1)=>{k("reply"),T(be),B(!0),j(null)},P=be=>{k("forward"),T(be),B(!0),j(null)},Q=async be=>{if(t)try{const ae=await q(t);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${be.id}/trash`,{method:"POST",headers:{Authorization:`Bearer ${ae}`}}),c(l.filter(Ie=>Ie.id!==be.id)),(u==null?void 0:u.id)===be.id&&A(null),j(null)}catch(ae){console.error("Error deleting email:",ae),alert("Failed to delete email")}},J=async be=>{if(!t)throw new Error("No Gmail connection");const ae=await q(t);let Ie="";if(be.attachments.length>0){const we="----=_Part_"+Date.now(),Te=['Content-Type: multipart/mixed; boundary="'+we+'"',"MIME-Version: 1.0",`To: ${be.to.join(", ")}`];be.cc.length>0&&Te.push(`Cc: ${be.cc.join(", ")}`),be.bcc.length>0&&Te.push(`Bcc: ${be.bcc.join(", ")}`),Te.push(`Subject: ${be.subject}`),Ie=Te.join(`\r
`)+`\r
\r
`,Ie+=`--${we}\r
`,Ie+=`Content-Type: text/html; charset="UTF-8"\r
`,Ie+=`Content-Transfer-Encoding: 7bit\r
\r
`,Ie+=be.body+`\r
\r
`;for(const he of be.attachments){const ce=await te(he);Ie+=`--${we}\r
`,Ie+=`Content-Type: ${he.type}; name="${he.name}"\r
`,Ie+=`Content-Transfer-Encoding: base64\r
`,Ie+=`Content-Disposition: attachment; filename="${he.name}"\r
\r
`,Ie+=ce+`\r
\r
`}Ie+=`--${we}--`}else{const we=['Content-Type: text/html; charset="UTF-8"',"MIME-Version: 1.0",`To: ${be.to.join(", ")}`];be.cc.length>0&&we.push(`Cc: ${be.cc.join(", ")}`),be.bcc.length>0&&we.push(`Bcc: ${be.bcc.join(", ")}`),we.push(`Subject: ${be.subject}`),Ie=we.join(`\r
`)+`\r
\r
`+be.body}const De=btoa(unescape(encodeURIComponent(Ie))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");if(!(await fetch("https://gmail.googleapis.com/gmail/v1/users/me/messages/send",{method:"POST",headers:{Authorization:`Bearer ${ae}`,"Content-Type":"application/json"},body:JSON.stringify({raw:De})})).ok)throw new Error("Failed to send email")},te=be=>new Promise((ae,Ie)=>{const De=new FileReader;De.readAsDataURL(be),De.onload=()=>{const pe=De.result.split(",")[1];ae(pe)},De.onerror=pe=>Ie(pe)}),z=async(be,ae)=>{if(t)try{const Ie=await q(t),De=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${be.id}/attachments/${ae.attachmentId}`,{headers:{Authorization:`Bearer ${Ie}`}});if(!De.ok)throw new Error("Failed to download attachment");const we=(await De.json()).data.replace(/-/g,"+").replace(/_/g,"/"),Te=atob(we),he=new Uint8Array(Te.length);for(let Le=0;Le<Te.length;Le++)he[Le]=Te.charCodeAt(Le);const ce=new Blob([he],{type:ae.mimeType}),Se=window.URL.createObjectURL(ce),Pe=document.createElement("a");Pe.href=Se,Pe.download=ae.filename,document.body.appendChild(Pe),Pe.click(),document.body.removeChild(Pe),window.URL.revokeObjectURL(Se)}catch(Ie){console.error("Error downloading attachment:",Ie),alert("Failed to download attachment")}},ye=async be=>{if(!be){alert("No email selected");return}j(null);try{const ae={subject:be.subject||"No Subject",body:be.htmlBody||be.body||be.snippet||"",fromEmail:be.fromEmail||"",fromName:be.from||"",date:be.date?be.date.toISOString():new Date().toISOString()};sessionStorage.setItem("pendingEmailForInquiry",JSON.stringify(ae)),e("command-center")}catch(ae){console.error("Error preparing inquiry:",ae),alert("Failed to prepare inquiry. Please try again.")}},re=(be,ae)=>{be.preventDefault(),j({x:be.clientX,y:be.clientY,email:ae})},ke=be=>{const Ie=new Date().getTime()-be.getTime(),De=Math.floor(Ie/(1e3*60*60*24));return De===0?be.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):De<7?be.toLocaleDateString("en-US",{weekday:"short"}):be.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return n?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx(Do,{className:"w-6 h-6 animate-spin text-blue-500"})}):g?i.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:i.jsxs("div",{className:"text-center max-w-md px-6",children:[i.jsx(ya,{className:"w-16 h-16 text-amber-500 mx-auto mb-4"}),i.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Gmail Not Connected"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:g}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left",children:[i.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"To connect Gmail:"}),i.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[i.jsx("li",{children:"Go to Settings page"}),i.jsx("li",{children:"Navigate to Gmail Settings section"}),i.jsx("li",{children:'Click "Connect Gmail Account"'}),i.jsx("li",{children:"Authorize access to your Gmail account"})]})]}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition",children:"Refresh Page"})]})}):i.jsxs("div",{className:"flex h-[calc(100vh-16rem)] bg-white rounded-lg border border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"w-[10%] min-w-[140px] border-r border-gray-200 flex flex-col bg-gray-50",children:[i.jsx("div",{className:"p-3 border-b border-gray-200",children:i.jsx("h3",{className:"text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Folders"})}),i.jsxs("div",{className:"flex-1 overflow-y-auto py-1",children:[i.jsxs("button",{onClick:()=>f("INBOX"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="INBOX"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(hF,{className:"w-3.5 h-3.5"}),i.jsx("span",{children:"Inbox"})]}),i.jsxs("button",{onClick:()=>f("STARRED"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="STARRED"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(vv,{className:"w-3.5 h-3.5"}),i.jsx("span",{children:"Starred"})]}),i.jsxs("button",{onClick:()=>f("SENT"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="SENT"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(Ii,{className:"w-3.5 h-3.5"}),i.jsx("span",{children:"Sent"})]}),i.jsxs("button",{onClick:()=>f("DRAFT"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="DRAFT"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(la,{className:"w-3.5 h-3.5"}),i.jsx("span",{children:"Drafts"})]}),i.jsxs("button",{onClick:()=>f("ALL"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="ALL"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(oF,{className:"w-3.5 h-3.5"}),i.jsx("span",{children:"All Mail"})]}),i.jsxs("button",{onClick:()=>f("TRASH"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="TRASH"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(yv,{className:"w-3.5 h-3.5"}),i.jsx("span",{children:"Trash"})]})]}),i.jsx("div",{className:"p-2 border-t border-gray-200",children:i.jsxs("button",{onClick:()=>X(),disabled:s,className:"w-full flex items-center justify-center gap-1.5 px-2 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition disabled:opacity-50",children:[i.jsx(Ec,{className:`w-3 h-3 ${s?"animate-spin":""}`}),"Refresh"]})})]}),i.jsxs("div",{className:"w-[30%] min-w-[320px] flex flex-col border-r border-gray-200 bg-white",children:[i.jsx("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:i.jsxs("div",{className:"relative",children:[i.jsx(Hc,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),i.jsx("input",{type:"text",value:d,onChange:be=>v(be.target.value),placeholder:"Search emails...",className:"w-full pl-8 pr-3 py-1.5 text-xs border border-gray-300 rounded bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:s&&l.length===0?i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx(Do,{className:"w-6 h-6 animate-spin text-blue-500"})}):l.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[i.jsx(la,{className:"w-12 h-12 mb-4 text-gray-300"}),i.jsx("p",{className:"text-sm",children:"No emails found"})]}):i.jsxs("div",{children:[l.filter(be=>d===""||be.subject.toLowerCase().includes(d.toLowerCase())||be.from.toLowerCase().includes(d.toLowerCase())||be.snippet.toLowerCase().includes(d.toLowerCase())).map(be=>i.jsxs("div",{onClick:()=>C(be),onContextMenu:ae=>re(ae,be),className:`flex items-start gap-2 px-3 py-2.5 border-b border-gray-100 cursor-pointer transition ${(u==null?void 0:u.id)===be.id?"bg-blue-50 border-l-2 border-l-blue-500":(be.isUnread,"bg-white hover:bg-gray-50")}`,children:[i.jsx("button",{onClick:ae=>{ae.stopPropagation(),O(be.id,be.isStarred)},className:"mt-0.5 flex-shrink-0",children:i.jsx(vv,{className:`w-3.5 h-3.5 ${be.isStarred?"fill-yellow-400 text-yellow-400":"text-gray-300"} hover:text-yellow-400 transition`})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-baseline justify-between gap-2 mb-0.5",children:[i.jsx("p",{className:`text-xs truncate ${be.isUnread?"font-bold text-gray-900":"font-medium text-gray-700"}`,children:be.from}),i.jsx("span",{className:"text-[10px] text-gray-500 whitespace-nowrap flex-shrink-0",children:ke(be.date)})]}),i.jsx("p",{className:`text-xs truncate mb-0.5 ${be.isUnread?"font-semibold text-gray-900":"text-gray-600"}`,children:be.subject}),i.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-1",children:be.snippet})]}),be.isUnread&&i.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500 mt-1.5 flex-shrink-0"})]},be.id)),p&&i.jsx("div",{className:"p-4 text-center",children:i.jsx("button",{onClick:()=>X(p),disabled:s,className:"px-4 py-2 text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50",children:s?"Loading...":"Load More"})})]})})]}),i.jsx("div",{className:"flex-1 w-[60%] flex flex-col bg-white overflow-hidden",children:u?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-white",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3 leading-tight",children:u.subject}),i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",children:u.from.charAt(0).toUpperCase()}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("p",{className:"text-sm font-semibold text-gray-900",children:u.from}),i.jsx("p",{className:"text-xs text-gray-500 truncate",children:u.fromEmail})]})]}),i.jsx("p",{className:"text-xs text-gray-500 whitespace-nowrap",children:u.date.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 bg-gray-50",children:w?i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx(Do,{className:"w-6 h-6 animate-spin text-blue-500"})}):i.jsxs(i.Fragment,{children:[u.htmlBody?i.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:i.jsx(KF,{htmlContent:u.htmlBody})}):u.body?i.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:i.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:u.body})}):i.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:i.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:u.snippet})}),u.attachments&&u.attachments.length>0&&i.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm mt-4",children:[i.jsxs("p",{className:"text-xs font-semibold text-gray-700 mb-2 uppercase",children:["Attachments (",u.attachments.length,")"]}),i.jsx("div",{className:"space-y-2",children:u.attachments.map((be,ae)=>i.jsxs("button",{onClick:()=>z(u,be),className:"flex items-center gap-3 w-full p-3 bg-gray-50 hover:bg-gray-100 rounded-lg border border-gray-200 transition",children:[i.jsx(pr,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 text-left min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:be.filename}),i.jsxs("p",{className:"text-xs text-gray-500",children:[(be.size/1024).toFixed(1)," KB"]})]}),i.jsx(ld,{className:"w-4 h-4 text-gray-400"})]},ae))})]})]})}),i.jsx("div",{className:"px-4 py-3 border-t border-gray-200 bg-white",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>D(u,!1),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-700 transition",children:[i.jsx(NN,{className:"w-4 h-4"}),"Reply"]}),u.cc&&i.jsxs("button",{onClick:()=>D(u,!0),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition",children:[i.jsx(Qu,{className:"w-4 h-4"}),"Reply All"]}),i.jsxs("button",{onClick:()=>P(u),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition",children:[i.jsx(wN,{className:"w-4 h-4"}),"Forward"]}),i.jsxs("button",{onClick:()=>ye(u),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded hover:bg-blue-100 transition",children:[i.jsx(ua,{className:"w-4 h-4"}),"Process in Command Center"]}),i.jsxs("button",{onClick:()=>Q(u),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded hover:bg-red-100 transition ml-auto",children:[i.jsx(yv,{className:"w-4 h-4"}),"Delete"]})]})})]}):i.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx(la,{className:"w-20 h-20 mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Select an email to view"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Choose a message from your inbox"})]})})}),S&&i.jsxs("div",{ref:I,className:"fixed bg-white rounded-lg shadow-xl border border-gray-200 py-1 z-50 min-w-[160px]",style:{top:S.y,left:S.x},children:[i.jsxs("button",{onClick:()=>D(S.email,!1),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[i.jsx(NN,{className:"w-4 h-4"}),"Reply"]}),S.email.cc&&i.jsxs("button",{onClick:()=>D(S.email,!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[i.jsx(Qu,{className:"w-4 h-4"}),"Reply All"]}),i.jsxs("button",{onClick:()=>P(S.email),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[i.jsx(wN,{className:"w-4 h-4"}),"Forward"]}),i.jsxs("button",{onClick:()=>O(S.email.id,S.email.isStarred),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[i.jsx(vv,{className:"w-4 h-4"}),S.email.isStarred?"Unstar":"Star"]}),i.jsxs("button",{onClick:()=>ye(S.email),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2 border-t border-gray-100",children:[i.jsx(ua,{className:"w-4 h-4"}),"Process in Command Center"]}),i.jsxs("button",{onClick:()=>Q(S.email),className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-700 flex items-center gap-2 border-t border-gray-100",children:[i.jsx(yv,{className:"w-4 h-4"}),"Delete"]})]}),i.jsx(r$,{isOpen:b,onClose:()=>{B(!1),T(null),k("compose")},mode:_,replyTo:E?{id:E.id,subject:E.subject,from:E.from,fromEmail:E.fromEmail,body:E.body,htmlBody:E.htmlBody,date:E.date}:void 0,onSend:J})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ug={};Ug.version="0.18.5";var $F=1252,C$=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Zb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},e_=function(e){C$.indexOf(e)!=-1&&($F=Zb[0]=e)};function E$(){e_(1252)}var ro=function(e){e_(e)};function t_(){ro(1200),E$()}function uB(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function S$(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function VF(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Wf=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?S$(e.slice(2)):t==254&&r==255?VF(e.slice(2)):t==65279?e.slice(1):e},Qp=function(t){return String.fromCharCode(t)},AB=function(t){return String.fromCharCode(t)},Yh,fc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jh(e){for(var t="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,a=e.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=fc.charAt(s)+fc.charAt(o)+fc.charAt(l)+fc.charAt(c);return t}function oi(e){var t="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=fc.indexOf(e.charAt(u++)),o=fc.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=fc.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=fc.indexOf(e.charAt(u++)),a=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var cr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ll=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Tc(e){return cr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function dB(e){return cr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Zs=function(t){return cr?Ll(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ux(e){if(typeof ArrayBuffer>"u")return Zs(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function qc(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function k$(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function r_(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return r_(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ga=cr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ll(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function j$(e){for(var t=[],r=0,n=e.length+250,a=Tc(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Tc(65535),n=65530)}return t.push(a.slice(0,r)),ga(t)}var vs=/\u0000/g,zf=/[\u0001-\u0006]/g;function ud(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function no(e,t){var r=""+e;return r.length>=t?r:wn("0",t-r.length)+r}function n_(e,t){var r=""+e;return r.length>=t?r:wn(" ",t-r.length)+r}function Pg(e,t){var r=""+e;return r.length>=t?r:r+wn(" ",t-r.length)}function F$(e,t){var r=""+Math.round(e);return r.length>=t?r:wn("0",t-r.length)+r}function T$(e,t){var r=""+e;return r.length>=t?r:wn("0",t-r.length)+r}var fB=Math.pow(2,32);function wA(e,t){if(e>fB||e<-fB)return F$(e,t);var r=Math.round(e);return T$(r,t)}function Dg(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var hB=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function I$(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},pB={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},L$={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Rg(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,o=1,l=0,c=1,u=0,A=0,h=Math.floor(a);u<t&&(h=Math.floor(a),l=h*o+s,A=h*u+c,!(a-h<5e-8));)a=1/(a-h),s=o,o=l,c=u,u=A;if(A>t&&(u>t?(A=c,l=s):(A=u,l=o)),!r)return[0,n*l,A];var f=Math.floor(n*l/A);return[f,n*l-f*A,A]}function Nu(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=Q$(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var GF=new Date(1899,11,31,0,0,0),O$=GF.getTime(),U$=new Date(1900,2,1,0,0,0);function WF(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=U$&&(r+=24*60*60*1e3),(r-(O$+(e.getTimezoneOffset()-GF.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function a_(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function P$(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function D$(e){var t=e<0?12:11,r=a_(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function R$(e){var t=a_(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Zh(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=D$(e):t===10?r=e.toFixed(10).substr(0,12):r=R$(e),a_(P$(r.toUpperCase()))}function Mu(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Zh(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Oi(14,WF(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Q$(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function M$(e,t,r,n){var a="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return jv[r.m-1][1];case 5:return jv[r.m-1][0];default:return jv[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return hB[r.q][0];default:return hB[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?no(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(a=no(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var A=u>0?no(c,u):"";return A}function hc(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var zF=/%/g;function H$(e,t,r){var n=t.replace(zF,""),a=t.length-n.length;return wl(e,n,r*Math.pow(10,2*a))+wn("%",a)}function q$(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function XF(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+XF(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,A){return c+u+A.substr(0,(a+s)%a)+"."+A.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var YF=/# (\?+)( ?)\/( ?)(\d+)/;function K$(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?wn(" ",e[1].length+1+e[4].length):n_(o,e[1].length)+e[2]+"/"+e[3]+no(l,e[4].length))}function $$(e,t,r){return r+(t===0?"":""+t)+wn(" ",e[1].length+2+e[4].length)}var JF=/^#*0*\.([0#]+)/,ZF=/\).*[0#]/,e6=/\(###\) ###\\?-####/;function ps(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function mB(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function gB(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function V$(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function G$(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function mi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZF)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?mi("n",n,r):"("+mi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return q$(e,t,r);if(t.indexOf("%")!==-1)return H$(e,t,r);if(t.indexOf("E")!==-1)return XF(t,r);if(t.charCodeAt(0)===36)return"$"+mi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+wA(c,t.length);if(t.match(/^[#?]+$/))return a=wA(r,0),a==="0"&&(a=""),a.length>t.length?a:ps(t.substr(0,t.length-a.length))+a;if(s=t.match(YF))return K$(s,c,u);if(t.match(/^#+0+$/))return u+wA(c,t.length-t.indexOf("0"));if(s=t.match(JF))return a=mB(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ps(s[1])).replace(/\.$/,"."+ps(s[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+wn("0",ps(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+mB(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+hc(wA(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+mi(e,t,-r):hc(""+(Math.floor(r)+V$(r,s[1].length)))+"."+no(gB(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return mi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ud(mi(e,t.replace(/[\\-]/g,""),r)),o=0,ud(ud(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<a.length?a.charAt(o++):v==="0"?"0":""}));if(t.match(e6))return a=mi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var A="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=Rg(c,Math.pow(10,o)-1,!1),a=""+u,A=wl("n",s[1],l[1]),A.charAt(A.length-1)==" "&&(A=A.substr(0,A.length-1)+"0"),a+=A+s[2]+"/"+s[3],A=Pg(l[2],o),A.length<s[4].length&&(A=ps(s[4].substr(s[4].length-A.length))+A),a+=A,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=Rg(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?n_(l[1],o)+s[2]+"/"+s[3]+Pg(l[2],o):wn(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=wA(r,0),t.length<=a.length?a:ps(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,f=t.length-a.length-h;return ps(t.substr(0,h)+a+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=gB(r,s[1].length),r<0?"-"+mi(e,t,-r):hc(G$(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?no(0,3-v.length):"")+v})+"."+no(o,s[1].length);switch(t){case"###,##0.00":return mi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=hc(wA(c,0));return d!=="0"?u+d:"";case"###,###.00":return mi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return mi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function W$(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function z$(e,t,r){var n=t.replace(zF,""),a=t.length-n.length;return wl(e,n,r*Math.pow(10,2*a))+wn("%",a)}function t6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+t6(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,A){return c+u+A.substr(0,(a+s)%a)+"."+A.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Eo(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZF)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Eo("n",n,r):"("+Eo("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return W$(e,t,r);if(t.indexOf("%")!==-1)return z$(e,t,r);if(t.indexOf("E")!==-1)return t6(t,r);if(t.charCodeAt(0)===36)return"$"+Eo(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+no(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:ps(t.substr(0,t.length-a.length))+a;if(s=t.match(YF))return $$(s,c,u);if(t.match(/^#+0+$/))return u+no(c,t.length-t.indexOf("0"));if(s=t.match(JF))return a=(""+r).replace(/^([^\.]+)$/,"$1."+ps(s[1])).replace(/\.$/,"."+ps(s[1])),a=a.replace(/\.(\d*)$/,function(v,g){return"."+g+wn("0",ps(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+hc(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Eo(e,t,-r):hc(""+r)+"."+wn("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Eo(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ud(Eo(e,t.replace(/[\\-]/g,""),r)),o=0,ud(ud(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<a.length?a.charAt(o++):v==="0"?"0":""}));if(t.match(e6))return a=Eo(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var A="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=Rg(c,Math.pow(10,o)-1,!1),a=""+u,A=wl("n",s[1],l[1]),A.charAt(A.length-1)==" "&&(A=A.substr(0,A.length-1)+"0"),a+=A+s[2]+"/"+s[3],A=Pg(l[2],o),A.length<s[4].length&&(A=ps(s[4].substr(s[4].length-A.length))+A),a+=A,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=Rg(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?n_(l[1],o)+s[2]+"/"+s[3]+Pg(l[2],o):wn(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:ps(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,f=t.length-a.length-h;return ps(t.substr(0,h)+a+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Eo(e,t,-r):hc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?no(0,3-v.length):"")+v})+"."+no(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=hc(""+c);return d!=="0"?u+d:"";default:if(t.match(/\.[0#?]*$/))return Eo(e,t.slice(0,t.lastIndexOf(".")),r)+ps(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function wl(e,t,r){return(r|0)===r?Eo(e,t,r):mi(e,t,r)}function X$(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var r6=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function qd(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Dg(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(r6))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Y$(e,t,r,n){for(var a=[],s="",o=0,l="",c="t",u,A,h,f="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Dg(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(h);a[a.length]={t:"t",v:s},++o;break;case"\\":var d=e.charAt(++o),v=d==="("||d===")"?d:"t";a[a.length]={t:v,v:d},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Nu(t,r,e.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Nu(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var g={t:l,v:l};if(u==null&&(u=Nu(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",o+=5,f="h"):(g.t="t",++o),u==null&&g.t==="T")return"";a[a.length]=g,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(r6)){if(u==null&&(u=Nu(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",qd(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var y=0,p=0,m;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=f,c="h",y<1&&(y=1);break;case"s":(m=a[o].v.match(/\.0+$/))&&(p=Math.max(p,m[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[o].v.match(/[Hh]/)&&(y=1),y<2&&a[o].v.match(/[Mm]/)&&(y=2),y<3&&a[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",x;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=M$(a[o].t.charCodeAt(0),a[o].v,u,p),a[o].t="t";break;case"n":case"?":for(x=o+1;a[x]!=null&&((l=a[x].t)==="?"||l==="D"||(l===" "||l==="t")&&a[x+1]!=null&&(a[x+1].t==="?"||a[x+1].t==="t"&&a[x+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[x].v==="/"||a[x].v===" "&&a[x+1]!=null&&a[x+1].t=="?"));)a[o].v+=a[x].v,a[x]={v:"",t:";"},++x;w+=a[o].v,o=x-1;break;case"G":a[o].t="t",a[o].v=Mu(t,r);break}var b="",B,_;if(w.length>0){w.charCodeAt(0)==40?(B=t<0&&w.charCodeAt(0)===45?-t:t,_=wl("n",w,B)):(B=t<0&&n>1?-t:t,_=wl("n",w,B),B<0&&a[0]&&a[0].t=="t"&&(_=_.substr(1),a[0].v="-"+a[0].v)),x=_.length-1;var k=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){k=o;break}var E=a.length;if(k===a.length&&_.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(x>=a[o].v.length-1?(x-=a[o].v.length,a[o].v=_.substr(x+1,a[o].v.length)):x<0?a[o].v="":(a[o].v=_.substr(0,x+1),x=-1),a[o].t="t",E=o);x>=0&&E<a.length&&(a[E].v=_.substr(0,x+1)+a[E].v)}else if(k!==a.length&&_.indexOf("E")===-1){for(x=_.indexOf(".")-1,o=k;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(A=a[o].v.indexOf(".")>-1&&o===k?a[o].v.indexOf(".")-1:a[o].v.length-1,b=a[o].v.substr(A+1);A>=0;--A)x>=0&&(a[o].v.charAt(A)==="0"||a[o].v.charAt(A)==="#")&&(b=_.charAt(x--)+b);a[o].v=b,a[o].t="t",E=o}for(x>=0&&E<a.length&&(a[E].v=_.substr(0,x+1)+a[E].v),x=_.indexOf(".")+1,o=k;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==k)){for(A=a[o].v.indexOf(".")>-1&&o===k?a[o].v.indexOf(".")+1:0,b=a[o].v.substr(0,A);A<a[o].v.length;++A)x<_.length&&(b+=_.charAt(x++));a[o].v=b,a[o].t="t",E=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(B=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=wl(a[o].t,a[o].v,B),a[o].t="t");var T="";for(o=0;o!==a.length;++o)a[o]!=null&&(T+=a[o].v);return T}var xB=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vB(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function J$(e,t){var r=X$(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(xB),l=r[1].match(xB);return vB(t,o)?[n,r[0]]:vB(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Oi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Kt)[e],n==null&&(n=r.table&&r.table[pB[e]]||Kt[pB[e]]),n==null&&(n=L$[e]||"General");break}if(Dg(n,0))return Mu(t,r);t instanceof Date&&(t=WF(t,r.date1904));var a=J$(n,t);if(Dg(a[1]))return Mu(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Y$(a[1],t,r,a[0])}function bl(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Kt[r]==null){t<0&&(t=r);continue}if(Kt[r]==e){t=r;break}}t<0&&(t=391)}return Kt[t]=e,t}function Px(e){for(var t=0;t!=392;++t)e[t]!==void 0&&bl(e[t],t)}function Kd(){Kt=I$()}var Z$={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},n6=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function eV(e){var t=typeof e=="number"?Kt[e]:e;return t=t.replace(n6,"(\\d+)"),new RegExp("^"+t+"$")}function tV(e,t,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(t.match(n6)||[]).forEach(function(h,f){var d=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":o=d;break;case"s":c=d;break;case"m":o>=0?l=d:a=d;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var A=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&s==-1?A:u+"T"+A}var rV=function(){var e={};e.version="1.2.0";function t(){for(var _=0,k=new Array(256),E=0;E!=256;++E)_=E,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,k[E]=_;return typeof Int32Array<"u"?new Int32Array(k):k}var r=t();function n(_){var k=0,E=0,T=0,S=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)S[T]=_[T];for(T=0;T!=256;++T)for(E=_[T],k=256+T;k<4096;k+=256)E=S[k]=E>>>8^_[E&255];var j=[];for(T=1;T!=16;++T)j[T-1]=typeof Int32Array<"u"?S.subarray(T*256,T*256+256):S.slice(T*256,T*256+256);return j}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4],A=a[5],h=a[6],f=a[7],d=a[8],v=a[9],g=a[10],y=a[11],p=a[12],m=a[13],w=a[14];function x(_,k){for(var E=k^-1,T=0,S=_.length;T<S;)E=E>>>8^r[(E^_.charCodeAt(T++))&255];return~E}function b(_,k){for(var E=k^-1,T=_.length-15,S=0;S<T;)E=w[_[S++]^E&255]^m[_[S++]^E>>8&255]^p[_[S++]^E>>16&255]^y[_[S++]^E>>>24]^g[_[S++]]^v[_[S++]]^d[_[S++]]^f[_[S++]]^h[_[S++]]^A[_[S++]]^u[_[S++]]^c[_[S++]]^l[_[S++]]^o[_[S++]]^s[_[S++]]^r[_[S++]];for(T+=15;S<T;)E=E>>>8^r[(E^_[S++])&255];return~E}function B(_,k){for(var E=k^-1,T=0,S=_.length,j=0,I=0;T<S;)j=_.charCodeAt(T++),j<128?E=E>>>8^r[(E^j)&255]:j<2048?(E=E>>>8^r[(E^(192|j>>6&31))&255],E=E>>>8^r[(E^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,I=_.charCodeAt(T++)&1023,E=E>>>8^r[(E^(240|j>>8&7))&255],E=E>>>8^r[(E^(128|j>>2&63))&255],E=E>>>8^r[(E^(128|I>>6&15|(j&3)<<4))&255],E=E>>>8^r[(E^(128|I&63))&255]):(E=E>>>8^r[(E^(224|j>>12&15))&255],E=E>>>8^r[(E^(128|j>>6&63))&255],E=E>>>8^r[(E^(128|j&63))&255]);return~E}return e.table=r,e.bstr=x,e.buf=b,e.str=B,e}(),Qt=function(){var t={};t.version="1.2.1";function r(le,ee){for(var se=le.split("/"),ne=ee.split("/"),xe=0,me=0,Ue=Math.min(se.length,ne.length);xe<Ue;++xe){if(me=se[xe].length-ne[xe].length)return me;if(se[xe]!=ne[xe])return se[xe]<ne[xe]?-1:1}return se.length-ne.length}function n(le){if(le.charAt(le.length-1)=="/")return le.slice(0,-1).indexOf("/")===-1?le:n(le.slice(0,-1));var ee=le.lastIndexOf("/");return ee===-1?le:le.slice(0,ee+1)}function a(le){if(le.charAt(le.length-1)=="/")return a(le.slice(0,-1));var ee=le.lastIndexOf("/");return ee===-1?le:le.slice(ee+1)}function s(le,ee){typeof ee=="string"&&(ee=new Date(ee));var se=ee.getHours();se=se<<6|ee.getMinutes(),se=se<<5|ee.getSeconds()>>>1,le.write_shift(2,se);var ne=ee.getFullYear()-1980;ne=ne<<4|ee.getMonth()+1,ne=ne<<5|ee.getDate(),le.write_shift(2,ne)}function o(le){var ee=le.read_shift(2)&65535,se=le.read_shift(2)&65535,ne=new Date,xe=se&31;se>>>=5;var me=se&15;se>>>=4,ne.setMilliseconds(0),ne.setFullYear(se+1980),ne.setMonth(me-1),ne.setDate(xe);var Ue=ee&31;ee>>>=5;var Me=ee&63;return ee>>>=6,ne.setHours(ee),ne.setMinutes(Me),ne.setSeconds(Ue<<1),ne}function l(le){Ia(le,0);for(var ee={},se=0;le.l<=le.length-4;){var ne=le.read_shift(2),xe=le.read_shift(2),me=le.l+xe,Ue={};switch(ne){case 21589:se=le.read_shift(1),se&1&&(Ue.mtime=le.read_shift(4)),xe>5&&(se&2&&(Ue.atime=le.read_shift(4)),se&4&&(Ue.ctime=le.read_shift(4))),Ue.mtime&&(Ue.mt=new Date(Ue.mtime*1e3));break}le.l=me,ee[ne]=Ue}return ee}var c;function u(){return c||(c={})}function A(le,ee){if(le[0]==80&&le[1]==75)return _t(le,ee);if((le[0]|32)==109&&(le[1]|32)==105)return Lt(le,ee);if(le.length<512)throw new Error("CFB file size "+le.length+" < 512");var se=3,ne=512,xe=0,me=0,Ue=0,Me=0,$e=0,Ge=[],je=le.slice(0,512);Ia(je,0);var _e=h(je);switch(se=_e[0],se){case 3:ne=512;break;case 4:ne=4096;break;case 0:if(_e[1]==0)return _t(le,ee);default:throw new Error("Major Version: Expected 3 or 4 saw "+se)}ne!==512&&(je=le.slice(0,ne),Ia(je,28));var He=le.slice(0,ne);f(je,se);var Je=je.read_shift(4,"i");if(se===3&&Je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Je);je.l+=4,Ue=je.read_shift(4,"i"),je.l+=4,je.chk("00100000","Mini Stream Cutoff Size: "),Me=je.read_shift(4,"i"),xe=je.read_shift(4,"i"),$e=je.read_shift(4,"i"),me=je.read_shift(4,"i");for(var st=-1,tt=0;tt<109&&(st=je.read_shift(4,"i"),!(st<0));++tt)Ge[tt]=st;var yt=d(le,ne);y($e,me,yt,ne,Ge);var zt=m(yt,Ue,Ge,ne);zt[Ue].name="!Directory",xe>0&&Me!==I&&(zt[Me].name="!MiniFAT"),zt[Ge[0]].name="!FAT",zt.fat_addrs=Ge,zt.ssz=ne;var $t={},_r=[],_a=[],lr=[];w(Ue,zt,yt,_r,xe,$t,_a,Me),v(_a,lr,_r),_r.shift();var Wr={FileIndex:_a,FullPaths:lr};return ee&&ee.raw&&(Wr.raw={header:He,sectors:yt}),Wr}function h(le){if(le[le.l]==80&&le[le.l+1]==75)return[0,0];le.chk(U,"Header Signature: "),le.l+=16;var ee=le.read_shift(2,"u");return[le.read_shift(2,"u"),ee]}function f(le,ee){var se=9;switch(le.l+=2,se=le.read_shift(2)){case 9:if(ee!=3)throw new Error("Sector Shift: Expected 9 saw "+se);break;case 12:if(ee!=4)throw new Error("Sector Shift: Expected 12 saw "+se);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+se)}le.chk("0600","Mini Sector Shift: "),le.chk("000000000000","Reserved: ")}function d(le,ee){for(var se=Math.ceil(le.length/ee)-1,ne=[],xe=1;xe<se;++xe)ne[xe-1]=le.slice(xe*ee,(xe+1)*ee);return ne[se-1]=le.slice(se*ee),ne}function v(le,ee,se){for(var ne=0,xe=0,me=0,Ue=0,Me=0,$e=se.length,Ge=[],je=[];ne<$e;++ne)Ge[ne]=je[ne]=ne,ee[ne]=se[ne];for(;Me<je.length;++Me)ne=je[Me],xe=le[ne].L,me=le[ne].R,Ue=le[ne].C,Ge[ne]===ne&&(xe!==-1&&Ge[xe]!==xe&&(Ge[ne]=Ge[xe]),me!==-1&&Ge[me]!==me&&(Ge[ne]=Ge[me])),Ue!==-1&&(Ge[Ue]=ne),xe!==-1&&ne!=Ge[ne]&&(Ge[xe]=Ge[ne],je.lastIndexOf(xe)<Me&&je.push(xe)),me!==-1&&ne!=Ge[ne]&&(Ge[me]=Ge[ne],je.lastIndexOf(me)<Me&&je.push(me));for(ne=1;ne<$e;++ne)Ge[ne]===ne&&(me!==-1&&Ge[me]!==me?Ge[ne]=Ge[me]:xe!==-1&&Ge[xe]!==xe&&(Ge[ne]=Ge[xe]));for(ne=1;ne<$e;++ne)if(le[ne].type!==0){if(Me=ne,Me!=Ge[Me])do Me=Ge[Me],ee[ne]=ee[Me]+"/"+ee[ne];while(Me!==0&&Ge[Me]!==-1&&Me!=Ge[Me]);Ge[ne]=-1}for(ee[0]+="/",ne=1;ne<$e;++ne)le[ne].type!==2&&(ee[ne]+="/")}function g(le,ee,se){for(var ne=le.start,xe=le.size,me=[],Ue=ne;se&&xe>0&&Ue>=0;)me.push(ee.slice(Ue*j,Ue*j+j)),xe-=j,Ue=gu(se,Ue*4);return me.length===0?Ze(0):ga(me).slice(0,le.size)}function y(le,ee,se,ne,xe){var me=I;if(le===I){if(ee!==0)throw new Error("DIFAT chain shorter than expected")}else if(le!==-1){var Ue=se[le],Me=(ne>>>2)-1;if(!Ue)return;for(var $e=0;$e<Me&&(me=gu(Ue,$e*4))!==I;++$e)xe.push(me);y(gu(Ue,ne-4),ee-1,se,ne,xe)}}function p(le,ee,se,ne,xe){var me=[],Ue=[];xe||(xe=[]);var Me=ne-1,$e=0,Ge=0;for($e=ee;$e>=0;){xe[$e]=!0,me[me.length]=$e,Ue.push(le[$e]);var je=se[Math.floor($e*4/ne)];if(Ge=$e*4&Me,ne<4+Ge)throw new Error("FAT boundary crossed: "+$e+" 4 "+ne);if(!le[je])break;$e=gu(le[je],Ge)}return{nodes:me,data:FB([Ue])}}function m(le,ee,se,ne){var xe=le.length,me=[],Ue=[],Me=[],$e=[],Ge=ne-1,je=0,_e=0,He=0,Je=0;for(je=0;je<xe;++je)if(Me=[],He=je+ee,He>=xe&&(He-=xe),!Ue[He]){$e=[];var st=[];for(_e=He;_e>=0;){st[_e]=!0,Ue[_e]=!0,Me[Me.length]=_e,$e.push(le[_e]);var tt=se[Math.floor(_e*4/ne)];if(Je=_e*4&Ge,ne<4+Je)throw new Error("FAT boundary crossed: "+_e+" 4 "+ne);if(!le[tt]||(_e=gu(le[tt],Je),st[_e]))break}me[He]={nodes:Me,data:FB([$e])}}return me}function w(le,ee,se,ne,xe,me,Ue,Me){for(var $e=0,Ge=ne.length?2:0,je=ee[le].data,_e=0,He=0,Je;_e<je.length;_e+=128){var st=je.slice(_e,_e+128);Ia(st,64),He=st.read_shift(2),Je=A_(st,0,He-Ge),ne.push(Je);var tt={name:Je,type:st.read_shift(1),color:st.read_shift(1),L:st.read_shift(4,"i"),R:st.read_shift(4,"i"),C:st.read_shift(4,"i"),clsid:st.read_shift(16),state:st.read_shift(4,"i"),start:0,size:0},yt=st.read_shift(2)+st.read_shift(2)+st.read_shift(2)+st.read_shift(2);yt!==0&&(tt.ct=x(st,st.l-8));var zt=st.read_shift(2)+st.read_shift(2)+st.read_shift(2)+st.read_shift(2);zt!==0&&(tt.mt=x(st,st.l-8)),tt.start=st.read_shift(4,"i"),tt.size=st.read_shift(4,"i"),tt.size<0&&tt.start<0&&(tt.size=tt.type=0,tt.start=I,tt.name=""),tt.type===5?($e=tt.start,xe>0&&$e!==I&&(ee[$e].name="!StreamData")):tt.size>=4096?(tt.storage="fat",ee[tt.start]===void 0&&(ee[tt.start]=p(se,tt.start,ee.fat_addrs,ee.ssz)),ee[tt.start].name=tt.name,tt.content=ee[tt.start].data.slice(0,tt.size)):(tt.storage="minifat",tt.size<0?tt.size=0:$e!==I&&tt.start!==I&&ee[$e]&&(tt.content=g(tt,ee[$e].data,(ee[Me]||{}).data))),tt.content&&Ia(tt.content,0),me[Je]=tt,Ue.push(tt)}}function x(le,ee){return new Date((Xs(le,ee+4)/1e7*Math.pow(2,32)+Xs(le,ee)/1e7-11644473600)*1e3)}function b(le,ee){return u(),A(c.readFileSync(le),ee)}function B(le,ee){var se=ee&&ee.type;switch(se||cr&&Buffer.isBuffer(le)&&(se="buffer"),se||"base64"){case"file":return b(le,ee);case"base64":return A(Zs(oi(le)),ee);case"binary":return A(Zs(le),ee)}return A(le,ee)}function _(le,ee){var se=ee||{},ne=se.root||"Root Entry";if(le.FullPaths||(le.FullPaths=[]),le.FileIndex||(le.FileIndex=[]),le.FullPaths.length!==le.FileIndex.length)throw new Error("inconsistent CFB structure");le.FullPaths.length===0&&(le.FullPaths[0]=ne+"/",le.FileIndex[0]={name:ne,type:5}),se.CLSID&&(le.FileIndex[0].clsid=se.CLSID),k(le)}function k(le){var ee="Sh33tJ5";if(!Qt.find(le,"/"+ee)){var se=Ze(4);se[0]=55,se[1]=se[3]=50,se[2]=54,le.FileIndex.push({name:ee,type:2,content:se,size:4,L:69,R:69,C:69}),le.FullPaths.push(le.FullPaths[0]+ee),E(le)}}function E(le,ee){_(le);for(var se=!1,ne=!1,xe=le.FullPaths.length-1;xe>=0;--xe){var me=le.FileIndex[xe];switch(me.type){case 0:ne?se=!0:(le.FileIndex.pop(),le.FullPaths.pop());break;case 1:case 2:case 5:ne=!0,isNaN(me.R*me.L*me.C)&&(se=!0),me.R>-1&&me.L>-1&&me.R==me.L&&(se=!0);break;default:se=!0;break}}if(!(!se&&!ee)){var Ue=new Date(1987,1,19),Me=0,$e=Object.create?Object.create(null):{},Ge=[];for(xe=0;xe<le.FullPaths.length;++xe)$e[le.FullPaths[xe]]=!0,le.FileIndex[xe].type!==0&&Ge.push([le.FullPaths[xe],le.FileIndex[xe]]);for(xe=0;xe<Ge.length;++xe){var je=n(Ge[xe][0]);ne=$e[je],ne||(Ge.push([je,{name:a(je).replace("/",""),type:1,clsid:V,ct:Ue,mt:Ue,content:null}]),$e[je]=!0)}for(Ge.sort(function(Je,st){return r(Je[0],st[0])}),le.FullPaths=[],le.FileIndex=[],xe=0;xe<Ge.length;++xe)le.FullPaths[xe]=Ge[xe][0],le.FileIndex[xe]=Ge[xe][1];for(xe=0;xe<Ge.length;++xe){var _e=le.FileIndex[xe],He=le.FullPaths[xe];if(_e.name=a(He).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||V,xe===0)_e.C=Ge.length>1?1:-1,_e.size=0,_e.type=5;else if(He.slice(-1)=="/"){for(Me=xe+1;Me<Ge.length&&n(le.FullPaths[Me])!=He;++Me);for(_e.C=Me>=Ge.length?-1:Me,Me=xe+1;Me<Ge.length&&n(le.FullPaths[Me])!=n(He);++Me);_e.R=Me>=Ge.length?-1:Me,_e.type=1}else n(le.FullPaths[xe+1]||"")==n(He)&&(_e.R=xe+1),_e.type=2}}}function T(le,ee){var se=ee||{};if(se.fileType=="mad")return Dn(le,se);switch(E(le),se.fileType){case"zip":return bt(le,se)}var ne=function(Je){for(var st=0,tt=0,yt=0;yt<Je.FileIndex.length;++yt){var zt=Je.FileIndex[yt];if(zt.content){var $t=zt.content.length;$t>0&&($t<4096?st+=$t+63>>6:tt+=$t+511>>9)}}for(var _r=Je.FullPaths.length+3>>2,_a=st+7>>3,lr=st+127>>7,Wr=_a+tt+_r+lr,Rr=Wr+127>>7,Di=Rr<=109?0:Math.ceil((Rr-109)/127);Wr+Rr+Di+127>>7>Rr;)Di=++Rr<=109?0:Math.ceil((Rr-109)/127);var mn=[1,Di,Rr,lr,_r,tt,st,0];return Je.FileIndex[0].size=st<<6,mn[7]=(Je.FileIndex[0].start=mn[0]+mn[1]+mn[2]+mn[3]+mn[4]+mn[5])+(mn[6]+7>>3),mn}(le),xe=Ze(ne[7]<<9),me=0,Ue=0;{for(me=0;me<8;++me)xe.write_shift(1,q[me]);for(me=0;me<8;++me)xe.write_shift(2,0);for(xe.write_shift(2,62),xe.write_shift(2,3),xe.write_shift(2,65534),xe.write_shift(2,9),xe.write_shift(2,6),me=0;me<3;++me)xe.write_shift(2,0);for(xe.write_shift(4,0),xe.write_shift(4,ne[2]),xe.write_shift(4,ne[0]+ne[1]+ne[2]+ne[3]-1),xe.write_shift(4,0),xe.write_shift(4,4096),xe.write_shift(4,ne[3]?ne[0]+ne[1]+ne[2]-1:I),xe.write_shift(4,ne[3]),xe.write_shift(-4,ne[1]?ne[0]-1:I),xe.write_shift(4,ne[1]),me=0;me<109;++me)xe.write_shift(-4,me<ne[2]?ne[1]+me:-1)}if(ne[1])for(Ue=0;Ue<ne[1];++Ue){for(;me<236+Ue*127;++me)xe.write_shift(-4,me<ne[2]?ne[1]+me:-1);xe.write_shift(-4,Ue===ne[1]-1?I:Ue+1)}var Me=function(Je){for(Ue+=Je;me<Ue-1;++me)xe.write_shift(-4,me+1);Je&&(++me,xe.write_shift(-4,I))};for(Ue=me=0,Ue+=ne[1];me<Ue;++me)xe.write_shift(-4,X.DIFSECT);for(Ue+=ne[2];me<Ue;++me)xe.write_shift(-4,X.FATSECT);Me(ne[3]),Me(ne[4]);for(var $e=0,Ge=0,je=le.FileIndex[0];$e<le.FileIndex.length;++$e)je=le.FileIndex[$e],je.content&&(Ge=je.content.length,!(Ge<4096)&&(je.start=Ue,Me(Ge+511>>9)));for(Me(ne[6]+7>>3);xe.l&511;)xe.write_shift(-4,X.ENDOFCHAIN);for(Ue=me=0,$e=0;$e<le.FileIndex.length;++$e)je=le.FileIndex[$e],je.content&&(Ge=je.content.length,!(!Ge||Ge>=4096)&&(je.start=Ue,Me(Ge+63>>6)));for(;xe.l&511;)xe.write_shift(-4,X.ENDOFCHAIN);for(me=0;me<ne[4]<<2;++me){var _e=le.FullPaths[me];if(!_e||_e.length===0){for($e=0;$e<17;++$e)xe.write_shift(4,0);for($e=0;$e<3;++$e)xe.write_shift(4,-1);for($e=0;$e<12;++$e)xe.write_shift(4,0);continue}je=le.FileIndex[me],me===0&&(je.start=je.size?je.start-1:I);var He=me===0&&se.root||je.name;if(Ge=2*(He.length+1),xe.write_shift(64,He,"utf16le"),xe.write_shift(2,Ge),xe.write_shift(1,je.type),xe.write_shift(1,je.color),xe.write_shift(-4,je.L),xe.write_shift(-4,je.R),xe.write_shift(-4,je.C),je.clsid)xe.write_shift(16,je.clsid,"hex");else for($e=0;$e<4;++$e)xe.write_shift(4,0);xe.write_shift(4,je.state||0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,je.start),xe.write_shift(4,je.size),xe.write_shift(4,0)}for(me=1;me<le.FileIndex.length;++me)if(je=le.FileIndex[me],je.size>=4096)if(xe.l=je.start+1<<9,cr&&Buffer.isBuffer(je.content))je.content.copy(xe,xe.l,0,je.size),xe.l+=je.size+511&-512;else{for($e=0;$e<je.size;++$e)xe.write_shift(1,je.content[$e]);for(;$e&511;++$e)xe.write_shift(1,0)}for(me=1;me<le.FileIndex.length;++me)if(je=le.FileIndex[me],je.size>0&&je.size<4096)if(cr&&Buffer.isBuffer(je.content))je.content.copy(xe,xe.l,0,je.size),xe.l+=je.size+63&-64;else{for($e=0;$e<je.size;++$e)xe.write_shift(1,je.content[$e]);for(;$e&63;++$e)xe.write_shift(1,0)}if(cr)xe.l=xe.length;else for(;xe.l<xe.length;)xe.write_shift(1,0);return xe}function S(le,ee){var se=le.FullPaths.map(function($e){return $e.toUpperCase()}),ne=se.map(function($e){var Ge=$e.split("/");return Ge[Ge.length-($e.slice(-1)=="/"?2:1)]}),xe=!1;ee.charCodeAt(0)===47?(xe=!0,ee=se[0].slice(0,-1)+ee):xe=ee.indexOf("/")!==-1;var me=ee.toUpperCase(),Ue=xe===!0?se.indexOf(me):ne.indexOf(me);if(Ue!==-1)return le.FileIndex[Ue];var Me=!me.match(zf);for(me=me.replace(vs,""),Me&&(me=me.replace(zf,"!")),Ue=0;Ue<se.length;++Ue)if((Me?se[Ue].replace(zf,"!"):se[Ue]).replace(vs,"")==me||(Me?ne[Ue].replace(zf,"!"):ne[Ue]).replace(vs,"")==me)return le.FileIndex[Ue];return null}var j=64,I=-2,U="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],V="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:I,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:V,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(le,ee,se){u();var ne=T(le,se);c.writeFileSync(ee,ne)}function M(le){for(var ee=new Array(le.length),se=0;se<le.length;++se)ee[se]=String.fromCharCode(le[se]);return ee.join("")}function G(le,ee){var se=T(le,ee);switch(ee&&ee.type||"buffer"){case"file":return u(),c.writeFileSync(ee.filename,se),se;case"binary":return typeof se=="string"?se:M(se);case"base64":return Jh(typeof se=="string"?se:M(se));case"buffer":if(cr)return Buffer.isBuffer(se)?se:Ll(se);case"array":return typeof se=="string"?Zs(se):se}return se}var H;function C(le){try{var ee=le.InflateRaw,se=new ee;if(se._processChunk(new Uint8Array([3,0]),se._finishFlushFlag),se.bytesRead)H=le;else throw new Error("zlib does not expose bytesRead")}catch(ne){console.error("cannot use native zlib: "+(ne.message||ne))}}function L(le,ee){if(!H)return Et(le,ee);var se=H.InflateRaw,ne=new se,xe=ne._processChunk(le.slice(le.l),ne._finishFlushFlag);return le.l+=ne.bytesRead,xe}function O(le){return H?H.deflateRawSync(le):Qe(le)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(le){var ee=(le<<1|le<<11)&139536|(le<<5|le<<15)&558144;return(ee>>16|ee>>8|ee)&255}for(var te=typeof Uint8Array<"u",z=te?new Uint8Array(256):[],ye=0;ye<256;++ye)z[ye]=J(ye);function re(le,ee){var se=z[le&255];return ee<=8?se>>>8-ee:(se=se<<8|z[le>>8&255],ee<=16?se>>>16-ee:(se=se<<8|z[le>>16&255],se>>>24-ee))}function ke(le,ee){var se=ee&7,ne=ee>>>3;return(le[ne]|(se<=6?0:le[ne+1]<<8))>>>se&3}function be(le,ee){var se=ee&7,ne=ee>>>3;return(le[ne]|(se<=5?0:le[ne+1]<<8))>>>se&7}function ae(le,ee){var se=ee&7,ne=ee>>>3;return(le[ne]|(se<=4?0:le[ne+1]<<8))>>>se&15}function Ie(le,ee){var se=ee&7,ne=ee>>>3;return(le[ne]|(se<=3?0:le[ne+1]<<8))>>>se&31}function De(le,ee){var se=ee&7,ne=ee>>>3;return(le[ne]|(se<=1?0:le[ne+1]<<8))>>>se&127}function pe(le,ee,se){var ne=ee&7,xe=ee>>>3,me=(1<<se)-1,Ue=le[xe]>>>ne;return se<8-ne||(Ue|=le[xe+1]<<8-ne,se<16-ne)||(Ue|=le[xe+2]<<16-ne,se<24-ne)||(Ue|=le[xe+3]<<24-ne),Ue&me}function we(le,ee,se){var ne=ee&7,xe=ee>>>3;return ne<=5?le[xe]|=(se&7)<<ne:(le[xe]|=se<<ne&255,le[xe+1]=(se&7)>>8-ne),ee+3}function Te(le,ee,se){var ne=ee&7,xe=ee>>>3;return se=(se&1)<<ne,le[xe]|=se,ee+1}function he(le,ee,se){var ne=ee&7,xe=ee>>>3;return se<<=ne,le[xe]|=se&255,se>>>=8,le[xe+1]=se,ee+8}function ce(le,ee,se){var ne=ee&7,xe=ee>>>3;return se<<=ne,le[xe]|=se&255,se>>>=8,le[xe+1]=se&255,le[xe+2]=se>>>8,ee+16}function Se(le,ee){var se=le.length,ne=2*se>ee?2*se:ee+5,xe=0;if(se>=ee)return le;if(cr){var me=dB(ne);if(le.copy)le.copy(me);else for(;xe<le.length;++xe)me[xe]=le[xe];return me}else if(te){var Ue=new Uint8Array(ne);if(Ue.set)Ue.set(le);else for(;xe<se;++xe)Ue[xe]=le[xe];return Ue}return le.length=ne,le}function Pe(le){for(var ee=new Array(le),se=0;se<le;++se)ee[se]=0;return ee}function Le(le,ee,se){var ne=1,xe=0,me=0,Ue=0,Me=0,$e=le.length,Ge=te?new Uint16Array(32):Pe(32);for(me=0;me<32;++me)Ge[me]=0;for(me=$e;me<se;++me)le[me]=0;$e=le.length;var je=te?new Uint16Array($e):Pe($e);for(me=0;me<$e;++me)Ge[xe=le[me]]++,ne<xe&&(ne=xe),je[me]=0;for(Ge[0]=0,me=1;me<=ne;++me)Ge[me+16]=Me=Me+Ge[me-1]<<1;for(me=0;me<$e;++me)Me=le[me],Me!=0&&(je[me]=Ge[Me+16]++);var _e=0;for(me=0;me<$e;++me)if(_e=le[me],_e!=0)for(Me=re(je[me],ne)>>ne-_e,Ue=(1<<ne+4-_e)-1;Ue>=0;--Ue)ee[Me|Ue<<_e]=_e&15|me<<4;return ne}var Xe=te?new Uint16Array(512):Pe(512),fe=te?new Uint16Array(32):Pe(32);if(!te){for(var Ee=0;Ee<512;++Ee)Xe[Ee]=0;for(Ee=0;Ee<32;++Ee)fe[Ee]=0}(function(){for(var le=[],ee=0;ee<32;ee++)le.push(5);Le(le,fe,32);var se=[];for(ee=0;ee<=143;ee++)se.push(8);for(;ee<=255;ee++)se.push(9);for(;ee<=279;ee++)se.push(7);for(;ee<=287;ee++)se.push(8);Le(se,Xe,288)})();var qe=function(){for(var ee=te?new Uint8Array(32768):[],se=0,ne=0;se<Q.length-1;++se)for(;ne<Q[se+1];++ne)ee[ne]=se;for(;ne<32768;++ne)ee[ne]=29;var xe=te?new Uint8Array(259):[];for(se=0,ne=0;se<P.length-1;++se)for(;ne<P[se+1];++ne)xe[ne]=se;function me(Me,$e){for(var Ge=0;Ge<Me.length;){var je=Math.min(65535,Me.length-Ge),_e=Ge+je==Me.length;for($e.write_shift(1,+_e),$e.write_shift(2,je),$e.write_shift(2,~je&65535);je-- >0;)$e[$e.l++]=Me[Ge++]}return $e.l}function Ue(Me,$e){for(var Ge=0,je=0,_e=te?new Uint16Array(32768):[];je<Me.length;){var He=Math.min(65535,Me.length-je);if(He<10){for(Ge=we($e,Ge,+(je+He==Me.length)),Ge&7&&(Ge+=8-(Ge&7)),$e.l=Ge/8|0,$e.write_shift(2,He),$e.write_shift(2,~He&65535);He-- >0;)$e[$e.l++]=Me[je++];Ge=$e.l*8;continue}Ge=we($e,Ge,+(je+He==Me.length)+2);for(var Je=0;He-- >0;){var st=Me[je];Je=(Je<<5^st)&32767;var tt=-1,yt=0;if((tt=_e[Je])&&(tt|=je&-32768,tt>je&&(tt-=32768),tt<je))for(;Me[tt+yt]==Me[je+yt]&&yt<250;)++yt;if(yt>2){st=xe[yt],st<=22?Ge=he($e,Ge,z[st+1]>>1)-1:(he($e,Ge,3),Ge+=5,he($e,Ge,z[st-23]>>5),Ge+=3);var zt=st<8?0:st-4>>2;zt>0&&(ce($e,Ge,yt-P[st]),Ge+=zt),st=ee[je-tt],Ge=he($e,Ge,z[st]>>3),Ge-=3;var $t=st<4?0:st-2>>1;$t>0&&(ce($e,Ge,je-tt-Q[st]),Ge+=$t);for(var _r=0;_r<yt;++_r)_e[Je]=je&32767,Je=(Je<<5^Me[je])&32767,++je;He-=yt-1}else st<=143?st=st+48:Ge=Te($e,Ge,1),Ge=he($e,Ge,z[st]),_e[Je]=je&32767,++je}Ge=he($e,Ge,0)-1}return $e.l=(Ge+7)/8|0,$e.l}return function($e,Ge){return $e.length<8?me($e,Ge):Ue($e,Ge)}}();function Qe(le){var ee=Ze(50+Math.floor(le.length*1.1)),se=qe(le,ee);return ee.slice(0,se)}var Ye=te?new Uint16Array(32768):Pe(32768),Nt=te?new Uint16Array(32768):Pe(32768),xt=te?new Uint16Array(128):Pe(128),it=1,ut=1;function Mt(le,ee){var se=Ie(le,ee)+257;ee+=5;var ne=Ie(le,ee)+1;ee+=5;var xe=ae(le,ee)+4;ee+=4;for(var me=0,Ue=te?new Uint8Array(19):Pe(19),Me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$e=1,Ge=te?new Uint8Array(8):Pe(8),je=te?new Uint8Array(8):Pe(8),_e=Ue.length,He=0;He<xe;++He)Ue[D[He]]=me=be(le,ee),$e<me&&($e=me),Ge[me]++,ee+=3;var Je=0;for(Ge[0]=0,He=1;He<=$e;++He)je[He]=Je=Je+Ge[He-1]<<1;for(He=0;He<_e;++He)(Je=Ue[He])!=0&&(Me[He]=je[Je]++);var st=0;for(He=0;He<_e;++He)if(st=Ue[He],st!=0){Je=z[Me[He]]>>8-st;for(var tt=(1<<7-st)-1;tt>=0;--tt)xt[Je|tt<<st]=st&7|He<<3}var yt=[];for($e=1;yt.length<se+ne;)switch(Je=xt[De(le,ee)],ee+=Je&7,Je>>>=3){case 16:for(me=3+ke(le,ee),ee+=2,Je=yt[yt.length-1];me-- >0;)yt.push(Je);break;case 17:for(me=3+be(le,ee),ee+=3;me-- >0;)yt.push(0);break;case 18:for(me=11+De(le,ee),ee+=7;me-- >0;)yt.push(0);break;default:yt.push(Je),$e<Je&&($e=Je);break}var zt=yt.slice(0,se),$t=yt.slice(se);for(He=se;He<286;++He)zt[He]=0;for(He=ne;He<30;++He)$t[He]=0;return it=Le(zt,Ye,286),ut=Le($t,Nt,30),ee}function ht(le,ee){if(le[0]==3&&!(le[1]&3))return[Tc(ee),2];for(var se=0,ne=0,xe=dB(ee||1<<18),me=0,Ue=xe.length>>>0,Me=0,$e=0;!(ne&1);){if(ne=be(le,se),se+=3,ne>>>1)ne>>1==1?(Me=9,$e=5):(se=Mt(le,se),Me=it,$e=ut);else{se&7&&(se+=8-(se&7));var Ge=le[se>>>3]|le[(se>>>3)+1]<<8;if(se+=32,Ge>0)for(!ee&&Ue<me+Ge&&(xe=Se(xe,me+Ge),Ue=xe.length);Ge-- >0;)xe[me++]=le[se>>>3],se+=8;continue}for(;;){!ee&&Ue<me+32767&&(xe=Se(xe,me+32767),Ue=xe.length);var je=pe(le,se,Me),_e=ne>>>1==1?Xe[je]:Ye[je];if(se+=_e&15,_e>>>=4,!(_e>>>8&255))xe[me++]=_e;else{if(_e==256)break;_e-=257;var He=_e<8?0:_e-4>>2;He>5&&(He=0);var Je=me+P[_e];He>0&&(Je+=pe(le,se,He),se+=He),je=pe(le,se,$e),_e=ne>>>1==1?fe[je]:Nt[je],se+=_e&15,_e>>>=4;var st=_e<4?0:_e-2>>1,tt=Q[_e];for(st>0&&(tt+=pe(le,se,st),se+=st),!ee&&Ue<Je&&(xe=Se(xe,Je+100),Ue=xe.length);me<Je;)xe[me]=xe[me-tt],++me}}}return ee?[xe,se+7>>>3]:[xe.slice(0,me),se+7>>>3]}function Et(le,ee){var se=le.slice(le.l||0),ne=ht(se,ee);return le.l+=ne[1],ne[0]}function mt(le,ee){if(le)typeof console<"u"&&console.error(ee);else throw new Error(ee)}function _t(le,ee){var se=le;Ia(se,0);var ne=[],xe=[],me={FileIndex:ne,FullPaths:xe};_(me,{root:ee.root});for(var Ue=se.length-4;(se[Ue]!=80||se[Ue+1]!=75||se[Ue+2]!=5||se[Ue+3]!=6)&&Ue>=0;)--Ue;se.l=Ue+4,se.l+=4;var Me=se.read_shift(2);se.l+=6;var $e=se.read_shift(4);for(se.l=$e,Ue=0;Ue<Me;++Ue){se.l+=20;var Ge=se.read_shift(4),je=se.read_shift(4),_e=se.read_shift(2),He=se.read_shift(2),Je=se.read_shift(2);se.l+=8;var st=se.read_shift(4),tt=l(se.slice(se.l+_e,se.l+_e+He));se.l+=_e+He+Je;var yt=se.l;se.l=st+4,Ht(se,Ge,je,me,tt),se.l=yt}return me}function Ht(le,ee,se,ne,xe){le.l+=2;var me=le.read_shift(2),Ue=le.read_shift(2),Me=o(le);if(me&8257)throw new Error("Unsupported ZIP encryption");for(var $e=le.read_shift(4),Ge=le.read_shift(4),je=le.read_shift(4),_e=le.read_shift(2),He=le.read_shift(2),Je="",st=0;st<_e;++st)Je+=String.fromCharCode(le[le.l++]);if(He){var tt=l(le.slice(le.l,le.l+He));(tt[21589]||{}).mt&&(Me=tt[21589].mt),((xe||{})[21589]||{}).mt&&(Me=xe[21589].mt)}le.l+=He;var yt=le.slice(le.l,le.l+Ge);switch(Ue){case 8:yt=L(le,je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ue)}var zt=!1;me&8&&($e=le.read_shift(4),$e==134695760&&($e=le.read_shift(4),zt=!0),Ge=le.read_shift(4),je=le.read_shift(4)),Ge!=ee&&mt(zt,"Bad compressed size: "+ee+" != "+Ge),je!=se&&mt(zt,"Bad uncompressed size: "+se+" != "+je),Nn(ne,Je,yt,{unsafe:!0,mt:Me})}function bt(le,ee){var se=ee||{},ne=[],xe=[],me=Ze(1),Ue=se.compression?8:0,Me=0,$e=0,Ge=0,je=0,_e=0,He=le.FullPaths[0],Je=He,st=le.FileIndex[0],tt=[],yt=0;for($e=1;$e<le.FullPaths.length;++$e)if(Je=le.FullPaths[$e].slice(He.length),st=le.FileIndex[$e],!(!st.size||!st.content||Je=="Sh33tJ5")){var zt=je,$t=Ze(Je.length);for(Ge=0;Ge<Je.length;++Ge)$t.write_shift(1,Je.charCodeAt(Ge)&127);$t=$t.slice(0,$t.l),tt[_e]=rV.buf(st.content,0);var _r=st.content;Ue==8&&(_r=O(_r)),me=Ze(30),me.write_shift(4,67324752),me.write_shift(2,20),me.write_shift(2,Me),me.write_shift(2,Ue),st.mt?s(me,st.mt):me.write_shift(4,0),me.write_shift(-4,tt[_e]),me.write_shift(4,_r.length),me.write_shift(4,st.content.length),me.write_shift(2,$t.length),me.write_shift(2,0),je+=me.length,ne.push(me),je+=$t.length,ne.push($t),je+=_r.length,ne.push(_r),me=Ze(46),me.write_shift(4,33639248),me.write_shift(2,0),me.write_shift(2,20),me.write_shift(2,Me),me.write_shift(2,Ue),me.write_shift(4,0),me.write_shift(-4,tt[_e]),me.write_shift(4,_r.length),me.write_shift(4,st.content.length),me.write_shift(2,$t.length),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(4,0),me.write_shift(4,zt),yt+=me.l,xe.push(me),yt+=$t.length,xe.push($t),++_e}return me=Ze(22),me.write_shift(4,101010256),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,_e),me.write_shift(2,_e),me.write_shift(4,yt),me.write_shift(4,je),me.write_shift(2,0),ga([ga(ne),ga(xe),me])}var Ct={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function or(le,ee){if(le.ctype)return le.ctype;var se=le.name||"",ne=se.match(/\.([^\.]+)$/);return ne&&Ct[ne[1]]||ee&&(ne=(se=ee).match(/[\.\\]([^\.\\])+$/),ne&&Ct[ne[1]])?Ct[ne[1]]:"application/octet-stream"}function Ra(le){for(var ee=Jh(le),se=[],ne=0;ne<ee.length;ne+=76)se.push(ee.slice(ne,ne+76));return se.join(`\r
`)+`\r
`}function er(le){var ee=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ge){var je=Ge.charCodeAt(0).toString(16).toUpperCase();return"="+(je.length==1?"0"+je:je)});ee=ee.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ee.charAt(0)==`
`&&(ee="=0D"+ee.slice(1)),ee=ee.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var se=[],ne=ee.split(`\r
`),xe=0;xe<ne.length;++xe){var me=ne[xe];if(me.length==0){se.push("");continue}for(var Ue=0;Ue<me.length;){var Me=76,$e=me.slice(Ue,Ue+Me);$e.charAt(Me-1)=="="?Me--:$e.charAt(Me-2)=="="?Me-=2:$e.charAt(Me-3)=="="&&(Me-=3),$e=me.slice(Ue,Ue+Me),Ue+=Me,Ue<me.length&&($e+="="),se.push($e)}}return se.join(`\r
`)}function on(le){for(var ee=[],se=0;se<le.length;++se){for(var ne=le[se];se<=le.length&&ne.charAt(ne.length-1)=="=";)ne=ne.slice(0,ne.length-1)+le[++se];ee.push(ne)}for(var xe=0;xe<ee.length;++xe)ee[xe]=ee[xe].replace(/[=][0-9A-Fa-f]{2}/g,function(me){return String.fromCharCode(parseInt(me.slice(1),16))});return Zs(ee.join(`\r
`))}function zn(le,ee,se){for(var ne="",xe="",me="",Ue,Me=0;Me<10;++Me){var $e=ee[Me];if(!$e||$e.match(/^\s*$/))break;var Ge=$e.match(/^(.*?):\s*([^\s].*)$/);if(Ge)switch(Ge[1].toLowerCase()){case"content-location":ne=Ge[2].trim();break;case"content-type":me=Ge[2].trim();break;case"content-transfer-encoding":xe=Ge[2].trim();break}}switch(++Me,xe.toLowerCase()){case"base64":Ue=Zs(oi(ee.slice(Me).join("")));break;case"quoted-printable":Ue=on(ee.slice(Me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+xe)}var je=Nn(le,ne.slice(se.length),Ue,{unsafe:!0});me&&(je.ctype=me)}function Lt(le,ee){if(M(le.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var se=ee&&ee.root||"",ne=(cr&&Buffer.isBuffer(le)?le.toString("binary"):M(le)).split(`\r
`),xe=0,me="";for(xe=0;xe<ne.length;++xe)if(me=ne[xe],!!/^Content-Location:/i.test(me)&&(me=me.slice(me.indexOf("file")),se||(se=me.slice(0,me.lastIndexOf("/")+1)),me.slice(0,se.length)!=se))for(;se.length>0&&(se=se.slice(0,se.length-1),se=se.slice(0,se.lastIndexOf("/")+1),me.slice(0,se.length)!=se););var Ue=(ne[1]||"").match(/boundary="(.*?)"/);if(!Ue)throw new Error("MAD cannot find boundary");var Me="--"+(Ue[1]||""),$e=[],Ge=[],je={FileIndex:$e,FullPaths:Ge};_(je);var _e,He=0;for(xe=0;xe<ne.length;++xe){var Je=ne[xe];Je!==Me&&Je!==Me+"--"||(He++&&zn(je,ne.slice(_e,xe),se),_e=xe)}return je}function Dn(le,ee){var se=ee||{},ne=se.boundary||"SheetJS";ne="------="+ne;for(var xe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ne.slice(2)+'"',"","",""],me=le.FullPaths[0],Ue=me,Me=le.FileIndex[0],$e=1;$e<le.FullPaths.length;++$e)if(Ue=le.FullPaths[$e].slice(me.length),Me=le.FileIndex[$e],!(!Me.size||!Me.content||Ue=="Sh33tJ5")){Ue=Ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(yt){return"_x"+yt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(yt){return"_u"+yt.charCodeAt(0).toString(16)+"_"});for(var Ge=Me.content,je=cr&&Buffer.isBuffer(Ge)?Ge.toString("binary"):M(Ge),_e=0,He=Math.min(1024,je.length),Je=0,st=0;st<=He;++st)(Je=je.charCodeAt(st))>=32&&Je<128&&++_e;var tt=_e>=He*4/5;xe.push(ne),xe.push("Content-Location: "+(se.root||"file:///C:/SheetJS/")+Ue),xe.push("Content-Transfer-Encoding: "+(tt?"quoted-printable":"base64")),xe.push("Content-Type: "+or(Me,Ue)),xe.push(""),xe.push(tt?er(je):Ra(je))}return xe.push(ne+`--\r
`),xe.join(`\r
`)}function Xn(le){var ee={};return _(ee,le),ee}function Nn(le,ee,se,ne){var xe=ne&&ne.unsafe;xe||_(le);var me=!xe&&Qt.find(le,ee);if(!me){var Ue=le.FullPaths[0];ee.slice(0,Ue.length)==Ue?Ue=ee:(Ue.slice(-1)!="/"&&(Ue+="/"),Ue=(Ue+ee).replace("//","/")),me={name:a(ee),type:2},le.FileIndex.push(me),le.FullPaths.push(Ue),xe||Qt.utils.cfb_gc(le)}return me.content=se,me.size=se?se.length:0,ne&&(ne.CLSID&&(me.clsid=ne.CLSID),ne.mt&&(me.mt=ne.mt),ne.ct&&(me.ct=ne.ct)),me}function da(le,ee){_(le);var se=Qt.find(le,ee);if(se){for(var ne=0;ne<le.FileIndex.length;++ne)if(le.FileIndex[ne]==se)return le.FileIndex.splice(ne,1),le.FullPaths.splice(ne,1),!0}return!1}function Ar(le,ee,se){_(le);var ne=Qt.find(le,ee);if(ne){for(var xe=0;xe<le.FileIndex.length;++xe)if(le.FileIndex[xe]==ne)return le.FileIndex[xe].name=a(se),le.FullPaths[xe]=se,!0}return!1}function Br(le){E(le,!0)}return t.find=S,t.read=B,t.parse=A,t.write=G,t.writeFile=W,t.utils={cfb_new:Xn,cfb_add:Nn,cfb_del:da,cfb_mov:Ar,cfb_gc:Br,ReadShift:ph,CheckField:B6,prep_blob:Ia,bconcat:ga,use_zlib:C,_deflateRaw:Qe,_inflateRaw:Et,consts:X},t}();function nV(e){return typeof e=="string"?Ux(e):Array.isArray(e)?k$(e):e}function N0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ux(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Io(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([nV(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=qc(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function aV(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function _n(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function yB(e,t){for(var r=[],n=_n(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Dx(e){for(var t=[],r=_n(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Rx(e){for(var t=[],r=_n(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function sV(e){for(var t=[],r=_n(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Qg=new Date(1899,11,30,0,0,0);function Aa(e,t){var r=e.getTime(),n=Qg.getTime()+(e.getTimezoneOffset()-Qg.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var a6=new Date,iV=Qg.getTime()+(a6.getTimezoneOffset()-Qg.getTimezoneOffset())*6e4,wB=a6.getTimezoneOffset();function Qx(e){var t=new Date;return t.setTime(e*24*60*60*1e3+iV),t.getTimezoneOffset()!==wB&&t.setTime(t.getTime()+(t.getTimezoneOffset()-wB)*6e4),t}function oV(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var bB=new Date("2017-02-19T19:06:09.000Z"),s6=isNaN(bB.getFullYear())?new Date("2/19/17"):bB,lV=s6.getFullYear()==2017;function tn(e,t){var r=new Date(e);if(lV)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(s6.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Hu(e,t){if(cr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Io(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Io(VF(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Io(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Io(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function rn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=rn(e[r]));return t}function wn(e,t){for(var r="";r.length<t;)r+=e;return r}function oo(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var cV=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ed(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&cV.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var uV=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(a),o.push(s[l]);return o}}();function i6(e){return e?e.content&&e.type?Hu(e.content,!0):e.data?Wf(e.data):e.asNodeBuffer&&cr?Wf(e.asNodeBuffer().toString("binary")):e.asBinary?Wf(e.asBinary()):e._data&&e._data.getContent?Wf(Hu(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function o6(e){if(!e)return null;if(e.data)return uB(e.data);if(e.asNodeBuffer&&cr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?uB(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function AV(e){return e&&e.name.slice(-4)===".bin"?o6(e):i6(e)}function vi(e,t){for(var r=e.FullPaths||_n(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function s_(e,t){var r=vi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function qn(e,t,r){if(!r)return AV(s_(e,t));if(!t)return null;try{return qn(e,t)}catch{return null}}function ei(e,t,r){if(!r)return i6(s_(e,t));if(!t)return null;try{return ei(e,t)}catch{return null}}function dV(e,t,r){return o6(s_(e,t))}function _B(e){for(var t=e.FullPaths||_n(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function sr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return cr?n=Ll(r):n=j$(r),Qt.utils.cfb_add(e,t,n)}Qt.utils.cfb_add(e,t,r)}else e.file(t,r)}function i_(){return Qt.utils.cfb_new()}function l6(e,t){switch(t.type){case"base64":return Qt.read(e,{type:"base64"});case"binary":return Qt.read(e,{type:"binary"});case"buffer":case"array":return Qt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Xf(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Pn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fV=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,NB=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hV=/<[^>]*>/g,is=Pn.match(NB)?NB:hV,pV=/<\w*:/,mV=/<(\/?)\w+:/;function Gt(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(fV),l=0,c="",u=0,A="",h="",f=1;if(o)for(u=0;u!=o.length;++u){for(h=o[u],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(A=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(f=(a=h.charCodeAt(s+1))==34||a==39?1:0,c=h.slice(s+1+f,h.length-f),l=0;l!=A.length&&A.charCodeAt(l)!==58;++l);if(l===A.length)A.indexOf("_")>0&&(A=A.slice(0,A.indexOf("_"))),n[A]=c,n[A.toLowerCase()]=c;else{var d=(l===5&&A.slice(0,5)==="xmlns"?"xmlns":"")+A.slice(l+1);if(n[d]&&A.slice(l-3,l)=="ext")continue;n[d]=c,n[d.toLowerCase()]=c}}return n}function Ho(e){return e.replace(mV,"<$1")}var c6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},o_=Dx(c6),wr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(l,c){return c6[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,o)+r(a.slice(o+3))}}(),l_=/[&<>'"]/g,gV=/[\u0000-\u0008\u000b-\u001f]/g;function Lr(e){var t=e+"";return t.replace(l_,function(r){return o_[r]}).replace(gV,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function BB(e){return Lr(e).replace(/ /g,"_x0020_")}var u6=/[\u0000-\u001f]/g;function c_(e){var t=e+"";return t.replace(l_,function(r){return o_[r]}).replace(/\n/g,"<br/>").replace(u6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function xV(e){var t=e+"";return t.replace(l_,function(r){return o_[r]}).replace(u6,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var CB=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function vV(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Jr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Fv(e){for(var t="",r=0,n=0,a=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function EB(e){var t=Tc(2*e.length),r,n,a=1,s=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function SB(e){return Ll(e,"binary").toString("utf8")}var Mp="foo bar baz",Pr=cr&&(SB(Mp)==Fv(Mp)&&SB||EB(Mp)==Fv(Mp)&&EB)||Fv,Io=cr?function(e){return Ll(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},e0=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),A6=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),yV=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),wV=/<\/?(?:vt:)?variant>/g,bV=/<(?:vt:)([^>]*)>([\s\S]*)</;function kB(e,t){var r=Gt(e),n=e.match(yV(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var o=s.replace(wV,"").match(bV);o&&a.push({v:Pr(o[2]),t:o[1]})}),a}var d6=/(^\s|\s$|\n)/;function La(e,t){return"<"+e+(t.match(d6)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function t0(e){return _n(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function pt(e,t,r){return"<"+e+(r!=null?t0(r):"")+(t!=null?(t.match(d6)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Zw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function _V(e,t){switch(typeof e){case"string":var r=pt("vt:lpwstr",Lr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return pt((e|0)==e?"vt:i4":"vt:r8",Lr(String(e)));case"boolean":return pt("vt:bool",e?"true":"false")}if(e instanceof Date)return pt("vt:filetime",Zw(e));throw new Error("Unable to serialize "+e)}function u_(e){if(cr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Pr(qc(r_(e)));throw new Error("Bad input format: expected Buffer or string")}var r0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ia={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Yu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],zs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function NV(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function BV(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,o=n?-t:t;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var jB=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},FB=cr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ll(t)})):jB(e)}:jB,TB=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(vl(e,a)));return n.join("").replace(vs,"")},A_=cr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(vs,""):TB(e,t,r)}:TB,IB=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},f6=cr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):IB(e,t,r)}:IB,LB=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(OA(e,a)));return n.join("")},B0=cr?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):LB(t,r,n)}:LB,h6=function(e,t){var r=Xs(e,t);return r>0?B0(e,t+4,t+4+r-1):""},p6=h6,m6=function(e,t){var r=Xs(e,t);return r>0?B0(e,t+4,t+4+r-1):""},g6=m6,x6=function(e,t){var r=2*Xs(e,t);return r>0?B0(e,t+4,t+4+r-1):""},v6=x6,y6=function(t,r){var n=Xs(t,r);return n>0?A_(t,r+4,r+4+n):""},w6=y6,b6=function(e,t){var r=Xs(e,t);return r>0?B0(e,t+4,t+4+r):""},_6=b6,N6=function(e,t){return NV(e,t)},Mg=N6,d_=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};cr&&(p6=function(t,r){if(!Buffer.isBuffer(t))return h6(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},g6=function(t,r){if(!Buffer.isBuffer(t))return m6(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},v6=function(t,r){if(!Buffer.isBuffer(t))return x6(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},w6=function(t,r){if(!Buffer.isBuffer(t))return y6(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},_6=function(t,r){if(!Buffer.isBuffer(t))return b6(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Mg=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):N6(t,r)},d_=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var OA=function(e,t){return e[t]},vl=function(e,t){return e[t+1]*256+e[t]},CV=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Xs=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},gu=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},EV=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ph(e,t){var r="",n,a,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,cr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(vl(this,u)),u+=2;e*=2;break;case"utf8":r=B0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=A_(this,this.l,this.l+e);break;case"wstr":return ph.call(this,e,"dbcs");case"lpstr-ansi":r=p6(this,this.l),e=4+Xs(this,this.l);break;case"lpstr-cp":r=g6(this,this.l),e=4+Xs(this,this.l);break;case"lpwstr":r=v6(this,this.l),e=4+2*Xs(this,this.l);break;case"lpp4":e=4+Xs(this,this.l),r=w6(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Xs(this,this.l),r=_6(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=OA(this,this.l+e++))!==0;)s.push(Qp(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=vl(this,this.l+e))!==0;)s.push(Qp(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=OA(this,u),this.l=u+1,l=ph.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Qp(vl(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=OA(this,u),this.l=u+1,l=ph.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Qp(OA(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=OA(this,this.l),this.l++,n;case 2:return n=(t==="i"?CV:vl)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?gu:EV)(this,this.l),this.l+=4,n):(a=Xs(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Mg(this,this.l):a=Mg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=f6(this,this.l,e);break}}return this.l+=e,r}var SV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},kV=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},jV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function FV(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)jV(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,SV(this,t,this.l);break;case 8:if(n=8,r==="f"){BV(this,t,this.l);break}case 16:break;case-4:n=4,kV(this,t,this.l);break}return this.l+=n,this}function B6(e,t){var r=f6(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ia(e,t){e.l=t,e.read_shift=ph,e.chk=B6,e.write_shift=FV}function ss(e,t){e.l+=t}function Ze(e){var t=Tc(e);return Ia(t,0),t}function Ol(e,t,r){if(e){var n,a,s;Ia(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=l0[l]||l0[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;c=e.l+s;var A=u.f&&u.f(e,s,r);if(e.l=c,t(A,u,l))return}}}function Is(){var e=[],t=cr?256:2048,r=function(u){var A=Ze(u);return Ia(A,0),A},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},o=function(){return a(),ga(e)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function ot(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=l0[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&d_(r)&&e.push(r)}}function mh(e,t,r){var n=rn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function OB(e,t,r){var n=rn(e);return n.s=mh(n.s,t.s,r),n.e=mh(n.e,t.s,r),n}function gh(e,t){if(e.cRel&&e.c<0)for(e=rn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=rn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Vt(e);return!e.cRel&&e.cRel!=null&&(r=LV(r)),!e.rRel&&e.rRel!=null&&(r=TV(r)),r}function Tv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+dn(e.s.c)+":"+(e.e.cRel?"":"$")+dn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Un(e.s.r)+":"+(e.e.rRel?"":"$")+Un(e.e.r):gh(e.s,t.biff)+":"+gh(e.e,t.biff)}function f_(e){return parseInt(IV(e),10)-1}function Un(e){return""+(e+1)}function TV(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function IV(e){return e.replace(/\$(\d+)$/,"$1")}function h_(e){for(var t=OV(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function dn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function LV(e){return e.replace(/^([A-Z])/,"$$$1")}function OV(e){return e.replace(/^\$([A-Z])/,"$1")}function UV(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function fn(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Vt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Os(e){var t=e.indexOf(":");return t==-1?{s:fn(e),e:fn(e)}:{s:fn(e.slice(0,t)),e:fn(e.slice(t+1))}}function rr(e,t){return typeof t>"u"||typeof t=="number"?rr(e.s,e.e):(typeof e!="string"&&(e=Vt(e)),typeof t!="string"&&(t=Vt(t)),e==t?e:e+":"+t)}function br(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function UB(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Oi(e.z,r?Aa(t):t)}catch{}try{return e.w=Oi((e.XF||{}).numFmtId||(r?14:0),r?Aa(t):t)}catch{return""+t}}function jl(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ul[e.v]||e.v:t==null?UB(e,e.v):UB(e,t))}function Kc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function C6(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?fn(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var A=br(s["!ref"]);u.s.c=A.s.c,u.s.r=A.s.r,u.e.c=Math.max(u.e.c,A.e.c),u.e.r=Math.max(u.e.r,A.e.r),o==-1&&(u.e.r=o=A.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var d={v:t[h][f]},v=o+h,g=l+f;if(u.s.r>v&&(u.s.r=v),u.s.c>g&&(u.s.c=g),u.e.r<v&&(u.e.r=v),u.e.c<g&&(u.e.c=g),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))d=t[h][f];else if(Array.isArray(d.v)&&(d.f=t[h][f][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Kt[14],n.cellDates?(d.t="d",d.w=Oi(d.z,Aa(d.v))):(d.t="n",d.v=Aa(d.v),d.w=Oi(d.z,d.v))):d.t="s";if(a)s[v]||(s[v]=[]),s[v][g]&&s[v][g].z&&(d.z=s[v][g].z),s[v][g]=d;else{var y=Vt({c:g,r:v});s[y]&&s[y].z&&(d.z=s[y].z),s[y]=d}}}return u.s.c<1e7&&(s["!ref"]=rr(u)),s}function $d(e,t){return C6(null,e,t)}function PV(e){return e.read_shift(4,"i")}function lo(e,t){return t||(t=Ze(4)),t.write_shift(4,e),t}function rs(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function xa(e,t){var r=!1;return t==null&&(r=!0,t=Ze(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function DV(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function RV(e,t){return t||(t=Ze(4)),t.write_shift(2,0),t.write_shift(2,0),t}function p_(e,t){var r=e.l,n=e.read_shift(1),a=rs(e),s=[],o={t:a,h:a};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(DV(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function QV(e,t){var r=!1;return t==null&&(r=!0,t=Ze(15+4*e.t.length)),t.write_shift(1,0),xa(e.t,t),r?t.slice(0,t.l):t}var MV=p_;function HV(e,t){var r=!1;return t==null&&(r=!0,t=Ze(23+4*e.t.length)),t.write_shift(1,1),xa(e.t,t),t.write_shift(4,1),RV({},t),r?t.slice(0,t.l):t}function Pi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ju(e,t){return t==null&&(t=Ze(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Zu(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function eA(e,t){return t==null&&(t=Ze(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var qV=rs,E6=xa;function m_(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Hg(e,t){var r=!1;return t==null&&(r=!0,t=Ze(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var KV=rs,e2=m_,g_=Hg;function x_(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Mg([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):gu(t,0)>>2;return r?a/100:a}function S6(e,t){t==null&&(t=Ze(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function k6(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function $V(e,t){return t||(t=Ze(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var tA=k6,Vd=$V;function es(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function qu(e,t){return(t||Ze(8)).write_shift(8,e,"f")}function VV(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Su[a];u&&(t.rgb=a0(u));break;case 2:t.rgb=a0([o,l,c]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function qg(e,t){if(t||(t=Ze(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function GV(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function WV(e,t){t||(t=Ze(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function j6(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function zV(e){return j6(e,1)}function XV(e){return j6(e,2)}var v_=2,Cs=3,Hp=11,PB=12,Kg=19,qp=64,YV=65,JV=71,ZV=4108,eG=4126,ha=80,F6=81,tG=[ha,F6],t2={1:{n:"CodePage",t:v_},2:{n:"Category",t:ha},3:{n:"PresentationFormat",t:ha},4:{n:"ByteCount",t:Cs},5:{n:"LineCount",t:Cs},6:{n:"ParagraphCount",t:Cs},7:{n:"SlideCount",t:Cs},8:{n:"NoteCount",t:Cs},9:{n:"HiddenCount",t:Cs},10:{n:"MultimediaClipCount",t:Cs},11:{n:"ScaleCrop",t:Hp},12:{n:"HeadingPairs",t:ZV},13:{n:"TitlesOfParts",t:eG},14:{n:"Manager",t:ha},15:{n:"Company",t:ha},16:{n:"LinksUpToDate",t:Hp},17:{n:"CharacterCount",t:Cs},19:{n:"SharedDoc",t:Hp},22:{n:"HyperlinksChanged",t:Hp},23:{n:"AppVersion",t:Cs,p:"version"},24:{n:"DigSig",t:YV},26:{n:"ContentType",t:ha},27:{n:"ContentStatus",t:ha},28:{n:"Language",t:ha},29:{n:"Version",t:ha},255:{},2147483648:{n:"Locale",t:Kg},2147483651:{n:"Behavior",t:Kg},1919054434:{}},r2={1:{n:"CodePage",t:v_},2:{n:"Title",t:ha},3:{n:"Subject",t:ha},4:{n:"Author",t:ha},5:{n:"Keywords",t:ha},6:{n:"Comments",t:ha},7:{n:"Template",t:ha},8:{n:"LastAuthor",t:ha},9:{n:"RevNumber",t:ha},10:{n:"EditTime",t:qp},11:{n:"LastPrinted",t:qp},12:{n:"CreatedDate",t:qp},13:{n:"ModifiedDate",t:qp},14:{n:"PageCount",t:Cs},15:{n:"WordCount",t:Cs},16:{n:"CharCount",t:Cs},17:{n:"Thumbnail",t:JV},18:{n:"Application",t:ha},19:{n:"DocSecurity",t:Cs},255:{},2147483648:{n:"Locale",t:Kg},2147483651:{n:"Behavior",t:Kg},1919054434:{}},DB={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},rG=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function nG(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var aG=nG([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Su=rn(aG),Ul={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},T6={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},n2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Kp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function y_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function sG(e){var t=y_();if(!e||!e.match)return t;var r={};if((e.match(is)||[]).forEach(function(n){var a=Gt(n);switch(a[0].replace(pV,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[n2[a.ContentType]]!==void 0&&t[n2[a.ContentType]].push(a.PartName);break}}),t.xmlns!==ia.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function I6(e,t){var r=sV(n2),n=[],a;n[n.length]=Pn,n[n.length]=pt("Types",null,{xmlns:ia.CT,"xmlns:xsd":ia.xsd,"xmlns:xsi":ia.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return pt("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=pt("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Kp[c][t.bookType]||Kp[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=pt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Kp[c][t.bookType]||Kp[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=pt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ur={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function n0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function xh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(is)||[]).forEach(function(a){var s=Gt(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Xf(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function Ad(e){var t=[Pn,pt("Relationships",null,{xmlns:ia.RELS})];return _n(e["!id"]).forEach(function(r){t[t.length]=pt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Tr(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[ur.HLINK,ur.XPATH,ur.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var iG="application/vnd.oasis.opendocument.spreadsheet";function oG(e,t){for(var r=u_(e),n,a;n=r0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Gt(n[0],!1),a.path=="/"&&a.type!==iG)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function lG(e){var t=[Pn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function RB(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function cG(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function uG(e){var t=[Pn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(RB(e[r][0],e[r][1])),t.push(cG("",e[r][0]));return t.push(RB("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function L6(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ug.version+"</meta:generator></office:meta></office:document-meta>"}var ji=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],AG=function(){for(var e=new Array(ji.length),t=0;t<ji.length;++t){var r=ji[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function O6(e){var t={};e=Pr(e);for(var r=0;r<ji.length;++r){var n=ji[r],a=e.match(AG[r]);a!=null&&a.length>0&&(t[n[1]]=wr(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=tn(t[n[1]]))}return t}function Iv(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Lr(t),n[n.length]=r?pt(e,t,r):La(e,t))}function U6(e,t){var r=t||{},n=[Pn,pt("cp:coreProperties",null,{"xmlns:cp":ia.CORE_PROPS,"xmlns:dc":ia.dc,"xmlns:dcterms":ia.dcterms,"xmlns:dcmitype":ia.dcmitype,"xmlns:xsi":ia.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Iv("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Zw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Iv("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Zw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=ji.length;++s){var o=ji[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Iv(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ku=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],P6=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function D6(e,t,r,n){var a=[];if(typeof e=="string")a=kB(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(A){return{v:A}}));var o=typeof t=="string"?kB(t,n).map(function(A){return A.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function dG(e,t,r){var n={};return t||(t={}),e=Pr(e),ku.forEach(function(a){var s=(e.match(e0(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=wr(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&D6(n.HeadingPairs,n.TitlesOfParts,t,r),t}function R6(e){var t=[],r=pt;return e||(e={}),e.Application="SheetJS",t[t.length]=Pn,t[t.length]=pt("Properties",null,{xmlns:ia.EXT_PROPS,"xmlns:vt":ia.vt}),ku.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Lr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Lr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var fG=/<[^>]+>[^<]*/g;function hG(e,t){var r={},n="",a=e.match(fG);if(a)for(var s=0;s!=a.length;++s){var o=a[s],l=Gt(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=wr(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),A=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=wr(A);break;case"bool":r[n]=Jr(A);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(A,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(A);break;case"filetime":case"date":r[n]=tn(A);break;case"cy":case"error":r[n]=wr(A);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function Q6(e){var t=[Pn,pt("Properties",null,{xmlns:ia.CUST_PROPS,"xmlns:vt":ia.vt})];if(!e)return t.join("");var r=1;return _n(e).forEach(function(a){++r,t[t.length]=pt("property",_V(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Lr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var a2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Lv;function pG(e,t,r){Lv||(Lv=Dx(a2)),t=Lv[t]||t,e[t]=r}function mG(e,t){var r=[];return _n(a2).map(function(n){for(var a=0;a<ji.length;++a)if(ji[a][1]==n)return ji[a];for(a=0;a<ku.length;++a)if(ku[a][1]==n)return ku[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(La(a2[n[1]]||n[1],a))}}),pt("DocumentProperties",r.join(""),{xmlns:zs.o})}function gG(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&_n(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<ji.length;++o)if(s==ji[o][1])return;for(o=0;o<ku.length;++o)if(s==ku[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(pt(BB(s),l,{"dt:dt":c}))}}),t&&_n(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(pt(BB(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+zs.o+'">'+a.join("")+"</"+n+">"}function w_(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function xG(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=Ze(8);return o.write_shift(4,n),o.write_shift(4,a),o}function M6(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function H6(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function q6(e,t,r){return t===31?H6(e):M6(e,t,r)}function s2(e,t,r){return q6(e,t,r===!1?0:4)}function vG(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return q6(e,t,0)}function yG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(vs,""),e.l-a&2&&(e.l+=2)}return r}function wG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(vs,"");return r}function bG(e){var t=e.l,r=$g(e,F6);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=$g(e,Cs);return[r,n]}function _G(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(bG(e));return r}function QB(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(vs,"").replace(zf,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function K6(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function NG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function $g(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==PB&&n!==t&&tG.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===PB?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return M6(e,n,4).replace(vs,"");case 31:return H6(e);case 64:return w_(e);case 65:return K6(e);case 71:return NG(e);case 80:return s2(e,n,!s.raw).replace(vs,"");case 81:return vG(e,n).replace(vs,"");case 4108:return _G(e);case 4126:case 4127:return n==4127?yG(e):wG(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function MB(e,t){var r=Ze(4),n=Ze(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ze(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=xG(t);break;case 31:case 80:for(n=Ze(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ga([r,n])}function HB(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=a;++o){var A=e.read_shift(4),h=e.read_shift(4);s[o]=[A,h+r]}s.sort(function(m,w){return m[1]-w[1]});var f={};for(o=0;o!=a;++o){if(e.l!==s[o][1]){var d=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],d=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],d=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(d=!1,e.l=s[o][1]),d)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var v=t[s[o][0]];if(f[v.n]=$g(e,v.t,{raw:!0}),v.p==="version"&&(f[v.n]=String(f[v.n]>>16)+"."+("0000"+String(f[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(f[v.n]){case 0:f[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ro(l=f[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[v.n])}}else if(s[o][0]===1){if(l=f.CodePage=$g(e,v_),ro(l),c!==-1){var g=e.l;e.l=s[c][1],u=QB(e,l),e.l=g}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}u=QB(e,l)}else{var y=u[s[o][0]],p;switch(e[e.l]){case 65:e.l+=4,p=K6(e);break;case 30:e.l+=4,p=s2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,p=s2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,p=e.read_shift(4,"i");break;case 19:e.l+=4,p=e.read_shift(4);break;case 5:e.l+=4,p=e.read_shift(8,"f");break;case 11:e.l+=4,p=jn(e,4);break;case 64:e.l+=4,p=tn(w_(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[y]=p}}return e.l=r+n,f}var $6=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function BG(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function qB(e,t,r){var n=Ze(8),a=[],s=[],o=8,l=0,c=Ze(8),u=Ze(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),o+=8+c.length,!t){u=Ze(8),u.write_shift(4,0),a.unshift(u);var A=[Ze(4)];for(A[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(c=Ze(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);A.push(c)}c=ga(A),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!($6.indexOf(e[l][0])>-1||P6.indexOf(e[l][0])>-1)&&e[l][1]!=null){var f=e[l][1],d=0;if(t){d=+t[e[l][0]];var v=r[d];if(v.p=="version"&&typeof f=="string"){var g=f.split(".");f=(+g[0]<<16)+(+g[1]||0)}c=MB(v.t,f)}else{var y=BG(f);y==-1&&(y=31,f=String(f)),c=MB(y,f)}s.push(c),u=Ze(8),u.write_shift(4,t?d:2+l),a.push(u),o+=8+c.length}var p=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,p),p+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),ga([n].concat(a).concat(s))}function KB(e,t,r){var n=e.content;if(!n)return{};Ia(n,0);var a,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),A=n.read_shift(16);if(A!==Qt.utils.consts.HEADER_CLSID&&A!==r)throw new Error("Bad PropertySet CLSID "+A);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var h=HB(n,t),f={SystemIdentifier:u};for(var d in h)f[d]=h[d];if(f.FMTID=s,a===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=HB(n,null)}catch{}for(d in v)f[d]=v[d];return f.FMTID=[s,o],f}function $B(e,t,r,n,a,s){var o=Ze(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Qt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,a?68:48);var c=qB(e,r,n);if(l.push(c),a){var u=qB(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return ga(l)}function ec(e,t){return e.read_shift(t),null}function CG(e,t){t||(t=Ze(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function EG(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function jn(e,t){return e.read_shift(t)===1}function ms(e,t){return t||(t=Ze(2)),t.write_shift(2,+!!e),t}function Kn(e){return e.read_shift(2,"u")}function wi(e,t){return t||(t=Ze(2)),t.write_shift(2,e),t}function V6(e,t){return EG(e,t,Kn)}function SG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function G6(e,t,r){return r||(r=Ze(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function C0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function kG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),o=0,l,c={};a&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",A=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*o),n&&(e.l+=l),c.t=A,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function jG(e){var t=e.t||"",r=Ze(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ze(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return ga(a)}function Ku(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function E0(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ku(e,n,r)}function rA(e,t,r){if(r.biff>5)return E0(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function W6(e,t,r){return r||(r=Ze(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function FG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function TG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(vs,"");return n&&(e.l+=24),a}function IG(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(vs,"");return r+o}function LG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return TG(e);case"0303000000000000c000000000000046":return IG(e);default:throw new Error("Unsupported Moniker "+r)}}function $p(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(vs,""):"";return r}function VB(e,t){t||(t=Ze(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function OG(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,o,l,c,u="",A,h;a&16&&(s=$p(e,r-e.l)),a&128&&(o=$p(e,r-e.l)),(a&257)===257&&(l=$p(e,r-e.l)),(a&257)===1&&(c=LG(e,r-e.l)),a&8&&(u=$p(e,r-e.l)),a&32&&(A=e.read_shift(16)),a&64&&(h=w_(e)),e.l=r;var f=o||l||c||"";f&&u&&(f+="#"+u),f||(f="#"+u),a&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var d={Target:f};return A&&(d.guid=A),h&&(d.time=h),s&&(d.Tooltip=s),d}function UG(e){var t=Ze(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),VB(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&VB(a>-1?n.slice(a+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function z6(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function X6(e,t){var r=z6(e);return r[3]=0,r}function qo(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function $u(e,t,r,n){return n||(n=Ze(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function PG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function DG(e,t,r){return t===0?"":rA(e,t,r)}function RG(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,s,o]}function Y6(e){var t=e.read_shift(2),r=x_(e);return[t,r]}function QG(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=C0(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Mx(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function J6(e,t){return t||(t=Ze(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Z6(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var MG=Z6;function eT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function HG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function qG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function qa(e){e.l+=2,e.l+=e.read_shift(2)}var KG={0:qa,4:qa,5:qa,6:qa,7:qG,8:qa,9:qa,10:qa,11:qa,12:qa,13:HG,14:qa,15:qa,16:qa,17:qa,18:qa,19:qa,20:qa,21:eT};function $G(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(KG[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Vp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function b_(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ze(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function VG(e,t){return t===0||e.read_shift(2),1200}function GG(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=rA(e,0,r);return e.read_shift(t+n-e.l),a}function WG(e,t){var r=!t||t.biff==8,n=Ze(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function zG(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function XG(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=C0(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function YG(e,t){var r=!t||t.biff>=8?2:1,n=Ze(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function JG(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0;o!=a&&e.l<r;++o)s.push(kG(e));return s.Count=n,s.Unique=a,s}function ZG(e,t){var r=Ze(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=jG(e[a]);var s=ga([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function eW(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function tW(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function rW(e){var t=PG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function nW(e){return e.read_shift(2),e.read_shift(4)}function GB(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function aW(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function sW(){var e=Ze(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function iW(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function oW(e){var t=Ze(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function lW(){}function cW(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=C0(e,0,r),n}function uW(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=Ze(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function AW(e){var t=qo(e);return t.isst=e.read_shift(4),t}function dW(e,t,r,n){var a=Ze(10);return $u(e,t,n,a),a.write_shift(4,r),a}function fW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=qo(e);r.biff==2&&e.l++;var s=E0(e,n-e.l,r);return a.val=s,a}function hW(e,t,r,n,a){var s=!a||a.biff==8,o=Ze(8+ +s+(1+s)*r.length);return $u(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function pW(e,t,r){var n=e.read_shift(2),a=rA(e,0,r);return[n,a]}function mW(e,t,r,n){var a=r&&r.biff==5;n||(n=Ze(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var gW=rA;function WB(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c}}}function xW(e,t){var r=t.biff==8||!t.biff?4:2,n=Ze(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function vW(e){var t=e.read_shift(2),r=e.read_shift(2),n=Y6(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function yW(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Y6(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function wW(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function bW(e,t,r,n){var a={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return a.patternType=rG[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function _W(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=bW(e,t,n.fStyle,r),n}function zB(e,t,r,n){var a=r&&r.biff==5;n||(n=Ze(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function NW(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function BW(e){var t=Ze(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function XB(e,t,r){var n=qo(e);(r.biff==2||t==9)&&++e.l;var a=SG(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function CW(e,t,r,n,a,s){var o=Ze(8);return $u(e,t,n,o),G6(r,s,o),o}function EW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=qo(e),a=es(e);return n.val=a,n}function SW(e,t,r,n){var a=Ze(14);return $u(e,t,n,a),qu(r,a),a}var YB=DG;function kW(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=Ku(e,s),l=[];n>e.l;)l.push(E0(e));return[s,a,o,l]}function JB(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=QG(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var jW=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ZB(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Ku(e,o,r);a&32&&(u=jW[u.charCodeAt(0)]);var A=n-e.l;r&&r.biff==2&&--A;var h=n==e.l||l===0||!(A>0)?[]:$J(e,A,r,l);return{chKey:s,Name:u,itab:c,rgce:h}}function tT(e,t,r){if(r.biff<8)return FW(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(RG(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function FW(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=C0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function TW(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Ku(e,n,r),o=Ku(e,a,r);return[s,o]}function IW(e,t,r){var n=Z6(e);e.l++;var a=e.read_shift(1);return t-=8,[VJ(e,t,r),a,n]}function eC(e,t,r){var n=MG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,qJ(e,t,r)]}function LW(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function OW(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=rA(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,o,s]}}function UW(e,t,r){return OW(e,t,r)}function PW(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Mx(e));return r}function DW(e){var t=Ze(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)J6(e[r],t);return t}function RW(e,t,r){if(r&&r.biff<8)return MW(e,t,r);var n=eT(e),a=$G(e,t-22,n[1]);return{cmo:n,ft:a}}var QW={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function MW(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((QW[n]||ss)(e,t,r)),{cmo:[a,n,s],ft:o}}function HW(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=FG(e,6,r);var l=e.read_shift(2);e.read_shift(2),Kn(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var A=e[e.l],h=Ku(e,e.lens[u+1]-e.lens[u]-1);if(a+=h,a.length>=(A?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function qW(e,t){var r=Mx(e);e.l+=16;var n=OG(e,t-24);return[r,n]}function KW(e){var t=Ze(24),r=fn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return ga([t,UG(e[1])])}function $W(e,t){e.read_shift(2);var r=Mx(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(vs,""),[r,n]}function VW(e){var t=e[1].Tooltip,r=Ze(10+2*(t.length+1));r.write_shift(2,2048);var n=fn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function GW(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=DB[r]||r,r=e.read_shift(2),t[1]=DB[r]||r,t}function WW(e){return e||(e=Ze(4)),e.write_shift(2,1),e.write_shift(2,1),e}function zW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X6(e));return r}function XW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X6(e));return r}function YW(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rT(e,t,r){if(!r.cellStyles)return ss(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function JW(e,t){var r=Ze(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function ZW(e,t){var r={};return t<32||(e.l+=16,r.header=es(e),r.footer=es(e),e.l+=2),r}function ez(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function tz(e){for(var t=Ze(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var rz=qo,nz=V6,az=E0;function sz(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function iz(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=qo(e);++e.l;var a=rA(e,t-7,r);return n.t="str",n.val=a,n}function oz(e){var t=qo(e);++e.l;var r=es(e);return t.t="n",t.val=r,t}function lz(e,t,r){var n=Ze(15);return F0(n,e,t),n.write_shift(8,r,"f"),n}function cz(e){var t=qo(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function uz(e,t,r){var n=Ze(9);return F0(n,e,t),n.write_shift(2,r),n}function Az(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function dz(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function fz(e,t,r){var n=e.l+t,a=qo(e),s=e.read_shift(2),o=Ku(e,s,r);return e.l=n,a.t="str",a.val=o,a}var hz=[2,3,48,49,131,139,140,245],i2=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Dx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],A=Tc(1);switch(c.type){case"base64":A=Zs(oi(l));break;case"binary":A=Zs(l);break;case"buffer":case"array":A=l;break}Ia(A,0);var h=A.read_shift(1),f=!!(h&136),d=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,f=!0;break;case 49:d=!0,f=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,y=521;h==2&&(g=A.read_shift(2)),A.l+=3,h!=2&&(g=A.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(y=A.read_shift(2));var p=A.read_shift(2),m=c.codepage||1252;h!=2&&(A.l+=16,A.read_shift(1),A[A.l]!==0&&(m=e[A[A.l]]),A.l+=1,A.l+=2),v&&(A.l+=36);for(var w=[],x={},b=Math.min(A.length,h==2?521:y-10-(d?264:0)),B=v?32:11;A.l<b&&A[A.l]!=13;)switch(x={},x.name=Yh.utils.decode(m,A.slice(A.l,A.l+B)).replace(/[\u0000\r\n].*$/g,""),A.l+=B,x.type=String.fromCharCode(A.read_shift(1)),h!=2&&!v&&(x.offset=A.read_shift(4)),x.len=A.read_shift(1),h==2&&(x.offset=A.read_shift(2)),x.dec=A.read_shift(1),x.name.length&&w.push(x),h!=2&&(A.l+=v?13:14),x.type){case"B":(!d||x.len!=8)&&c.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+x.type)}if(A[A.l]!==13&&(A.l=y-1),A.read_shift(1)!==13)throw new Error("DBF Terminator not found "+A.l+" "+A[A.l]);A.l=y;var _=0,k=0;for(u[0]=[],k=0;k!=w.length;++k)u[0][k]=w[k].name;for(;g-- >0;){if(A[A.l]===42){A.l+=p;continue}for(++A.l,u[++_]=[],k=0,k=0;k!=w.length;++k){var E=A.slice(A.l,A.l+w[k].len);A.l+=w[k].len,Ia(E,0);var T=Yh.utils.decode(m,E);switch(w[k].type){case"C":T.trim().length&&(u[_][k]=T.replace(/\s+$/,""));break;case"D":T.length===8?u[_][k]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):u[_][k]=T;break;case"F":u[_][k]=parseFloat(T.trim());break;case"+":case"I":u[_][k]=v?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":u[_][k]=!0;break;case"N":case"F":u[_][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[_][k]="##MEMO##"+(v?parseInt(T.trim(),10):E.read_shift(4));break;case"N":T=T.replace(/\u0000/g,"").trim(),T&&T!="."&&(u[_][k]=+T||0);break;case"@":u[_][k]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[_][k]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[_][k]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][k]=-E.read_shift(-8,"f");break;case"B":if(d&&w[k].len==8){u[_][k]=E.read_shift(8,"f");break}case"G":case"P":E.l+=w[k].len;break;case"0":if(w[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[k].type)}}}if(h!=2&&A.l<A.length&&A[A.l++]!=26)throw new Error("DBF EOF Marker missing "+(A.l-1)+" of "+A.length+" "+A[A.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var A=$d(r(l,u),u);return A["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,A}function a(l,c){try{return Kc(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&ro(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var A=Is(),h=zg(l,{header:1,raw:!0,cellDates:!0}),f=h[0],d=h.slice(1),v=l["!cols"]||[],g=0,y=0,p=0,m=1;for(g=0;g<f.length;++g){if(((v[g]||{}).DBF||{}).name){f[g]=v[g].DBF.name,++p;continue}if(f[g]!=null){if(++p,typeof f[g]=="number"&&(f[g]=f[g].toString(10)),typeof f[g]!="string")throw new Error("DBF Invalid column name "+f[g]+" |"+typeof f[g]+"|");if(f.indexOf(f[g])!==g){for(y=0;y<1024;++y)if(f.indexOf(f[g]+"_"+y)==-1){f[g]+="_"+y;break}}}}var w=br(l["!ref"]),x=[],b=[],B=[];for(g=0;g<=w.e.c-w.s.c;++g){var _="",k="",E=0,T=[];for(y=0;y<d.length;++y)d[y][g]!=null&&T.push(d[y][g]);if(T.length==0||f[g]==null){x[g]="?";continue}for(y=0;y<T.length;++y){switch(typeof T[y]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=T[y]instanceof Date?"D":"C";break;default:k="C"}E=Math.max(E,String(T[y]).length),_=_&&_!=k?"C":k}E>250&&(E=250),k=((v[g]||{}).DBF||{}).type,k=="C"&&v[g].DBF.len>E&&(E=v[g].DBF.len),_=="B"&&k=="N"&&(_="N",B[g]=v[g].DBF.dec,E=v[g].DBF.len),b[g]=_=="C"||k=="N"?E:s[_]||0,m+=b[g],x[g]=_}var S=A.next(32);for(S.write_shift(4,318902576),S.write_shift(4,d.length),S.write_shift(2,296+32*p),S.write_shift(2,m),g=0;g<4;++g)S.write_shift(4,0);for(S.write_shift(4,0|(+t[$F]||3)<<8),g=0,y=0;g<f.length;++g)if(f[g]!=null){var j=A.next(32),I=(f[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,I,"sbcs"),j.write_shift(1,x[g]=="?"?"C":x[g],"sbcs"),j.write_shift(4,y),j.write_shift(1,b[g]||s[x[g]]||0),j.write_shift(1,B[g]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),y+=b[g]||s[x[g]]||0}var U=A.next(264);for(U.write_shift(4,13),g=0;g<65;++g)U.write_shift(4,0);for(g=0;g<d.length;++g){var q=A.next(m);for(q.write_shift(1,0),y=0;y<f.length;++y)if(f[y]!=null)switch(x[y]){case"L":q.write_shift(1,d[g][y]==null?63:d[g][y]?84:70);break;case"B":q.write_shift(8,d[g][y]||0,"f");break;case"N":var V="0";for(typeof d[g][y]=="number"&&(V=d[g][y].toFixed(B[y]||0)),p=0;p<b[y]-V.length;++p)q.write_shift(1,32);q.write_shift(1,V,"sbcs");break;case"D":d[g][y]?(q.write_shift(4,("0000"+d[g][y].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(d[g][y].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+d[g][y].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var X=String(d[g][y]!=null?d[g][y]:"").slice(0,b[y]);for(q.write_shift(1,X,"sbcs"),p=0;p<b[y]-X.length;++p)q.write_shift(1,32);break}}return A.next(1).write_shift(1,26),A.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),nT=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+_n(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,d){var v=e[d];return typeof v=="number"?AB(v):v},n=function(f,d,v){var g=d.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?f:AB(g)};e["|"]=254;function a(f,d){switch(d.type){case"base64":return s(oi(f),d);case"binary":return s(f,d);case"buffer":return s(cr&&Buffer.isBuffer(f)?f.toString("binary"):qc(f),d);case"array":return s(Hu(f),d)}throw new Error("Unrecognized type "+d.type)}function s(f,d){var v=f.split(/[\n\r]+/),g=-1,y=-1,p=0,m=0,w=[],x=[],b=null,B={},_=[],k=[],E=[],T=0,S;for(+d.codepage>=0&&ro(+d.codepage);p!==v.length;++p){T=0;var j=v[p].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),I=j.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),U=I[0],q;if(j.length>0)switch(U){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":I[1].charAt(0)=="P"&&x.push(j.slice(3).replace(/;;/g,";"));break;case"C":var V=!1,X=!1,W=!1,M=!1,G=-1,H=-1;for(m=1;m<I.length;++m)switch(I[m].charAt(0)){case"A":break;case"X":y=parseInt(I[m].slice(1))-1,X=!0;break;case"Y":for(g=parseInt(I[m].slice(1))-1,X||(y=0),S=w.length;S<=g;++S)w[S]=[];break;case"K":q=I[m].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(oo(q))?isNaN(Ed(q).getDate())||(q=tn(q)):(q=oo(q),b!==null&&qd(b)&&(q=Qx(q))),V=!0;break;case"E":M=!0;var C=dd(I[m].slice(1),{r:g,c:y});w[g][y]=[w[g][y],C];break;case"S":W=!0,w[g][y]=[w[g][y],"S5S"];break;case"G":break;case"R":G=parseInt(I[m].slice(1))-1;break;case"C":H=parseInt(I[m].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+j)}if(V&&(w[g][y]&&w[g][y].length==2?w[g][y][0]=q:w[g][y]=q,b=null),W){if(M)throw new Error("SYLK shared formula cannot have own formula");var L=G>-1&&w[G][H];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");w[g][y][1]=wT(L[1],{r:g-G,c:y-H})}break;case"F":var O=0;for(m=1;m<I.length;++m)switch(I[m].charAt(0)){case"X":y=parseInt(I[m].slice(1))-1,++O;break;case"Y":for(g=parseInt(I[m].slice(1))-1,S=w.length;S<=g;++S)w[S]=[];break;case"M":T=parseInt(I[m].slice(1))/20;break;case"F":break;case"G":break;case"P":b=x[parseInt(I[m].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=I[m].slice(1).split(" "),S=parseInt(E[0],10);S<=parseInt(E[1],10);++S)T=parseInt(E[2],10),k[S-1]=T===0?{hidden:!0}:{wch:T},Ic(k[S-1]);break;case"C":y=parseInt(I[m].slice(1))-1,k[y]||(k[y]={});break;case"R":g=parseInt(I[m].slice(1))-1,_[g]||(_[g]={}),T>0?(_[g].hpt=T,_[g].hpx=kd(T)):T===0&&(_[g].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+j)}O<1&&(b=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+j)}}return _.length>0&&(B["!rows"]=_),k.length>0&&(B["!cols"]=k),d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),[w,B]}function o(f,d){var v=a(f,d),g=v[0],y=v[1],p=$d(g,d);return _n(y).forEach(function(m){p[m]=y[m]}),p}function l(f,d){return Kc(o(f,d),d)}function c(f,d,v,g){var y="C;Y"+(v+1)+";X"+(g+1)+";K";switch(f.t){case"n":y+=f.v||0,f.f&&!f.F&&(y+=";E"+S_(f.f,{r:v,c:g}));break;case"b":y+=f.v?"TRUE":"FALSE";break;case"e":y+=f.w||f.v;break;case"d":y+='"'+(f.w||f.v)+'"';break;case"s":y+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(f,d){d.forEach(function(v,g){var y="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=s0(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=i0(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&f.push(y)})}function A(f,d){d.forEach(function(v,g){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*o0(v.hpx)+";"),y.length>2&&f.push(y+"R"+(g+1))})}function h(f,d){var v=["ID;PWXL;N;E"],g=[],y=br(f["!ref"]),p,m=Array.isArray(f),w=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&u(v,f["!cols"]),f["!rows"]&&A(v,f["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var x=y.s.r;x<=y.e.r;++x)for(var b=y.s.c;b<=y.e.c;++b){var B=Vt({r:x,c:b});p=m?(f[x]||[])[b]:f[B],!(!p||p.v==null&&(!p.f||p.F))&&g.push(c(p,f,x,b))}return v.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:h}}(),aT=function(){function e(s,o){switch(o.type){case"base64":return t(oi(s),o);case"binary":return t(s,o);case"buffer":return t(cr&&Buffer.isBuffer(s)?s.toString("binary"):qc(s),o);case"array":return t(Hu(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,A=0,h=[];A!==l.length;++A){if(l[A].trim()==="BOT"){h[++c]=[],u=0;continue}if(!(c<0)){var f=l[A].trim().split(","),d=f[0],v=f[1];++A;for(var g=l[A]||"";(g.match(/["]/g)||[]).length&1&&A<l.length-1;)g+=`
`+l[++A];switch(g=g.trim(),+d){case-1:if(g==="BOT"){h[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[c][u]=!0:g==="FALSE"?h[c][u]=!1:isNaN(oo(v))?isNaN(Ed(v).getDate())?h[c][u]=v:h[c][u]=tn(v):h[c][u]=oo(v),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(s,o){return $d(e(s,o),o)}function n(s,o){return Kc(r(s,o),o)}var a=function(){var s=function(c,u,A,h,f){c.push(u),c.push(A+","+h),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,u,A,h){c.push(u+","+A),c.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var u=[],A=br(c["!ref"]),h,f=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,A.e.r-A.s.r+1,""),s(u,"TUPLES",0,A.e.c-A.s.c+1,""),s(u,"DATA",0,0,"");for(var d=A.s.r;d<=A.e.r;++d){o(u,-1,0,"BOT");for(var v=A.s.c;v<=A.e.c;++v){var g=Vt({r:d,c:v});if(h=f?(c[d]||[])[v]:c[g],!h){o(u,1,0,"");continue}switch(h.t){case"n":var y=h.w;!y&&h.v!=null&&(y=h.v),y==null?h.f&&!h.F?o(u,1,0,"="+h.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Oi(h.z||Kt[14],Aa(tn(h.v)))),o(u,0,h.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var p=`\r
`,m=u.join(p);return m}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),sT=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var d=h.split(`
`),v=-1,g=-1,y=0,p=[];y!==d.length;++y){var m=d[y].trim().split(":");if(m[0]==="cell"){var w=fn(m[1]);if(p.length<=w.r)for(v=p.length;v<=w.r;++v)p[v]||(p[v]=[]);switch(v=w.r,g=w.c,m[2]){case"t":p[v][g]=e(m[3]);break;case"v":p[v][g]=+m[3];break;case"vtf":var x=m[m.length-1];case"vtc":switch(m[3]){case"nl":p[v][g]=!!+m[4];break;default:p[v][g]=+m[4];break}m[2]=="vtf"&&(p[v][g]=[p[v][g],x])}}}return f&&f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}function n(h,f){return $d(r(h,f),f)}function a(h,f){return Kc(n(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var f=[],d=[],v,g="",y=Os(h["!ref"]),p=Array.isArray(h),m=y.s.r;m<=y.e.r;++m)for(var w=y.s.c;w<=y.e.c;++w)if(g=Vt({r:m,c:w}),v=p?(h[m]||[])[w]:h[g],!(!v||v.v==null||v.t==="z")){switch(d=["cell",g,"t"],v.t){case"s":case"str":d.push(t(v.v));break;case"n":v.f?(d[2]="vtf",d[3]="n",d[4]=v.v,d[5]=t(v.f)):(d[2]="v",d[3]=v.v);break;case"b":d[2]="vt"+(v.f?"f":"c"),d[3]="nl",d[4]=v.v?"1":"0",d[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var x=Aa(tn(v.v));d[2]="vtc",d[3]="nd",d[4]=""+x,d[5]=v.w||Oi(v.z||Kt[14],x);break;case"e":continue}f.push(d.join(":"))}return f.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function A(h){return[s,o,l,o,u(h),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:A}}(),Sd=function(){function e(A,h,f,d,v){v.raw?h[f][d]=A:A===""||(A==="TRUE"?h[f][d]=!0:A==="FALSE"?h[f][d]=!1:isNaN(oo(A))?isNaN(Ed(A).getDate())?h[f][d]=A:h[f][d]=tn(A):h[f][d]=oo(A))}function t(A,h){var f=h||{},d=[];if(!A||A.length===0)return d;for(var v=A.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var y=10,p=0,m=0;m<=g;++m)p=v[m].indexOf(" "),p==-1?p=v[m].length:p++,y=Math.max(y,p);for(m=0;m<=g;++m){d[m]=[];var w=0;for(e(v[m].slice(0,y).trim(),d,m,w,f),w=1;w<=(v[m].length-y)/10+1;++w)e(v[m].slice(y+(w-1)*10,y+w*10).trim(),d,m,w,f)}return f.sheetRows&&(d=d.slice(0,f.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(A){for(var h={},f=!1,d=0,v=0;d<A.length;++d)(v=A.charCodeAt(d))==34?f=!f:!f&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&v.push([h[d],d]);if(!v.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&v.push([h[d],d])}return v.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[v.pop()[1]]||44}function s(A,h){var f=h||{},d="",v=f.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};A.slice(0,4)=="sep="?A.charCodeAt(5)==13&&A.charCodeAt(6)==10?(d=A.charAt(4),A=A.slice(7)):A.charCodeAt(5)==13||A.charCodeAt(5)==10?(d=A.charAt(4),A=A.slice(6)):d=a(A.slice(0,1024)):f&&f.FS?d=f.FS:d=a(A.slice(0,1024));var y=0,p=0,m=0,w=0,x=0,b=d.charCodeAt(0),B=!1,_=0,k=A.charCodeAt(0);A=A.replace(/\r\n/mg,`
`);var E=f.dateNF!=null?eV(f.dateNF):null;function T(){var S=A.slice(w,x),j={};if(S.charAt(0)=='"'&&S.charAt(S.length-1)=='"'&&(S=S.slice(1,-1).replace(/""/g,'"')),S.length===0)j.t="z";else if(f.raw)j.t="s",j.v=S;else if(S.trim().length===0)j.t="s",j.v=S;else if(S.charCodeAt(0)==61)S.charCodeAt(1)==34&&S.charCodeAt(S.length-1)==34?(j.t="s",j.v=S.slice(2,-1).replace(/""/g,'"')):kY(S)?(j.t="n",j.f=S.slice(1)):(j.t="s",j.v=S);else if(S=="TRUE")j.t="b",j.v=!0;else if(S=="FALSE")j.t="b",j.v=!1;else if(!isNaN(m=oo(S)))j.t="n",f.cellText!==!1&&(j.w=S),j.v=m;else if(!isNaN(Ed(S).getDate())||E&&S.match(E)){j.z=f.dateNF||Kt[14];var I=0;E&&S.match(E)&&(S=tV(S,f.dateNF,S.match(E)||[]),I=1),f.cellDates?(j.t="d",j.v=tn(S,I)):(j.t="n",j.v=Aa(tn(S,I))),f.cellText!==!1&&(j.w=Oi(j.z,j.v instanceof Date?Aa(j.v):j.v)),f.cellNF||delete j.z}else j.t="s",j.v=S;if(j.t=="z"||(f.dense?(v[y]||(v[y]=[]),v[y][p]=j):v[Vt({c:p,r:y})]=j),w=x+1,k=A.charCodeAt(w),g.e.c<p&&(g.e.c=p),g.e.r<y&&(g.e.r=y),_==b)++p;else if(p=0,++y,f.sheetRows&&f.sheetRows<=y)return!0}e:for(;x<A.length;++x)switch(_=A.charCodeAt(x)){case 34:k===34&&(B=!B);break;case b:case 10:case 13:if(!B&&T())break e;break}return x-w>0&&T(),v["!ref"]=rr(g),v}function o(A,h){return!(h&&h.PRN)||h.FS||A.slice(0,4)=="sep="||A.indexOf("	")>=0||A.indexOf(",")>=0||A.indexOf(";")>=0?s(A,h):$d(t(A,h),h)}function l(A,h){var f="",d=h.type=="string"?[0,0,0,0]:U_(A,h);switch(h.type){case"base64":f=oi(A);break;case"binary":f=A;break;case"buffer":h.codepage==65001?f=A.toString("utf8"):h.codepage&&typeof Yh<"u"||(f=cr&&Buffer.isBuffer(A)?A.toString("binary"):qc(A));break;case"array":f=Hu(A);break;case"string":f=A;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?f=Pr(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=Pr(f):h.type=="binary"&&typeof Yh<"u",f.slice(0,19)=="socialcalc:version:"?sT.to_sheet(h.type=="string"?f:Pr(f),h):o(f,h)}function c(A,h){return Kc(l(A,h),h)}function u(A){for(var h=[],f=br(A["!ref"]),d,v=Array.isArray(A),g=f.s.r;g<=f.e.r;++g){for(var y=[],p=f.s.c;p<=f.e.c;++p){var m=Vt({r:g,c:p});if(d=v?(A[g]||[])[p]:A[m],!d||d.v==null){y.push("          ");continue}for(var w=(d.w||(jl(d),d.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(p===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function pz(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=nT.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Sd.to_workbook(e,t)}}var ju=function(){function e(C,L,O){if(C){Ia(C,C.l||0);for(var D=O.Enum||G;C.l<C.length;){var P=C.read_shift(2),Q=D[P]||D[65535],J=C.read_shift(2),te=C.l+J,z=Q.f&&Q.f(C,J,O);if(C.l=te,L(z,Q,P))return}}}function t(C,L){switch(L.type){case"base64":return r(Zs(oi(C)),L);case"binary":return r(Zs(C),L);case"buffer":case"array":return r(C,L)}throw"Unsupported type "+L.type}function r(C,L){if(!C)return C;var O=L||{},D=O.dense?[]:{},P="Sheet1",Q="",J=0,te={},z=[],ye=[],re={s:{r:0,c:0},e:{r:0,c:0}},ke=O.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)O.Enum=G,e(C,function(De,pe,we){switch(we){case 0:O.vers=De,De>=4096&&(O.qpro=!0);break;case 6:re=De;break;case 204:De&&(Q=De);break;case 222:Q=De;break;case 15:case 51:O.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:we==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=O.dateNF||Kt[14],O.cellDates&&(De[1].t="d",De[1].v=Qx(De[1].v))),O.qpro&&De[3]>J&&(D["!ref"]=rr(re),te[P]=D,z.push(P),D=O.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},J=De[3],P=Q||"Sheet"+(J+1),Q="");var Te=O.dense?(D[De[0].r]||[])[De[0].c]:D[Vt(De[0])];if(Te){Te.t=De[1].t,Te.v=De[1].v,De[1].z!=null&&(Te.z=De[1].z),De[1].f!=null&&(Te.f=De[1].f);break}O.dense?(D[De[0].r]||(D[De[0].r]=[]),D[De[0].r][De[0].c]=De[1]):D[Vt(De[0])]=De[1];break}},O);else if(C[2]==26||C[2]==14)O.Enum=H,C[2]==14&&(O.qpro=!0,C.l=0),e(C,function(De,pe,we){switch(we){case 204:P=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>J&&(D["!ref"]=rr(re),te[P]=D,z.push(P),D=O.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},J=De[3],P="Sheet"+(J+1)),ke>0&&De[0].r>=ke)break;O.dense?(D[De[0].r]||(D[De[0].r]=[]),D[De[0].r][De[0].c]=De[1]):D[Vt(De[0])]=De[1],re.e.c<De[0].c&&(re.e.c=De[0].c),re.e.r<De[0].r&&(re.e.r=De[0].r);break;case 27:De[14e3]&&(ye[De[14e3][0]]=De[14e3][1]);break;case 1537:ye[De[0]]=De[1],De[0]==J&&(P=De[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(D["!ref"]=rr(re),te[Q||P]=D,z.push(Q||P),!ye.length)return{SheetNames:z,Sheets:te};for(var be={},ae=[],Ie=0;Ie<ye.length;++Ie)te[z[Ie]]?(ae.push(ye[Ie]||z[Ie]),be[ye[Ie]]=te[ye[Ie]]||te[z[Ie]]):(ae.push(ye[Ie]),be[ye[Ie]]={"!ref":"A1"});return{SheetNames:ae,Sheets:be}}function n(C,L){var O=L||{};if(+O.codepage>=0&&ro(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Is(),P=br(C["!ref"]),Q=Array.isArray(C),J=[];gt(D,0,s(1030)),gt(D,6,c(P));for(var te=Math.min(P.e.r,8191),z=P.s.r;z<=te;++z)for(var ye=Un(z),re=P.s.c;re<=P.e.c;++re){z===P.s.r&&(J[re]=dn(re));var ke=J[re]+ye,be=Q?(C[z]||[])[re]:C[ke];if(!(!be||be.t=="z"))if(be.t=="n")(be.v|0)==be.v&&be.v>=-32768&&be.v<=32767?gt(D,13,d(z,re,be.v)):gt(D,14,g(z,re,be.v));else{var ae=jl(be);gt(D,15,h(z,re,ae.slice(0,239)))}}return gt(D,1),D.end()}function a(C,L){var O=L||{};if(+O.codepage>=0&&ro(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Is();gt(D,0,o(C));for(var P=0,Q=0;P<C.SheetNames.length;++P)(C.Sheets[C.SheetNames[P]]||{})["!ref"]&&gt(D,27,M(C.SheetNames[P],Q++));var J=0;for(P=0;P<C.SheetNames.length;++P){var te=C.Sheets[C.SheetNames[P]];if(!(!te||!te["!ref"])){for(var z=br(te["!ref"]),ye=Array.isArray(te),re=[],ke=Math.min(z.e.r,8191),be=z.s.r;be<=ke;++be)for(var ae=Un(be),Ie=z.s.c;Ie<=z.e.c;++Ie){be===z.s.r&&(re[Ie]=dn(Ie));var De=re[Ie]+ae,pe=ye?(te[be]||[])[Ie]:te[De];if(!(!pe||pe.t=="z"))if(pe.t=="n")gt(D,23,T(be,Ie,J,pe.v));else{var we=jl(pe);gt(D,22,_(be,Ie,J,we.slice(0,239)))}}++J}}return gt(D,1),D.end()}function s(C){var L=Ze(2);return L.write_shift(2,C),L}function o(C){var L=Ze(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var O=0,D=0,P=0,Q=0;Q<C.SheetNames.length;++Q){var J=C.SheetNames[Q],te=C.Sheets[J];if(!(!te||!te["!ref"])){++P;var z=Os(te["!ref"]);O<z.e.r&&(O=z.e.r),D<z.e.c&&(D=z.e.c)}}return O>8191&&(O=8191),L.write_shift(2,O),L.write_shift(1,P),L.write_shift(1,D),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function l(C,L,O){var D={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&O.qpro?(D.s.c=C.read_shift(1),C.l++,D.s.r=C.read_shift(2),D.e.c=C.read_shift(1),C.l++,D.e.r=C.read_shift(2),D):(D.s.c=C.read_shift(2),D.s.r=C.read_shift(2),L==12&&O.qpro&&(C.l+=2),D.e.c=C.read_shift(2),D.e.r=C.read_shift(2),L==12&&O.qpro&&(C.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function c(C){var L=Ze(8);return L.write_shift(2,C.s.c),L.write_shift(2,C.s.r),L.write_shift(2,C.e.c),L.write_shift(2,C.e.r),L}function u(C,L,O){var D=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(D[0].c=C.read_shift(1),D[3]=C.read_shift(1),D[0].r=C.read_shift(2),C.l+=2):(D[2]=C.read_shift(1),D[0].c=C.read_shift(2),D[0].r=C.read_shift(2)),D}function A(C,L,O){var D=C.l+L,P=u(C,L,O);if(P[1].t="s",O.vers==20768){C.l++;var Q=C.read_shift(1);return P[1].v=C.read_shift(Q,"utf8"),P}return O.qpro&&C.l++,P[1].v=C.read_shift(D-C.l,"cstr"),P}function h(C,L,O){var D=Ze(7+O.length);D.write_shift(1,255),D.write_shift(2,L),D.write_shift(2,C),D.write_shift(1,39);for(var P=0;P<D.length;++P){var Q=O.charCodeAt(P);D.write_shift(1,Q>=128?95:Q)}return D.write_shift(1,0),D}function f(C,L,O){var D=u(C,L,O);return D[1].v=C.read_shift(2,"i"),D}function d(C,L,O){var D=Ze(7);return D.write_shift(1,255),D.write_shift(2,L),D.write_shift(2,C),D.write_shift(2,O,"i"),D}function v(C,L,O){var D=u(C,L,O);return D[1].v=C.read_shift(8,"f"),D}function g(C,L,O){var D=Ze(13);return D.write_shift(1,255),D.write_shift(2,L),D.write_shift(2,C),D.write_shift(8,O,"f"),D}function y(C,L,O){var D=C.l+L,P=u(C,L,O);if(P[1].v=C.read_shift(8,"f"),O.qpro)C.l=D;else{var Q=C.read_shift(2);x(C.slice(C.l,C.l+Q),P),C.l+=Q}return P}function p(C,L,O){var D=L&32768;return L&=-32769,L=(D?C:0)+(L>=8192?L-16384:L),(D?"":"$")+(O?dn(L):Un(L))}var m={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function x(C,L){Ia(C,0);for(var O=[],D=0,P="",Q="",J="",te="";C.l<C.length;){var z=C[C.l++];switch(z){case 0:O.push(C.read_shift(8,"f"));break;case 1:Q=p(L[0].c,C.read_shift(2),!0),P=p(L[0].r,C.read_shift(2),!1),O.push(Q+P);break;case 2:{var ye=p(L[0].c,C.read_shift(2),!0),re=p(L[0].r,C.read_shift(2),!1);Q=p(L[0].c,C.read_shift(2),!0),P=p(L[0].r,C.read_shift(2),!1),O.push(ye+re+":"+Q+P)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(C.read_shift(2));break;case 6:{for(var ke="";z=C[C.l++];)ke+=String.fromCharCode(z);O.push('"'+ke.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:te=O.pop(),J=O.pop(),O.push(["AND","OR"][z-20]+"("+J+","+te+")");break;default:if(z<32&&w[z])te=O.pop(),J=O.pop(),O.push(J+w[z]+te);else if(m[z]){if(D=m[z][1],D==69&&(D=C[C.l++]),D>O.length){console.error("WK1 bad formula parse 0x"+z.toString(16)+":|"+O.join("|")+"|");return}var be=O.slice(-D);O.length-=D,O.push(m[z][0]+"("+be.join(",")+")")}else return z<=7?console.error("WK1 invalid opcode "+z.toString(16)):z<=24?console.error("WK1 unsupported op "+z.toString(16)):z<=30?console.error("WK1 invalid opcode "+z.toString(16)):z<=115?console.error("WK1 unsupported function opcode "+z.toString(16)):console.error("WK1 unrecognized opcode "+z.toString(16))}}O.length==1?L[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function b(C){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=C.read_shift(2),L[3]=C[C.l++],L[0].c=C[C.l++],L}function B(C,L){var O=b(C);return O[1].t="s",O[1].v=C.read_shift(L-4,"cstr"),O}function _(C,L,O,D){var P=Ze(6+D.length);P.write_shift(2,C),P.write_shift(1,O),P.write_shift(1,L),P.write_shift(1,39);for(var Q=0;Q<D.length;++Q){var J=D.charCodeAt(Q);P.write_shift(1,J>=128?95:J)}return P.write_shift(1,0),P}function k(C,L){var O=b(C);O[1].v=C.read_shift(2);var D=O[1].v>>1;if(O[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return O[1].v=D,O}function E(C,L){var O=b(C),D=C.read_shift(4),P=C.read_shift(4),Q=C.read_shift(2);if(Q==65535)return D===0&&P===3221225472?(O[1].t="e",O[1].v=15):D===0&&P===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var J=Q&32768;return Q=(Q&32767)-16446,O[1].v=(1-J*2)*(P*Math.pow(2,Q+32)+D*Math.pow(2,Q)),O}function T(C,L,O,D){var P=Ze(14);if(P.write_shift(2,C),P.write_shift(1,O),P.write_shift(1,L),D==0)return P.write_shift(4,0),P.write_shift(4,0),P.write_shift(2,65535),P;var Q=0,J=0,te=0,z=0;return D<0&&(Q=1,D=-D),J=Math.log2(D)|0,D/=Math.pow(2,J-31),z=D>>>0,z&2147483648||(D/=2,++J,z=D>>>0),D-=z,z|=2147483648,z>>>=0,D*=Math.pow(2,32),te=D>>>0,P.write_shift(4,te),P.write_shift(4,z),J+=16383+(Q?32768:0),P.write_shift(2,J),P}function S(C,L){var O=E(C);return C.l+=L-14,O}function j(C,L){var O=b(C),D=C.read_shift(4);return O[1].v=D>>6,O}function I(C,L){var O=b(C),D=C.read_shift(8,"f");return O[1].v=D,O}function U(C,L){var O=I(C);return C.l+=L-10,O}function q(C,L){return C[C.l+L-1]==0?C.read_shift(L,"cstr"):""}function V(C,L){var O=C[C.l++];O>L-1&&(O=L-1);for(var D="";D.length<O;)D+=String.fromCharCode(C[C.l++]);return D}function X(C,L,O){if(!(!O.qpro||L<21)){var D=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var P=C.read_shift(L-21,"cstr");return[D,P]}}function W(C,L){for(var O={},D=C.l+L;C.l<D;){var P=C.read_shift(2);if(P==14e3){for(O[P]=[0,""],O[P][0]=C.read_shift(2);C[C.l];)O[P][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return O}function M(C,L){var O=Ze(5+C.length);O.write_shift(2,14e3),O.write_shift(2,L);for(var D=0;D<C.length;++D){var P=C.charCodeAt(D);O[O.l++]=P>127?95:P}return O[O.l++]=0,O}var G={0:{n:"BOF",f:Kn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:A},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:A},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:V},65535:{n:""}},H={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:S},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:W},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:I},40:{n:"FORMULA28",f:U},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function mz(e){var t={},r=e.match(is),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Gt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Zb[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var gz=function(){var e=e0("t"),t=e0("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:wr(o[1])},c=s.match(t);return c&&(l.s=mz(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),xz=function(){var t=/(\r\n|\n)/g;function r(a,s,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),vz=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,yz=/<(?:\w+:)?r>/,wz=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function __(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=wr(Pr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Pr(e),r&&(n.h=c_(n.t))):e.match(yz)&&(n.r=Pr(e),n.t=wr(Pr((e.replace(wz,"").match(vz)||[]).join("").replace(is,""))),r&&(n.h=xz(gz(n.r)))),n):{t:""}}var bz=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,_z=/<(?:\w+:)?(?:si|sstItem)>/g,Nz=/<\/(?:\w+:)?(?:si|sstItem)>/;function Bz(e,t){var r=[],n="";if(!e)return r;var a=e.match(bz);if(a){n=a[2].replace(_z,"").split(Nz);for(var s=0;s!=n.length;++s){var o=__(n[s].trim(),t);o!=null&&(r[r.length]=o)}a=Gt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var Cz=/^\s|\s$|[\t\n\r]/;function iT(e,t){if(!t.bookSST)return"";var r=[Pn];r[r.length]=pt("sst",null,{xmlns:Yu[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(Cz)&&(s+=' xml:space="preserve"'),s+=">"+Lr(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Ez(e){return[e.read_shift(4),e.read_shift(4)]}function Sz(e,t){var r=[],n=!1;return Ol(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function kz(e,t){return t||(t=Ze(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var jz=QV;function Fz(e){var t=Is();ot(t,159,kz(e));for(var r=0;r<e.length;++r)ot(t,19,jz(e[r]));return ot(t,160),t.end()}function oT(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function _l(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Tz(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=_l(e,4),t.U=_l(e,4),t.W=_l(e,4),t}function Iz(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Lz(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Iz(e));return t}function Oz(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Uz(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=_l(e,4),t.U=_l(e,4),t.W=_l(e,4),t}function Pz(e){var t=Uz(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function lT(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function cT(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Dz(e){var t=_l(e);switch(t.Minor){case 2:return[t.Minor,Rz(e)];case 3:return[t.Minor,Qz()];case 4:return[t.Minor,Mz(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Rz(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=lT(e,r),a=cT(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Qz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Mz(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(is,function(s){var o=Gt(s);switch(Ho(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Hz(e,t){var r={},n=r.EncryptionVersionInfo=_l(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=lT(e,a),t-=a,r.EncryptionVerifier=cT(e,t),r}function qz(e){var t={},r=t.EncryptionVersionInfo=_l(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function N_(e){var t=0,r,n=oT(e),a=n.length+1,s,o,l,c,u;for(r=Tc(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var uT=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var A=o[u],h=0;h!=7;++h)A&64&&(l^=r[c]),A*=2,--c;return l};return function(o){for(var l=oT(o),c=s(l),u=l.length,A=Tc(16),h=0;h!=16;++h)A[h]=0;var f,d,v;for((u&1)===1&&(f=c>>8,A[u]=a(e[0],f),--u,f=c&255,d=l[l.length-1],A[u]=a(d,f));u>0;)--u,f=c>>8,A[u]=a(l[u],f),--u,f=c&255,A[u]=a(l[u],f);for(u=15,v=15-l.length;v>0;)f=c>>8,A[u]=a(e[v],f),--u,--v,f=c&255,A[u]=a(l[u],f),--u,--v;return A}}(),Kz=function(e,t,r,n,a){a||(a=t),n||(n=uT(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,a[s]=o,++r;return[a,r,n]},$z=function(e){var t=0,r=uT(e);return function(n){var a=Kz("",n,t,r);return t=a[1],a[0]}};function Vz(e,t,r,n){var a={key:Kn(e),verificationBytes:Kn(e)};return r.password&&(a.verifier=N_(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=$z(r.password)),a}function Gz(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=qz(e):n.Data=Hz(e,t),n}function Wz(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Gz(e,t-2,n):Vz(e,r.biff>=8?t:t-2,r,n),n}var AT=function(){function e(a,s){switch(s.type){case"base64":return t(oi(a),s);case"binary":return t(a,s);case"buffer":return t(cr&&Buffer.isBuffer(a)?a.toString("binary"):qc(a),s);case"array":return t(Hu(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(A,h){Array.isArray(l)&&(l[h]=[]);for(var f=/\\\w+\b/g,d=0,v,g=-1;v=f.exec(A);){switch(v[0]){case"\\cell":var y=A.slice(d,f.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var p={v:y,t:"s"};Array.isArray(l)?l[h][g]=p:l[Vt({r:h,c:g})]=p}break}d=f.lastIndex}g>u.e.c&&(u.e.c=g)}),l["!ref"]=rr(u),l}function r(a,s){return Kc(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=br(a["!ref"]),l,c=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var A=o.s.c;A<=o.e.c;++A)s.push("\\cellx"+(A+1));for(s.push("\\pard\\intbl"),A=o.s.c;A<=o.e.c;++A){var h=Vt({r:u,c:A});l=c?(a[u]||[])[A]:a[h],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(jl(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function zz(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function a0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Xz(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),o=a-s;if(o===0)return[0,0,t];var l=0,c=0,u=a+s;switch(c=o/(u>1?2-u:u),a){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function Yz(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function Vg(e,t){if(t===0)return e;var r=Xz(zz(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),a0(Yz(r))}var dT=6,Jz=15,Zz=1,Za=dT;function s0(e){return Math.floor((e+Math.round(128/Za)/256)*Za)}function i0(e){return Math.floor((e-5)/Za*100+.5)/100}function Gg(e){return Math.round((e*Za+5)/Za*256)/256}function Ov(e){return Gg(i0(s0(e)))}function B_(e){var t=Math.abs(e-Ov(e)),r=Za;if(t>.005)for(Za=Zz;Za<Jz;++Za)Math.abs(e-Ov(e))<=t&&(t=Math.abs(e-Ov(e)),r=Za);Za=r}function Ic(e){e.width?(e.wpx=s0(e.width),e.wch=i0(e.wpx),e.MDW=Za):e.wpx?(e.wch=i0(e.wpx),e.width=Gg(e.wch),e.MDW=Za):typeof e.wch=="number"&&(e.width=Gg(e.wch),e.wpx=s0(e.width),e.MDW=Za),e.customWidth&&delete e.customWidth}var eX=96,fT=eX;function o0(e){return e*96/fT}function kd(e){return e*fT/96}var tX={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function rX(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(is)||[]).forEach(function(o){var l=Gt(o);switch(Ho(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Jr(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Jr(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function nX(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(is)||[]).forEach(function(o){var l=Gt(o);switch(Ho(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function aX(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(is)||[]).forEach(function(o){var l=Gt(o);switch(Ho(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Pr(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Jr(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Jr(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Jr(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Jr(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Jr(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Jr(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Jr(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Zb[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Jr(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Su[a.color.index];a.color.index==81&&(c=Su[1]),c||(c=Su[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Vg(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function sX(e,t,r){t.NumberFmt=[];for(var n=_n(Kt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Kt[n[a]];var s=e[0].match(is);if(s)for(a=0;a<s.length;++a){var o=Gt(s[a]);switch(Ho(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=wr(Pr(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}bl(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function iX(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=pt("numFmt",null,{numFmtId:n,formatCode:Lr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=pt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Gp=["numFmtId","fillId","fontId","borderId","xfId"],Wp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function oX(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(is)||[]).forEach(function(s){var o=Gt(s),l=0;switch(Ho(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Gp.length;++l)n[Gp[l]]&&(n[Gp[l]]=parseInt(n[Gp[l]],10));for(l=0;l<Wp.length;++l)n[Wp[l]]&&(n[Wp[l]]=Jr(n[Wp[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Jr(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function lX(e){var t=[];return t[t.length]=pt("cellXfs",null),e.forEach(function(r){t[t.length]=pt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=pt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var cX=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var A={};if(!l)return A;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=l.match(t))&&sX(h,A,u),(h=l.match(a))&&aX(h,A,c,u),(h=l.match(n))&&nX(h,A,c,u),(h=l.match(s))&&rX(h,A,c,u),(h=l.match(r))&&oX(h,A,u),A}}();function hT(e,t){var r=[Pn,pt("styleSheet",null,{xmlns:Yu[0],"xmlns:vt":ia.vt})],n;return e.SSF&&(n=iX(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lX(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uX(e,t){var r=e.read_shift(2),n=rs(e);return[r,n]}function AX(e,t,r){r||(r=Ze(6+4*t.length)),r.write_shift(2,e),xa(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function dX(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=GV(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=VV(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=rs(e),n}function fX(e,t){t||(t=Ze(25+4*32)),t.write_shift(2,e.sz*20),WV(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),qg(e.color,t);var n=0;return n=2,t.write_shift(1,n),xa(e.name,t),t.length>t.l?t.slice(0,t.l):t}var hX=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Uv,pX=ss;function tC(e,t){t||(t=Ze(4*3+8*7+16*1)),Uv||(Uv=Dx(hX));var r=Uv[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(qg({auto:1},t),qg({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function mX(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function pT(e,t,r){r||(r=Ze(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Uf(e,t){return t||(t=Ze(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var gX=ss;function xX(e,t){return t||(t=Ze(51)),t.write_shift(1,0),Uf(null,t),Uf(null,t),Uf(null,t),Uf(null,t),Uf(null,t),t.length>t.l?t.slice(0,t.l):t}function vX(e,t){return t||(t=Ze(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Hg(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function yX(e,t,r){var n=Ze(2052);return n.write_shift(4,e),Hg(t,n),Hg(r,n),n.length>n.l?n.slice(0,n.l):n}function wX(e,t,r){var n={};n.NumberFmt=[];for(var a in Kt)n.NumberFmt[a]=Kt[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return Ol(e,function(c,u,A){switch(A){case 44:n.NumberFmt[c[0]]=c[1],bl(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Vg(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(A),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(A);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+A.toString(16))}}),n}function bX(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(ot(e,615,lo(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ot(e,44,AX(a,t[a]))}),ot(e,616))}}function _X(e){var t=1;ot(e,611,lo(t)),ot(e,43,fX({sz:12,color:{theme:1},name:"Calibri",family:2})),ot(e,612)}function NX(e){var t=2;ot(e,603,lo(t)),ot(e,45,tC({patternType:"none"})),ot(e,45,tC({patternType:"gray125"})),ot(e,604)}function BX(e){var t=1;ot(e,613,lo(t)),ot(e,46,xX()),ot(e,614)}function CX(e){var t=1;ot(e,626,lo(t)),ot(e,47,pT({numFmtId:0},65535)),ot(e,627)}function EX(e,t){ot(e,617,lo(t.length)),t.forEach(function(r){ot(e,47,pT(r,0))}),ot(e,618)}function SX(e){var t=1;ot(e,619,lo(t)),ot(e,48,vX({xfId:0,name:"Normal"})),ot(e,620)}function kX(e){var t=0;ot(e,505,lo(t)),ot(e,506)}function jX(e){var t=0;ot(e,508,yX(t,"TableStyleMedium9","PivotStyleMedium4")),ot(e,509)}function FX(e,t){var r=Is();return ot(r,278),bX(r,e.SSF),_X(r),NX(r),BX(r),CX(r),EX(r,t.cellXfs),SX(r),kX(r),jX(r),ot(r,279),r.end()}var TX=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function IX(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(is)||[]).forEach(function(a){var s=Gt(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[TX.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function LX(){}function OX(){}var UX=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,PX=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,DX=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function RX(e,t,r){t.themeElements={};var n;[["clrScheme",UX,IX],["fontScheme",PX,LX],["fmtScheme",DX,OX]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var QX=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function mT(e,t){(!e||e.length===0)&&(e=C_());var r,n={};if(!(r=e.match(QX)))throw new Error("themeElements not found in theme");return RX(r[0],n,t),n.raw=e,n}function C_(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Pn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function MX(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=l6(s,{type:"array"})}catch{return}var l=ei(o,"theme/theme/theme1.xml",!0);if(l)return mT(l,r)}}function HX(e){return e.read_shift(4)}function qX(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=KX(e,4);break;case 2:t.xclrValue=z6(e);break;case 3:t.xclrValue=HX(e);break;case 4:e.l+=4;break}return e.l+=8,t}function KX(e,t){return ss(e,t)}function $X(e,t){return ss(e,t)}function VX(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=qX(e);break;case 6:n[1]=$X(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function GX(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(VX(e,r-e.l));return{ixfe:n,ext:s}}function WX(e,t){t.forEach(function(r){switch(r[0]){}})}function zX(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:rs(e)}}function XX(e){var t=Ze(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),xa(e.name,t),t.slice(0,t.l)}function YX(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function JX(e){var t=Ze(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function ZX(e,t){var r=Ze(8+2*t.length);return r.write_shift(4,e),xa(t,r),r.slice(0,r.l)}function eY(e){return e.l+=4,e.read_shift(4)!=0}function tY(e,t){var r=Ze(8);return r.write_shift(4,e),r.write_shift(4,1),r}function rY(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],o=!1,l=2;return Ol(e,function(c,u,A){switch(A){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){l==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):l==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(A),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+A.toString(16))}}}),n}function nY(){var e=Is();return ot(e,332),ot(e,334,lo(1)),ot(e,335,XX({name:"XLDAPR",version:12e4,flags:3496657072})),ot(e,336),ot(e,339,ZX(1,"XLDAPR")),ot(e,52),ot(e,35,lo(514)),ot(e,4096,lo(0)),ot(e,4097,wi(1)),ot(e,36),ot(e,53),ot(e,340),ot(e,337,tY(1)),ot(e,51,JX([[1,0]])),ot(e,338),ot(e,333),e.end()}function aY(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,o;return e.replace(is,function(l){var c=Gt(l);switch(Ho(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function gT(){var e=[Pn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function sY(e){var t=[];if(!e)return t;var r=1;return(e.match(is)||[]).forEach(function(n){var a=Gt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function iY(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Vt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function oY(e,t,r){var n=[];return Ol(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function lY(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Ol(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function cY(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var JA=1024;function xT(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[pt("xml",null,{"xmlns:v":zs.v,"xmlns:o":zs.o,"xmlns:x":zs.x,"xmlns:mv":zs.mv}).replace(/\/>/,">"),pt("o:shapelayout",pt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),pt("v:shapetype",[pt("v:stroke",null,{joinstyle:"miter"}),pt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];JA<e*1e3;)JA+=1e3;return t.forEach(function(s){var o=fn(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?pt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=pt("v:fill",c,l),A={on:"t",obscured:"t"};++JA,a=a.concat(["<v:shape"+t0({id:"_x0000_s"+JA,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,pt("v:shadow",null,A),pt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",La("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),La("x:AutoFill","False"),La("x:Row",String(o.r)),La("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function rC(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(o){var l=fn(o.ref);if(a?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},a?e[l.r][l.c]=s:e[o.ref]=s;var c=br(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=rr(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var A={a:o.author,t:o.t,r:o.r,T:r};o.h&&(A.h=o.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(A.a==n[h].id){A.a=n[h].name||A.a;break}}s.c.push(A)})}function uY(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Gt(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},A=fn(c.ref);if(!(t.sheetRows&&t.sheetRows<=A.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!h&&!!h[1]&&__(h[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=f.h),n.push(u)}}}}),n}function vT(e){var t=[Pn,pt("comments",null,{xmlns:Yu[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=Lr(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(Lr(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(La("t",Lr(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(La("t",Lr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function AY(e,t){var r=[],n=!1,a={},s=0;return e.replace(is,function(l,c){var u=Gt(l);switch(Ho(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":a.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function dY(e,t,r){var n=[Pn,pt("ThreadedComments",null,{xmlns:ia.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(pt("threadedComment",La("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function fY(e,t){var r=[],n=!1;return e.replace(is,function(s){var o=Gt(s);switch(Ho(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function hY(e){var t=[Pn,pt("personList",null,{xmlns:ia.TCMNT,"xmlns:x":Yu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(pt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function pY(e){var t={};t.iauthor=e.read_shift(4);var r=tA(e);return t.rfx=r.s,t.ref=Vt(r.s),e.l+=16,t}function mY(e,t){return t==null&&(t=Ze(36)),t.write_shift(4,e[1].iauthor),Vd(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var gY=rs;function xY(e){return xa(e.slice(0,54))}function vY(e,t){var r=[],n=[],a={},s=!1;return Ol(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function yY(e){var t=Is(),r=[];return ot(t,628),ot(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),ot(t,632,xY(a.a)))})}),ot(t,631),ot(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:fn(n[0]),e:fn(n[0])};ot(t,635,mY([s,a])),a.t&&a.t.length>0&&ot(t,637,HV(a)),ot(t,636),delete a.iauthor})}),ot(t,634),ot(t,629),t.end()}var wY="application/vnd.ms-office.vbaProject";function bY(e){var t=Qt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Qt.write(t)}function _Y(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Qt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var yT=["xlsb","xlsm","xlam","biff8","xla"];function NY(){return{"!type":"dialog"}}function BY(){return{"!type":"dialog"}}function CY(){return{"!type":"macro"}}function EY(){return{"!type":"macro"}}var dd=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,A=o.length>0?parseInt(o,10)|0:0;return l?A+=t.c:--A,c?u+=t.r:--u,a+(l?"":"$")+dn(A)+(c?"":"$")+Un(u)}return function(a,s){return t=s,a.replace(e,r)}}(),E_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,S_=function(){return function(t,r){return t.replace(E_,function(n,a,s,o,l,c){var u=h_(o)-(s?0:r.c),A=f_(c)-(l?0:r.r),h=A==0?"":l?A+1:"["+A+"]",f=u==0?"":s?u+1:"["+u+"]";return a+"R"+h+"C"+f})}}();function wT(e,t){return e.replace(E_,function(r,n,a,s,o,l){return n+(a=="$"?a+s:dn(h_(s)+t.c))+(o=="$"?o+l:Un(f_(l)+t.r))})}function SY(e,t,r){var n=Os(t),a=n.s,s=fn(r),o={r:s.r-a.r,c:s.c-a.c};return wT(e,o)}function kY(e){return e.length!=1}function nC(e){return e.replace(/_xlfn\./g,"")}function Hn(e){e.l+=1}function Lc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bT(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return _T(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),o=Lc(e),l=Lc(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function _T(e){var t=Lc(e),r=Lc(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function jY(e,t,r){if(r.biff<8)return _T(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Lc(e),o=Lc(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function NT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return FY(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Lc(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function FY(e){var t=Lc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function TY(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function IY(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return LY(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function LY(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function OY(e,t,r){var n=(e[e.l++]&96)>>5,a=bT(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function UY(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=bT(e,s,r);return[n,a,o]}function PY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function DY(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function RY(e,t,r){var n=(e[e.l++]&96)>>5,a=jY(e,t-1,r);return[n,a]}function QY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function aC(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function MY(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function HY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function qY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function KY(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function $Y(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function BT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function VY(e){return e.read_shift(2),BT(e)}function GY(e){return e.read_shift(2),BT(e)}function WY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=NT(e,0,r);return[n,a]}function zY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=IY(e,0,r);return[n,a]}function XY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=NT(e,0,r);return[n,a,s]}function YY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[eZ[a],ST[a],n]}function JY(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:ZY(e);return[a,(s[0]===0?ST:ZJ)[s[1]]]}function ZY(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function eJ(e,t,r){e.l+=r&&r.biff==2?3:4}function tJ(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function rJ(e){return e.l++,Ul[e.read_shift(1)]}function nJ(e){return e.l++,e.read_shift(2)}function aJ(e){return e.l++,e.read_shift(1)!==0}function sJ(e){return e.l++,es(e)}function iJ(e,t,r){return e.l++,C0(e,t-1,r)}function oJ(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=jn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ul[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=es(e);break;case 2:r[1]=rA(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function lJ(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?tA:Mx)(e));return a}function cJ(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=oJ(e,r.biff);return o}function uJ(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function AJ(e,t,r){if(r.biff==5)return dJ(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function dJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function fJ(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function hJ(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function pJ(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function mJ(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var gJ=ss,xJ=ss,vJ=ss;function S0(e,t,r){return e.l+=2,[TY(e)]}function k_(e){return e.l+=6,[]}var yJ=S0,wJ=k_,bJ=k_,_J=S0;function CT(e){return e.l+=2,[Kn(e),e.read_shift(2)&1]}var NJ=S0,BJ=CT,CJ=k_,EJ=S0,SJ=S0,kJ=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jJ(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),o=kJ[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:s}}function FJ(e){return e.l+=2,[e.read_shift(4)]}function TJ(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function IJ(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function LJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function OJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function UJ(e){return e.l+=4,[0,0]}var sC={1:{n:"PtgExp",f:tJ},2:{n:"PtgTbl",f:vJ},3:{n:"PtgAdd",f:Hn},4:{n:"PtgSub",f:Hn},5:{n:"PtgMul",f:Hn},6:{n:"PtgDiv",f:Hn},7:{n:"PtgPower",f:Hn},8:{n:"PtgConcat",f:Hn},9:{n:"PtgLt",f:Hn},10:{n:"PtgLe",f:Hn},11:{n:"PtgEq",f:Hn},12:{n:"PtgGe",f:Hn},13:{n:"PtgGt",f:Hn},14:{n:"PtgNe",f:Hn},15:{n:"PtgIsect",f:Hn},16:{n:"PtgUnion",f:Hn},17:{n:"PtgRange",f:Hn},18:{n:"PtgUplus",f:Hn},19:{n:"PtgUminus",f:Hn},20:{n:"PtgPercent",f:Hn},21:{n:"PtgParen",f:Hn},22:{n:"PtgMissArg",f:Hn},23:{n:"PtgStr",f:iJ},26:{n:"PtgSheet",f:TJ},27:{n:"PtgEndSheet",f:IJ},28:{n:"PtgErr",f:rJ},29:{n:"PtgBool",f:aJ},30:{n:"PtgInt",f:nJ},31:{n:"PtgNum",f:sJ},32:{n:"PtgArray",f:QY},33:{n:"PtgFunc",f:YY},34:{n:"PtgFuncVar",f:JY},35:{n:"PtgName",f:uJ},36:{n:"PtgRef",f:WY},37:{n:"PtgArea",f:OY},38:{n:"PtgMemArea",f:fJ},39:{n:"PtgMemErr",f:gJ},40:{n:"PtgMemNoMem",f:xJ},41:{n:"PtgMemFunc",f:hJ},42:{n:"PtgRefErr",f:pJ},43:{n:"PtgAreaErr",f:PY},44:{n:"PtgRefN",f:zY},45:{n:"PtgAreaN",f:RY},46:{n:"PtgMemAreaN",f:LJ},47:{n:"PtgMemNoMemN",f:OJ},57:{n:"PtgNameX",f:AJ},58:{n:"PtgRef3d",f:XY},59:{n:"PtgArea3d",f:UY},60:{n:"PtgRefErr3d",f:mJ},61:{n:"PtgAreaErr3d",f:DY},255:{}},PJ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},DJ={1:{n:"PtgElfLel",f:CT},2:{n:"PtgElfRw",f:EJ},3:{n:"PtgElfCol",f:yJ},6:{n:"PtgElfRwV",f:SJ},7:{n:"PtgElfColV",f:_J},10:{n:"PtgElfRadical",f:NJ},11:{n:"PtgElfRadicalS",f:CJ},13:{n:"PtgElfColS",f:wJ},15:{n:"PtgElfColSV",f:bJ},16:{n:"PtgElfRadicalLel",f:BJ},25:{n:"PtgList",f:jJ},29:{n:"PtgSxName",f:FJ},255:{}},RJ={0:{n:"PtgAttrNoop",f:UJ},1:{n:"PtgAttrSemi",f:$Y},2:{n:"PtgAttrIf",f:qY},4:{n:"PtgAttrChoose",f:MY},8:{n:"PtgAttrGoto",f:HY},16:{n:"PtgAttrSum",f:eJ},32:{n:"PtgAttrBaxcel",f:aC},33:{n:"PtgAttrBaxcel",f:aC},64:{n:"PtgAttrSpace",f:VY},65:{n:"PtgAttrSpaceSemi",f:GY},128:{n:"PtgAttrIfError",f:KY},255:{}};function k0(e,t,r,n){if(n.biff<8)return ss(e,t);for(var a=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=cJ(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=lJ(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&s.push(ss(e,t)),s}function j0(e,t,r){for(var n=e.l+t,a,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],a=sC[s]||sC[PJ[s]],(s===24||s===25)&&(a=(s===24?DJ:RJ)[e[e.l+1]]),!a||!a.f?ss(e,t):o.push([a.n,a.f(e,t,r)]);return o}function QJ(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var MJ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function HJ(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ET(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function iC(e,t,r){var n=ET(e,t,r);return n=="#REF"?n:HJ(n,r)}function Xa(e,t,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,u,A,h=0,f=0,d,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",p=0,m=e[0].length;p<m;++p){var w=e[0][p];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=wn(" ",e[0][g][1][1]);break;case 1:y=wn("\r",e[0][g][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}l.push(u+MJ[w[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":A=mh(w[1][1],o,a),l.push(gh(A,s));break;case"PtgRefN":A=r?mh(w[1][1],r,a):w[1][1],l.push(gh(A,s));break;case"PtgRef3d":h=w[1][1],A=mh(w[1][2],o,a),v=iC(n,h,a),l.push(v+"!"+gh(A,s));break;case"PtgFunc":case"PtgFuncVar":var x=w[1][0],b=w[1][1];x||(x=0),x&=127;var B=x==0?[]:l.slice(-x);l.length-=x,b==="User"&&(b=B.shift()),l.push(b+"("+B.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":d=OB(w[1][1],r?{s:r}:o,a),l.push(Tv(d,a));break;case"PtgArea":d=OB(w[1][1],o,a),l.push(Tv(d,a));break;case"PtgArea3d":h=w[1][1],d=w[1][2],v=iC(n,h,a),l.push(v+"!"+Tv(d,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=w[1][2];var _=(n.names||[])[f-1]||(n[0]||[])[f],k=_?_.Name:"SH33TJSNAME"+String(f);k&&k.slice(0,6)=="_xlfn."&&!a.xlfn&&(k=k.slice(6)),l.push(k);break;case"PtgNameX":var E=w[1][1];f=w[1][2];var T;if(a.biff<=5)E<0&&(E=-E),n[E]&&(T=n[E][f]);else{var S="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][f]&&n[E][f].itab>0&&(S=n.SheetNames[n[E][f].itab-1]+"!"):S=n.SheetNames[f-1]+"!"),n[E]&&n[E][f])S+=n[E][f].Name;else if(n[0]&&n[0][f])S+=n[0][f].Name;else{var j=(ET(n,E,a)||"").split(";;");j[f-1]?S=j[f-1]:S+="SH33TJSERRX"}l.push(S);break}T||(T={Name:"SH33TJSERRY"}),l.push(T.Name);break;case"PtgParen":var I="(",U=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:I=wn(" ",e[0][g][1][1])+I;break;case 3:I=wn("\r",e[0][g][1][1])+I;break;case 4:U=wn(" ",e[0][g][1][1])+U;break;case 5:U=wn("\r",e[0][g][1][1])+U;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(I+l.pop()+U);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":A={c:w[1][1],r:w[1][0]};var q={c:r.c,r:r.r};if(n.sharedf[Vt(A)]){var V=n.sharedf[Vt(A)];l.push(Xa(V,o,q,n,a))}else{var X=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(A.c<u[0].s.c||A.c>u[0].e.c)&&!(A.r<u[0].s.r||A.r>u[0].e.r)){l.push(Xa(u[1],o,q,n,a)),X=!0;break}X||l.push(w[1])}break;case"PtgArray":l.push("{"+QJ(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=p;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var W=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&W.indexOf(e[0][p][0])==-1){w=e[0][g];var M=!0;switch(w[1][0]){case 4:M=!1;case 0:y=wn(" ",w[1][1]);break;case 5:M=!1;case 1:y=wn("\r",w[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((M?y:"")+l.pop()+(M?"":y)),g=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function qJ(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],ss(e,t-2)];var l=j0(e,o,r);return t!==o+a&&(s=k0(e,t-o-a,l,r)),e.l=n,[l,s]}function KJ(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],ss(e,t-2)];var l=j0(e,o,r);return t!==o+a&&(s=k0(e,t-o-a,l,r)),e.l=n,[l,s]}function $J(e,t,r,n){var a=e.l+t,s=j0(e,n,r),o;return a!==e.l&&(o=k0(e,a-e.l,s,r)),[s,o]}function VJ(e,t,r){var n=e.l+t,a,s=e.read_shift(2),o=j0(e,s,r);return s==65535?[[],ss(e,t-2)]:(t!==s+2&&(a=k0(e,n-s-2,o,r)),[o,a])}function GJ(e){var t;if(vl(e,e.l+6)!==65535)return[es(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function WJ(e){if(e==null){var t=Ze(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return qu(e);return qu(0)}function Pv(e,t,r){var n=e.l+t,a=qo(e);r.biff==2&&++e.l;var s=GJ(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=KJ(e,n-e.l,r);return{cell:a,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function zJ(e,t,r,n,a){var s=$u(t,r,a),o=WJ(e.v),l=Ze(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=Ze(e.bf.length),A=0;A<e.bf.length;++A)u[A]=e.bf[A];var h=ga([s,o,l,u]);return h}function Hx(e,t,r){var n=e.read_shift(4),a=j0(e,n,r),s=e.read_shift(4),o=s>0?k0(e,s,a,r):null;return[a,o]}var XJ=Hx,qx=Hx,YJ=Hx,JJ=Hx,ZJ={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ST={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},eZ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function oC(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function tZ(e){var t="of:="+e.replace(E_,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Dv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function rZ(e){return e.replace(/\./,"!")}var vh={},fd={},yh=typeof Map<"u";function j_(e,t,r){var n=0,a=e.length;if(r){if(yh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=yh?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(yh?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Kx(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Za=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=i0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Gg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Fu(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function $c(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){bl(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function kT(e,t,r,n,a,s){try{n.cellNF&&(e.z=Kt[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=tn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Kt[t]==null&&bl(Z$[t]||"General",t),e.t==="e")e.w=e.w||Ul[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zh(e.v);else if(e.t==="d"){var o=Aa(e.v);(o|0)===o?e.w=o.toString(10):e.w=Zh(o)}else{if(e.v===void 0)return"";e.w=Mu(e.v,fd)}else e.t==="d"?e.w=Oi(t,Aa(e.v),fd):e.w=Oi(t,e.v,fd)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Vg(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Vg(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function nZ(e,t,r){if(e&&e["!ref"]){var n=br(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function aZ(e,t){var r=br(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=rr(r))}var sZ=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,iZ=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,oZ=/<(?:\w:)?hyperlink [^>]*>/mg,lZ=/"(\w*:\w*)"/,cZ=/<(?:\w:)?col\b[^>]*[\/]?>/g,uZ=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,AZ=/<(?:\w:)?pageMargins[^>]*\/>/g,jT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,dZ=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,fZ=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function hZ(e,t,r,n,a,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",A="",h=e.match(iZ);h?(u=e.slice(0,h.index),A=e.slice(h.index+h[0].length)):u=A=e;var f=u.match(jT);f?F_(f[0],l,a,r):(f=u.match(dZ))&&mZ(f[0],f[1]||"",l,a,r);var d=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var v=u.slice(d,d+50).match(lZ);v&&aZ(l,v[1])}var g=u.match(fZ);g&&g[1]&&kZ(g[1],a);var y=[];if(t.cellStyles){var p=u.match(cZ);p&&NZ(y,p)}h&&TZ(h[1],l,t,c,s,o);var m=A.match(uZ);m&&(l["!autofilter"]=CZ(m[0]));var w=[],x=A.match(sZ);if(x)for(d=0;d!=x.length;++d)w[d]=br(x[d].slice(x[d].indexOf('"')+1));var b=A.match(oZ);b&&wZ(l,b,n);var B=A.match(AZ);if(B&&(l["!margins"]=bZ(Gt(B[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=rr(c)),t.sheetRows>0&&l["!ref"]){var _=br(l["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=rr(_))}return y.length>0&&(l["!cols"]=y),w.length>0&&(l["!merges"]=w),l}function pZ(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+rr(e[r])+'"/>';return t+"</mergeCells>"}function F_(e,t,r,n){var a=Gt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=wr(Pr(a.codeName)))}function mZ(e,t,r,n,a){F_(e.slice(0,e.indexOf(">")),r,n,a)}function gZ(e,t,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Io(Lr(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+pt("outlinePr",null,u)}!s&&!l||(a[a.length]=pt("sheetPr",l,o))}var xZ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vZ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yZ(e){var t={sheet:1};return xZ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),vZ.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=N_(e.password).toString(16).toUpperCase()),pt("sheetProtection",null,t)}function wZ(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Gt(Pr(t[a]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+wr(s.location))):(s.Target="#"+wr(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=br(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var A=Vt({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[A]||(e[A]={t:"z",v:void 0}),e[A].l=s)}}}function bZ(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function _Z(e){return Fu(e),pt("pageMargins",null,e)}function NZ(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Gt(t[n],!0);a.hidden&&(a.hidden=Jr(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,B_(a.width)),Ic(a);s<=o;)e[s++]=rn(a)}}function BZ(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=pt("col",null,Kx(a,n)));return r[r.length]="</cols>",r.join("")}function CZ(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function EZ(e,t,r,n){var a=typeof e.ref=="string"?e.ref:rr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Os(a);o.s.r==o.e.r&&(o.e.r=Os(t["!ref"]).e.r,a=rr(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),pt("autoFilter",null,{ref:a})}var SZ=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function kZ(e,t){t.Views||(t.Views=[{}]),(e.match(SZ)||[]).forEach(function(r,n){var a=Gt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Jr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function jZ(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),pt("sheetViews",pt("sheetView",null,a),{})}function FZ(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ul[e.v];break;case"d":n&&n.cellDates?a=tn(e.v,-1).toISOString():(e=rn(e),e.t="n",a=""+(e.v=Aa(tn(e.v)))),typeof e.z>"u"&&(e.z=Kt[14]);break;default:a=e.v;break}var l=La("v",Lr(a)),c={r:t},u=$c(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=La("v",""+j_(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var A=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=pt("f",Lr(e.f),A)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),pt("c",l,c)}var TZ=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=e0("v"),o=e0("f");return function(c,u,A,h,f,d){for(var v=0,g="",y=[],p=[],m=0,w=0,x=0,b="",B,_,k=0,E=0,T,S,j=0,I=0,U=Array.isArray(d.CellXf),q,V=[],X=[],W=Array.isArray(u),M=[],G={},H=!1,C=!!A.sheetStubs,L=c.split(t),O=0,D=L.length;O!=D;++O){g=L[O].trim();var P=g.length;if(P!==0){var Q=0;e:for(v=0;v<P;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(A&&A.cellStyles){if(_=Gt(g.slice(Q,v),!0),k=_.r!=null?parseInt(_.r,10):k+1,E=-1,A.sheetRows&&A.sheetRows<k)continue;G={},H=!1,_.ht&&(H=!0,G.hpt=parseFloat(_.ht),G.hpx=kd(G.hpt)),_.hidden=="1"&&(H=!0,G.hidden=!0),_.outlineLevel!=null&&(H=!0,G.level=+_.outlineLevel),H&&(M[k-1]=G)}break;case"<":Q=v;break}if(Q>=v)break;if(_=Gt(g.slice(Q,v),!0),k=_.r!=null?parseInt(_.r,10):k+1,E=-1,!(A.sheetRows&&A.sheetRows<k)){h.s.r>k-1&&(h.s.r=k-1),h.e.r<k-1&&(h.e.r=k-1),A&&A.cellStyles&&(G={},H=!1,_.ht&&(H=!0,G.hpt=parseFloat(_.ht),G.hpx=kd(G.hpt)),_.hidden=="1"&&(H=!0,G.hidden=!0),_.outlineLevel!=null&&(H=!0,G.level=+_.outlineLevel),H&&(M[k-1]=G)),y=g.slice(v).split(e);for(var J=0;J!=y.length&&y[J].trim().charAt(0)=="<";++J);for(y=y.slice(J),v=0;v!=y.length;++v)if(g=y[v].trim(),g.length!==0){if(p=g.match(r),m=v,w=0,x=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,p!=null&&p.length===2){for(m=0,b=p[1],w=0;w!=b.length&&!((x=b.charCodeAt(w)-64)<1||x>26);++w)m=26*m+x;--m,E=m}else++E;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,_=Gt(g.slice(0,w),!0),_.r||(_.r=Vt({r:k-1,c:E})),b=g.slice(w),B={t:""},(p=b.match(s))!=null&&p[1]!==""&&(B.v=wr(p[1])),A.cellFormula){if((p=b.match(o))!=null&&p[1]!==""){if(B.f=wr(Pr(p[1])).replace(/\r\n/g,`
`),A.xlfn||(B.f=nC(B.f)),p[0].indexOf('t="array"')>-1)B.F=(b.match(a)||[])[1],B.F.indexOf(":")>-1&&V.push([br(B.F),B.F]);else if(p[0].indexOf('t="shared"')>-1){S=Gt(p[0]);var te=wr(Pr(p[1]));A.xlfn||(te=nC(te)),X[parseInt(S.si,10)]=[S,te,_.r]}}else(p=b.match(/<f[^>]*\/>/))&&(S=Gt(p[0]),X[S.si]&&(B.f=SY(X[S.si][1],X[S.si][2],_.r)));var z=fn(_.r);for(w=0;w<V.length;++w)z.r>=V[w][0].s.r&&z.r<=V[w][0].e.r&&z.c>=V[w][0].s.c&&z.c<=V[w][0].e.c&&(B.F=V[w][1])}if(_.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(C)B.t="z";else continue;else B.t=_.t||"n";switch(h.s.c>E&&(h.s.c=E),h.e.c<E&&(h.e.c=E),B.t){case"n":if(B.v==""||B.v==null){if(!C)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!C)continue;B.t="z"}else T=vh[parseInt(B.v,10)],B.v=T.t,B.r=T.r,A.cellHTML&&(B.h=T.h);break;case"str":B.t="s",B.v=B.v!=null?Pr(B.v):"",A.cellHTML&&(B.h=c_(B.v));break;case"inlineStr":p=b.match(n),B.t="s",p!=null&&(T=__(p[1]))?(B.v=T.t,A.cellHTML&&(B.h=T.h)):B.v="";break;case"b":B.v=Jr(B.v);break;case"d":A.cellDates?B.v=tn(B.v,1):(B.v=Aa(tn(B.v,1)),B.t="n");break;case"e":(!A||A.cellText!==!1)&&(B.w=B.v),B.v=T6[B.v];break}if(j=I=0,q=null,U&&_.s!==void 0&&(q=d.CellXf[_.s],q!=null&&(q.numFmtId!=null&&(j=q.numFmtId),A.cellStyles&&q.fillId!=null&&(I=q.fillId))),kT(B,j,I,A,f,d),A.cellDates&&U&&B.t=="n"&&qd(Kt[j])&&(B.t="d",B.v=Qx(B.v)),_.cm&&A.xlmeta){var ye=(A.xlmeta.Cell||[])[+_.cm-1];ye&&ye.type=="XLDAPR"&&(B.D=!0)}if(W){var re=fn(_.r);u[re.r]||(u[re.r]=[]),u[re.r][re.c]=B}else u[_.r]=B}}}}M.length>0&&(u["!rows"]=M)}}();function IZ(e,t,r,n){var a=[],s=[],o=br(e["!ref"]),l="",c,u="",A=[],h=0,f=0,d=e["!rows"],v=Array.isArray(e),g={r:u},y,p=-1;for(f=o.s.c;f<=o.e.c;++f)A[f]=dn(f);for(h=o.s.r;h<=o.e.r;++h){for(s=[],u=Un(h),f=o.s.c;f<=o.e.c;++f){c=A[f]+u;var m=v?(e[h]||[])[f]:e[c];m!==void 0&&(l=FZ(m,c,e,t))!=null&&s.push(l)}(s.length>0||d&&d[h])&&(g={r:u},d&&d[h]&&(y=d[h],y.hidden&&(g.hidden=1),p=-1,y.hpx?p=o0(y.hpx):y.hpt&&(p=y.hpt),p>-1&&(g.ht=p,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),a[a.length]=pt("row",s.join(""),g))}if(d)for(;h<d.length;++h)d&&d[h]&&(g={r:h+1},y=d[h],y.hidden&&(g.hidden=1),p=-1,y.hpx?p=o0(y.hpx):y.hpt&&(p=y.hpt),p>-1&&(g.ht=p,g.customHeight=1),y.level&&(g.outlineLevel=y.level),a[a.length]=pt("row","",g));return a.join("")}function FT(e,t,r,n){var a=[Pn,pt("worksheet",null,{xmlns:Yu[0],"xmlns:r":ia.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",A=br(u);if(A.e.c>16383||A.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");A.e.c=Math.min(A.e.c,16383),A.e.r=Math.min(A.e.c,1048575),u=rr(A)}n||(n={}),c["!comments"]=[];var h=[];gZ(c,r,e,t,a),a[a.length]=pt("dimension",null,{ref:u}),a[a.length]=jZ(c,t,e,r),t.sheetFormat&&(a[a.length]=pt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=BZ(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=IZ(c,t),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=yZ(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=EZ(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=pZ(c["!merges"]));var f=-1,d,v=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(d={ref:g[0]},g[1].Target.charAt(0)!="#"&&(v=Tr(n,-1,Lr(g[1].Target).replace(/#.*$/,""),ur.HLINK),d["r:id"]="rId"+v),(f=g[1].Target.indexOf("#"))>-1&&(d.location=Lr(g[1].Target.slice(f+1))),g[1].Tooltip&&(d.tooltip=Lr(g[1].Tooltip)),a[a.length]=pt("hyperlink",null,d))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=_Z(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=La("ignoredErrors",pt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(v=Tr(n,-1,"../drawings/drawing"+(e+1)+".xml",ur.DRAW),a[a.length]=pt("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=h),c["!comments"].length>0&&(v=Tr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ur.VML),a[a.length]=pt("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function LZ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function OZ(e,t,r){var n=Ze(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=o0(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},A=0;A<16;++A)if(!(t.s.c>A+1<<10||t.e.c<A<<10)){for(var h=-1,f=-1,d=A<<10;d<A+1<<10;++d){u.c=d;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Vt(u)];v&&(h<0&&(h=d),f=d)}h<0||(++l,n.write_shift(4,h),n.write_shift(4,f))}var g=n.l;return n.l=c,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function UZ(e,t,r,n){var a=OZ(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&ot(e,0,a)}var PZ=tA,DZ=Vd;function RZ(){}function QZ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=qV(e),r}function MZ(e,t,r){r==null&&(r=Ze(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return qg({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),E6(e,r),r.slice(0,r.l)}function HZ(e){var t=Pi(e);return[t]}function qZ(e,t,r){return r==null&&(r=Ze(8)),Ju(t,r)}function KZ(e){var t=Zu(e);return[t]}function $Z(e,t,r){return r==null&&(r=Ze(4)),eA(t,r)}function VZ(e){var t=Pi(e),r=e.read_shift(1);return[t,r,"b"]}function GZ(e,t,r){return r==null&&(r=Ze(9)),Ju(t,r),r.write_shift(1,e.v?1:0),r}function WZ(e){var t=Zu(e),r=e.read_shift(1);return[t,r,"b"]}function zZ(e,t,r){return r==null&&(r=Ze(5)),eA(t,r),r.write_shift(1,e.v?1:0),r}function XZ(e){var t=Pi(e),r=e.read_shift(1);return[t,r,"e"]}function YZ(e,t,r){return r==null&&(r=Ze(9)),Ju(t,r),r.write_shift(1,e.v),r}function JZ(e){var t=Zu(e),r=e.read_shift(1);return[t,r,"e"]}function ZZ(e,t,r){return r==null&&(r=Ze(8)),eA(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function eee(e){var t=Pi(e),r=e.read_shift(4);return[t,r,"s"]}function tee(e,t,r){return r==null&&(r=Ze(12)),Ju(t,r),r.write_shift(4,t.v),r}function ree(e){var t=Zu(e),r=e.read_shift(4);return[t,r,"s"]}function nee(e,t,r){return r==null&&(r=Ze(8)),eA(t,r),r.write_shift(4,t.v),r}function aee(e){var t=Pi(e),r=es(e);return[t,r,"n"]}function see(e,t,r){return r==null&&(r=Ze(16)),Ju(t,r),qu(e.v,r),r}function TT(e){var t=Zu(e),r=es(e);return[t,r,"n"]}function iee(e,t,r){return r==null&&(r=Ze(12)),eA(t,r),qu(e.v,r),r}function oee(e){var t=Pi(e),r=x_(e);return[t,r,"n"]}function lee(e,t,r){return r==null&&(r=Ze(12)),Ju(t,r),S6(e.v,r),r}function cee(e){var t=Zu(e),r=x_(e);return[t,r,"n"]}function uee(e,t,r){return r==null&&(r=Ze(8)),eA(t,r),S6(e.v,r),r}function Aee(e){var t=Pi(e),r=p_(e);return[t,r,"is"]}function dee(e){var t=Pi(e),r=rs(e);return[t,r,"str"]}function fee(e,t,r){return r==null&&(r=Ze(12+4*e.v.length)),Ju(t,r),xa(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hee(e){var t=Zu(e),r=rs(e);return[t,r,"str"]}function pee(e,t,r){return r==null&&(r=Ze(8+4*e.v.length)),eA(t,r),xa(e.v,r),r.length>r.l?r.slice(0,r.l):r}function mee(e,t,r){var n=e.l+t,a=Pi(e);a.r=r["!row"];var s=e.read_shift(1),o=[a,s,"b"];if(r.cellFormula){e.l+=2;var l=qx(e,n-e.l,r);o[3]=Xa(l,null,a,r.supbooks,r)}else e.l=n;return o}function gee(e,t,r){var n=e.l+t,a=Pi(e);a.r=r["!row"];var s=e.read_shift(1),o=[a,s,"e"];if(r.cellFormula){e.l+=2;var l=qx(e,n-e.l,r);o[3]=Xa(l,null,a,r.supbooks,r)}else e.l=n;return o}function xee(e,t,r){var n=e.l+t,a=Pi(e);a.r=r["!row"];var s=es(e),o=[a,s,"n"];if(r.cellFormula){e.l+=2;var l=qx(e,n-e.l,r);o[3]=Xa(l,null,a,r.supbooks,r)}else e.l=n;return o}function vee(e,t,r){var n=e.l+t,a=Pi(e);a.r=r["!row"];var s=rs(e),o=[a,s,"str"];if(r.cellFormula){e.l+=2;var l=qx(e,n-e.l,r);o[3]=Xa(l,null,a,r.supbooks,r)}else e.l=n;return o}var yee=tA,wee=Vd;function bee(e,t){return t==null&&(t=Ze(4)),t.write_shift(4,e),t}function _ee(e,t){var r=e.l+t,n=tA(e),a=m_(e),s=rs(e),o=rs(e),l=rs(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function Nee(e,t){var r=Ze(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Vd({s:fn(e[0]),e:fn(e[0])},r),g_("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return xa(a||"",r),xa(e[1].Tooltip||"",r),xa("",r),r.slice(0,r.l)}function Bee(){}function Cee(e,t,r){var n=e.l+t,a=k6(e),s=e.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=XJ(e,n-e.l,r);o[1]=l}else e.l=n;return o}function Eee(e,t,r){var n=e.l+t,a=tA(e),s=[a];if(r.cellFormula){var o=JJ(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function See(e,t,r){r==null&&(r=Ze(18));var n=Kx(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var IT=["left","right","top","bottom","header","footer"];function kee(e){var t={};return IT.forEach(function(r){t[r]=es(e)}),t}function jee(e,t){return t==null&&(t=Ze(6*8)),Fu(e),IT.forEach(function(r){qu(e[r],t)}),t}function Fee(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Tee(e,t,r){r==null&&(r=Ze(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Iee(e){var t=Ze(24);return t.write_shift(4,4),t.write_shift(4,1),Vd(e,t),t}function Lee(e,t){return t==null&&(t=Ze(16*4+2)),t.write_shift(2,e.password?N_(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Oee(){}function Uee(){}function Pee(e,t,r,n,a,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,f=!1,d,v,g,y,p,m,w,x,b,B=[];l.biff=12,l["!row"]=0;var _=0,k=!1,E=[],T={},S=l.supbooks||a.supbooks||[[]];if(S.sharedf=T,S.arrayf=E,S.SheetNames=a.SheetNames||a.Sheets.map(function(W){return W.name}),!l.supbooks&&(l.supbooks=S,a.Names))for(var j=0;j<a.Names.length;++j)S[0][j+1]=a.Names[j];var I=[],U=[],q=!1;l0[16]={n:"BrtShortReal",f:TT};var V;if(Ol(e,function(M,G,H){if(!f)switch(H){case 148:u=M;break;case 0:d=M,l.sheetRows&&l.sheetRows<=d.r&&(f=!0),x=Un(y=d.r),l["!row"]=d.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=kd(M.hpt)),U[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:M[2]},M[2]){case"n":v.v=M[1];break;case"s":w=vh[M[1]],v.v=w.t,v.r=w.r;break;case"b":v.v=!!M[1];break;case"e":v.v=M[1],l.cellText!==!1&&(v.w=Ul[v.v]);break;case"str":v.t="s",v.v=M[1];break;case"is":v.t="s",v.v=M[1].t;break}if((g=o.CellXf[M[0].iStyleRef])&&kT(v,g.numFmtId,null,l,s,o),p=M[0].c==-1?p+1:M[0].c,l.dense?(c[y]||(c[y]=[]),c[y][p]=v):c[dn(p)+x]=v,l.cellFormula){for(k=!1,_=0;_<E.length;++_){var C=E[_];d.r>=C[0].s.r&&d.r<=C[0].e.r&&p>=C[0].s.c&&p<=C[0].e.c&&(v.F=rr(C[0]),k=!0)}!k&&M.length>3&&(v.f=M[3])}if(A.s.r>d.r&&(A.s.r=d.r),A.s.c>p&&(A.s.c=p),A.e.r<d.r&&(A.e.r=d.r),A.e.c<p&&(A.e.c=p),l.cellDates&&g&&v.t=="n"&&qd(Kt[g.numFmtId])){var L=Nu(v.v);L&&(v.t="d",v.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}V&&(V.type=="XLDAPR"&&(v.D=!0),V=void 0);break;case 1:case 12:if(!l.sheetStubs||h)break;v={t:"z",v:void 0},p=M[0].c==-1?p+1:M[0].c,l.dense?(c[y]||(c[y]=[]),c[y][p]=v):c[dn(p)+x]=v,A.s.r>d.r&&(A.s.r=d.r),A.s.c>p&&(A.s.c=p),A.e.r<d.r&&(A.e.r=d.r),A.e.c<p&&(A.e.c=p),V&&(V.type=="XLDAPR"&&(v.D=!0),V=void 0);break;case 176:B.push(M);break;case 49:V=((l.xlmeta||{}).Cell||[])[M-1];break;case 494:var O=n["!id"][M.relId];for(O?(M.Target=O.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=O):M.relId==""&&(M.Target="#"+M.loc),y=M.rfx.s.r;y<=M.rfx.e.r;++y)for(p=M.rfx.s.c;p<=M.rfx.e.c;++p)l.dense?(c[y]||(c[y]=[]),c[y][p]||(c[y][p]={t:"z",v:void 0}),c[y][p].l=M):(m=Vt({c:p,r:y}),c[m]||(c[m]={t:"z",v:void 0}),c[m].l=M);break;case 426:if(!l.cellFormula)break;E.push(M),b=l.dense?c[y][p]:c[dn(p)+x],b.f=Xa(M[1],A,{r:d.r,c:p},S,l),b.F=rr(M[0]);break;case 427:if(!l.cellFormula)break;T[Vt(M[0].s)]=M[1],b=l.dense?c[y][p]:c[dn(p)+x],b.f=Xa(M[1],A,{r:d.r,c:p},S,l);break;case 60:if(!l.cellStyles)break;for(;M.e>=M.s;)I[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},q||(q=!0,B_(M.w/256)),Ic(I[M.e+1]);break;case 161:c["!autofilter"]={ref:rr(M)};break;case 476:c["!margins"]=M;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),M.name&&(a.Sheets[r].CodeName=M.name),(M.above||M.left)&&(c["!outline"]={above:M.above,left:M.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),M.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!G.T){if(!h||l.WTF)throw new Error("Unexpected record 0x"+H.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(A.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=rr(u||A)),l.sheetRows&&c["!ref"]){var X=br(c["!ref"]);l.sheetRows<=+X.e.r&&(X.e.r=l.sheetRows-1,X.e.r>A.e.r&&(X.e.r=A.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>A.e.c&&(X.e.c=A.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),c["!fullref"]=c["!ref"],c["!ref"]=rr(X))}return B.length>0&&(c["!merges"]=B),I.length>0&&(c["!cols"]=I),U.length>0&&(c["!rows"]=U),c}function Dee(e,t,r,n,a,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=rn(t),t.z=t.z||Kt[14],t.v=Aa(tn(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=$c(a.cellXfs,t,a),t.l&&s["!links"].push([Vt(c),t.l]),t.c&&s["!comments"].push([Vt(c),t.c]),t.t){case"s":case"str":return a.bookSST?(l=j_(a.Strings,t.v,a.revStrings),c.t="s",c.v=l,o?ot(e,18,nee(t,c)):ot(e,7,tee(t,c))):(c.t="str",o?ot(e,17,pee(t,c)):ot(e,6,fee(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ot(e,13,uee(t,c)):ot(e,2,lee(t,c)):o?ot(e,16,iee(t,c)):ot(e,5,see(t,c)),!0;case"b":return c.t="b",o?ot(e,15,zZ(t,c)):ot(e,4,GZ(t,c)),!0;case"e":return c.t="e",o?ot(e,14,ZZ(t,c)):ot(e,3,YZ(t,c)),!0}return o?ot(e,12,$Z(t,c)):ot(e,1,qZ(t,c)),!0}function Ree(e,t,r,n){var a=br(t["!ref"]||"A1"),s,o="",l=[];ot(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var A=a.s.r;A<=u;++A){o=Un(A),UZ(e,t,a,A);var h=!1;if(A<=a.e.r)for(var f=a.s.c;f<=a.e.c;++f){A===a.s.r&&(l[f]=dn(f)),s=l[f]+o;var d=c?(t[A]||[])[f]:t[s];if(!d){h=!1;continue}h=Dee(e,d,A,f,n,t,h)}}ot(e,146)}function Qee(e,t){!t||!t["!merges"]||(ot(e,177,bee(t["!merges"].length)),t["!merges"].forEach(function(r){ot(e,176,wee(r))}),ot(e,178))}function Mee(e,t){!t||!t["!cols"]||(ot(e,390),t["!cols"].forEach(function(r,n){r&&ot(e,60,See(n,r))}),ot(e,391))}function Hee(e,t){!t||!t["!ref"]||(ot(e,648),ot(e,649,Iee(br(t["!ref"]))),ot(e,650))}function qee(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Tr(r,-1,n[1].Target.replace(/#.*$/,""),ur.HLINK);ot(e,494,Nee(n,a))}}),delete t["!links"]}function Kee(e,t,r,n){if(t["!comments"].length>0){var a=Tr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ur.VML);ot(e,551,g_("rId"+a)),t["!legacy"]=a}}function $ee(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:rr(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Os(s);l.s.r==l.e.r&&(l.e.r=Os(t["!ref"]).e.r,s=rr(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ot(e,161,Vd(br(s))),ot(e,162)}}function Vee(e,t,r){ot(e,133),ot(e,137,Tee(t,r)),ot(e,138),ot(e,134)}function Gee(e,t){t["!protect"]&&ot(e,535,Lee(t["!protect"]))}function Wee(e,t,r,n){var a=Is(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=br(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ot(a,129),(r.vbaraw||o["!outline"])&&ot(a,147,MZ(l,o["!outline"])),ot(a,148,DZ(c)),Vee(a,o,r.Workbook),Mee(a,o),Ree(a,o,e,t),Gee(a,o),$ee(a,o,r,e),Qee(a,o),qee(a,o,n),o["!margins"]&&ot(a,476,jee(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Hee(a,o),Kee(a,o,e,n),ot(a,130),a.end()}function zee(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=wr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function Xee(e,t,r,n,a,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,u="A",A={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var f=zee(h);A.s.r=A.s.c=0,A.e.c=l,u=dn(l),f[0].forEach(function(d,v){o[u+Un(v)]={t:"n",v:d,z:f[1]},c=v}),A.e.r<c&&(A.e.r=c),++l}),l>0&&(o["!ref"]=rr(A)),o}function Yee(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(jT);return l&&F_(l[0],s,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Jee(e,t){e.l+=10;var r=rs(e);return{name:r}}function Zee(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ol(e,function(c,u,A){switch(A){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var T_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ete=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tte=[],rte=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function lC(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Jr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function cC(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Jr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function LT(e){cC(e.WBProps,T_),cC(e.CalcPr,rte),lC(e.WBView,ete),lC(e.Sheets,tte),fd.date1904=Jr(e.WBProps.date1904)}function nte(e){return!e.Workbook||!e.Workbook.WBProps?"false":Jr(e.Workbook.WBProps.date1904)?"true":"false"}var ate="][*?/\\".split("");function OT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return ate.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function ste(e,t,r){e.forEach(function(n,a){OT(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[a]&&t[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function ite(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];ste(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)nZ(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var ote=/<\w+:workbook/;function lte(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(e.replace(is,function(c,u){var A=Gt(c);switch(Ho(A[0])){case"<?xml":break;case"<workbook":c.match(ote)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=A[a];break;case"</workbook>":break;case"<fileVersion":delete A[0],r.AppVersion=A;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":T_.forEach(function(h){if(A[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Jr(A[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(A[h[0]],10);break;default:r.WBProps[h[0]]=A[h[0]]}}),A.codeName&&(r.WBProps.CodeName=Pr(A.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete A[0],r.WBView.push(A);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(A.state){case"hidden":A.Hidden=1;break;case"veryHidden":A.Hidden=2;break;default:A.Hidden=0}delete A.state,A.name=wr(Pr(A.name)),delete A[0],r.Sheets.push(A);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Pr(A.name),A.comment&&(s.Comment=A.comment),A.localSheetId&&(s.Sheet=+A.localSheetId),Jr(A.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=wr(Pr(e.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete A[0],r.CalcPr=A;break;case"<calcPr/>":delete A[0],r.CalcPr=A;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+A[0]+" in workbook")}return c}),Yu.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return LT(r),r}function UT(e){var t=[Pn];t[t.length]=pt("workbook",null,{xmlns:Yu[0],"xmlns:r":ia.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(T_.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=pt("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Lr(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=pt("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=pt("definedName",Lr(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function cte(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=e2(e),r.name=rs(e),r}function ute(e,t){return t||(t=Ze(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),g_(e.strRelID,t),xa(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Ate(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?rs(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function dte(e,t){t||(t=Ze(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),E6(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function fte(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function hte(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=KV(e),o=YJ(e,0,r),l=m_(e);e.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function pte(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],l0[16]={n:"BrtFRTArchID$",f:fte},Ol(e,function(c,u,A){switch(A){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Xa(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([A,c]):o[0]=[A,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(A),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(A),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+A.toString(16))}}},t),LT(r),r.Names=s,r.supbooks=o,r}function mte(e,t){ot(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ot(e,156,ute(a))}ot(e,144)}function gte(e,t){t||(t=Ze(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return xa("SheetJS",t),xa(Ug.version,t),xa(Ug.version,t),xa("7262",t),t.length>t.l?t.slice(0,t.l):t}function xte(e,t){t||(t=Ze(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function vte(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(ot(e,135),ot(e,158,xte(a)),ot(e,136))}}function yte(e,t){var r=Is();return ot(r,131),ot(r,128,gte()),ot(r,153,dte(e.Workbook&&e.Workbook.WBProps||null)),vte(r,e),mte(r,e),ot(r,132),r.end()}function wte(e,t,r){return t.slice(-4)===".bin"?pte(e,r):lte(e,r)}function bte(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?Pee(e,n,r,a,s,o,l):hZ(e,n,r,a,s,o,l)}function _te(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?Zee(e,n,r,a,s):Yee(e,n,r,a,s)}function Nte(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?CY():EY()}function Bte(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?NY():BY()}function Cte(e,t,r,n){return t.slice(-4)===".bin"?wX(e,r,n):cX(e,r,n)}function Ete(e,t,r){return mT(e,r)}function Ste(e,t,r){return t.slice(-4)===".bin"?Sz(e,r):Bz(e,r)}function kte(e,t,r){return t.slice(-4)===".bin"?vY(e,r):uY(e,r)}function jte(e,t,r){return t.slice(-4)===".bin"?oY(e):sY(e)}function Fte(e,t,r,n){return r.slice(-4)===".bin"?lY(e,t,r,n):void 0}function Tte(e,t,r){return t.slice(-4)===".bin"?rY(e,t,r):aY(e,t,r)}function Ite(e,t,r){return(t.slice(-4)===".bin"?yte:UT)(e)}function Lte(e,t,r,n,a){return(t.slice(-4)===".bin"?Wee:FT)(e,r,n,a)}function Ote(e,t,r){return(t.slice(-4)===".bin"?FX:hT)(e,r)}function Ute(e,t,r){return(t.slice(-4)===".bin"?Fz:iT)(e,r)}function Pte(e,t,r){return(t.slice(-4)===".bin"?yY:vT)(e)}function Dte(e){return(e.slice(-4)===".bin"?nY:gT)()}var PT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,DT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function $i(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(PT),s,o,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(DT),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function Rte(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(PT),a,s,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(DT),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),r[o]=a[2].slice(1,a[2].length-1));return r}var wh;function Qte(e,t){var r=wh[e]||wr(e);return r==="General"?Mu(t):Oi(r,t)}function Mte(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Jr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=tn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[wr(t)]=a}function Hte(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ul[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zh(e.v):e.w=Mu(e.v):e.w=Qte(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=wh[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&qd(n)){var a=Nu(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function qte(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=tX[n.Pattern]||n.Pattern)}e[t.ID]=t}function Kte(e,t,r,n,a,s,o,l,c,u){var A="General",h=n.StyleID,f={};u=u||{};var d=[],v=0;for(h===void 0&&l&&(h=l.StyleID),h===void 0&&o&&(h=o.StyleID);s[h]!==void 0&&(s[h].nf&&(A=s[h].nf),s[h].Interior&&d.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Jr(e);break;case"String":n.t="s",n.r=CB(wr(e)),n.v=e.indexOf("<")>-1?wr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(tn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=wr(e):n.v<60&&(n.v=n.v-1),(!A||A=="General")&&(A="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=T6[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=CB(t||e));break}if(Hte(n,A,u),u.cellFormula!==!1)if(n.Formula){var g=wr(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=dd(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=dd("RC:RC",a):n.ArrayRange&&(n.F=dd(n.ArrayRange,a),c.push([br(n.F),n.F]))}else for(v=0;v<c.length;++v)a.r>=c[v][0].s.r&&a.r<=c[v][0].e.r&&a.c>=c[v][0].s.c&&a.c<=c[v][0].e.c&&(n.F=c[v][1]);u.cellStyles&&(d.forEach(function(y){!f.patternType&&y.patternType&&(f.patternType=y.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function $te(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Rv(e,t){var r=t||{};Kd();var n=Wf(u_(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Pr(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=rn(r);return o.type="string",Sd.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(pe){a.indexOf("<"+pe)>=0&&(s=!0)}),s)return jre(n,r);wh={"General Number":"General","General Date":Kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Kt[15],"Short Date":Kt[14],"Long Time":Kt[19],"Medium Time":Kt[18],"Short Time":Kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Kt[2],Standard:Kt[4],Percent:Kt[10],Scientific:Kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,A={},h=[],f=r.dense?[]:{},d="",v={},g={},y=$i('<Data ss:Type="String">'),p=0,m=0,w=0,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},B={},_="",k=0,E=[],T={},S={},j=0,I=[],U=[],q={},V=[],X,W=!1,M=[],G=[],H={},C=0,L=0,O={Sheets:[],WBProps:{date1904:!1}},D={};r0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var P="";l=r0.exec(n);)switch(l[3]=(P=l[3]).toLowerCase()){case"data":if(P=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Kte(n.slice(p,l.index),_,y,c[c.length-1][0]=="comment"?q:v,{c:m,r:w},b,V[m],g,M,r):(_="",y=$i(l[0]),p=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(U.length>0&&(v.c=U),(!r.sheetRows||r.sheetRows>w)&&v.v!==void 0&&(r.dense?(f[w]||(f[w]=[]),f[w][m]=v):f[dn(m)+Un(w)]=v),v.HRef&&(v.l={Target:wr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(C=m+(parseInt(v.MergeAcross,10)|0),L=w+(parseInt(v.MergeDown,10)|0),E.push({s:{c:m,r:w},e:{c:C,r:L}})),!r.sheetStubs)v.MergeAcross?m=C+1:++m;else if(v.MergeAcross||v.MergeDown){for(var Q=m;Q<=C;++Q)for(var J=w;J<=L;++J)(Q>m||J>w)&&(r.dense?(f[J]||(f[J]=[]),f[J][Q]={t:"z"}):f[dn(Q)+Un(J)]={t:"z"});m=C+1}else++m;else v=Rte(l[0]),v.Index&&(m=+v.Index-1),m<x.s.c&&(x.s.c=m),m>x.e.c&&(x.e.c=m),l[0].slice(-2)==="/>"&&++m,U=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<x.s.r&&(x.s.r=w),w>x.e.r&&(x.e.r=w),l[0].slice(-2)==="/>"&&(g=$i(l[0]),g.Index&&(w=+g.Index-1)),m=0,++w):(g=$i(l[0]),g.Index&&(w=+g.Index-1),H={},(g.AutoFitHeight=="0"||g.Height)&&(H.hpx=parseInt(g.Height,10),H.hpt=o0(H.hpx),G[w]=H),g.Hidden=="1"&&(H.hidden=!0,G[w]=H));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));h.push(d),x.s.r<=x.e.r&&x.s.c<=x.e.c&&(f["!ref"]=rr(x),r.sheetRows&&r.sheetRows<=x.e.r&&(f["!fullref"]=f["!ref"],x.e.r=r.sheetRows-1,f["!ref"]=rr(x))),E.length&&(f["!merges"]=E),V.length>0&&(f["!cols"]=V),G.length>0&&(f["!rows"]=G),A[d]=f}else x={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=m=0,c.push([l[3],!1]),u=$i(l[0]),d=wr(u.Name),f=r.dense?[]:{},E=[],M=[],G=[],D={name:d,Hidden:0},O.Sheets.push(D);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),V=[],W=!1}break;case"style":l[1]==="/"?qte(b,B,r):B=$i(l[0]);break;case"numberformat":B.nf=wr($i(l[0]).Format||"General"),wh[B.nf]&&(B.nf=wh[B.nf]);for(var te=0;te!=392&&Kt[te]!=B.nf;++te);if(te==392){for(te=57;te!=392;++te)if(Kt[te]==null){bl(B.nf,te);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(X=$i(l[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!W&&X.wpx>10){W=!0,Za=dT;for(var z=0;z<V.length;++z)V[z]&&Ic(V[z])}W&&Ic(X),V[X.Index-1||V.length]=X;for(var ye=0;ye<+X.Span;++ye)V[V.length]=rn(X);break;case"namedrange":if(l[1]==="/")break;O.Names||(O.Names=[]);var re=Gt(l[0]),ke={Name:re.Name,Ref:dd(re.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(ke.Sheet=O.Sheets.length-1),O.Names.push(ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_+=n.slice(k,l.index):k=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=$i(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?pG(T,P,n.slice(j,l.index)):j=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));$te(q),U.push(q)}else c.push([l[3],!1]),u=$i(l[0]),q={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var be=$i(l[0]);f["!autofilter"]={ref:dd(be.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return hC(n,r);var ae=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ae=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ae=!1}break;case"excelworkbook":switch(l[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ae=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:ae=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(j,l.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else j=l.index+l[0].length;break;case"header":f["!margins"]||Fu(f["!margins"]={},"xlml"),isNaN(+Gt(l[0]).Margin)||(f["!margins"].header=+Gt(l[0]).Margin);break;case"footer":f["!margins"]||Fu(f["!margins"]={},"xlml"),isNaN(+Gt(l[0]).Margin)||(f["!margins"].footer=+Gt(l[0]).Margin);break;case"pagemargins":var Ie=Gt(l[0]);f["!margins"]||Fu(f["!margins"]={},"xlml"),isNaN(+Ie.Top)||(f["!margins"].top=+Ie.Top),isNaN(+Ie.Left)||(f["!margins"].left=+Ie.Left),isNaN(+Ie.Right)||(f["!margins"].right=+Ie.Right),isNaN(+Ie.Bottom)||(f["!margins"].bottom=+Ie.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ae=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ae=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ae=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ae=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ae=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ae=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ae=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ae=!1}break;case"smarttags":break;default:ae=!1;break}if(ae||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Mte(S,P,I,n.slice(j,l.index)):(I=l,j=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=A),De.SheetNames=h,De.Workbook=O,De.SSF=rn(Kt),De.Props=T,De.Custprops=S,De}function o2(e,t){switch(L_(t=t||{}),t.type||"base64"){case"base64":return Rv(oi(e),t);case"binary":case"buffer":case"file":return Rv(e,t);case"array":return Rv(qc(e),t)}}function Vte(e,t){var r=[];return e.Props&&r.push(mG(e.Props,t)),e.Custprops&&r.push(gG(e.Props,e.Custprops)),r.join("")}function Gte(){return""}function Wte(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(pt("NumberFormat",null,{"ss:Format":Lr(Kt[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(pt("Style",s.join(""),o))}),pt("Styles",r.join(""))}function RT(e){return pt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+S_(e.Ref,{r:0,c:0})})}function zte(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(RT(a)))}return pt("Names",r.join(""))}function Xte(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(RT(l)))}return s.join("")}function Yte(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(pt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(pt("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(pt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(pt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(La("ProtectContents","True")),e["!protect"].objects&&a.push(La("ProtectObjects","True")),e["!protect"].scenarios&&a.push(La("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(La("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(La("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":pt("WorksheetOptions",a.join(""),{xmlns:zs.x})}function Jte(e){return e.map(function(t){var r=vV(t.t||""),n=pt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return pt("Comment",n,{"ss:Author":t.a})}).join("")}function Zte(e,t,r,n,a,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Lr(S_(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=fn(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Lr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Lr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],A=0;A!=u.length;++A)u[A].s.c!=o.c||u[A].s.r!=o.r||(u[A].e.c>u[A].s.c&&(l["ss:MergeAcross"]=u[A].e.c-u[A].s.c),u[A].e.r>u[A].s.r&&(l["ss:MergeDown"]=u[A].e.r-u[A].s.r));var h="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=Ul[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Kt[14]);break;case"s":h="String",f=xV(e.v||"");break}var d=$c(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+d),l["ss:Index"]=o.c+1;var v=e.v!=null?f:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(e.c||[]).length>0&&(g+=Jte(e.c)),pt("Cell",g,l)}function ere(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=kd(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function tre(e,t,r,n){if(!e["!ref"])return"";var a=br(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,p){Ic(y);var m=!!y.width,w=Kx(p,y),x={"ss:Index":p+1};m&&(x["ss:Width"]=s0(w.width)),y.hidden&&(x["ss:Hidden"]="1"),l.push(pt("Column",null,x))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var A=[ere(u,(e["!rows"]||[])[u])],h=a.s.c;h<=a.e.c;++h){var f=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>u)&&!(s[o].e.c<h)&&!(s[o].e.r<u)){(s[o].s.c!=h||s[o].s.r!=u)&&(f=!0);break}if(!f){var d={r:u,c:h},v=Vt(d),g=c?(e[u]||[])[h]:e[v];A.push(Zte(g,v,e,t,r,n,d))}}A.push("</Row>"),A.length>2&&l.push(A.join(""))}return l.join("")}function rre(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],o=s?Xte(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?tre(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Yte(s,t,e,r)),n.join("")}function nre(e,t){t||(t={}),e.SSF||(e.SSF=rn(Kt)),e.SSF&&(Kd(),Px(e.SSF),t.revssf=Rx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],$c(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Vte(e,t)),r.push(Gte()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(pt("Worksheet",rre(n,t,e),{"ss:Name":Lr(e.SheetNames[n])}));return r[2]=Wte(e,t),r[3]=zte(e),Pn+pt("Workbook",r.join(""),{xmlns:zs.ss,"xmlns:o":zs.o,"xmlns:x":zs.x,"xmlns:ss":zs.ss,"xmlns:dt":zs.dt,"xmlns:html":zs.html})}function are(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=zV(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=XV(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var sre=[60,1084,2066,2165,2175];function ire(e,t,r,n,a){var s=n,o=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=s;for(var c=vl(r,r.l),u=l2[c],A=0;u!=null&&sre.indexOf(c)>-1;)s=vl(r,r.l+2),A=r.l+4,c==2066?A+=4:(c==2165||c==2175)&&(A+=12),l=r.slice(A,r.l+4+s),o.push(l),r.l+=4+s,u=l2[c=vl(r,r.l)];var h=ga(o);Ia(h,0);var f=0;h.lens=[];for(var d=0;d<o.length;++d)h.lens.push(f),f+=o[d].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function No(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Kt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ul[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zh(e.v):e.w=Mu(e.v):e.w=Oi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&qd(Kt[n]||String(n))){var a=Nu(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function zp(e,t,r){return{v:e,ixfe:t,t:r}}function ore(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},o={},l=null,c=[],u="",A={},h,f="",d,v,g,y,p={},m=[],w,x,b=[],B=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},E=function(Qe){return Qe<8?Su[Qe]:Qe<64&&B[Qe-8]||Su[Qe]},T=function(Qe,Ye,Nt){var xt=Ye.XF.data;if(!(!xt||!xt.patternType||!Nt||!Nt.cellStyles)){Ye.s={},Ye.s.patternType=xt.patternType;var it;(it=a0(E(xt.icvFore)))&&(Ye.s.fgColor={rgb:it}),(it=a0(E(xt.icvBack)))&&(Ye.s.bgColor={rgb:it})}},S=function(Qe,Ye,Nt){if(!(H>1)&&!(Nt.sheetRows&&Qe.r>=Nt.sheetRows)){if(Nt.cellStyles&&Ye.XF&&Ye.XF.data&&T(Qe,Ye,Nt),delete Ye.ixfe,delete Ye.XF,h=Qe,f=Vt(Qe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<o.s.r&&(o.s.r=Qe.r),Qe.c<o.s.c&&(o.s.c=Qe.c),Qe.r+1>o.e.r&&(o.e.r=Qe.r+1),Qe.c+1>o.e.c&&(o.e.c=Qe.c+1),Nt.cellFormula&&Ye.f){for(var xt=0;xt<m.length;++xt)if(!(m[xt][0].s.c>Qe.c||m[xt][0].s.r>Qe.r)&&!(m[xt][0].e.c<Qe.c||m[xt][0].e.r<Qe.r)){Ye.F=rr(m[xt][0]),(m[xt][0].s.c!=Qe.c||m[xt][0].s.r!=Qe.r)&&delete Ye.f,Ye.f&&(Ye.f=""+Xa(m[xt][1],o,Qe,M,j));break}}Nt.dense?(a[Qe.r]||(a[Qe.r]=[]),a[Qe.r][Qe.c]=Ye):a[f]=Ye}},j={enc:!1,sbcch:0,snames:[],sharedf:p,arrayf:m,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(j.password=t.password);var I,U=[],q=[],V=[],X=[],W=!1,M=[];M.SheetNames=j.snames,M.sharedf=j.sharedf,M.arrayf=j.arrayf,M.names=[],M.XTI=[];var G=0,H=0,C=0,L=[],O=[],D;j.codepage=1200,ro(1200);for(var P=!1;e.l<e.length-1;){var Q=e.l,J=e.read_shift(2);if(J===0&&G===10)break;var te=e.l===e.length?0:e.read_shift(2),z=l2[J];if(z&&z.f){if(t.bookSheets&&G===133&&J!==133)break;if(G=J,z.r===2||z.r==12){var ye=e.read_shift(2);if(te-=2,!j.enc&&ye!==J&&((ye&255)<<8|ye>>8)!==J)throw new Error("rt mismatch: "+ye+"!="+J);z.r==12&&(e.l+=10,te-=10)}var re={};if(J===10?re=z.f(e,te,j):re=ire(J,z,e,te,j),H==0&&[9,521,1033,2057].indexOf(G)===-1)continue;switch(J){case 34:r.opts.Date1904=_.WBProps.date1904=re;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(e.l=0),j.enc=re,!t.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=re;break;case 66:var ke=Number(re);switch(ke){case 21010:ke=1200;break;case 32768:ke=1e4;break;case 32769:ke=1252;break}ro(j.codepage=ke),P=!0;break;case 317:j.rrtabid=re;break;case 25:j.winlocked=re;break;case 439:r.opts.RefreshAll=re;break;case 12:r.opts.CalcCount=re;break;case 16:r.opts.CalcDelta=re;break;case 17:r.opts.CalcIter=re;break;case 13:r.opts.CalcMode=re;break;case 14:r.opts.CalcPrecision=re;break;case 95:r.opts.CalcSaveRecalc=re;break;case 15:j.CalcRefMode=re;break;case 2211:r.opts.FullCalc=re;break;case 129:re.fDialog&&(a["!type"]="dialog"),re.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),re.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:b.push(re);break;case 430:M.push([re]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(re);break;case 24:case 536:D={Name:re.Name,Ref:Xa(re.rgce,o,null,M,j)},re.itab>0&&(D.Sheet=re.itab-1),M.names.push(D),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(O[re.itab-1]={ref:rr(re.rgce[0][0][1][2])});break;case 22:j.ExternCount=re;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(re),M.XTI=M.XTI.concat(re);break;case 2196:if(j.biff<8)break;D!=null&&(D.Comment=re[1]);break;case 18:a["!protect"]=re;break;case 19:re!==0&&j.WTF&&console.error("Password verifier: "+re);break;case 133:s[re.pos]=re,j.snames.push(re.name);break;case 10:{if(--H)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=rr(o),t.sheetRows&&t.sheetRows<=o.e.r){var be=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=rr(o),o.e.r=be}o.e.r++,o.e.c++}U.length>0&&(a["!merges"]=U),q.length>0&&(a["!objects"]=q),V.length>0&&(a["!cols"]=V),X.length>0&&(a["!rows"]=X),_.Sheets.push(k)}u===""?A=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),j.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(j.biff=5,P=!0,ro(j.codepage=28591)),j.biff==8&&re.BIFFVer==0&&re.dt==16&&(j.biff=2),H++)break;if(a=t.dense?[]:{},j.biff<8&&!P&&(P=!0,ro(j.codepage=t.codepage||1252)),j.biff<5||re.BIFFVer==0&&re.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ae={pos:e.l-te,name:u};s[ae.pos]=ae,j.snames.push(u)}else u=(s[Q]||{name:""}).name;re.dt==32&&(a["!type"]="chart"),re.dt==64&&(a["!type"]="macro"),U=[],q=[],j.arrayf=m=[],V=[],X=[],W=!1,k={Hidden:(s[Q]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[re.r]||[])[re.c]:a[Vt({c:re.c,r:re.r})])&&++re.c,w={ixfe:re.ixfe,XF:b[re.ixfe]||{},v:re.val,t:"n"},C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S({c:re.c,r:re.r},w,t);break;case 5:case 517:w={ixfe:re.ixfe,XF:b[re.ixfe],v:re.val,t:re.t},C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S({c:re.c,r:re.r},w,t);break;case 638:w={ixfe:re.ixfe,XF:b[re.ixfe],v:re.rknum,t:"n"},C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S({c:re.c,r:re.r},w,t);break;case 189:for(var Ie=re.c;Ie<=re.C;++Ie){var De=re.rkrec[Ie-re.c][0];w={ixfe:De,XF:b[De],v:re.rkrec[Ie-re.c][1],t:"n"},C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S({c:Ie,r:re.r},w,t)}break;case 6:case 518:case 1030:{if(re.val=="String"){l=re;break}if(w=zp(re.val,re.cell.ixfe,re.tt),w.XF=b[w.ixfe],t.cellFormula){var pe=re.formula;if(pe&&pe[0]&&pe[0][0]&&pe[0][0][0]=="PtgExp"){var we=pe[0][0][1][0],Te=pe[0][0][1][1],he=Vt({r:we,c:Te});p[he]?w.f=""+Xa(re.formula,o,re.cell,M,j):w.F=((t.dense?(a[we]||[])[Te]:a[he])||{}).F}else w.f=""+Xa(re.formula,o,re.cell,M,j)}C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S(re.cell,w,t),l=re}break;case 7:case 519:if(l)l.val=re,w=zp(re,l.cell.ixfe,"s"),w.XF=b[w.ixfe],t.cellFormula&&(w.f=""+Xa(l.formula,o,l.cell,M,j)),C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{m.push(re);var ce=Vt(re[0].s);if(d=t.dense?(a[re[0].s.r]||[])[re[0].s.c]:a[ce],t.cellFormula&&d){if(!l||!ce||!d)break;d.f=""+Xa(re[1],o,re[0],M,j),d.F=rr(re[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!l)break;p[Vt(l.cell)]=re[0],d=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[Vt(l.cell)],(d||{}).f=""+Xa(re[0],o,h,M,j)}}break;case 253:w=zp(c[re.isst].t,re.ixfe,"s"),c[re.isst].h&&(w.h=c[re.isst].h),w.XF=b[w.ixfe],C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S({c:re.c,r:re.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:re.ixfe,XF:b[re.ixfe],t:"z"},C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S({c:re.c,r:re.r},w,t));break;case 190:if(t.sheetStubs)for(var Se=re.c;Se<=re.C;++Se){var Pe=re.ixfe[Se-re.c];w={ixfe:Pe,XF:b[Pe],t:"z"},C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S({c:Se,r:re.r},w,t)}break;case 214:case 516:case 4:w=zp(re.val,re.ixfe,"s"),w.XF=b[w.ixfe],C>0&&(w.z=L[w.ixfe>>8&63]),No(w,t,r.opts.Date1904),S({c:re.c,r:re.r},w,t);break;case 0:case 512:H===1&&(o=re);break;case 252:c=re;break;case 1054:if(j.biff==4){L[C++]=re[1];for(var Le=0;Le<C+163&&Kt[Le]!=re[1];++Le);Le>=163&&bl(re[1],C+163)}else bl(re[1],re[0]);break;case 30:{L[C++]=re;for(var Xe=0;Xe<C+163&&Kt[Xe]!=re;++Xe);Xe>=163&&bl(re,C+163)}break;case 229:U=U.concat(re);break;case 93:q[re.cmo[0]]=j.lastobj=re;break;case 438:j.lastobj.TxO=re;break;case 127:j.lastobj.ImData=re;break;case 440:for(y=re[0].s.r;y<=re[0].e.r;++y)for(g=re[0].s.c;g<=re[0].e.c;++g)d=t.dense?(a[y]||[])[g]:a[Vt({c:g,r:y})],d&&(d.l=re[1]);break;case 2048:for(y=re[0].s.r;y<=re[0].e.r;++y)for(g=re[0].s.c;g<=re[0].e.c;++g)d=t.dense?(a[y]||[])[g]:a[Vt({c:g,r:y})],d&&d.l&&(d.l.Tooltip=re[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;d=t.dense?(a[re[0].r]||[])[re[0].c]:a[Vt(re[0])];var fe=q[re[2]];d||(t.dense?(a[re[0].r]||(a[re[0].r]=[]),d=a[re[0].r][re[0].c]={t:"z"}):d=a[Vt(re[0])]={t:"z"},o.e.r=Math.max(o.e.r,re[0].r),o.s.r=Math.min(o.s.r,re[0].r),o.e.c=Math.max(o.e.c,re[0].c),o.s.c=Math.min(o.s.c,re[0].c)),d.c||(d.c=[]),v={a:re[1],t:fe.TxO.t},d.c.push(v)}break;case 2173:WX(b[re.ixfe],re.ext);break;case 125:{if(!j.cellStyles)break;for(;re.e>=re.s;)V[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},W||(W=!0,B_(re.w/256)),Ic(V[re.e+1])}break;case 520:{var Ee={};re.level!=null&&(X[re.r]=Ee,Ee.level=re.level),re.hidden&&(X[re.r]=Ee,Ee.hidden=!0),re.hpt&&(X[re.r]=Ee,Ee.hpt=re.hpt,Ee.hpx=kd(re.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Fu(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=re;break;case 161:a["!margins"]||Fu(a["!margins"]={}),a["!margins"].header=re.header,a["!margins"].footer=re.footer;break;case 574:re.RTL&&(_.Views[0].RTL=!0);break;case 146:B=re;break;case 2198:I=re;break;case 140:x=re;break;case 442:u?k.CodeName=re||k.name:_.WBProps.CodeName=re||"ThisWorkbook";break}}else z||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=te}return r.SheetNames=_n(s).sort(function(qe,Qe){return Number(qe)-Number(Qe)}).map(function(qe){return s[qe].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&A["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=A)):r.Preamble=A,r.Sheets&&O.forEach(function(qe,Qe){r.Sheets[r.SheetNames[Qe]]["!autofilter"]=qe}),r.Strings=c,r.SSF=rn(Kt),j.enc&&(r.Encryption=j.enc),I&&(r.Themes=I),r.Metadata={},x!==void 0&&(r.Metadata.Country=x),M.names.length>0&&(_.Names=M.names),r.Workbook=_,r}var bh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lre(e,t,r){var n=Qt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=KB(n,t2,bh.DSI);for(var s in a)t[s]=a[s]}catch(u){if(r.WTF)throw u}var o=Qt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=KB(o,r2,bh.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(D6(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function cre(e,t){var r=[],n=[],a=[],s=0,o,l=yB(t2,"n"),c=yB(r2,"n");if(e.Props)for(o=_n(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=_n(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<a.length;++s)$6.indexOf(a[s][0])>-1||P6.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&Qt.utils.cfb_add(t,"/SummaryInformation",$B(n,bh.SI,c,r2)),(r.length||u.length)&&Qt.utils.cfb_add(t,"/DocumentSummaryInformation",$B(r,bh.DSI,l,t2,u.length?u:null,bh.UDI))}function QT(e,t){t||(t={}),L_(t),t_(),t.codepage&&e_(t.codepage);var r,n;if(e.FullPaths){if(Qt.find(e,"/encryption"))throw new Error("File is password-protected");r=Qt.find(e,"!CompObj"),n=Qt.find(e,"/Workbook")||Qt.find(e,"/Book")}else{switch(t.type){case"base64":e=Zs(oi(e));break;case"binary":e=Zs(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ia(e,0),n={content:e}}var a,s;if(r&&are(r),t.bookProps&&!t.bookSheets)a={};else{var o=cr?"buffer":"array";if(n&&n.content)a=ore(n.content,t);else if((s=Qt.find(e,"PerfectOffice_MAIN"))&&s.content)a=ju.to_workbook(s.content,(t.type=o,t));else if((s=Qt.find(e,"NativeContent_MAIN"))&&s.content)a=ju.to_workbook(s.content,(t.type=o,t));else throw(s=Qt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Qt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=bY(e))}var l={};return e.FullPaths&&lre(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}function ure(e,t){var r=t||{},n=Qt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qt.utils.cfb_add(n,a,MT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&cre(e,n),r.biff==8&&e.vbaraw&&_Y(n,Qt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var l0={0:{f:LZ},1:{f:HZ},2:{f:oee},3:{f:XZ},4:{f:VZ},5:{f:aee},6:{f:dee},7:{f:eee},8:{f:vee},9:{f:xee},10:{f:mee},11:{f:gee},12:{f:KZ},13:{f:cee},14:{f:JZ},15:{f:WZ},16:{f:TT},17:{f:hee},18:{f:ree},19:{f:p_},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:hte},40:{},42:{},43:{f:dX},44:{f:uX},45:{f:pX},46:{f:gX},47:{f:mX},48:{},49:{f:PV},50:{},51:{f:YX},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rT},62:{f:Aee},63:{f:iY},64:{f:Oee},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ss,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Fee},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:QZ},148:{f:PZ,p:16},151:{f:Bee},152:{},153:{f:Ate},154:{},155:{},156:{f:cte},157:{},158:{},159:{T:1,f:Ez},160:{T:-1},161:{T:1,f:tA},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yee},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:zX},336:{T:-1},337:{f:eY,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:e2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Cee},427:{f:Eee},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:kee},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:RZ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_ee},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:e2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:gY},633:{T:1},634:{T:-1},635:{T:1,f:pY},636:{T:-1},637:{f:MV},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Jee},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Uee},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},l2={6:{f:Pv},10:{f:ec},12:{f:Kn},13:{f:Kn},14:{f:jn},15:{f:jn},16:{f:es},17:{f:jn},18:{f:jn},19:{f:Kn},20:{f:YB},21:{f:YB},23:{f:tT},24:{f:ZB},25:{f:jn},26:{},27:{},28:{f:UW},29:{},34:{f:jn},35:{f:JB},38:{f:es},39:{f:es},40:{f:es},41:{f:es},42:{f:jn},43:{f:jn},47:{f:Wz},49:{f:cW},51:{f:Kn},60:{},61:{f:aW},64:{f:jn},65:{f:lW},66:{f:Kn},77:{},80:{},81:{},82:{},85:{f:Kn},89:{},90:{},91:{},92:{f:GG},93:{f:RW},94:{},95:{f:jn},96:{},97:{},99:{f:jn},125:{f:rT},128:{f:NW},129:{f:zG},130:{f:Kn},131:{f:jn},132:{f:jn},133:{f:XG},134:{},140:{f:GW},141:{f:Kn},144:{},146:{f:XW},151:{},152:{},153:{},154:{},155:{},156:{f:Kn},157:{},158:{},160:{f:nz},161:{f:ZW},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:yW},190:{f:wW},193:{f:ec},197:{},198:{},199:{},200:{},201:{},202:{f:jn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Kn},220:{},221:{f:jn},222:{},224:{f:_W},225:{f:VG},226:{f:ec},227:{},229:{f:PW},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:JG},253:{f:AW},255:{f:eW},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:V6},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:jn},353:{f:ec},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:kW},431:{f:jn},432:{},433:{},434:{},437:{},438:{f:HW},439:{f:jn},440:{f:qW},441:{},442:{f:E0},443:{},444:{f:Kn},445:{},446:{},448:{f:ec},449:{f:nW,r:2},450:{f:ec},512:{f:WB},513:{f:rz},515:{f:EW},516:{f:fW},517:{f:XB},519:{f:az},520:{f:tW},523:{},545:{f:eC},549:{f:GB},566:{},574:{f:iW},638:{f:vW},659:{},1048:{},1054:{f:pW},1084:{},1212:{f:IW},2048:{f:$W},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Vp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ec},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:YW,r:12},2173:{f:GX,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:jn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:TW,r:12},2197:{},2198:{f:MX,r:12},2199:{},2200:{},2201:{},2202:{f:LW,r:12},2203:{f:ec},2204:{},2205:{},2206:{},2207:{},2211:{f:rW},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Kn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ez},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:zW},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:WB},1:{},2:{f:cz},3:{f:oz},4:{f:iz},5:{f:XB},7:{f:Az},8:{},9:{f:Vp},11:{},22:{f:Kn},30:{f:gW},31:{},32:{},33:{f:eC},36:{},37:{f:GB},50:{f:dz},62:{},52:{},67:{},68:{f:Kn},69:{},86:{},126:{},127:{f:sz},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:fz},223:{},234:{},354:{},421:{},518:{f:Pv},521:{f:Vp},536:{f:ZB},547:{f:JB},561:{},579:{},1030:{f:Pv},1033:{f:Vp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function gt(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&d_(r)&&e.push(r)}}function Are(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return gt(e,t,r,a);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var A=e.next(4);for(A.write_shift(2,s),A.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(A=e.next(4),A.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;A.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function F0(e,t,r){return e||(e=Ze(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function dre(e,t,r,n){var a=Ze(9);return F0(a,e,t),G6(r,n||"b",a),a}function fre(e,t,r){var n=Ze(8+2*r.length);return F0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function hre(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Aa(tn(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?gt(e,2,uz(r,n,a)):gt(e,3,lz(r,n,a));return;case"b":case"e":gt(e,5,dre(r,n,t.v,t.t));return;case"s":case"str":gt(e,4,fre(r,n,(t.v||"").slice(0,255)));return}gt(e,1,F0(null,r,n))}function pre(e,t,r,n){var a=Array.isArray(t),s=br(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=rr(s)}for(var u=s.s.r;u<=s.e.r;++u){l=Un(u);for(var A=s.s.c;A<=s.e.c;++A){u===s.s.r&&(c[A]=dn(A)),o=c[A]+l;var h=a?(t[u]||[])[A]:t[o];h&&hre(e,h,u,A)}}}function mre(e,t){for(var r=t||{},n=Is(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return gt(n,r.biff==4?1033:r.biff==3?521:9,b_(e,16,r)),pre(n,e.Sheets[e.SheetNames[a]],a,r),gt(n,10),n.end()}function gre(e,t,r){gt(e,49,uW({sz:12,name:"Arial"},r))}function xre(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&gt(e,1054,mW(a,t[a],r))})}function vre(e,t){var r=Ze(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),gt(e,2151,r),r=Ze(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),J6(br(t["!ref"]||"A1"),r),r.write_shift(4,4),gt(e,2152,r)}function yre(e,t){for(var r=0;r<16;++r)gt(e,224,zB({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){gt(e,224,zB(n,0,t))})}function wre(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];gt(e,440,KW(n)),n[1].Tooltip&&gt(e,2048,VW(n))}delete t["!links"]}function bre(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&gt(e,125,JW(Kx(a,n),a))})}}function _re(e,t,r,n,a){var s=16+$c(a.cellXfs,t,a);if(t.v==null&&!t.bf){gt(e,513,$u(r,n,s));return}if(t.bf)gt(e,6,zJ(t,r,n,a,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Aa(tn(t.v)):t.v;gt(e,515,SW(r,n,o,s));break;case"b":case"e":gt(e,517,CW(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var l=j_(a.Strings,t.v,a.revStrings);gt(e,253,dW(r,n,l,s))}else gt(e,516,hW(r,n,(t.v||"").slice(0,255),s,a));break;default:gt(e,513,$u(r,n,s))}}function Nre(e,t,r){var n=Is(),a=r.SheetNames[e],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,A,h="",f=[],d=br(s["!ref"]||"A1"),v=u?65536:16384;if(d.e.c>255||d.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,v-1)}gt(n,2057,b_(r,16,t)),gt(n,13,wi(1)),gt(n,12,wi(100)),gt(n,15,ms(!0)),gt(n,17,ms(!1)),gt(n,16,qu(.001)),gt(n,95,ms(!0)),gt(n,42,ms(!1)),gt(n,43,ms(!1)),gt(n,130,wi(1)),gt(n,128,BW()),gt(n,131,ms(!1)),gt(n,132,ms(!1)),u&&bre(n,s["!cols"]),gt(n,512,xW(d,t)),u&&(s["!links"]=[]);for(var g=d.s.r;g<=d.e.r;++g){h=Un(g);for(var y=d.s.c;y<=d.e.c;++y){g===d.s.r&&(f[y]=dn(y)),A=f[y]+h;var p=c?(s[g]||[])[y]:s[A];p&&(_re(n,p,g,y,t),u&&p.l&&s["!links"].push([A,p.l]))}}var m=l.CodeName||l.name||a;return u&&gt(n,574,oW((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&gt(n,229,DW(s["!merges"])),u&&wre(n,s),gt(n,442,W6(m)),u&&vre(n,s),gt(n,10),n.end()}function Bre(e,t,r){var n=Is(),a=(e||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(gt(n,2057,b_(e,5,r)),r.bookType=="xla"&&gt(n,135),gt(n,225,l?wi(1200):null),gt(n,193,CG(2)),c&&gt(n,191),c&&gt(n,192),gt(n,226),gt(n,92,WG("SheetJS",r)),gt(n,66,wi(l?1200:1252)),l&&gt(n,353,wi(0)),l&&gt(n,448),gt(n,317,tz(e.SheetNames.length)),l&&e.vbaraw&&gt(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";gt(n,442,W6(u))}gt(n,156,wi(17)),gt(n,25,ms(!1)),gt(n,18,ms(!1)),gt(n,19,wi(0)),l&&gt(n,431,ms(!1)),l&&gt(n,444,wi(0)),gt(n,61,sW()),gt(n,64,ms(!1)),gt(n,141,wi(0)),gt(n,34,ms(nte(e)=="true")),gt(n,14,ms(!0)),l&&gt(n,439,ms(!1)),gt(n,218,wi(0)),gre(n,e,r),xre(n,e.SSF,r),yre(n,r),l&&gt(n,352,ms(!1));var A=n.end(),h=Is();l&&gt(h,140,WW()),l&&r.Strings&&Are(h,252,ZG(r.Strings)),gt(h,10);var f=h.end(),d=Is(),v=0,g=0;for(g=0;g<e.SheetNames.length;++g)v+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var y=A.length+v+f.length;for(g=0;g<e.SheetNames.length;++g){var p=s[g]||{};gt(d,133,YG({pos:y,hs:p.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var m=d.end();if(v!=m.length)throw new Error("BS8 "+v+" != "+m.length);var w=[];return A.length&&w.push(A),m.length&&w.push(m),f.length&&w.push(f),ga(w)}function Cre(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=rn(Kt)),e&&e.SSF&&(Kd(),Px(e.SSF),r.revssf=Rx(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,O_(r),r.cellXfs=[],$c(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Nre(a,r,e);return n.unshift(Bre(e,n,r)),ga(n)}function MT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Os(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return Cre(e,t);case 4:case 3:case 2:return mre(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function uC(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=a.index,l=s&&s.index||e.length,c=uV(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,A=0,h=0,f=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<c.length;++o){var g=c[o].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}A=0;continue}if(!(y!="<td"&&y!="<th")){var p=g.split(/<\/t[dh]>/i);for(l=0;l<p.length;++l){var m=p[l].trim();if(m.match(/<t[dh]/i)){for(var w=m,x=0;w.charAt(0)=="<"&&(x=w.indexOf(">"))>-1;)w=w.slice(x+1);for(var b=0;b<v.length;++b){var B=v[b];B.s.c==A&&B.s.r<u&&u<=B.e.r&&(A=B.e.c+1,b=-1)}var _=Gt(m.slice(0,m.indexOf(">")));f=_.colspan?+_.colspan:1,((h=+_.rowspan)>1||f>1)&&v.push({s:{r:u,c:A},e:{r:u+(h||1)-1,c:A+f-1}});var k=_.t||_["data-t"]||"";if(!w.length){A+=f;continue}if(w=A6(w),d.s.r>u&&(d.s.r=u),d.e.r<u&&(d.e.r=u),d.s.c>A&&(d.s.c=A),d.e.c<A&&(d.e.c=A),!w.length){A+=f;continue}var E={t:"s",v:w};r.raw||!w.trim().length||k=="s"||(w==="TRUE"?E={t:"b",v:!0}:w==="FALSE"?E={t:"b",v:!1}:isNaN(oo(w))?isNaN(Ed(w).getDate())||(E={t:"d",v:tn(w)},r.cellDates||(E={t:"n",v:Aa(E.v)}),E.z=r.dateNF||Kt[14]):E={t:"n",v:oo(w)}),r.dense?(n[u]||(n[u]=[]),n[u][A]=E):n[Vt({r:u,c:A})]=E,A+=f}}}}return n["!ref"]=rr(d),v.length&&(n["!merges"]=v),n}function Ere(e,t,r,n){for(var a=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>o)&&!(a[u].e.r<r||a[u].e.c<o)){if(a[u].s.r<r||a[u].s.c<o){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var A=Vt({r,c:o}),h=n.dense?(e[r]||[])[o]:e[A],f=h&&h.v!=null&&(h.h||c_(h.w||(jl(h),h.w)||""))||"",d={};l>1&&(d.rowspan=l),c>1&&(d.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(n.id||"sjs")+"-"+A,s.push(pt("td",f,d))}}var v="<tr>";return v+s.join("")+"</tr>"}var Sre='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',kre="</body></html>";function jre(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Kc(uC(r[0],t),t);var n=D_();return r.forEach(function(a,s){R_(n,uC(a,t),"Sheet"+(s+1))}),n}function Fre(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function HT(e,t){var r=t||{},n=r.header!=null?r.header:Sre,a=r.footer!=null?r.footer:kre,s=[n],o=Os(e["!ref"]);r.dense=Array.isArray(e),s.push(Fre(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(Ere(e,o,l,r));return s.push("</table>"+a),s.join("")}function qT(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?fn(n.origin):n.origin;a=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var A=Os(e["!ref"]);u.s.r=Math.min(u.s.r,A.s.r),u.s.c=Math.min(u.s.c,A.s.c),u.e.r=Math.max(u.e.r,A.e.r),u.e.c=Math.max(u.e.c,A.e.c),a==-1&&(u.e.r=a=A.e.r+1)}var h=[],f=0,d=e["!rows"]||(e["!rows"]=[]),v=0,g=0,y=0,p=0,m=0,w=0;for(e["!cols"]||(e["!cols"]=[]);v<l.length&&g<c;++v){var x=l[v];if(AC(x)){if(n.display)continue;d[g]={hidden:!0}}var b=x.children;for(y=p=0;y<b.length;++y){var B=b[y];if(!(n.display&&AC(B))){var _=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):A6(B.innerHTML),k=B.getAttribute("data-z")||B.getAttribute("z");for(f=0;f<h.length;++f){var E=h[f];E.s.c==p+s&&E.s.r<g+a&&g+a<=E.e.r&&(p=E.e.c+1-s,f=-1)}w=+B.getAttribute("colspan")||1,((m=+B.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:g+a,c:p+s},e:{r:g+a+(m||1)-1,c:p+s+(w||1)-1}});var T={t:"s",v:_},S=B.getAttribute("data-t")||B.getAttribute("t")||"";_!=null&&(_.length==0?T.t=S||"z":n.raw||_.trim().length==0||S=="s"||(_==="TRUE"?T={t:"b",v:!0}:_==="FALSE"?T={t:"b",v:!1}:isNaN(oo(_))?isNaN(Ed(_).getDate())||(T={t:"d",v:tn(_)},n.cellDates||(T={t:"n",v:Aa(T.v)}),T.z=n.dateNF||Kt[14]):T={t:"n",v:oo(_)})),T.z===void 0&&k!=null&&(T.z=k);var j="",I=B.getElementsByTagName("A");if(I&&I.length)for(var U=0;U<I.length&&!(I[U].hasAttribute("href")&&(j=I[U].getAttribute("href"),j.charAt(0)!="#"));++U);j&&j.charAt(0)!="#"&&(T.l={Target:j}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][p+s]=T):e[Vt({c:p+s,r:g+a})]=T,u.e.c<p+s&&(u.e.c=p+s),p+=w}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=rr(u),g>=c&&(e["!fullref"]=rr((u.e.r=l.length-v+g-1+a,u))),e}function KT(e,t){var r=t||{},n=r.dense?[]:{};return qT(n,e,t)}function Tre(e,t){return Kc(KT(e,t),t)}function AC(e){var t="",r=Ire(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Ire(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Lre(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=wr(t.replace(/<[^>]*>/g,""));return[r]}var dC={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function $T(e,t){var r=t||{},n=u_(e),a=[],s,o,l={name:""},c="",u=0,A,h,f={},d=[],v=r.dense?[]:{},g,y,p={value:""},m="",w=0,x=[],b=-1,B=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,E={},T=[],S={},j=0,I=0,U=[],q=1,V=1,X=[],W={Names:[]},M={},G=["",""],H=[],C={},L="",O=0,D=!1,P=!1,Q=0;for(r0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=r0.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?v["!ref"]=rr(_):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(v["!fullref"]=v["!ref"],_.e.r=r.sheetRows-1,v["!ref"]=rr(_)),T.length&&(v["!merges"]=T),U.length&&(v["!rows"]=U),A.name=A.||A.name,typeof JSON<"u"&&JSON.stringify(A),d.push(A.name),f[A.name]=v,P=!1):g[0].charAt(g[0].length-2)!=="/"&&(A=Gt(g[0],!1),b=B=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,v=r.dense?[]:{},T=[],U=[],P=!0);break;case"table-row-group":g[1]==="/"?--k:++k;break;case"table-row":case"":if(g[1]==="/"){b+=q,q=1;break}if(h=Gt(g[0],!1),h.?b=h.-1:b==-1&&(b=0),q=+h["number-rows-repeated"]||1,q<10)for(Q=0;Q<q;++Q)k>0&&(U[b+Q]={level:k});B=-1;break;case"covered-table-cell":g[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(v[b]||(v[b]=[]),v[b][B]={t:"z"}):v[Vt({r:b,c:B})]={t:"z"}),m="",x=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++B,p=Gt(g[0],!1),V=parseInt(p["number-columns-repeated"]||"1",10),y={t:"z",v:null},p.formula&&r.cellFormula!=!1&&(y.f=oC(wr(p.formula))),(p.||p["value-type"])=="string"&&(y.t="s",y.v=wr(p["string-value"]||""),r.dense?(v[b]||(v[b]=[]),v[b][B]=y):v[Vt({r:b,c:B})]=y),B+=V-1;else if(g[1]!=="/"){++B,m="",w=0,x=[],V=1;var J=q?b+q-1:b;if(B>_.e.c&&(_.e.c=B),B<_.s.c&&(_.s.c=B),b<_.s.r&&(_.s.r=b),J>_.e.r&&(_.e.r=J),p=Gt(g[0],!1),H=[],C={},y={t:p.||p["value-type"],v:null},r.cellFormula)if(p.formula&&(p.formula=wr(p.formula)),p["number-matrix-columns-spanned"]&&p["number-matrix-rows-spanned"]&&(j=parseInt(p["number-matrix-rows-spanned"],10)||0,I=parseInt(p["number-matrix-columns-spanned"],10)||0,S={s:{r:b,c:B},e:{r:b+j-1,c:B+I-1}},y.F=rr(S),X.push([S,y.F])),p.formula)y.f=oC(p.formula);else for(Q=0;Q<X.length;++Q)b>=X[Q][0].s.r&&b<=X[Q][0].e.r&&B>=X[Q][0].s.c&&B<=X[Q][0].e.c&&(y.F=X[Q][1]);switch((p["number-columns-spanned"]||p["number-rows-spanned"])&&(j=parseInt(p["number-rows-spanned"],10)||0,I=parseInt(p["number-columns-spanned"],10)||0,S={s:{r:b,c:B},e:{r:b+j-1,c:B+I-1}},T.push(S)),p["number-columns-repeated"]&&(V=parseInt(p["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Jr(p["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(p.value);break;case"percentage":y.t="n",y.v=parseFloat(p.value);break;case"currency":y.t="n",y.v=parseFloat(p.value);break;case"date":y.t="d",y.v=tn(p["date-value"]),r.cellDates||(y.t="n",y.v=Aa(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=oV(p["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Qx(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(p.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",p["string-value"]!=null&&(m=wr(p["string-value"]),x=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(D=!1,y.t==="s"&&(y.v=m||"",x.length&&(y.R=x),D=w==0),M.Target&&(y.l=M),H.length>0&&(y.c=H,H=[]),m&&r.cellText!==!1&&(y.w=m),D&&(y.t="z",delete y.v),(!D||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var te=0;te<q;++te){if(V=parseInt(p["number-columns-repeated"]||"1",10),r.dense)for(v[b+te]||(v[b+te]=[]),v[b+te][B]=te==0?y:rn(y);--V>0;)v[b+te][B+V]=rn(y);else for(v[Vt({r:b+te,c:B})]=y;--V>0;)v[Vt({r:b+te,c:B+V})]=rn(y);_.e.c<=B&&(_.e.c=B)}V=parseInt(p["number-columns-repeated"]||"1",10),B+=V-1,V=0,y={},m="",x=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s;C.t=m,x.length&&(C.R=x),C.a=L,H.push(C)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);L="",O=0,m="",w=0,x=[];break;case"creator":g[1]==="/"?L=n.slice(O,g.index):O=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);m="",w=0,x=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(E[l.name]=c,(s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(c="",l=Gt(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Gt(g[0],!1),c+=dC[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Gt(g[0],!1),c+=dC[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":o=Gt(g[0],!1),G=Dv(o["cell-range-address"]);var z={Name:o.name,Ref:G[0]+"!"+G[1]};P&&(z.Sheet=d.length),W.Names.push(z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!p||!p["string-value"])){var ye=Lre(n.slice(w,g.index));m=(m.length>0?m+`
`:"")+ye[0]}else Gt(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{G=Dv(Gt(g[0])["target-range-address"]),f[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(M=Gt(g[0],!1),!M.href)break;M.Target=wr(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(G=Dv(M.Target.slice(1)),M.Target="#"+G[0]+"!"+G[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var re={Sheets:f,SheetNames:d,Workbook:W};return r.bookSheets&&delete re.Sheets,re}function fC(e,t){t=t||{},vi(e,"META-INF/manifest.xml")&&oG(qn(e,"META-INF/manifest.xml"),t);var r=ei(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=$T(Pr(r),t);return vi(e,"meta.xml")&&(n.Props=O6(qn(e,"meta.xml"))),n}function hC(e,t){return $T(e,t)}var Ore=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+t0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Pn+t}}(),pC=function(){var e=function(s){return Lr(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+Lr(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,A=0,h=Os(s["!ref"]||"A1"),f=s["!merges"]||[],d=0,v=Array.isArray(s);if(s["!cols"])for(A=0;A<=h.e.c;++A)c.push("        <table:table-column"+(s["!cols"][A]?' table:style-name="co'+s["!cols"][A].ods+'"':"")+`></table:table-column>
`);var g="",y=s["!rows"]||[];for(u=0;u<h.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=h.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),A=0;A<h.s.c;++A)c.push(t);for(;A<=h.e.c;++A){var p=!1,m={},w="";for(d=0;d!=f.length;++d)if(!(f[d].s.c>A)&&!(f[d].s.r>u)&&!(f[d].e.c<A)&&!(f[d].e.r<u)){(f[d].s.c!=A||f[d].s.r!=u)&&(p=!0),m["table:number-columns-spanned"]=f[d].e.c-f[d].s.c+1,m["table:number-rows-spanned"]=f[d].e.r-f[d].s.r+1;break}if(p){c.push(r);continue}var x=Vt({r:u,c:A}),b=v?(s[u]||[])[A]:s[x];if(b&&b.f&&(m["table:formula"]=Lr(tZ(b.f)),b.F&&b.F.slice(0,x.length)==x)){var B=Os(b.F);m["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,m["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!b){c.push(t);continue}switch(b.t){case"b":w=b.v?"TRUE":"FALSE",m["office:value-type"]="boolean",m["office:boolean-value"]=b.v?"true":"false";break;case"n":w=b.w||String(b.v||0),m["office:value-type"]="float",m["office:value"]=b.v||0;break;case"s":case"str":w=b.v==null?"":b.v,m["office:value-type"]="string";break;case"d":w=b.w||tn(b.v).toISOString(),m["office:value-type"]="date",m["office:date-value"]=tn(b.v).toISOString(),m["table:style-name"]="ce1";break;default:c.push(t);continue}var _=e(w);if(b.l&&b.l.Target){var k=b.l.Target;k=k.charAt(0)=="#"?"#"+rZ(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),_=pt("text:a",_,{"xlink:href":k.replace(/&/g,"&amp;")})}c.push("          "+pt("table:table-cell",pt("text:p",_,{}),m)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var A=0;A<u["!cols"].length;++A)if(u["!cols"][A]){var h=u["!cols"][A];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Ic(h),h.ods=l;var f=u["!cols"][A].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var A=0;A<u["!rows"].length;++A)if(u["!rows"][A]){u["!rows"][A].ods=c;var h=u["!rows"][A].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Pn],u=t0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),A=t0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+A+`>
`),c.push(L6().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)c.push(n(o.Sheets[o.SheetNames[h]],o,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function VT(e,t){if(t.bookType=="fods")return pC(e,t);var r=i_(),n="",a=[],s=[];return n="mimetype",sr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",sr(r,n,pC(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",sr(r,n,Ore(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",sr(r,n,Pn+L6()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",sr(r,n,uG(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",sr(r,n,lG(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Vu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function c2(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Pr(qc(e))}function Ure(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Zs(Io(e))}function Pre(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Oc(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function mC(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Dre(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Rre(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function c0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Fr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function bn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Nr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=c0(e,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=c0(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function ja(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Fr(n*8+a.type)),a.type==2&&t.push(Fr(a.data.length)),t.push(a.data))})}),Oc(t)}function I_(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function gi(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=c0(e,n),s=Nr(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:bn(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=Nr(l.data),u=bn(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=bn(s[3][0].data)>>>0>0),r.push(o)}return r}function bA(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Fr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Fr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Fr(o.data.length)}],n[2].push({data:ja(o.meta),type:2})});var s=ja(n);t.push(Fr(s.length)),t.push(s),a.forEach(function(o){return t.push(o)})}),Oc(t)}function Qre(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=c0(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Oc(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var A=Oc(a);if(A.length!=n)throw new Error("Unexpected length: ".concat(A.length," != ").concat(n));return A}function xi(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Qre(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Oc(t)}function _A(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Fr(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Oc(t)}function Mre(e,t,r,n){var a=Vu(e),s=a.getUint32(4,!0),o=(n>1?12:8)+mC(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,A=new Date(2001,0,1);s&512&&(l=a.getUint32(o,!0),o+=4),o+=mC(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(o,!0),o+=4),s&32&&(u=a.getFloat64(o,!0),o+=8),s&64&&(A.setTime(A.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:A};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:r[l]};else if(c>-1)h={t:"s",v:t[c]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function Hre(e,t,r){var n=Vu(e),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,A=new Date(2001,0,1);a&1&&(c=Dre(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(A.setTime(A.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:A};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return h}function Qv(e,t){var r=new Uint8Array(32),n=Vu(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Rre(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Mv(e,t){var r=new Uint8Array(32),n=Vu(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function qre(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Mre(e,t,r,e[0]);case 5:return Hre(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function za(e){var t=Nr(e);return c0(t[1][0].data)}function gC(e,t){var r=Nr(t.data),n=bn(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(o){var l=Nr(o.data),c=bn(l[1][0].data)>>>0;switch(n){case 1:s[c]=c2(l[3][0].data);break;case 8:{var u=e[za(l[9][0].data)][0],A=Nr(u.data),h=e[za(A[1][0].data)][0],f=bn(h.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var d=Nr(h.data);s[c]=d[3].map(function(v){return c2(v.data)}).join("")}break}}),s}function Kre(e,t){var r,n,a,s,o,l,c,u,A,h,f,d,v,g,y=Nr(e),p=bn(y[1][0].data)>>>0,m=bn(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&bn(y[8][0].data)>0||!1,x,b;if((s=(a=y[7])==null?void 0:a[0])!=null&&s.data&&t!=0)x=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,b=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((h=(A=y[4])==null?void 0:A[0])!=null&&h.data&&t!=1)x=(d=(f=y[4])==null?void 0:f[0])==null?void 0:d.data,b=(g=(v=y[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var B=w?4:1,_=Vu(x),k=[],E=0;E<x.length/2;++E){var T=_.getUint16(E*2,!0);T<65535&&k.push([E,T])}if(k.length!=m)throw"Expected ".concat(m," cells, found ").concat(k.length);var S=[];for(E=0;E<k.length-1;++E)S[k[E][0]]=b.subarray(k[E][1]*B,k[E+1][1]*B);return k.length>=1&&(S[k[k.length-1][0]]=b.subarray(k[k.length-1][1]*B)),{R:p,cells:S}}function $re(e,t){var r,n=Nr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?bn(n[7][0].data)>>>0>0?1:0:-1,s=I_(n[5],function(o){return Kre(o,a)});return{nrows:bn(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function Vre(e,t,r){var n,a=Nr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(bn(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(bn(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=rr(s);var o=Nr(a[4][0].data),l=gC(e,e[za(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?gC(e,e[za(o[17][0].data)][0]):[],u=Nr(o[3][0].data),A=0;u[1].forEach(function(h){var f=Nr(h.data),d=e[za(f[2][0].data)][0],v=bn(d.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=$re(e,d);g.data.forEach(function(y,p){y.forEach(function(m,w){var x=Vt({r:A+p,c:w}),b=qre(m,l,c);b&&(r[x]=b)})}),A+=g.nrows})}function Gre(e,t){var r=Nr(t.data),n={"!ref":"A1"},a=e[za(r[2][0].data)],s=bn(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Vre(e,a[0],n),n}function Wre(e,t){var r,n=Nr(t.data),a={name:(r=n[1])!=null&&r[0]?c2(n[1][0].data):"",sheets:[]},s=I_(n[2],za);return s.forEach(function(o){e[o].forEach(function(l){var c=bn(l.meta[1][0].data);c==6e3&&a.sheets.push(Gre(e,l))})}),a}function zre(e,t){var r=D_(),n=Nr(t.data),a=I_(n[1],za);if(a.forEach(function(s){e[s].forEach(function(o){var l=bn(o.meta[1][0].data);if(l==2){var c=Wre(e,o);c.sheets.forEach(function(u,A){R_(r,u,A==0?c.name:c.name+"_"+A,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Hv(e){var t,r,n,a,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=xi(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var A;try{A=gi(u)}catch(h){return console.log("## "+(h.message||h))}A.forEach(function(h){s[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&bn(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var A=bn(u.meta[1][0].data)>>>0;if(A==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return zre(s,l)}function Xre(e,t,r){var n,a,s,o;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&bn(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=Vu(e[7][0].data),A=0,h=[],f=Vu(e[4][0].data),d=0,v=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),f.setUint16(g*2,65535);continue}u.setUint16(g*2,A,!0),f.setUint16(g*2,d,!0);var y,p;switch(typeof t[g]){case"string":y=Qv({t:"s",v:t[g]},r),p=Mv({t:"s",v:t[g]},r);break;case"number":y=Qv({t:"n",v:t[g]},r),p=Mv({t:"n",v:t[g]},r);break;case"boolean":y=Qv({t:"b",v:t[g]},r),p=Mv({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(y),A+=y.length,v.push(p),d+=p.length,++c}for(e[2][0].data=Fr(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),f.setUint16(g*2,65535,!0);return e[6][0].data=Oc(h),e[3][0].data=Oc(v),c}function Yre(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Os(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(rr(n)));var s=zg(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(L){return L.forEach(function(O){typeof O=="string"&&o.push(O)})});var l={},c=[],u=Qt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(L,O){return[L,u.FullPaths[O]]}).forEach(function(L){var O=L[0],D=L[1];if(O.type==2&&O.name.match(/\.iwa/)){var P=O.content,Q=xi(P),J=gi(Q);J.forEach(function(te){c.push(te.id),l[te.id]={deps:[],location:D,type:bn(te.messages[0].meta[1][0].data)}})}}),c.sort(function(L,O){return L-O});var A=c.filter(function(L){return L>1}).map(function(L){return[L,Fr(L)]});u.FileIndex.map(function(L,O){return[L,u.FullPaths[O]]}).forEach(function(L){var O=L[0];if(L[1],!!O.name.match(/\.iwa/)){var D=gi(xi(O.content));D.forEach(function(P){P.messages.forEach(function(Q){A.forEach(function(J){P.messages.some(function(te){return bn(te.meta[1][0].data)!=11006&&Pre(te.data,J[1])})&&l[J[0]].deps.push(P.id)})})})}});for(var h=Qt.find(u,l[1].location),f=gi(xi(h.content)),d,v=0;v<f.length;++v){var g=f[v];g.id==1&&(d=g)}var y=za(Nr(d.messages[0].data)[1][0].data);for(h=Qt.find(u,l[y].location),f=gi(xi(h.content)),v=0;v<f.length;++v)g=f[v],g.id==y&&(d=g);for(y=za(Nr(d.messages[0].data)[2][0].data),h=Qt.find(u,l[y].location),f=gi(xi(h.content)),v=0;v<f.length;++v)g=f[v],g.id==y&&(d=g);for(y=za(Nr(d.messages[0].data)[2][0].data),h=Qt.find(u,l[y].location),f=gi(xi(h.content)),v=0;v<f.length;++v)g=f[v],g.id==y&&(d=g);var p=Nr(d.messages[0].data);{p[6][0].data=Fr(n.e.r+1),p[7][0].data=Fr(n.e.c+1);var m=za(p[46][0].data),w=Qt.find(u,l[m].location),x=gi(xi(w.content));{for(var b=0;b<x.length&&x[b].id!=m;++b);if(x[b].id!=m)throw"Bad ColumnRowUIDMapArchive";var B=Nr(x[b].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var _=0;_<=n.e.c;++_){var k=[];k[1]=k[2]=[{type:0,data:Fr(_+420690)}],B[1].push({type:2,data:ja(k)}),B[2].push({type:0,data:Fr(_)}),B[3].push({type:0,data:Fr(_)})}B[4]=[],B[5]=[],B[6]=[];for(var E=0;E<=n.e.r;++E)k=[],k[1]=k[2]=[{type:0,data:Fr(E+726270)}],B[4].push({type:2,data:ja(k)}),B[5].push({type:0,data:Fr(E)}),B[6].push({type:0,data:Fr(E)});x[b].messages[0].data=ja(B)}w.content=_A(bA(x)),w.size=w.content.length,delete p[46];var T=Nr(p[4][0].data);{T[7][0].data=Fr(n.e.r+1);var S=Nr(T[1][0].data),j=za(S[2][0].data);w=Qt.find(u,l[j].location),x=gi(xi(w.content));{if(x[0].id!=j)throw"Bad HeaderStorageBucket";var I=Nr(x[0].messages[0].data);for(E=0;E<s.length;++E){var U=Nr(I[2][0].data);U[1][0].data=Fr(E),U[4][0].data=Fr(s[E].length),I[2][E]={type:I[2][0].type,data:ja(U)}}x[0].messages[0].data=ja(I)}w.content=_A(bA(x)),w.size=w.content.length;var q=za(T[2][0].data);w=Qt.find(u,l[q].location),x=gi(xi(w.content));{if(x[0].id!=q)throw"Bad HeaderStorageBucket";for(I=Nr(x[0].messages[0].data),_=0;_<=n.e.c;++_)U=Nr(I[2][0].data),U[1][0].data=Fr(_),U[4][0].data=Fr(n.e.r+1),I[2][_]={type:I[2][0].type,data:ja(U)};x[0].messages[0].data=ja(I)}w.content=_A(bA(x)),w.size=w.content.length;var V=za(T[4][0].data);(function(){for(var L=Qt.find(u,l[V].location),O=gi(xi(L.content)),D,P=0;P<O.length;++P){var Q=O[P];Q.id==V&&(D=Q)}var J=Nr(D.messages[0].data);{J[3]=[];var te=[];o.forEach(function(re,ke){te[1]=[{type:0,data:Fr(ke)}],te[2]=[{type:0,data:Fr(1)}],te[3]=[{type:2,data:Ure(re)}],J[3].push({type:2,data:ja(te)})})}D.messages[0].data=ja(J);var z=bA(O),ye=_A(z);L.content=ye,L.size=L.content.length})();var X=Nr(T[3][0].data);{var W=X[1][0];delete X[2];var M=Nr(W.data);{var G=za(M[2][0].data);(function(){for(var L=Qt.find(u,l[G].location),O=gi(xi(L.content)),D,P=0;P<O.length;++P){var Q=O[P];Q.id==G&&(D=Q)}var J=Nr(D.messages[0].data);{delete J[6],delete X[7];var te=new Uint8Array(J[5][0].data);J[5]=[];for(var z=0,ye=0;ye<=n.e.r;++ye){var re=Nr(te);z+=Xre(re,s[ye],o),re[1][0].data=Fr(ye),J[5].push({data:ja(re),type:2})}J[1]=[{type:0,data:Fr(n.e.c+1)}],J[2]=[{type:0,data:Fr(n.e.r+1)}],J[3]=[{type:0,data:Fr(z)}],J[4]=[{type:0,data:Fr(n.e.r+1)}]}D.messages[0].data=ja(J);var ke=bA(O),be=_A(ke);L.content=be,L.size=L.content.length})()}W.data=ja(M)}T[3][0].data=ja(X)}p[4][0].data=ja(T)}d.messages[0].data=ja(p);var H=bA(f),C=_A(H);return h.content=C,h.size=h.content.length,u}function GT(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function L_(e){GT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function O_(e){GT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Jre(e){return ur.WS.indexOf(e)>-1?"sheet":e==ur.CS?"chart":e==ur.DS?"dialog":e==ur.MS?"macro":e&&e.length?e:"sheet"}function Zre(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Jre(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function ene(e,t,r,n,a,s,o,l,c,u,A,h){try{s[n]=xh(ei(e,r,!0),t);var f=qn(e,t),d;switch(l){case"sheet":d=bte(f,t,a,c,s[n],u,A,h);break;case"chart":if(d=_te(f,t,a,c,s[n],u,A,h),!d||!d["!drawel"])break;var v=Xf(d["!drawel"].Target,t),g=n0(v),y=cY(ei(e,v,!0),xh(ei(e,g,!0),v)),p=Xf(y,v),m=n0(p);d=Xee(ei(e,p,!0),p,c,xh(ei(e,m,!0),p),u,d);break;case"macro":d=Nte(f,t,a,c,s[n],u,A,h);break;case"dialog":d=Bte(f,t,a,c,s[n],u,A,h);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=d;var w=[];s&&s[n]&&_n(s[n]).forEach(function(x){var b="";if(s[n][x].Type==ur.CMNT){b=Xf(s[n][x].Target,t);var B=kte(qn(e,b,!0),b,c);if(!B||!B.length)return;rC(d,B,!1)}s[n][x].Type==ur.TCMNT&&(b=Xf(s[n][x].Target,t),w=w.concat(AY(qn(e,b,!0),c)))}),w&&w.length&&rC(d,w,!0,c.people||[])}catch(x){if(c.WTF)throw x}}function pi(e){return e.charAt(0)=="/"?e.slice(1):e}function tne(e,t){if(Kd(),t=t||{},L_(t),vi(e,"META-INF/manifest.xml")||vi(e,"objectdata.xml"))return fC(e,t);if(vi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hv<"u"){if(e.FileIndex)return Hv(e);var r=Qt.utils.cfb_new();return _B(e).forEach(function(U){sr(r,U,dV(e,U))}),Hv(r)}throw new Error("Unsupported NUMBERS file")}if(!vi(e,"[Content_Types].xml"))throw vi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=_B(e),a=sG(ei(e,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",qn(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!qn(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(vh=[],a.sst)try{vh=Ste(qn(e,pi(a.sst)),a.sst,t)}catch(U){if(t.WTF)throw U}t.cellStyles&&a.themes.length&&(c=Ete(ei(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=Cte(qn(e,pi(a.style)),a.style,c,t))}a.links.map(function(U){try{var q=xh(ei(e,n0(pi(U))),U);return Fte(qn(e,pi(U)),q,U,t)}catch{}});var A=wte(qn(e,pi(a.workbooks[0])),a.workbooks[0],t),h={},f="";a.coreprops.length&&(f=qn(e,pi(a.coreprops[0]),!0),f&&(h=O6(f)),a.extprops.length!==0&&(f=qn(e,pi(a.extprops[0]),!0),f&&dG(f,h,t)));var d={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(f=ei(e,pi(a.custprops[0]),!0),f&&(d=hG(f,t)));var v={};if((t.bookSheets||t.bookProps)&&(A.Sheets?o=A.Sheets.map(function(q){return q.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),t.bookProps&&(v.Props=h,v.Custprops=d),t.bookSheets&&typeof o<"u"&&(v.SheetNames=o),t.bookSheets?v.SheetNames:t.bookProps))return v;o={};var g={};t.bookDeps&&a.calcchain&&(g=jte(qn(e,pi(a.calcchain)),a.calcchain));var y=0,p={},m,w;{var x=A.Sheets;h.Worksheets=x.length,h.SheetNames=[];for(var b=0;b!=x.length;++b)h.SheetNames[b]=x[b].name}var B=s?"bin":"xml",_=a.workbooks[0].lastIndexOf("/"),k=(a.workbooks[0].slice(0,_+1)+"_rels/"+a.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");vi(e,k)||(k="xl/_rels/workbook."+B+".rels");var E=xh(ei(e,k,!0),k.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Tte(qn(e,pi(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=fY(qn(e,pi(a.people[0])),t)),E&&(E=Zre(E,A.Sheets));var T=qn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var S="sheet";if(E&&E[y]?(m="xl/"+E[y][1].replace(/[\/]?xl\//,""),vi(e,m)||(m=E[y][1]),vi(e,m)||(m=k.replace(/_rels\/.*$/,"")+E[y][1]),S=E[y][2]):(m="xl/worksheets/sheet"+(y+1-T)+"."+B,m=m.replace(/sheet0\./,"sheet.")),w=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var j=!1,I=0;I!=t.sheets.length;++I)typeof t.sheets[I]=="number"&&t.sheets[I]==y&&(j=1),typeof t.sheets[I]=="string"&&t.sheets[I].toLowerCase()==h.SheetNames[y].toLowerCase()&&(j=1);if(!j)continue e}}ene(e,m,w,h.SheetNames[y],y,p,o,S,t,A,c,u)}return v={Directory:a,Workbook:A,Props:h,Custprops:d,Deps:g,Sheets:o,SheetNames:h.SheetNames,Strings:vh,Styles:u,Themes:c,SSF:rn(Kt)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(U,q){U=U.replace(/^Root Entry[\/]/,""),v.keys.push(U),v.files[U]=e.FileIndex[q]}))),t&&t.bookVBA&&(a.vba.length>0?v.vbaraw=qn(e,pi(a.vba[0]),!0):a.defaults&&a.defaults.bin===wY&&(v.vbaraw=qn(e,"xl/vbaProject.bin",!0))),v}function rne(e,t){var r=t||{},n="Workbook",a=Qt.find(e,n);try{if(n="/!DataSpaces/Version",a=Qt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Tz(a.content),n="/!DataSpaces/DataSpaceMap",a=Qt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Lz(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Qt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Oz(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Qt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Pz(a.content)}catch{}if(n="/EncryptionInfo",a=Qt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=Dz(a.content);if(n="/EncryptedPackage",a=Qt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function nne(e,t){return t.bookType=="ods"?VT(e,t):t.bookType=="numbers"?Yre(e,t):t.bookType=="xlsb"?ane(e,t):sne(e,t)}function ane(e,t){JA=1024,e&&!e.SSF&&(e.SSF=rn(Kt)),e&&e.SSF&&(Kd(),Px(e.SSF),t.revssf=Rx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,yh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=yT.indexOf(t.bookType)>-1,a=y_();O_(t=t||{});var s=i_(),o="",l=0;if(t.cellXfs=[],$c(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",sr(s,o,U6(e.Props,t)),a.coreprops.push(o),Tr(t.rels,2,o,ur.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,sr(s,o,R6(e.Props)),a.extprops.push(o),Tr(t.rels,3,o,ur.EXT_PROPS),e.Custprops!==e.Props&&_n(e.Custprops||{}).length>0&&(o="docProps/custom.xml",sr(s,o,Q6(e.Custprops)),a.custprops.push(o),Tr(t.rels,4,o,ur.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var A={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,sr(s,o,Lte(l-1,o,t,e,A)),a.sheets.push(o),Tr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ur.WS[0])}if(h){var d=h["!comments"],v=!1,g="";d&&d.length>0&&(g="xl/comments"+l+"."+r,sr(s,g,Pte(d,g)),a.comments.push(g),Tr(A,-1,"../comments"+l+"."+r,ur.CMNT),v=!0),h["!legacy"]&&v&&sr(s,"xl/drawings/vmlDrawing"+l+".vml",xT(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}A["!id"].rId1&&sr(s,n0(o),Ad(A))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,sr(s,o,Ute(t.Strings,o,t)),a.strs.push(o),Tr(t.wbrels,-1,"sharedStrings."+r,ur.SST)),o="xl/workbook."+r,sr(s,o,Ite(e,o)),a.workbooks.push(o),Tr(t.rels,1,o,ur.WB),o="xl/theme/theme1.xml",sr(s,o,C_(e.Themes,t)),a.themes.push(o),Tr(t.wbrels,-1,"theme/theme1.xml",ur.THEME),o="xl/styles."+r,sr(s,o,Ote(e,o,t)),a.styles.push(o),Tr(t.wbrels,-1,"styles."+r,ur.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",sr(s,o,e.vbaraw),a.vba.push(o),Tr(t.wbrels,-1,"vbaProject.bin",ur.VBA)),o="xl/metadata."+r,sr(s,o,Dte(o)),a.metadata.push(o),Tr(t.wbrels,-1,"metadata."+r,ur.XLMETA),sr(s,"[Content_Types].xml",I6(a,t)),sr(s,"_rels/.rels",Ad(t.rels)),sr(s,"xl/_rels/workbook."+r+".rels",Ad(t.wbrels)),delete t.revssf,delete t.ssf,s}function sne(e,t){JA=1024,e&&!e.SSF&&(e.SSF=rn(Kt)),e&&e.SSF&&(Kd(),Px(e.SSF),t.revssf=Rx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,yh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=yT.indexOf(t.bookType)>-1,a=y_();O_(t=t||{});var s=i_(),o="",l=0;if(t.cellXfs=[],$c(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",sr(s,o,U6(e.Props,t)),a.coreprops.push(o),Tr(t.rels,2,o,ur.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,sr(s,o,R6(e.Props)),a.extprops.push(o),Tr(t.rels,3,o,ur.EXT_PROPS),e.Custprops!==e.Props&&_n(e.Custprops||{}).length>0&&(o="docProps/custom.xml",sr(s,o,Q6(e.Custprops)),a.custprops.push(o),Tr(t.rels,4,o,ur.CUST_PROPS));var A=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,sr(s,o,FT(l-1,t,e,h)),a.sheets.push(o),Tr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ur.WS[0])}if(f){var v=f["!comments"],g=!1,y="";if(v&&v.length>0){var p=!1;v.forEach(function(m){m[1].forEach(function(w){w.T==!0&&(p=!0)})}),p&&(y="xl/threadedComments/threadedComment"+l+"."+r,sr(s,y,dY(v,A,t)),a.threadedcomments.push(y),Tr(h,-1,"../threadedComments/threadedComment"+l+"."+r,ur.TCMNT)),y="xl/comments"+l+"."+r,sr(s,y,vT(v)),a.comments.push(y),Tr(h,-1,"../comments"+l+"."+r,ur.CMNT),g=!0}f["!legacy"]&&g&&sr(s,"xl/drawings/vmlDrawing"+l+".vml",xT(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&sr(s,n0(o),Ad(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,sr(s,o,iT(t.Strings,t)),a.strs.push(o),Tr(t.wbrels,-1,"sharedStrings."+r,ur.SST)),o="xl/workbook."+r,sr(s,o,UT(e)),a.workbooks.push(o),Tr(t.rels,1,o,ur.WB),o="xl/theme/theme1.xml",sr(s,o,C_(e.Themes,t)),a.themes.push(o),Tr(t.wbrels,-1,"theme/theme1.xml",ur.THEME),o="xl/styles."+r,sr(s,o,hT(e,t)),a.styles.push(o),Tr(t.wbrels,-1,"styles."+r,ur.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",sr(s,o,e.vbaraw),a.vba.push(o),Tr(t.wbrels,-1,"vbaProject.bin",ur.VBA)),o="xl/metadata."+r,sr(s,o,gT()),a.metadata.push(o),Tr(t.wbrels,-1,"metadata."+r,ur.XLMETA),A.length>1&&(o="xl/persons/person.xml",sr(s,o,hY(A)),a.people.push(o),Tr(t.wbrels,-1,"persons/person.xml",ur.PEOPLE)),sr(s,"[Content_Types].xml",I6(a,t)),sr(s,"_rels/.rels",Ad(t.rels)),sr(s,"xl/_rels/workbook."+r+".rels",Ad(t.wbrels)),delete t.revssf,delete t.ssf,s}function U_(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=oi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ine(e,t){return Qt.find(e,"EncryptedPackage")?rne(e,t):QT(e,t)}function one(e,t){var r,n=e,a=t||{};return a.type||(a.type=cr&&Buffer.isBuffer(e)?"buffer":"base64"),r=l6(n,a),tne(r,a)}function WT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return o2(e.slice(r),t);default:break e}return Sd.to_workbook(e,t)}function lne(e,t){var r="",n=U_(e,t);switch(t.type){case"base64":r=oi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Hu(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Pr(r)),t.type="binary",WT(r,t)}function cne(e,t){var r=e;return t.type=="base64"&&(r=oi(r)),r=Yh.utils.decode(1200,r.slice(2),"str"),t.type="binary",WT(r,t)}function une(e){return e.match(/[^\x00-\x7F]/)?Io(e):e}function qv(e,t,r,n){return n?(r.type="string",Sd.to_workbook(e,r)):Sd.to_workbook(t,r)}function u2(e,t){t_();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return u2(new Uint8Array(e),(r=rn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),fd={},r.dateNF&&(fd.dateNF=r.dateNF),r.type||(r.type=cr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=cr?"buffer":"binary",n=aV(e),typeof Uint8Array<"u"&&!cr&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=une(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=rn(r),r.type="array",u2(r_(n),r)}switch((a=U_(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return ine(Qt.read(n,r),r);break;case 9:if(a[1]<=8)return QT(n,r);break;case 60:return o2(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return pz(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return aT.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?one(n,r):qv(e,n,r,s);case 239:return a[3]===60?o2(n,r):qv(e,n,r,s);case 255:if(a[1]===254)return cne(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return ju.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ju.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return i2.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return AT.to_workbook(n,r);break;case 10:case 13:case 32:return lne(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return hz.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?i2.to_workbook(n,r):qv(e,n,r,s)}function zT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return N0(t.file,Qt.write(e,{type:cr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Qt.write(e,t)}function Ane(e,t){var r=rn(t||{}),n=nne(e,r);return dne(n,r)}function dne(e,t){var r={},n=cr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Qt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Ux(a))}return t.password&&typeof encrypt_agile<"u"?zT(encrypt_agile(a,t.password),t):t.type==="file"?N0(t.file,a):t.type=="string"?Pr(a):a}function fne(e,t){var r=t||{},n=ure(e,r);return zT(n,r)}function So(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Jh(Io(n));case"binary":return Io(n);case"string":return e;case"file":return N0(t.file,n,"utf8");case"buffer":return cr?Ll(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):So(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hne(e,t){switch(t.type){case"base64":return Jh(e);case"binary":return e;case"string":return e;case"file":return N0(t.file,e,"binary");case"buffer":return cr?Ll(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Xp(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Jh(r):t.type=="string"?Pr(r):r;case"file":return N0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function XT(e,t){t_(),ite(e);var r=rn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=XT(e,r);return r.type="array",Ux(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return So(nre(e,r),r);case"slk":case"sylk":return So(nT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return So(HT(e.Sheets[e.SheetNames[a]],r),r);case"txt":return hne(YT(e.Sheets[e.SheetNames[a]],r),r);case"csv":return So(P_(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return So(aT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Xp(i2.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return So(Sd.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return So(AT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return So(sT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return So(VT(e,r),r);case"wk1":return Xp(ju.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Xp(ju.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Xp(MT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),fne(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Ane(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function pne(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Wg(e,t,r){var n={};return n.type="file",n.file=t,pne(n),XT(e,n)}function mne(e,t,r,n,a,s,o,l){var c=Un(r),u=l.defval,A=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,f=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||e[r])for(var d=t.s.c;d<=t.e.c;++d){var v=o?e[r][d]:e[n[d]+c];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[d]!=null&&(f[s[d]]=u);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[d]!=null){if(g==null)if(v.t=="e"&&g===null)f[s[d]]=null;else if(u!==void 0)f[s[d]]=u;else if(A&&g===null)f[s[d]]=null;else continue;else f[s[d]]=A&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?g:jl(v,g,l);g!=null&&(h=!1)}}return{row:f,isempty:h}}function zg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},A=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof A){case"string":c=br(A);break;case"number":c=br(e["!ref"]),c.s.r=A;break;default:c=A}n>0&&(a=0);var h=Un(c.s.r),f=[],d=[],v=0,g=0,y=Array.isArray(e),p=c.s.r,m=0,w={};y&&!e[p]&&(e[p]=[]);var x=u.skipHidden&&e["!cols"]||[],b=u.skipHidden&&e["!rows"]||[];for(m=c.s.c;m<=c.e.c;++m)if(!(x[m]||{}).hidden)switch(f[m]=dn(m),r=y?e[p][m]:e[f[m]+h],n){case 1:s[m]=m-c.s.c;break;case 2:s[m]=f[m];break;case 3:s[m]=u.header[m-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=jl(r,null,u),g=w[o]||0,!g)w[o]=1;else{do l=o+"_"+g++;while(w[l]);w[o]=g,w[l]=1}s[m]=l}for(p=c.s.r+a;p<=c.e.r;++p)if(!(b[p]||{}).hidden){var B=mne(e,c,p,f,n,s,y,u);(B.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[v++]=B.row)}return d.length=v,d}var xC=/"/g;function gne(e,t,r,n,a,s,o,l){for(var c=!0,u=[],A="",h=Un(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var d=l.dense?(e[r]||[])[f]:e[n[f]+h];if(d==null)A="";else if(d.v!=null){c=!1,A=""+(l.rawNumbers&&d.t=="n"?d.v:jl(d,null,l));for(var v=0,g=0;v!==A.length;++v)if((g=A.charCodeAt(v))===a||g===s||g===34||l.forceQuotes){A='"'+A.replace(xC,'""')+'"';break}A=="ID"&&(A='"ID"')}else d.f!=null&&!d.F?(c=!1,A="="+d.f,A.indexOf(",")>=0&&(A='"'+A.replace(xC,'""')+'"')):A="";u.push(A)}return l.blankrows===!1&&c?null:u.join(o)}function P_(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=br(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),A="",h=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(f[v]||{}).hidden||(h[v]=dn(v));for(var g=0,y=a.s.r;y<=a.e.r;++y)(d[y]||{}).hidden||(A=gne(e,a,y,h,o,c,s,n),A!=null&&(n.strip&&(A=A.replace(u,"")),(A||n.blankrows!==!1)&&r.push((g++?l:"")+A)));return delete n.dense,r.join("")}function YT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=P_(e,t);return r}function xne(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=br(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=dn(l);for(var A=a.s.r;A<=a.e.r;++A)for(s=Un(A),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+s,r=u?(e[A]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function JT(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?fn(n.origin):n.origin;o=c.r,l=c.c}var u,A={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(s["!ref"]){var h=br(s["!ref"]);A.e.c=Math.max(A.e.c,h.e.c),A.e.r=Math.max(A.e.r,h.e.r),o==-1&&(o=h.e.r+1,A.e.r=o+t.length-1+a)}else o==-1&&(o=0,A.e.r=t.length-1+a);var f=n.header||[],d=0;t.forEach(function(g,y){_n(g).forEach(function(p){(d=f.indexOf(p))==-1&&(f[d=f.length]=p);var m=g[p],w="z",x="",b=Vt({c:l+d,r:o+y+a});u=u0(s,b),m&&typeof m=="object"&&!(m instanceof Date)?s[b]=m:(typeof m=="number"?w="n":typeof m=="boolean"?w="b":typeof m=="string"?w="s":m instanceof Date?(w="d",n.cellDates||(w="n",m=Aa(m)),x=n.dateNF||Kt[14]):m===null&&n.nullError&&(w="e",m=0),u?(u.t=w,u.v=m,delete u.w,delete u.R,x&&(u.z=x)):s[b]=u={t:w,v:m},x&&(u.z=x))})}),A.e.c=Math.max(A.e.c,l+f.length-1);var v=Un(o);if(a)for(d=0;d<f.length;++d)s[dn(d+l)+v]={t:"s",v:f[d]};return s["!ref"]=rr(A),s}function vne(e,t){return JT(null,e,t)}function u0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=fn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?u0(e,Vt(t)):u0(e,Vt({r:t,c:r||0}))}function yne(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function D_(){return{SheetNames:[],Sheets:{}}}function R_(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(OT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function wne(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=yne(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function bne(e,t){return e.z=t,e}function ZT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function _ne(e,t,r){return ZT(e,"#"+t,r)}function Nne(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Bne(e,t,r,n){for(var a=typeof t!="string"?t:br(t),s=typeof t=="string"?t:rr(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=u0(e,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var hs={encode_col:dn,encode_row:Un,encode_cell:Vt,encode_range:rr,decode_col:h_,decode_row:f_,split_cell:UV,decode_cell:fn,decode_range:Os,format_cell:jl,sheet_add_aoa:C6,sheet_add_json:JT,sheet_add_dom:qT,aoa_to_sheet:$d,json_to_sheet:vne,table_to_sheet:KT,table_to_book:Tre,sheet_to_csv:P_,sheet_to_txt:YT,sheet_to_json:zg,sheet_to_html:HT,sheet_to_formulae:xne,sheet_to_row_object_array:zg,sheet_get_cell:u0,book_new:D_,book_append_sheet:R_,book_set_sheet_visibility:wne,cell_set_number_format:bne,cell_set_hyperlink:ZT,cell_set_internal_link:_ne,cell_add_comment:Nne,sheet_set_array_formula:Bne,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Cne({isOpen:e,onClose:t,inquiry:r,replyTo:n}){const[a,s]=Z.useState(r.contact_email||""),[o,l]=Z.useState(""),[c,u]=Z.useState(""),[A,h]=Z.useState(!1),[f,d]=Z.useState(!1),[v,g]=Z.useState(n!=null&&n.subject?n.subject.startsWith("Re:")?n.subject:`Re: ${n.subject}`:`Re: ${r.product_name} - Inquiry ${r.inquiry_number}`),[y,p]=Z.useState(""),[m,w]=Z.useState([]),[x,b]=Z.useState(!1),[B,_]=Z.useState([]),[k,E]=Z.useState(!1),[T,S]=Z.useState(""),j=Z.useRef(null);Z.useEffect(()=>{if(I(),U(),n){const G=`
        <br><br>
        <div style="border-left: 3px solid #ccc; padding-left: 15px; margin-left: 10px; color: #666;">
          <p><strong>On ${new Date().toLocaleDateString()}, ${n.from_email} wrote:</strong></p>
          ${n.body}
        </div>
      `;p(G)}},[n]);const I=async()=>{try{const{data:G,error:H}=await de.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(H)throw H;_(G||[])}catch(G){console.error("Error loading templates:",G)}},U=async()=>{try{const{data:{user:G}}=await de.auth.getUser();if(G){const{data:H}=await de.from("user_profiles").select("full_name").eq("id",G.id).single();S((H==null?void 0:H.full_name)||"")}}catch(G){console.error("Error loading user name:",G)}},q=G=>{const H={"{{contact_person}}":r.contact_person||"","{{company_name}}":r.company_name,"{{product_name}}":r.product_name,"{{specification}}":r.specification||"-","{{quantity}}":r.quantity,"{{supplier_name}}":r.supplier_name||"-","{{supplier_country}}":r.supplier_country||"-","{{inquiry_number}}":r.inquiry_number,"{{user_name}}":T};let C=G.subject,L=G.body;Object.entries(H).forEach(([O,D])=>{const P=new RegExp(O.replace(/[{}]/g,"\\$&"),"g");C=C.replace(P,D),L=L.replace(P,D)}),g(C),p(L),E(!1),de.from("crm_email_templates").update({use_count:G.use_count+1,last_used:new Date().toISOString()}).eq("id",G.id).then(()=>{})},V=G=>{const H=G.target.files;if(!H)return;const C=[];for(let L=0;L<H.length;L++){const O=H[L];if(O.size>25*1024*1024){alert(`File ${O.name} is too large. Maximum size is 25MB.`);continue}C.push({file:O,name:O.name,size:O.size})}w(L=>[...L,...C])},X=G=>{w(H=>H.filter((C,L)=>L!==G))},W=G=>G<1024?G+" B":G<1024*1024?(G/1024).toFixed(1)+" KB":(G/(1024*1024)).toFixed(1)+" MB",M=async()=>{if(!a||!v||!y){alert("Please fill in all required fields");return}b(!0);try{const{data:{user:G}}=await de.auth.getUser();if(!G)throw new Error("Not authenticated");const H=[];for(const D of m){const P=`${Date.now()}_${D.name}`,Q=`email-attachments/${G.id}/${P}`,{error:J}=await de.storage.from("crm-documents").upload(Q,D.file);J||H.push(Q)}const C={inquiry_id:r.id,email_type:"sent",from_email:G.email,to_email:[a,...o?o.split(",").map(D=>D.trim()):[]],cc_email:o?o.split(",").map(D=>D.trim()):null,bcc_email:c?c.split(",").map(D=>D.trim()):null,subject:v,body:y,attachments:H.length>0?H:null,sent_date:new Date().toISOString(),created_by:G.id,reply_to_id:(n==null?void 0:n.email_id)||null},{error:L}=await de.from("crm_email_activities").insert([C]);if(L)throw L;const O={};v.toLowerCase().includes("price")||v.toLowerCase().includes("quote")?(O.price_quoted=!0,O.price_quoted_date=new Date().toISOString().split("T")[0],O.status="price_quoted"):(v.toLowerCase().includes("coa")||v.toLowerCase().includes("msds"))&&(O.coa_sent=!0,O.coa_sent_date=new Date().toISOString().split("T")[0]),Object.keys(O).length>0&&await de.from("crm_inquiries").update(O).eq("id",r.id),alert("Email sent successfully!"),t()}catch(G){console.error("Error sending email:",G),alert("Failed to send email. Please try again.")}finally{b(!1)}};return e?i.jsx(ir,{isOpen:e,onClose:t,title:"",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between border-b pb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(la,{className:"w-5 h-5"}),n?"Reply to Email":"New Message"]}),i.jsxs("button",{onClick:()=>E(!k),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded transition",children:[i.jsx(cd,{className:"w-4 h-4"}),"Templates",i.jsx(To,{className:"w-3 h-3"})]})]}),k&&i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Choose a template:"}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:B.map(G=>i.jsxs("button",{onClick:()=>q(G),className:"px-3 py-2 text-left text-sm bg-white hover:bg-blue-50 border border-gray-200 rounded transition",children:[i.jsx("div",{className:"font-medium text-gray-900",children:G.template_name}),i.jsx("div",{className:"text-xs text-gray-500",children:G.category})]},G.id))})]}),i.jsx("div",{children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"To:"}),i.jsx("input",{type:"email",value:a,onChange:G=>s(G.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"recipient@example.com",required:!0}),i.jsx("button",{onClick:()=>h(!A),className:"text-sm text-blue-600 hover:text-blue-700",children:"Cc"}),i.jsx("button",{onClick:()=>d(!f),className:"text-sm text-blue-600 hover:text-blue-700",children:"Bcc"})]})}),A&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"Cc:"}),i.jsx("input",{type:"text",value:o,onChange:G=>l(G.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"cc@example.com (comma separated)"})]}),f&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"Bcc:"}),i.jsx("input",{type:"text",value:c,onChange:G=>u(G.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"bcc@example.com (comma separated)"})]}),i.jsx("div",{children:i.jsx("input",{type:"text",value:v,onChange:G=>g(G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Subject",required:!0})}),i.jsx("div",{children:i.jsx("textarea",{value:y.replace(/<[^>]*>/g,""),onChange:G=>p(G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:15,placeholder:"Compose your email..."})}),m.length>0&&i.jsx("div",{className:"space-y-2",children:m.map((G,H)=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ki,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-sm text-gray-700",children:G.name}),i.jsxs("span",{className:"text-xs text-gray-500",children:["(",W(G.size),")"]})]}),i.jsx("button",{onClick:()=>X(H),className:"text-red-600 hover:text-red-700",children:i.jsx(An,{className:"w-4 h-4"})})]},H))}),i.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[i.jsxs("div",{children:[i.jsx("input",{ref:j,type:"file",multiple:!0,onChange:V,className:"hidden"}),i.jsxs("button",{onClick:()=>{var G;return(G=j.current)==null?void 0:G.click()},className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",children:[i.jsx(ki,{className:"w-4 h-4"}),"Attach Files"]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{onClick:M,disabled:x||!a||!v||!y,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:x?i.jsxs(i.Fragment,{children:[i.jsx(Do,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ii,{className:"w-4 h-4"}),"Send"]})})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 pt-2 border-t",children:[i.jsx("strong",{children:"Inquiry:"})," ",r.inquiry_number," | ",r.company_name," | ",r.product_name]})]})}):null}function eI({isOpen:e,onClose:t,onSuccess:r,initialData:n}){const{user:a}=Dr(),[s,o]=Z.useState(!1),[l,c]=Z.useState([]),[u,A]=Z.useState([]),[h,f]=Z.useState([]),[d,v]=Z.useState([]),g=Z.useRef(null),[y,p]=Z.useState(""),[m,w]=Z.useState(""),[x,b]=Z.useState(""),[B,_]=Z.useState(""),[k,E]=Z.useState("medium"),[T,S]=Z.useState([]),[j,I]=Z.useState(""),[U,q]=Z.useState(""),[V,X]=Z.useState(""),[W,M]=Z.useState([]),[G,H]=Z.useState(""),[C,L]=Z.useState([]),[O,D]=Z.useState(""),[P,Q]=Z.useState(!1);Z.useEffect(()=>{if(e){J(),te(),z(),ye(),n&&(I(n.inquiry_id||""),q(n.customer_id||""),X(n.product_id||""));const pe=new Date;pe.setDate(pe.getDate()+1),b(pe.toISOString().split("T")[0]),_("17:00")}},[e,n]);const J=async()=>{try{const{data:pe,error:we}=await de.from("user_profiles").select("id, full_name, email, role").eq("is_active",!0).order("full_name");if(we)throw we;c(pe||[])}catch(pe){console.error("Error loading users:",pe)}},te=async()=>{try{const{data:pe,error:we}=await de.from("crm_inquiries").select("id, inquiry_number, company_name, product_name").order("created_at",{ascending:!1}).limit(100);if(we)throw we;A((pe||[]).map(Te=>({id:Te.id,label:`${Te.inquiry_number} - ${Te.company_name} (${Te.product_name})`})))}catch(pe){console.error("Error loading inquiries:",pe)}},z=async()=>{try{const{data:pe,error:we}=await de.from("customers").select("id, company_name, contact_person").eq("is_active",!0).order("company_name");if(we)throw we;f((pe||[]).map(Te=>({id:Te.id,label:`${Te.company_name}${Te.contact_person?` (${Te.contact_person})`:""}`})))}catch(pe){console.error("Error loading customers:",pe)}},ye=async()=>{try{const{data:pe,error:we}=await de.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(we)throw we;v((pe||[]).map(Te=>({id:Te.id,label:`${Te.product_name}${Te.product_code?` (${Te.product_code})`:""}`})))}catch(pe){console.error("Error loading products:",pe)}},re=pe=>{T.includes(pe)?S(T.filter(we=>we!==pe)):S([...T,pe])},ke=()=>{G.trim()&&!W.includes(G.trim())&&(M([...W,G.trim()]),H(""))},be=pe=>{M(W.filter(we=>we!==pe))},ae=async pe=>{const we=[];for(const Te of C){const he=`${Date.now()}_${Te.name}`,ce=`tasks/${pe}/${he}`,{error:Se}=await de.storage.from("task-attachments").upload(ce,Te);Se?console.error("Error uploading file:",Se):we.push(ce)}return we},Ie=async pe=>{if(pe.preventDefault(),!y.trim()){alert("Please enter a task title");return}if(!x||!B){alert("Please set a deadline");return}if(T.length===0){alert("Please assign at least one user");return}try{o(!0);const we=`${x}T${B}:00`,Te={title:y.trim(),description:m.trim()||null,deadline:we,priority:k,created_by:a==null?void 0:a.id,assigned_users:T,inquiry_id:j||null,customer_id:U||null,product_id:V||null,tags:W},{data:he,error:ce}=await de.from("tasks").insert([Te]).select().single();if(ce)throw ce;if(C.length>0&&he){const Le=await ae(he.id),{error:Xe}=await de.from("tasks").update({attachment_urls:Le}).eq("id",he.id);if(Xe)throw Xe}const Se=T.map(Le=>({task_id:he.id,assigned_user_id:Le,assigned_by:a==null?void 0:a.id})),{error:Pe}=await de.from("task_assignments").insert(Se);if(Pe)throw Pe;r()}catch(we){console.error("Error creating task:",we),alert("Failed to create task. Please try again.")}finally{o(!1)}},De=l.filter(pe=>pe.full_name.toLowerCase().includes(O.toLowerCase())||pe.email.toLowerCase().includes(O.toLowerCase()));return i.jsx(ir,{isOpen:e,onClose:t,title:"Create New Task",size:"lg",children:i.jsxs("form",{onSubmit:Ie,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Task Title ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:y,onChange:pe=>p(pe.target.value),placeholder:"e.g., Send quotation to customer",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:m,onChange:pe=>w(pe.target.value),placeholder:"Add detailed instructions or notes...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deadline Date ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"date",value:x,onChange:pe=>b(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deadline Time ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"time",value:B,onChange:pe=>_(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Priority ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:k,onChange:pe=>E(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Assign To ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:O,onChange:pe=>D(pe.target.value),onFocus:()=>Q(!0),placeholder:"Search users...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsx(Hc,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),P&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:De.map(pe=>i.jsxs("button",{type:"button",onClick:()=>re(pe.id),className:`w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center justify-between ${T.includes(pe.id)?"bg-blue-50":""}`,children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:pe.full_name}),i.jsxs("p",{className:"text-xs text-gray-500",children:[pe.email,"  ",pe.role]})]}),T.includes(pe.id)&&i.jsx("div",{className:"w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center",children:i.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},pe.id))})]}),T.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:T.map(pe=>{const we=l.find(Te=>Te.id===pe);return i.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:[we==null?void 0:we.full_name,i.jsx("button",{type:"button",onClick:()=>re(pe),className:"text-blue-600 hover:text-blue-800",children:i.jsx(An,{className:"w-4 h-4"})})]},pe)})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Inquiry"}),i.jsxs("select",{value:j,onChange:pe=>I(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"None"}),u.map(pe=>i.jsx("option",{value:pe.id,children:pe.label},pe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Customer"}),i.jsxs("select",{value:U,onChange:pe=>q(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"None"}),h.map(pe=>i.jsx("option",{value:pe.id,children:pe.label},pe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Product"}),i.jsxs("select",{value:V,onChange:pe=>X(pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"None"}),d.map(pe=>i.jsx("option",{value:pe.id,children:pe.label},pe.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:G,onChange:pe=>H(pe.target.value),onKeyPress:pe=>pe.key==="Enter"&&(pe.preventDefault(),ke()),placeholder:"Add tag and press Enter",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsx("button",{type:"button",onClick:ke,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition",children:"Add"})]}),W.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:W.map(pe=>i.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:[i.jsx(Fg,{className:"w-3 h-3"}),pe,i.jsx("button",{type:"button",onClick:()=>be(pe),className:"text-gray-500 hover:text-red-600",children:i.jsx(An,{className:"w-3 h-3"})})]},pe))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attachments"}),i.jsx("input",{ref:g,type:"file",multiple:!0,onChange:pe=>{pe.target.files&&L(Array.from(pe.target.files))},className:"hidden"}),i.jsxs("button",{type:"button",onClick:()=>{var pe;return(pe=g.current)==null?void 0:pe.click()},className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[i.jsx(ki,{className:"w-4 h-4"}),"Choose Files"]}),C.length>0&&i.jsx("div",{className:"mt-2 space-y-2",children:C.map((pe,we)=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(pr,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-sm text-gray-700",children:pe.name}),i.jsxs("span",{className:"text-xs text-gray-500",children:["(",(pe.size/1024).toFixed(1)," KB)"]})]}),i.jsx("button",{type:"button",onClick:()=>L(Te=>Te.filter((he,ce)=>ce!==we)),className:"text-red-600 hover:text-red-700",children:i.jsx(An,{className:"w-4 h-4"})})]},we))})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:t,disabled:s,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:s||!y.trim()||T.length===0,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:s?i.jsxs(i.Fragment,{children:[i.jsx(Do,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):"Create Task"})]})]})})}function Ene({inquiry:e,compact:t=!1,onMarkSent:r}){const n=[{type:"price",letter:"P",required:e.price_required??!0,sent:e.price_sent_at,label:"Price"},{type:"coa",letter:"C",required:e.coa_required??!0,sent:e.coa_sent_at,label:"COA"},{type:"sample",letter:"S",required:e.sample_required,sent:e.sample_sent_at,label:"Sample"},{type:"agency_letter",letter:"A",required:e.agency_letter_required,sent:e.agency_letter_sent_at,label:"Agency Letter"},{type:"others",letter:"O",required:e.others_required,sent:e.others_sent_at,label:"Others"}];return n.some(s=>s.required)?i.jsx("div",{className:"flex flex-wrap gap-1.5",children:n.filter(s=>s.required).map(s=>i.jsx("button",{onClick:()=>r==null?void 0:r(s.type),disabled:!r,className:`
            inline-flex items-center justify-center
            w-6 h-6 rounded text-xs font-bold
            transition-colors duration-150
            ${s.sent?"bg-green-100 text-green-700 hover:bg-green-200 cursor-pointer":"bg-red-100 text-red-700 hover:bg-red-200 cursor-pointer"}
            ${r?"":"cursor-default"}
          `,title:`${s.label}${s.sent?" - Sent (Click to unmark)":" - Pending (Click to mark as sent)"}`,children:s.letter},s.type))}):i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-500",children:[i.jsx(Sne,{className:"w-3 h-3"}),!t&&"Nothing required"]})}function Sne({className:e}){return i.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}const vC={new:{label:"New",color:"bg-gray-100 text-gray-700 border-gray-300",icon:lF},in_progress:{label:"In Progress",color:"bg-blue-100 text-blue-700 border-blue-300",icon:Ao},follow_up:{label:"Follow Up",color:"bg-purple-100 text-purple-700 border-purple-300",icon:ts},won:{label:"Won",color:"bg-green-100 text-green-700 border-green-300",icon:ua},lost:{label:"Lost",color:"bg-red-100 text-red-700 border-red-300",icon:Pa},on_hold:{label:"On Hold",color:"bg-yellow-100 text-yellow-700 border-yellow-300",icon:oR}};function tI({status:e,compact:t=!1}){const r=vC[e]||vC.new,n=r.icon;return i.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium border ${r.color}`,children:[i.jsx(n,{className:"w-3 h-3"}),!t&&r.label]})}const Yp=[{value:"new",label:"New"},{value:"in_progress",label:"In Progress"},{value:"follow_up",label:"Follow Up"},{value:"won",label:"Won"},{value:"lost",label:"Lost"},{value:"on_hold",label:"On Hold"}];function kne({isOpen:e,onClose:t,inquiryId:r,inquiryNumber:n,onSuccess:a}){const[s,o]=Z.useState(""),[l,c]=Z.useState(""),[u,A]=Z.useState(""),[h,f]=Z.useState(!1),d=async y=>{if(y.preventDefault(),s.trim().length<10){alert("Please provide a detailed reason (at least 10 characters)");return}f(!0);try{const p={pipeline_status:"lost",lost_reason:s.trim(),lost_at:new Date().toISOString()};l.trim()&&(p.competitor_name=l.trim()),u.trim()&&(p.competitor_price=parseFloat(u));const{error:m}=await de.from("crm_inquiries").update(p).eq("id",r);if(m)throw m;a(),t(),v()}catch(p){console.error("Error marking inquiry as lost:",p),alert("Failed to mark inquiry as lost. Please try again.")}finally{f(!1)}},v=()=>{o(""),c(""),A("")},g=()=>{h||(t(),v())};return i.jsx(ir,{isOpen:e,onClose:g,title:`Mark Inquiry #${n} as Lost`,children:i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[i.jsx(Pa,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"text-sm text-red-800",children:[i.jsx("p",{className:"font-medium",children:"You are about to mark this inquiry as lost."}),i.jsx("p",{className:"mt-1 text-red-700",children:"This will move it to the Archive. Please provide details below."})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Lost Reason ",i.jsx("span",{className:"text-red-600",children:"*"})]}),i.jsx("textarea",{value:s,onChange:y=>o(y.target.value),placeholder:"e.g., Competitor offered lower price, Customer chose local supplier, Budget constraints...",rows:4,required:!0,minLength:10,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 10 characters. Be specific to help improve future quotes."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Competitor Name ",i.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),i.jsx("input",{type:"text",value:l,onChange:y=>c(y.target.value),placeholder:"e.g., ABC Trading Co.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Competitor Price (USD) ",i.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),i.jsx("input",{type:"number",step:"0.01",value:u,onChange:y=>A(y.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:g,disabled:h,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:h||s.trim().length<10,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:h?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Pa,{className:"w-4 h-4"}),"Mark as Lost"]})})]})]})})}function jne({inquiries:e,onRefresh:t,canManage:r,onAddInquiry:n}){const{profile:a}=Dr(),[s,o]=Z.useState(new Set),[l,c]=Z.useState([]),[u,A]=Z.useState(null),[h,f]=Z.useState(e),[d,v]=Z.useState({column:"inquiry_date",direction:"desc"}),[g,y]=Z.useState(null),[p,m]=Z.useState(""),[w,x]=Z.useState(!1),[b,B]=Z.useState(null),[_,k]=Z.useState(!1),[E,T]=Z.useState(""),[S,j]=Z.useState(!1),[I,U]=Z.useState(""),[q,V]=Z.useState(""),[X,W]=Z.useState(!1),[M,G]=Z.useState(!1),[H,C]=Z.useState(!1),[L,O]=Z.useState(null),[D,P]=Z.useState(!1),[Q,J]=Z.useState(null),[te,z]=Z.useState(""),[ye,re]=Z.useState(!1),[ke,be]=Z.useState({price_required:!1,coa_required:!1,sample_required:!1,agency_letter_required:!1,others_required:!1}),[ae,Ie]=Z.useState(new Set),[De,pe]=Z.useState(new Map),we=Z.useRef(null),[Te,he]=Z.useState({checkbox:50,inquiry_number:120,inquiry_date:120,product_name:200,specification:200,quantity:100,supplier_name:150,company_name:180,mail_subject:200,aceerp_no:120,status:130,pipeline_status:130,our_side:130,purchase_price:100,offered_price:100,delivery_date:120,priority:100,remarks:200}),[ce,Se]=Z.useState(null),Pe=[{value:"urgent",label:"Urgent",icon:i.jsx(AF,{className:"w-3 h-3 text-red-600"})},{value:"high",label:"High",icon:i.jsx(Qw,{className:"w-3 h-3 text-orange-600"})},{value:"medium",label:"Medium",icon:i.jsx(kg,{className:"w-3 h-3 text-gray-400"})},{value:"low",label:"Low",icon:i.jsx(kg,{className:"w-3 h-3 text-gray-300"})}];Z.useEffect(()=>{fe()},[e,l,d]),Z.useEffect(()=>{function ee(se){we.current&&!we.current.contains(se.target)&&A(null)}return document.addEventListener("mousedown",ee),()=>document.removeEventListener("mousedown",ee)},[]),Z.useEffect(()=>{const ee=ne=>{if(!ce)return;const xe=ne.clientX-ce.startX,me=Math.max(50,ce.startWidth+xe);he(Ue=>({...Ue,[ce.column]:me}))},se=()=>{Se(null)};if(ce)return document.addEventListener("mousemove",ee),document.addEventListener("mouseup",se),()=>{document.removeEventListener("mousemove",ee),document.removeEventListener("mouseup",se)}},[ce]);const Le=(ee,se)=>{se.preventDefault(),se.stopPropagation(),Se({column:ee,startX:se.clientX,startWidth:Te[ee]||150})},Xe=({column:ee,label:se,sortable:ne=!0,className:xe=""})=>i.jsxs("th",{style:{width:Te[ee],minWidth:Te[ee]},className:`relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 ${ne?"cursor-pointer hover:bg-gray-100 select-none":""} ${xe}`,onClick:ne?()=>Ee(ee):void 0,children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"truncate",children:se}),ne&&qe(ee)]}),i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400 group",onMouseDown:me=>Le(ee,me),onClick:me=>me.stopPropagation(),children:i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full bg-transparent group-hover:bg-blue-400"})})]}),fe=()=>{let ee=[...e];l.forEach(se=>{se.values.length>0&&(ee=ee.filter(ne=>{const xe=ne[se.column];return se.values.includes(String(xe||""))}))}),d.column&&d.direction&&ee.sort((se,ne)=>{const xe=se[d.column],me=ne[d.column];if(xe==null&&me==null)return 0;if(xe==null)return d.direction==="asc"?1:-1;if(me==null)return d.direction==="asc"?-1:1;const Ue=String(xe).toLowerCase(),Me=String(me).toLowerCase();return d.direction==="asc"?Ue>Me?1:Ue<Me?-1:0:Ue<Me?1:Ue>Me?-1:0}),f(ee)},Ee=ee=>{let se="asc";d.column===ee&&(d.direction==="asc"?se="desc":d.direction==="desc"&&(se=null)),v({column:ee,direction:se})},qe=ee=>d.column!==ee?i.jsx(xN,{className:"w-3 h-3 text-gray-400"}):d.direction==="asc"?i.jsx(Qw,{className:"w-3 h-3 text-blue-600"}):d.direction==="desc"?i.jsx(Q7,{className:"w-3 h-3 text-blue-600"}):i.jsx(xN,{className:"w-3 h-3 text-gray-400"}),Qe=()=>{G(!0);try{const ee=h.map(me=>{var Ue,Me;return{"No.":me.inquiry_number,Date:new Date(me.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),Product:me.product_name,Specification:me.specification||"-",Qty:me.quantity,Supplier:me.supplier_name||"-",Country:me.supplier_country||"-",Company:me.company_name,"Mail Subject":me.mail_subject||"-","ACE ERP#":me.aceerp_no||"-",Pipeline:((Ue=Yp.find($e=>$e.value===me.pipeline_status))==null?void 0:Ue.label)||"-","Price Needed":me.price_required?"Yes":"No","COA Needed":me.coa_required?"Yes":"No","Sample Needed":me.sample_required?"Yes":"No","Agency Letter Needed":me.agency_letter_required?"Yes":"No","Others Needed":me.others_required?"Yes":"No","Price Sent":me.price_sent_at?"Yes":"No","COA Sent":me.coa_sent_at?"Yes":"No","Sample Sent":me.sample_sent_at?"Yes":"No","Agency Letter Sent":me.agency_letter_sent_at?"Yes":"No","Purchase Price":me.purchase_price?`${me.purchase_price} ${me.purchase_price_currency||"USD"}`:"-","Offered Price":me.offered_price?`${me.offered_price} ${me.offered_price_currency||"USD"}`:"-","Delivery Date":me.delivery_date?new Date(me.delivery_date).toLocaleDateString("en-GB"):"-","Delivery Terms":me.delivery_terms||"-",Priority:((Me=Pe.find($e=>$e.value===me.priority))==null?void 0:Me.label)||me.priority,Remarks:me.remarks||"-"}}),se=hs.json_to_sheet(ee);se["!cols"]=[{wch:15},{wch:12},{wch:30},{wch:20},{wch:10},{wch:20},{wch:12},{wch:25},{wch:30},{wch:12},{wch:15},{wch:13},{wch:12},{wch:15},{wch:20},{wch:12},{wch:11},{wch:13},{wch:19},{wch:18},{wch:18},{wch:15},{wch:18},{wch:10},{wch:30}];const ne=hs.book_new();hs.book_append_sheet(ne,se,"CRM Inquiries");const xe=`CRM-Inquiries-${new Date().toISOString().split("T")[0]}.xlsx`;Wg(ne,xe),alert(`Exported ${ee.length} inquiries to ${xe}`)}catch(ee){console.error("Export error:",ee),alert("Failed to export data. Please try again.")}finally{G(!1)}},Ye=()=>{G(!0);try{const ee=h.map(Me=>{var $e,Ge;return{"No.":Me.inquiry_number,Date:new Date(Me.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),Product:Me.product_name,Specification:Me.specification||"-",Qty:Me.quantity,Supplier:Me.supplier_name||"-",Country:Me.supplier_country||"-",Company:Me.company_name,"Mail Subject":Me.mail_subject||"-","ACE ERP#":Me.aceerp_no||"-",Pipeline:(($e=Yp.find(je=>je.value===Me.pipeline_status))==null?void 0:$e.label)||"-","Price Needed":Me.price_required?"Yes":"No","COA Needed":Me.coa_required?"Yes":"No","Sample Needed":Me.sample_required?"Yes":"No","Agency Letter Needed":Me.agency_letter_required?"Yes":"No","Others Needed":Me.others_required?"Yes":"No","Price Sent":Me.price_sent_at?"Yes":"No","COA Sent":Me.coa_sent_at?"Yes":"No","Sample Sent":Me.sample_sent_at?"Yes":"No","Agency Letter Sent":Me.agency_letter_sent_at?"Yes":"No","Purchase Price":Me.purchase_price?`${Me.purchase_price} ${Me.purchase_price_currency||"USD"}`:"-","Offered Price":Me.offered_price?`${Me.offered_price} ${Me.offered_price_currency||"USD"}`:"-","Delivery Date":Me.delivery_date?new Date(Me.delivery_date).toLocaleDateString("en-GB"):"-","Delivery Terms":Me.delivery_terms||"-",Priority:((Ge=Pe.find(je=>je.value===Me.priority))==null?void 0:Ge.label)||Me.priority,Remarks:Me.remarks||"-"}}),se=hs.json_to_sheet(ee),ne=hs.sheet_to_csv(se),xe=new Blob([ne],{type:"text/csv;charset=utf-8;"}),me=document.createElement("a"),Ue=URL.createObjectURL(xe);me.setAttribute("href",Ue),me.setAttribute("download",`CRM-Inquiries-${new Date().toISOString().split("T")[0]}.csv`),me.style.visibility="hidden",document.body.appendChild(me),me.click(),document.body.removeChild(me),alert(`Exported ${ee.length} inquiries to CSV. You can import this file to Google Sheets.`)}catch(ee){console.error("Export error:",ee),alert("Failed to export data. Please try again.")}finally{G(!1)}},Nt=()=>{const ee=[{Date:"02-12-2024",Product:"Example Product Name",Specification:"BP / USP / EP",Qty:"500 KG",Supplier:"Manufacturer Name",Country:"Japan",Company:"Customer Company Name","Mail Subject":"Inquiry for Product","ACE ERP#":"ACE-123","Price Needed":"Yes","COA Needed":"Yes","Sample Needed":"No","Agency Letter Needed":"No","Others Needed":"No","Purchase Price":"100","Purchase Price Currency":"USD","Offered Price":"150","Offered Price Currency":"USD","Delivery Date":"2025-12-31","Delivery Terms":"FOB Shanghai",Priority:"Medium",Remarks:"Additional notes"}],se=hs.json_to_sheet(ee),ne=hs.book_new();hs.book_append_sheet(ne,se,"Import Template"),Wg(ne,"CRM-Import-Template.xlsx"),alert("Template downloaded! Fill in your data and use the Import button to upload.")},xt=ee=>{var xe;const se=(xe=ee.target.files)==null?void 0:xe[0];if(!se)return;const ne=new FileReader;ne.onload=async me=>{var Ue;try{const Me=new Uint8Array((Ue=me.target)==null?void 0:Ue.result),$e=u2(Me,{type:"array"}),Ge=$e.Sheets[$e.SheetNames[0]],je=hs.sheet_to_json(Ge);if(je.length===0){alert("No data found in the file");return}const{data:{user:_e}}=await de.auth.getUser();if(!_e)throw new Error("Not authenticated");const He=tt=>{if(!tt)return new Date().toISOString().split("T")[0];if(typeof tt=="number"){const lr=new Date(1899,11,30),Wr=new Date(lr.getTime()+tt*864e5),Rr=Wr.getFullYear(),Di=(Wr.getMonth()+1).toString().padStart(2,"0"),mn=Wr.getDate().toString().padStart(2,"0");return`${Rr}-${Di}-${mn}`}const yt=tt.toString().trim(),zt=yt.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2})$/);if(zt){let[,lr,Wr,Rr]=zt;return`${parseInt(Rr)<30?`20${Rr}`:`19${Rr}`}-${Wr.padStart(2,"0")}-${lr.padStart(2,"0")}`}const $t=yt.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if($t){const[,lr,Wr,Rr]=$t;return`${Rr}-${Wr.padStart(2,"0")}-${lr.padStart(2,"0")}`}const _r=yt.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(_r){const[,lr,Wr,Rr]=_r;return`${Rr}-${Wr.padStart(2,"0")}-${lr.padStart(2,"0")}`}const _a=yt.match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);if(_a){const[,lr,Wr,Rr]=_a;return`${lr}-${Wr.padStart(2,"0")}-${Rr.padStart(2,"0")}`}return new Date().toISOString().split("T")[0]},Je=je.map(tt=>({product_name:tt.Product||"",specification:tt.Specification||null,quantity:tt.Qty||"",supplier_name:tt.Supplier||null,supplier_country:tt.Country||null,company_name:tt.Company||"",mail_subject:tt["Mail Subject"]||null,aceerp_no:tt["ACE ERP#"]||null,price_required:(tt["Price Needed"]||"").toLowerCase()==="yes",coa_required:(tt["COA Needed"]||"").toLowerCase()==="yes",sample_required:(tt["Sample Needed"]||"").toLowerCase()==="yes",agency_letter_required:(tt["Agency Letter Needed"]||"").toLowerCase()==="yes",others_required:(tt["Others Needed"]||"").toLowerCase()==="yes",purchase_price:tt["Purchase Price"]?parseFloat(tt["Purchase Price"]):null,purchase_price_currency:tt["Purchase Price Currency"]||"USD",offered_price:tt["Offered Price"]?parseFloat(tt["Offered Price"]):null,offered_price_currency:tt["Offered Price Currency"]||"USD",delivery_date:tt["Delivery Date"]||null,delivery_terms:tt["Delivery Terms"]||null,priority:(tt.Priority||"medium").toLowerCase(),remarks:tt.Remarks||null,inquiry_date:He(tt.Date),pipeline_status:"new",status:"new",inquiry_source:"other",assigned_to:_e.id,created_by:_e.id})),{error:st}=await de.from("crm_inquiries").insert(Je);if(st)throw st;alert(`Successfully imported ${Je.length} inquiries!`),t(),ee.target.value=""}catch(Me){console.error("Import error:",Me),alert("Failed to import data. Please check the file format and try again."),ee.target.value=""}},ne.readAsArrayBuffer(se)},it=(ee,se)=>{c(ne=>{const xe=ne.find(me=>me.column===ee);if(xe){const me=xe.values.includes(se)?xe.values.filter(Ue=>Ue!==se):[...xe.values,se];return me.length===0?ne.filter(Ue=>Ue.column!==ee):ne.map(Ue=>Ue.column===ee?{...Ue,values:me}:Ue)}return[...ne,{column:ee,values:[se]}]})},ut=ee=>{c(se=>se.filter(ne=>ne.column!==ee))},Mt=ee=>{const se=e.map(ne=>ne[ee]);return[...new Set(se)].filter(Boolean).sort()},ht=ee=>l.some(se=>se.column===ee&&se.values.length>0),Et=ee=>{o(se=>{const ne=new Set(se);return ne.has(ee)?ne.delete(ee):ne.add(ee),ne})},mt=()=>{s.size===h.length?o(new Set):o(new Set(h.map(ee=>ee.id)))},_t=async ee=>{const se=new Set(ae);if(se.has(ee))se.delete(ee);else if(se.add(ee),!De.has(ee))try{const{data:ne,error:xe}=await de.from("crm_inquiry_items").select("*").eq("parent_inquiry_id",ee).order("inquiry_number",{ascending:!0});if(xe)throw xe;const me=new Map(De);me.set(ee,ne||[]),pe(me)}catch(ne){console.error("Error fetching inquiry items:",ne)}Ie(se)},Ht=(ee,se)=>{r&&(y({id:ee.id,field:se}),m(String(ee[se]||"")))},bt=async()=>{if(g)try{const{error:ee}=await de.from("crm_inquiries").update({[g.field]:p||null}).eq("id",g.id);if(ee)throw ee;y(null),t()}catch(ee){console.error("Error updating field:",ee),alert("Failed to update. Please try again.")}},Ct=async(ee,se)=>{try{const{error:ne}=await de.from("crm_inquiries").update({priority:se}).eq("id",ee.id);if(ne)throw ne;t()}catch(ne){console.error("Error updating priority:",ne)}},or=async(ee,se)=>{if(se==="lost"){O(ee),C(!0);return}try{const{error:ne}=await de.from("crm_inquiries").update({pipeline_status:se}).eq("id",ee.id);if(ne)throw ne;t()}catch(ne){console.error("Error updating pipeline status:",ne)}},Ra=async(ee,se)=>{var me;const ne=`${se}_sent_at`;if(ee[ne]){if(!confirm(`Are you sure you want to unmark ${se.toUpperCase()} as sent?`))return;try{const Ue={[ne]:null},{error:Me}=await de.from("crm_inquiries").update(Ue).eq("id",ee.id);if(Me)throw Me;t(),alert(`${se.toUpperCase()} unmarked!`)}catch(Ue){console.error("Error unmarking requirement:",Ue),alert("Failed to unmark. Please try again.")}return}if(se==="price"){J(ee),z(((me=ee.offered_price)==null?void 0:me.toString())||""),P(!0);return}try{const{error:Ue}=await de.rpc("mark_requirement_sent",{inquiry_id:ee.id,requirement_type:se});if(Ue)throw Ue;t(),alert(`${se.toUpperCase()} marked as sent!`)}catch(Ue){console.error("Error marking requirement as sent:",Ue),alert("Failed to mark as sent. Please try again.")}},er=async()=>{if(!Q)return;const ee=te.trim()?parseFloat(te):null;try{const{error:se}=await de.from("crm_inquiries").update({offered_price:ee}).eq("id",Q.id);if(se)throw se;const{error:ne}=await de.rpc("mark_requirement_sent",{inquiry_id:Q.id,requirement_type:"price"});if(ne)throw ne;P(!1),J(null),z(""),t(),alert("Price marked as sent with offered price updated!")}catch(se){console.error("Error saving offered price and marking sent:",se),alert("Failed to save. Please try again.")}},on=()=>{const ee=h.find(se=>s.has(se.id));ee&&(B(ee),x(!0))},zn=async()=>{const ee=h.find(se=>s.has(se.id));ee&&(B(ee),x(!0))},Lt=()=>{k(!0)},Dn=async()=>{const ee=h.find(se=>s.has(se.id));if(ee)try{const{data:{user:se}}=await de.auth.getUser();if(!se)throw new Error("Not authenticated");await de.from("crm_activities").insert({inquiry_id:ee.id,activity_type:"call",description:E,activity_date:new Date().toISOString().split("T")[0],is_completed:!0,created_by:se.id}),k(!1),T(""),alert("Call logged successfully!"),t()}catch(se){console.error("Error logging call:",se),alert("Failed to log call. Please try again.")}},Xn=async()=>{if(s.size===0)return;const ee=s.size;if(confirm(`Are you sure you want to delete ${ee} selected ${ee===1?"inquiry":"inquiries"}? This action cannot be undone.`))try{const se=Array.from(s),{error:ne}=await de.from("crm_inquiries").delete().in("id",se);if(ne)throw ne;o(new Set),alert(`Successfully deleted ${ee} ${ee===1?"inquiry":"inquiries"}`),t()}catch(se){console.error("Error deleting inquiries:",se),alert("Failed to delete inquiries. Please try again.")}},Nn=()=>{j(!0)},da=async()=>{const ee=h.find(se=>s.has(se.id));if(ee)try{const{data:{user:se}}=await de.auth.getUser();if(!se)throw new Error("Not authenticated");await de.from("crm_activities").insert({inquiry_id:ee.id,activity_type:"follow_up",description:q,activity_date:new Date().toISOString().split("T")[0],follow_up_date:I,is_completed:!1,created_by:se.id}),j(!1),U(""),V(""),alert("Follow-up scheduled successfully!"),t()}catch(se){console.error("Error scheduling follow-up:",se),alert("Failed to schedule follow-up. Please try again.")}},Ar=()=>{const ee=h.find(se=>s.has(se.id));ee&&(be({price_required:ee.price_required??!1,coa_required:ee.coa_required??!1,sample_required:ee.sample_required??!1,agency_letter_required:ee.agency_letter_required??!1,others_required:ee.others_required??!1}),re(!0))},Br=async()=>{const ee=h.find(se=>s.has(se.id));if(ee)try{const{error:se}=await de.from("crm_inquiries").update(ke).eq("id",ee.id);if(se)throw se;re(!1),alert("Customer requirements updated successfully!"),t()}catch(se){console.error("Error updating requirements:",se),alert("Failed to update requirements. Please try again.")}},le=h.find(ee=>s.has(ee.id));return i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:Qe,disabled:M||h.length===0,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed",title:"Export to Excel (.xlsx)",children:[i.jsx(yN,{className:"w-3.5 h-3.5"}),M?"Exporting...":"Export Excel"]}),i.jsxs("button",{onClick:Ye,disabled:M||h.length===0,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed",title:"Export to CSV for Google Sheets",children:[i.jsx(Qo,{className:"w-3.5 h-3.5"}),M?"Exporting...":"Export CSV"]}),r&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-px h-8 bg-gray-300 mx-2"}),i.jsxs("button",{onClick:Nt,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",title:"Download Excel template for bulk import",children:[i.jsx(Qo,{className:"w-3.5 h-3.5"}),"Download Template"]}),i.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition cursor-pointer",children:[i.jsx(yN,{className:"w-3.5 h-3.5"}),"Import Excel",i.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:xt,className:"hidden"})]}),n&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-px h-8 bg-gray-300 mx-2"}),i.jsxs("button",{onClick:n,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[i.jsx(Wn,{className:"w-3.5 h-3.5"}),"Add Inquiry"]})]})]}),i.jsxs("div",{className:"text-sm text-gray-600 ml-2",children:[h.length," ",h.length===1?"inquiry":"inquiries",l.length>0&&" (filtered)",d.direction&&" (sorted)"]})]})}),s.size>0&&r&&le&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"flex items-center gap-3",children:i.jsxs("div",{className:"text-sm font-medium text-blue-900",children:["Selected: ",i.jsx("span",{className:"font-bold",children:le.inquiry_number})," - ",le.product_name]})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:on,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[i.jsx(Ii,{className:"w-3.5 h-3.5"}),"Send Price"]}),i.jsxs("button",{onClick:zn,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-green-700 bg-green-50 border border-green-200 rounded-md hover:bg-green-100 transition",children:[i.jsx(pr,{className:"w-3.5 h-3.5"}),"Send COA/MSDS"]}),i.jsxs("button",{onClick:Lt,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[i.jsx(kl,{className:"w-3.5 h-3.5"}),"Log Call"]}),i.jsxs("button",{onClick:Nn,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[i.jsx(as,{className:"w-3.5 h-3.5"}),"Schedule Follow-up"]}),i.jsxs("button",{onClick:()=>W(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[i.jsx(Xh,{className:"w-3.5 h-3.5"}),"Create Task"]}),i.jsxs("button",{onClick:Ar,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-purple-700 bg-purple-50 border border-purple-200 rounded-md hover:bg-purple-100 transition",title:"Edit Customer Requirements",children:[i.jsx(Xh,{className:"w-3.5 h-3.5"}),"Edit Requirements"]}),i.jsxs("button",{onClick:Xn,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100 transition",title:"Delete Selected",children:[i.jsx(An,{className:"w-3.5 h-3.5"}),"Delete"]}),i.jsx("button",{onClick:()=>o(new Set),className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition",title:"Deselect",children:i.jsx(An,{className:"w-3.5 h-3.5"})})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden border border-gray-200",children:i.jsx("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"calc(100vh - 280px)"},children:i.jsxs("table",{className:"w-full text-sm border-collapse",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{className:"border-b border-gray-300",children:[i.jsx("th",{className:"px-3 py-2 border-r border-gray-300",children:i.jsx("input",{type:"checkbox",checked:s.size===h.length&&h.length>0,onChange:mt,className:"rounded border-gray-300"})}),i.jsx(Xe,{column:"inquiry_number",label:"No.",className:"whitespace-nowrap"}),i.jsx(Xe,{column:"inquiry_date",label:"Date",className:"whitespace-nowrap"}),i.jsx(Xe,{column:"product_name",label:"Product"}),i.jsx(Xe,{column:"specification",label:"Specification"}),i.jsx(Xe,{column:"quantity",label:"Qty"}),i.jsx(Xe,{column:"supplier_name",label:"Supplier"}),i.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 min-w-[150px] relative",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{children:"Company"}),i.jsx("button",{onClick:()=>A(u==="company_name"?null:"company_name"),className:`p-0.5 rounded hover:bg-gray-200 ${ht("company_name")?"text-blue-600":""}`,children:i.jsx(To,{className:"w-4 h-4"})})]}),u==="company_name"&&i.jsxs("div",{ref:we,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-64",children:[i.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs font-medium",children:"Filter Company"}),ht("company_name")&&i.jsx("button",{onClick:()=>ut("company_name"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),i.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Mt("company_name").map(ee=>{var ne;const se=(ne=l.find(xe=>xe.column==="company_name"))==null?void 0:ne.values.includes(String(ee));return i.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:se,onChange:()=>it("company_name",String(ee)),className:"rounded border-gray-300"}),i.jsx("span",{className:"text-sm",children:String(ee)})]},String(ee))})})]})]}),i.jsx(Xe,{column:"mail_subject",label:"Mail Subject"}),i.jsx(Xe,{column:"aceerp_no",label:"ACE ERP#"}),i.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 relative min-w-[130px]",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{children:"Pipeline"}),i.jsx("button",{onClick:()=>A(u==="pipeline_status"?null:"pipeline_status"),className:`p-0.5 rounded hover:bg-gray-200 ${ht("pipeline_status")?"text-blue-600":""}`,children:i.jsx(To,{className:"w-4 h-4"})})]}),u==="pipeline_status"&&i.jsxs("div",{ref:we,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-56",children:[i.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs font-medium",children:"Filter Pipeline"}),ht("pipeline_status")&&i.jsx("button",{onClick:()=>ut("pipeline_status"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),i.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Yp.map(ee=>{var ne;const se=(ne=l.find(xe=>xe.column==="pipeline_status"))==null?void 0:ne.values.includes(ee.value);return i.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:se,onChange:()=>it("pipeline_status",ee.value),className:"rounded border-gray-300"}),i.jsx("span",{className:"text-sm",children:ee.label})]},ee.value)})})]})]}),i.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 min-w-[120px] relative",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{children:"Our Side"}),i.jsx("button",{onClick:()=>A(u==="our_side"?null:"our_side"),className:`p-0.5 rounded hover:bg-gray-200 ${ht("our_side")?"text-blue-600":""}`,children:i.jsx(To,{className:"w-4 h-4"})})]}),u==="our_side"&&i.jsxs("div",{ref:we,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-56",children:[i.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs font-medium",children:"Filter Our Side"}),ht("our_side")&&i.jsx("button",{onClick:()=>ut("our_side"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),i.jsxs("div",{className:"p-2 space-y-1",children:[i.jsxs("button",{onClick:()=>{const ee=e.filter(se=>(se.price_required??!0)&&!se.price_sent_at);f(ee),A(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-red-50 rounded text-left text-sm",children:[i.jsx("span",{className:"w-5 h-5 rounded bg-red-100 text-red-700 flex items-center justify-center font-bold text-xs",children:"P"}),i.jsx("span",{children:"Price Pending"})]}),i.jsxs("button",{onClick:()=>{const ee=e.filter(se=>(se.coa_required??!0)&&!se.coa_sent_at);f(ee),A(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-red-50 rounded text-left text-sm",children:[i.jsx("span",{className:"w-5 h-5 rounded bg-red-100 text-red-700 flex items-center justify-center font-bold text-xs",children:"C"}),i.jsx("span",{children:"COA Pending"})]}),i.jsxs("button",{onClick:()=>{const ee=e.filter(se=>(se.price_required??!0)&&se.price_sent_at);f(ee),A(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-green-50 rounded text-left text-sm",children:[i.jsx("span",{className:"w-5 h-5 rounded bg-green-100 text-green-700 flex items-center justify-center font-bold text-xs",children:"P"}),i.jsx("span",{children:"Price Sent"})]}),i.jsxs("button",{onClick:()=>{const ee=e.filter(se=>(se.coa_required??!0)&&se.coa_sent_at);f(ee),A(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-green-50 rounded text-left text-sm",children:[i.jsx("span",{className:"w-5 h-5 rounded bg-green-100 text-green-700 flex items-center justify-center font-bold text-xs",children:"C"}),i.jsx("span",{children:"COA Sent"})]})]})]})]}),(a==null?void 0:a.role)==="admin"&&i.jsxs("th",{style:{width:Te.purchase_price,minWidth:Te.purchase_price},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[i.jsx("span",{children:"P.Price"}),i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:ee=>Le("purchase_price",ee)})]}),i.jsxs("th",{style:{width:Te.offered_price,minWidth:Te.offered_price},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[i.jsx("span",{children:"O.Price"}),i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:ee=>Le("offered_price",ee)})]}),i.jsxs("th",{style:{width:Te.delivery_date,minWidth:Te.delivery_date},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[i.jsx("span",{children:"Delivery"}),i.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:ee=>Le("delivery_date",ee)})]}),i.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 relative",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("span",{children:"Priority"}),i.jsx("button",{onClick:()=>A(u==="priority"?null:"priority"),className:`p-0.5 rounded hover:bg-gray-200 ${ht("priority")?"text-blue-600":""}`,children:i.jsx(To,{className:"w-4 h-4"})})]}),u==="priority"&&i.jsxs("div",{ref:we,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-48",children:[i.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"text-xs font-medium",children:"Filter Priority"}),ht("priority")&&i.jsx("button",{onClick:()=>ut("priority"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),i.jsx("div",{className:"p-2",children:Pe.map(ee=>{var ne;const se=(ne=l.find(xe=>xe.column==="priority"))==null?void 0:ne.values.includes(ee.value);return i.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:se,onChange:()=>it("priority",ee.value),className:"rounded border-gray-300"}),ee.icon,i.jsx("span",{className:"text-sm",children:ee.label})]},ee.value)})})]})]}),i.jsx(Xe,{column:"remarks",label:"Remarks"})]})}),i.jsx("tbody",{children:h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:18,className:"px-3 py-8 text-center text-gray-500",children:"No inquiries found"})}):h.map(ee=>{var se;return i.jsxs(eO.Fragment,{children:[i.jsxs("tr",{className:`border-b border-gray-200 hover:bg-blue-50 transition ${s.has(ee.id)?"bg-blue-100":""}`,children:[i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("input",{type:"checkbox",checked:s.has(ee.id),onChange:()=>Et(ee.id),className:"rounded border-gray-300"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 font-medium text-blue-600",children:i.jsxs("div",{className:"flex items-center gap-1",children:[ee.has_items&&i.jsx("button",{onClick:()=>_t(ee.id),className:"hover:bg-blue-100 rounded p-0.5 transition",title:ae.has(ee.id)?"Collapse products":"Expand products",children:ae.has(ee.id)?i.jsx(To,{className:"w-4 h-4"}):i.jsx(ld,{className:"w-4 h-4"})}),ee.is_multi_product&&i.jsx(pF,{className:"w-3.5 h-3.5 text-blue-500",title:"Multi-product inquiry"}),i.jsx("span",{children:ee.inquiry_number})]})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-gray-600 whitespace-nowrap",children:new Date(ee.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="product_name"?i.jsx("input",{type:"text",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>Ht(ee,"product_name"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:ee.product_name})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-gray-600 text-xs",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="specification"?i.jsx("input",{type:"text",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>Ht(ee,"specification"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:ee.specification||"-"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="quantity"?i.jsx("input",{type:"text",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>Ht(ee,"quantity"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:ee.quantity})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="supplier_name"?i.jsx("input",{type:"text",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsxs("div",{onDoubleClick:()=>Ht(ee,"supplier_name"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:[i.jsx("div",{children:ee.supplier_name||"-"}),ee.supplier_country&&i.jsx("div",{className:"text-xs text-gray-500",children:ee.supplier_country})]})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("div",{className:"font-medium",children:ee.company_name})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="mail_subject"?i.jsx("input",{type:"text",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>Ht(ee,"mail_subject"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs",title:ee.mail_subject||"",children:ee.mail_subject?i.jsx("div",{className:"line-clamp-2",children:ee.mail_subject}):i.jsx("span",{className:"text-gray-400",children:"-"})})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="aceerp_no"?i.jsx("input",{type:"text",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>r&&Ht(ee,"aceerp_no"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded":"px-2 py-1",children:ee.aceerp_no||(r?i.jsx("span",{className:"text-gray-400 text-xs",children:"Click to add"}):"-")})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("select",{value:ee.pipeline_status||"new",onChange:ne=>or(ee,ne.target.value),disabled:!r,className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:border-blue-500 focus:outline-none cursor-pointer bg-white",children:Yp.map(ne=>i.jsx("option",{value:ne.value,children:ne.label},ne.value))})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("div",{className:"flex items-center justify-center",children:i.jsx(Ene,{inquiry:ee,onMarkSent:r?ne=>Ra(ee,ne):void 0})})}),(a==null?void 0:a.role)==="admin"&&i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="purchase_price"?i.jsx("input",{type:"text",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0,placeholder:"Click to add"}):i.jsx("div",{onDoubleClick:()=>Ht(ee,"purchase_price"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs",children:ee.purchase_price?`$${ee.purchase_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:i.jsx("span",{className:"text-gray-400",children:"Click to add"})})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="offered_price"?i.jsx("input",{type:"text",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0,placeholder:"Click to add"}):i.jsx("div",{onDoubleClick:()=>r&&Ht(ee,"offered_price"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs":"px-2 py-1 text-xs",children:ee.offered_price?`$${ee.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:r?i.jsx("span",{className:"text-gray-400",children:"Click to add"}):"-"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="delivery_date"?i.jsx("input",{type:"date",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>r&&Ht(ee,"delivery_date"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs whitespace-nowrap":"px-2 py-1 text-xs whitespace-nowrap",children:ee.delivery_date?new Date(ee.delivery_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):r?i.jsx("span",{className:"text-gray-400",children:"Click to add"}):"-"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx("select",{value:ee.priority,onChange:ne=>Ct(ee,ne.target.value),disabled:!r,className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:border-blue-500 focus:outline-none cursor-pointer",children:Pe.map(ne=>i.jsx("option",{value:ne.value,children:ne.label},ne.value))})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(g==null?void 0:g.id)===ee.id&&(g==null?void 0:g.field)==="remarks"?i.jsx("input",{type:"text",value:p,onChange:ne=>m(ne.target.value),onBlur:bt,onKeyDown:ne=>{ne.key==="Enter"&&bt(),ne.key==="Escape"&&y(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):i.jsx("div",{onDoubleClick:()=>Ht(ee,"remarks"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-gray-600",children:ee.remarks||"-"})})]}),ee.has_items&&ae.has(ee.id)&&((se=De.get(ee.id))==null?void 0:se.map(ne=>i.jsxs("tr",{className:"bg-blue-50 border-b border-blue-100",children:[i.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-sm text-blue-700 pl-8",children:ne.inquiry_number}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-sm",children:ne.product_name}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-600",children:ne.specification||"-"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-sm",children:ne.quantity}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:i.jsx(tI,{status:ne.pipeline_stage})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-center",children:ne.document_sent?i.jsxs("div",{className:"flex items-center justify-center gap-1",children:[i.jsx(V7,{className:"w-4 h-4 text-green-600"}),i.jsx("span",{className:"text-xs text-gray-500",children:ne.document_sent_at?new Date(ne.document_sent_at).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}):""})]}):i.jsx(Pa,{className:"w-4 h-4 text-gray-400 mx-auto"})}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-600",children:ne.notes||"-"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),i.jsx("td",{className:"px-3 py-2 border-r border-gray-200"})]},ne.id)))]},ee.id)})})]})})}),w&&b&&i.jsx(Cne,{isOpen:w,onClose:()=>{x(!1),B(null),t()},inquiry:b}),i.jsx(ir,{isOpen:_,onClose:()=>{k(!1),T("")},title:"Log Phone Call",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Call Notes *"}),i.jsx("textarea",{value:E,onChange:ee=>T(ee.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"What was discussed during the call?",required:!0})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>{k(!1),T("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:Dn,disabled:!E.trim(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:"Save Call Log"})]})]})}),i.jsx(ir,{isOpen:S,onClose:()=>{j(!1),U(""),V("")},title:"Schedule Follow-up",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Date *"}),i.jsx("input",{type:"date",value:I,onChange:ee=>U(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:q,onChange:ee=>V(ee.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"What needs to be followed up?"})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>{j(!1),U(""),V("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:da,disabled:!I,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50",children:"Schedule Follow-up"})]})]})}),X&&le&&i.jsx(eI,{isOpen:X,onClose:()=>W(!1),onSuccess:()=>{W(!1),t()},initialData:{inquiry_id:le.id}}),L&&i.jsx(kne,{isOpen:H,onClose:()=>{C(!1),O(null)},inquiryId:L.id,inquiryNumber:L.inquiry_number,onSuccess:()=>{t(),O(null)}}),i.jsx(ir,{isOpen:D,onClose:()=>{P(!1),J(null),z("")},title:"Enter Offered Price",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Inquiry: ",(Q==null?void 0:Q.inquiry_number)||"-"]}),i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Product: ",(Q==null?void 0:Q.product_name)||"-"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Offered Price (O.Price) *"}),i.jsx("input",{type:"number",value:te,onChange:ee=>z(ee.target.value),placeholder:"Enter offered price",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the price you offered to the customer"})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[i.jsx("button",{onClick:()=>{P(!1),J(null),z("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),i.jsx("button",{onClick:er,className:"px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Save & Mark Price as Sent"})]})]})}),i.jsx(ir,{isOpen:ye,onClose:()=>re(!1),title:"Edit Customer Requirements",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Check what the customer has requested:"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:ke.price_required,onChange:ee=>be({...ke,price_required:ee.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Price"})]}),i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:ke.coa_required,onChange:ee=>be({...ke,coa_required:ee.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"COA"})]}),i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:ke.sample_required,onChange:ee=>be({...ke,sample_required:ee.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sample"})]}),i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:ke.agency_letter_required,onChange:ee=>be({...ke,agency_letter_required:ee.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Agency Letter"})]}),i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:ke.others_required,onChange:ee=>be({...ke,others_required:ee.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Others"})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-6 pt-4 border-t",children:[i.jsx("button",{onClick:()=>re(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{onClick:Br,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition",children:"Save Requirements"})]})]})})]})}function Fne({onReminderCreated:e}){const[t,r]=Z.useState([]),[n,a]=Z.useState(new Date),[s,o]=Z.useState(null),[l,c]=Z.useState("month"),[u,A]=Z.useState(!0),[h,f]=Z.useState(!1),[d,v]=Z.useState(null);Z.useEffect(()=>{g()},[n,l]);const g=async()=>{try{let I=de.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `);if(l==="month"){const V=new Date(n.getFullYear(),n.getMonth(),1),X=new Date(n.getFullYear(),n.getMonth()+1,0);I=I.gte("due_date",V.toISOString()).lte("due_date",X.toISOString())}const{data:U,error:q}=await I.order("due_date",{ascending:!0});if(q)throw q;r(U||[])}catch(I){console.error("Error loading reminders:",I)}finally{A(!1)}},y=async I=>{try{const{error:U}=await de.from("crm_reminders").update({is_completed:!I.is_completed,completed_at:I.is_completed?null:new Date().toISOString()}).eq("id",I.id);if(U)throw U;g()}catch(U){console.error("Error updating reminder:",U)}},p=async(I,U)=>{try{const q=new Date(I.due_date);q.setDate(q.getDate()+U);const{error:V}=await de.from("crm_reminders").update({due_date:q.toISOString()}).eq("id",I.id);if(V)throw V;g(),f(!1)}catch(q){console.error("Error snoozing reminder:",q)}},m=I=>new Date(I.getFullYear(),I.getMonth()+1,0).getDate(),w=I=>new Date(I.getFullYear(),I.getMonth(),1).getDay(),x=I=>t.filter(U=>{const q=new Date(U.due_date);return q.getDate()===I.getDate()&&q.getMonth()===I.getMonth()&&q.getFullYear()===I.getFullYear()}),b=()=>{const I=new Date;return I.setHours(0,0,0,0),t.filter(U=>{const q=new Date(U.due_date);return q.setHours(0,0,0,0),q.getTime()===I.getTime()&&!U.is_completed})},B=()=>{const I=new Date;return I.setHours(0,0,0,0),t.filter(U=>{const q=new Date(U.due_date);return q.setHours(0,0,0,0),q<I&&!U.is_completed})},_=()=>{const I=new Date;I.setHours(0,0,0,0);const U=new Date(I);return U.setDate(U.getDate()+7),t.filter(q=>{const V=new Date(q.due_date);return V.setHours(0,0,0,0),V>I&&V<=U&&!q.is_completed})},k=()=>{a(new Date(n.getFullYear(),n.getMonth()-1))},E=()=>{a(new Date(n.getFullYear(),n.getMonth()+1))},T={follow_up:"bg-blue-100 text-blue-800 border-blue-200",send_coa:"bg-orange-100 text-orange-800 border-orange-200",send_sample:"bg-green-100 text-green-800 border-green-200",send_price:"bg-purple-100 text-purple-800 border-purple-200",custom:"bg-gray-100 text-gray-800 border-gray-200"},S=()=>{const I=m(n),U=w(n),q=[];for(let V=0;V<U;V++)q.push(i.jsx("div",{className:"min-h-24 p-2 bg-gray-50"},`empty-${V}`));for(let V=1;V<=I;V++){const X=new Date(n.getFullYear(),n.getMonth(),V),W=x(X),M=X.toDateString()===new Date().toDateString();q.push(i.jsxs("div",{className:`min-h-24 p-2 border border-gray-200 ${M?"bg-blue-50":"bg-white"} hover:bg-gray-50 transition cursor-pointer`,onClick:()=>{o(X),W.length>0&&(v(W[0]),f(!0))},children:[i.jsx("div",{className:`text-sm font-medium mb-1 ${M?"text-blue-600":"text-gray-900"}`,children:V}),i.jsxs("div",{className:"space-y-1",children:[W.slice(0,3).map(G=>i.jsx("div",{className:`text-xs p-1 rounded border ${T[G.reminder_type]} truncate ${G.is_completed?"opacity-50 line-through":""}`,title:G.title,children:G.title},G.id)),W.length>3&&i.jsxs("div",{className:"text-xs text-gray-500 font-medium",children:["+",W.length-3," more"]})]})]},V))}return q},j=()=>{const I=B(),U=b(),q=_();return i.jsxs("div",{className:"space-y-6",children:[I.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-red-600 mb-2 flex items-center gap-2",children:[i.jsx(ya,{className:"w-4 h-4"}),"Overdue (",I.length,")"]}),i.jsx("div",{className:"space-y-2",children:I.map(V=>i.jsx(Kv,{reminder:V,onToggleComplete:y,onViewDetails:()=>{v(V),f(!0)}},V.id))})]}),U.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-blue-600 mb-2 flex items-center gap-2",children:[i.jsx(ts,{className:"w-4 h-4"}),"Today (",U.length,")"]}),i.jsx("div",{className:"space-y-2",children:U.map(V=>i.jsx(Kv,{reminder:V,onToggleComplete:y,onViewDetails:()=>{v(V),f(!0)}},V.id))})]}),q.length>0&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Upcoming (Next 7 days)"}),i.jsx("div",{className:"space-y-2",children:q.map(V=>i.jsx(Kv,{reminder:V,onToggleComplete:y,onViewDetails:()=>{v(V),f(!0)}},V.id))})]}),I.length===0&&U.length===0&&q.length===0&&i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(ts,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.length===0?i.jsx("p",{children:"No reminders found. Create one using the quick actions!"}):i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:"No upcoming reminders in the next 7 days"}),i.jsxs("p",{className:"text-sm mt-1",children:["You have ",t.length," reminder",t.length===1?"":"s"," total (all past or completed)"]})]})]})]})};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(as,{className:"w-5 h-5 text-blue-600"}),"Reminders & Tasks"]}),i.jsxs("div",{className:"flex gap-1 bg-gray-100 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>c("month"),className:`px-3 py-1 rounded text-sm ${l==="month"?"bg-white shadow":"text-gray-600"}`,children:"Month"}),i.jsx("button",{onClick:()=>c("list"),className:`px-3 py-1 rounded text-sm ${l==="list"?"bg-white shadow":"text-gray-600"}`,children:"List"})]})]}),l==="month"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:k,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:i.jsx(G7,{className:"w-5 h-5"})}),i.jsx("span",{className:"font-semibold min-w-40 text-center",children:n.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),i.jsx("button",{onClick:E,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:i.jsx(ld,{className:"w-5 h-5"})})]})]}),u?i.jsx("div",{className:"flex justify-center items-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l==="month"?i.jsxs("div",{className:"space-y-2",children:[t.length===0&&i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800",children:[i.jsxs("p",{className:"font-medium",children:["No reminders for ",n.toLocaleDateString("en-US",{month:"long",year:"numeric"})]}),i.jsx("p",{className:"text-xs mt-1",children:'Use the arrows above to navigate to other months, or switch to "List" view to see all reminders.'})]}),t.length>0&&i.jsxs("div",{className:"text-sm text-gray-600 px-2",children:[t.length," reminder",t.length===1?"":"s"," in ",n.toLocaleDateString("en-US",{month:"long"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(I=>i.jsx("div",{className:"p-2 text-center text-sm font-semibold text-gray-700 bg-gray-50",children:I},I))}),i.jsx("div",{className:"grid grid-cols-7",children:S()})]})]}):i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:j()}),i.jsx(ir,{isOpen:h,onClose:()=>{f(!1),v(null)},title:"Reminder Details",children:d&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:`p-3 rounded-lg border ${T[d.reminder_type]}`,children:[i.jsx("p",{className:"font-semibold",children:d.title}),i.jsxs("p",{className:"text-sm mt-1",children:["Due: ",new Date(d.due_date).toLocaleDateString()]})]}),d.description&&i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d.description})]}),d.crm_inquiries&&i.jsxs("div",{className:"border-t pt-4",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Related Inquiry"}),i.jsxs("div",{className:"mt-2 bg-gray-50 p-3 rounded-lg",children:[i.jsxs("p",{className:"text-sm font-medium",children:["#",d.crm_inquiries.inquiry_number]}),i.jsx("p",{className:"text-sm text-gray-600",children:d.crm_inquiries.company_name}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d.crm_inquiries.product_name})]})]}),i.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>p(d,1),className:"text-sm px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Snooze 1 day"}),i.jsx("button",{onClick:()=>p(d,3),className:"text-sm px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Snooze 3 days"})]}),i.jsxs("button",{onClick:()=>{y(d),f(!1)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[i.jsx(ua,{className:"w-4 h-4"}),d.is_completed?"Mark Incomplete":"Mark Complete"]})]})]})})]})}function Kv({reminder:e,onToggleComplete:t,onViewDetails:r}){const n={follow_up:"border-blue-200",send_coa:"border-orange-200",send_sample:"border-green-200",send_price:"border-purple-200",custom:"border-gray-200"},a=new Date(e.due_date)<new Date&&!e.is_completed;return i.jsx("div",{className:`p-3 border-l-4 ${n[e.reminder_type]} bg-white rounded-lg shadow-sm hover:shadow-md transition ${e.is_completed?"opacity-60":""}`,children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1 cursor-pointer",onClick:r,children:[i.jsx("p",{className:`font-medium ${e.is_completed?"line-through":""}`,children:e.title}),e.crm_inquiries&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["#",e.crm_inquiries.inquiry_number," - ",e.crm_inquiries.company_name]}),i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx("span",{className:`text-xs ${a?"text-red-600 font-medium":"text-gray-500"}`,children:new Date(e.due_date).toLocaleDateString()}),a&&i.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-0.5 rounded-full",children:"Overdue"})]})]}),i.jsx("button",{onClick:()=>t(e),className:`p-1 rounded ${e.is_completed?"text-green-600":"text-gray-400 hover:text-green-600"}`,children:i.jsx(ua,{className:"w-5 h-5"})})]})})}function Tne({canManage:e,onInquiryClick:t}){const[r,n]=Z.useState([]),[a,s]=Z.useState([]),[o,l]=Z.useState(!0),[c,u]=Z.useState(null),[A,h]=Z.useState(null);Z.useEffect(()=>{f(),d()},[]);const f=async()=>{try{u(null);const{data:b,error:B}=await de.from("crm_pipeline_stages").select("*").eq("is_active",!0).order("stage_order",{ascending:!0});if(B)throw console.error("Database error loading stages:",B),new Error(B.message||"Failed to load pipeline stages");s(b||[])}catch(b){const B=b instanceof Error?b.message:"Failed to load pipeline stages";console.error("Error loading stages:",b),u(B),s([])}},d=async()=>{try{u(null);const{data:b,error:B}=await de.from("crm_inquiries").select("*").order("created_at",{ascending:!1});if(B)throw console.error("Database error loading inquiries:",B),new Error(B.message||"Failed to load inquiries");n(b||[])}catch(b){const B=b instanceof Error?b.message:"Failed to load inquiries";console.error("Error loading inquiries:",b),u(B),n([])}finally{l(!1)}},v={"New Inquiry":"new","Price Quoted":"price_quoted","COA Pending":"coa_pending","Sample Sent":"sample_sent",Negotiation:"negotiation","PO Received":"po_received",Won:"won",Lost:"lost"},g=b=>{const B=v[b];return r.filter(_=>_.status===B)},y=b=>{e&&h(b)},p=b=>{b.preventDefault()},m=async b=>{if(!A||!e)return;const B=v[b];if(A.status===B){h(null);return}try{const{error:_}=await de.from("crm_inquiries").update({status:B}).eq("id",A.id);if(_)throw _;d()}catch(_){console.error("Error updating inquiry status:",_),alert("Failed to update inquiry status")}finally{h(null)}},w=b=>{const B=new Date(b.created_at),k=Math.abs(new Date().getTime()-B.getTime());return Math.ceil(k/(1e3*60*60*24))},x={urgent:"border-l-4 border-red-500",high:"border-l-4 border-orange-500",medium:"border-l-4 border-yellow-500",low:"border-l-4 border-gray-400"};return o?i.jsx("div",{className:"flex justify-center items-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c?i.jsx("div",{className:"space-y-4",children:i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"text-red-600 mt-0.5",children:i.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm font-medium text-red-900",children:"Error Loading Pipeline"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:c}),i.jsx("button",{onClick:()=>{f(),d()},className:"mt-3 text-sm font-medium text-red-700 hover:text-red-800 underline",children:"Try Again"})]})]})})}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Pipeline View"}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",r.length," inquiries"]})]}),i.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:a.map(b=>{const B=g(b.stage_name),_=B.reduce((k,E)=>k+(E.estimated_value||0),0);return i.jsxs("div",{className:"flex-shrink-0 w-80 bg-gray-50 rounded-lg",onDragOver:p,onDrop:()=>m(b.stage_name),children:[i.jsxs("div",{className:"p-4 rounded-t-lg",style:{backgroundColor:b.color+"20"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:b.stage_name}),i.jsx("span",{className:"text-sm font-medium text-gray-600",children:B.length})]}),_>0&&i.jsxs("div",{className:"text-xs text-gray-600",children:["Value: Rp ",_.toLocaleString("id-ID")]})]}),i.jsx("div",{className:"p-2 space-y-2 max-h-[600px] overflow-y-auto",children:B.length===0?i.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No inquiries"}):B.map(k=>i.jsxs("div",{draggable:e,onDragStart:()=>y(k),onClick:()=>t&&t(k),className:`bg-white rounded-lg p-3 shadow-sm hover:shadow-md transition cursor-pointer ${x[k.priority]||""} ${e?"cursor-move":""}`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsxs("span",{className:"text-xs font-semibold text-blue-600",children:["#",k.inquiry_number]}),i.jsxs("span",{className:"text-xs text-gray-500",children:[w(k),"d"]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(K7,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-2",children:k.company_name})]}),i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(si,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:k.product_name})]}),i.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[i.jsx("span",{children:k.quantity}),i.jsx("span",{children:new Date(k.inquiry_date).toLocaleDateString("en-GB")})]}),k.priority==="urgent"&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[i.jsx(ya,{className:"w-3 h-3"}),i.jsx("span",{className:"font-medium",children:"URGENT"})]}),k.estimated_value&&k.estimated_value>0&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 font-medium",children:[i.jsx(Ro,{className:"w-3 h-3"}),i.jsxs("span",{children:["Rp ",k.estimated_value.toLocaleString("id-ID")]})]})]})]},k.id))})]},b.id)})}),!e&&i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[i.jsx(ya,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-sm text-yellow-800",children:"You have view-only access to the pipeline. Contact admin to manage inquiries."})]})]})}function Ine({inquiry:e,onClose:t,onSent:r}){const[n,a]=Z.useState([]),[s,o]=Z.useState(null),[l,c]=Z.useState(""),[u,A]=Z.useState(""),[h,f]=Z.useState(""),[d,v]=Z.useState(!1),[g,y]=Z.useState(!1);Z.useEffect(()=>{p(),e&&c(e.contact_email||"")},[e]);const p=async()=>{try{const{data:x,error:b}=await de.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(b)throw b;a(x||[])}catch(x){console.error("Error loading templates:",x)}},m=x=>{let b=x.subject,B=x.body;e&&(b=b.replace(/\{\{company_name\}\}/g,e.company_name).replace(/\{\{contact_person\}\}/g,e.contact_person||"").replace(/\{\{product\}\}/g,e.product_name).replace(/\{\{quantity\}\}/g,e.quantity).replace(/\{\{inquiry_number\}\}/g,e.inquiry_number),B=B.replace(/\{\{company_name\}\}/g,e.company_name).replace(/\{\{contact_person\}\}/g,e.contact_person||"Sir/Madam").replace(/\{\{product\}\}/g,e.product_name).replace(/\{\{quantity\}\}/g,e.quantity).replace(/\{\{inquiry_number\}\}/g,e.inquiry_number)),A(b),f(B),o(x),y(!1)},w=async()=>{if(!l||!u||!h){alert("Please fill in all required fields");return}v(!0);try{const{data:{user:x}}=await de.auth.getUser();if(!x)throw new Error("Not authenticated");const b=l.split(";").map(k=>k.trim()).filter(k=>k.length>0),B={inquiry_id:(e==null?void 0:e.id)||null,contact_id:null,email_type:"sent",from_email:x.email,to_email:b,subject:u,body:h,template_id:(s==null?void 0:s.id)||null,sent_date:new Date().toISOString(),created_by:x.id},{error:_}=await de.from("crm_email_activities").insert([B]);if(_)throw _;s&&await de.from("crm_email_templates").update({use_count:s.use_count+1,last_used:new Date().toISOString()}).eq("id",s.id),alert("Email logged successfully! Note: Actual email sending requires SMTP configuration."),r&&r(),t&&t()}catch(x){console.error("Error sending email:",x),alert("Failed to send email. Please try again.")}finally{v(!1)}};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(la,{className:"w-5 h-5 text-blue-600"}),"Compose Email"]}),i.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition",children:[i.jsx(pr,{className:"w-4 h-4"}),"Use Template"]})]}),e&&i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[i.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Inquiry #",e.inquiry_number," - ",e.company_name]}),i.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:[e.product_name," - ",e.quantity]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To *"}),i.jsx("input",{type:"text",value:l,onChange:x=>c(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"recipient@example.com; recipient2@example.com",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l.includes(";")?`Sending to ${l.split(";").filter(x=>x.trim()).length} email addresses`:"Separate multiple emails with semicolon (;)"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:u,onChange:x=>A(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Email subject",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message *"}),i.jsx("textarea",{value:h,onChange:x=>f(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:12,placeholder:"Type your message here...",required:!0})]}),i.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[i.jsx("div",{className:"flex gap-2",children:i.jsxs("button",{type:"button",className:"flex items-center gap-2 px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",disabled:!0,children:[i.jsx(ki,{className:"w-4 h-4"}),"Attach Files (Coming Soon)"]})}),i.jsxs("div",{className:"flex gap-2",children:[t&&i.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{onClick:w,disabled:d||!l||!u||!h,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:d?i.jsxs(i.Fragment,{children:[i.jsx(Do,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ii,{className:"w-4 h-4"}),"Send Email"]})})]})]}),i.jsx(ir,{isOpen:g,onClose:()=>y(!1),title:"Email Templates",children:i.jsx("div",{className:"space-y-2",children:n.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(pr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),i.jsx("p",{children:"No templates available"}),i.jsx("p",{className:"text-sm mt-1",children:"Contact admin to create email templates"})]}):n.map(x=>i.jsxs("div",{onClick:()=>m(x),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition",children:[i.jsx("div",{className:"flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-900",children:x.template_name}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:x.subject}),x.category&&i.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:x.category})]})}),x.variables&&x.variables.length>0&&i.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:i.jsxs("p",{className:"text-xs text-gray-500",children:["Variables: ",x.variables.join(", ")]})})]},x.id))})})]})}function Lne({selectedCustomers:e,onClose:t,onComplete:r}){var I;const[n,a]=Z.useState([]),[s,o]=Z.useState(null),[l,c]=Z.useState(""),[u,A]=Z.useState(""),[h,f]=Z.useState(30),[d,v]=Z.useState(!1),[g,y]=Z.useState(!1),[p,m]=Z.useState([]),[w,x]=Z.useState(0);Z.useEffect(()=>{B(),b()},[]);const b=()=>{const U=e.map(q=>({customerId:q.id,companyName:q.company_name,email:q.email,status:"pending"}));m(U)},B=async()=>{try{const{data:U,error:q}=await de.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(q)throw q;a(U||[])}catch(U){console.error("Error loading templates:",U)}},_=U=>{c(U.subject),A(U.body),o(U),y(!1)},k=(U,q)=>U.replace(/\{\{company_name\}\}/g,q.company_name).replace(/\{\{contact_person\}\}/g,q.contact_person||"Sir/Madam"),E=async()=>{if(!l||!u){alert("Please fill in subject and message");return}if(h<10){alert("Please set interval to at least 10 seconds to avoid blocking");return}v(!0),x(0);try{const{data:{user:U}}=await de.auth.getUser();if(!U)throw new Error("Not authenticated");const{data:q}=await de.from("gmail_connections").select("*").eq("user_id",U.id).eq("is_connected",!0).maybeSingle();if(!q){alert("Gmail not connected. Please connect Gmail in Settings first."),v(!1);return}for(let X=0;X<e.length;X++){const W=e[X];x(X),m(M=>M.map((G,H)=>H===X?{...G,status:"sending"}:G));try{const M=W.email.split(";").map(P=>P.trim()).filter(P=>P.length>0),G=k(l,W),H=k(u,W),O=await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/send-bulk-email",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY"},body:JSON.stringify({userId:U.id,toEmails:M,subject:G,body:H,contactId:W.id})});if(!O.ok)throw new Error("Failed to send email");const D=await O.json();if(D.success){const P={contact_id:W.id,email_type:"sent",from_email:U.email,to_email:M,subject:G,body:H,template_id:(s==null?void 0:s.id)||null,sent_date:new Date().toISOString(),created_by:U.id};await de.from("crm_email_activities").insert([P]),m(Q=>Q.map((J,te)=>te===X?{...J,status:"success"}:J))}else throw new Error(D.error||"Unknown error");X<e.length-1&&await new Promise(P=>setTimeout(P,h*1e3))}catch(M){console.error(`Error sending to ${W.company_name}:`,M),m(G=>G.map((H,C)=>C===X?{...H,status:"error",error:M.message}:H))}}s&&await de.from("crm_email_templates").update({use_count:s.use_count+e.length,last_used:new Date().toISOString()}).eq("id",s.id);const V=p.filter(X=>X.status==="success").length;alert(`Bulk email completed!
${V} of ${e.length} emails sent successfully.`),r()}catch(U){console.error("Error in bulk email:",U),alert("Failed to complete bulk email. Please check the results.")}finally{v(!1)}},T=p.filter(U=>U.status==="success").length,S=p.filter(U=>U.status==="error").length,j=p.filter(U=>U.status==="pending").length;return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(la,{className:"w-5 h-5 text-blue-600"}),"Bulk Email to Customers"]}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Sending to ",e.length," customers"]})]}),i.jsxs("button",{onClick:()=>y(!0),disabled:d,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50",children:[i.jsx(pr,{className:"w-4 h-4"}),"Use Template"]})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[i.jsx(ya,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"text-sm text-yellow-800",children:[i.jsx("p",{className:"font-medium",children:"Important: Email Throttling"}),i.jsxs("p",{className:"mt-1",children:["Emails will be sent with ",h,"s intervals to prevent your email account from being blocked. Total time: ~",Math.ceil(e.length*h/60)," minutes"]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interval Between Emails (seconds)"}),i.jsx("input",{type:"number",min:"10",max:"300",value:h,onChange:U=>f(Math.max(10,parseInt(U.target.value)||10)),disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 10 seconds recommended. Higher values are safer for large batches."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:l,onChange:U=>c(U.target.value),disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",placeholder:"Email subject (use {{company_name}} and {{contact_person}} for personalization)"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message *"}),i.jsx("textarea",{value:u,onChange:U=>A(U.target.value),disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",rows:10,placeholder:"Type your message here... (use {{company_name}} and {{contact_person}} for personalization)"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables: ","{{company_name}}",", ","{{contact_person}}"]})]}),d&&i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),i.jsxs("div",{children:[i.jsxs("p",{className:"font-medium text-blue-900",children:["Sending email ",w+1," of ",e.length]}),i.jsxs("p",{className:"text-sm text-blue-700",children:["Current: ",(I=e[w])==null?void 0:I.company_name]})]})]}),i.jsxs("div",{className:"flex gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-1 text-green-700",children:[i.jsx(ua,{className:"w-4 h-4"}),"Success: ",T]}),i.jsxs("div",{className:"flex items-center gap-1 text-red-700",children:[i.jsx(Pa,{className:"w-4 h-4"}),"Failed: ",S]}),i.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[i.jsx(ts,{className:"w-4 h-4"}),"Pending: ",j]})]})]}),p.some(U=>U.status!=="pending")&&i.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b",children:i.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Send Results"})}),i.jsx("div",{className:"max-h-64 overflow-y-auto",children:p.map((U,q)=>i.jsxs("div",{className:`px-4 py-2 border-b last:border-b-0 flex items-center justify-between ${U.status==="success"?"bg-green-50":U.status==="error"?"bg-red-50":U.status==="sending"?"bg-blue-50":""}`,children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.companyName}),i.jsx("p",{className:"text-xs text-gray-600",children:U.email}),U.error&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:U.error})]}),i.jsxs("div",{children:[U.status==="success"&&i.jsx(ua,{className:"w-5 h-5 text-green-600"}),U.status==="error"&&i.jsx(Pa,{className:"w-5 h-5 text-red-600"}),U.status==="sending"&&i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),U.status==="pending"&&i.jsx(ts,{className:"w-5 h-5 text-gray-400"})]})]},q))})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{onClick:t,disabled:d,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:d?"Sending...":"Cancel"}),i.jsxs("button",{onClick:E,disabled:d||!l||!u,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Ii,{className:"w-4 h-4"}),d?"Sending...":"Start Bulk Send"]})]}),i.jsx(ir,{isOpen:g,onClose:()=>y(!1),title:"Email Templates",children:i.jsx("div",{className:"space-y-2",children:n.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(pr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),i.jsx("p",{children:"No templates available"}),i.jsx("p",{className:"text-sm mt-1",children:"Contact admin to create email templates"})]}):n.map(U=>i.jsx("div",{onClick:()=>_(U),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition",children:i.jsx("div",{className:"flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-900",children:U.template_name}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:U.subject}),U.category&&i.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:U.category})]})})},U.id))})})]})}function One(){const[e,t]=Z.useState([]),[r,n]=Z.useState([]),[a,s]=Z.useState(!0),[o,l]=Z.useState(null),[c,u]=Z.useState(""),[A,h]=Z.useState(new Set),[f,d]=Z.useState(!1),[v,g]=Z.useState(""),[y,p]=Z.useState(""),[m,w]=Z.useState(""),[x,b]=Z.useState({created_at:110,company_name:200,contact_person:150,designation:120,email:180,mobile:130,landline:130,phone:130,country:120,city:120,address:200,website:150,customer_type:120,notes:200}),[B,_]=Z.useState(null),k=Z.useRef(null);Z.useEffect(()=>{E()},[]),Z.useEffect(()=>{if(B){const Q=te=>{const z=te.clientX-B.startX,ye=Math.max(80,B.startWidth+z);b(re=>({...re,[B.column]:ye}))},J=()=>{_(null)};return document.addEventListener("mousemove",Q),document.addEventListener("mouseup",J),()=>{document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",J)}}},[B]);const E=async()=>{try{const{data:Q,error:J}=await de.from("crm_contacts").select("*").order("company_name");if(J)throw J;t(Q||[]),n(Q||[])}catch(Q){console.error("Error loading customers:",Q)}finally{s(!1)}};Z.useEffect(()=>{let Q=[...e];if(v){const J=v.toLowerCase();Q=Q.filter(te=>{var z,ye,re,ke;return((z=te.company_name)==null?void 0:z.toLowerCase().includes(J))||((ye=te.contact_person)==null?void 0:ye.toLowerCase().includes(J))||((re=te.email)==null?void 0:re.toLowerCase().includes(J))||((ke=te.city)==null?void 0:ke.toLowerCase().includes(J))})}y&&(Q=Q.filter(J=>J.city===y)),m&&(Q=Q.filter(J=>J.customer_type===m)),n(Q)},[v,y,m,e]);const T=Array.from(new Set(e.map(Q=>Q.city).filter(Boolean))).sort(),S=Array.from(new Set(e.map(Q=>Q.customer_type).filter(Boolean))).sort(),j=(Q,J)=>{l({rowId:Q.id,field:J}),u(Q[J]||"")},I=async()=>{if(o)try{const{error:Q}=await de.from("crm_contacts").update({[o.field]:c||null}).eq("id",o.rowId);if(Q)throw Q;t(J=>J.map(te=>te.id===o.rowId?{...te,[o.field]:c||null}:te))}catch(Q){console.error("Error updating customer:",Q),alert("Failed to update customer")}finally{l(null),u("")}},U=Q=>{Q.key==="Enter"?(Q.preventDefault(),I()):Q.key==="Escape"&&(l(null),u(""))},q=async()=>{try{const{data:{user:Q}}=await de.auth.getUser();if(!Q)throw new Error("Not authenticated");const{data:J,error:te}=await de.from("crm_contacts").insert({company_name:"New Customer",is_active:!0,created_by:Q.id}).select().single();if(te)throw te;t(z=>[J,...z])}catch(Q){console.error("Error adding customer:",Q),alert("Failed to add customer")}},V=async()=>{if(A.size!==0&&confirm(`Delete ${A.size} customer(s)?`))try{const{error:Q}=await de.from("crm_contacts").delete().in("id",Array.from(A));if(Q)throw Q;t(J=>J.filter(te=>!A.has(te.id))),h(new Set)}catch(Q){console.error("Error deleting customers:",Q),alert("Failed to delete customers")}},X=Q=>{h(J=>{const te=new Set(J);return te.has(Q)?te.delete(Q):te.add(Q),te})},W=()=>{A.size===r.length?h(new Set):h(new Set(r.map(Q=>Q.id)))},M=Q=>{const J=new Date(Q),te=J.getDate().toString().padStart(2,"0"),z=(J.getMonth()+1).toString().padStart(2,"0"),ye=J.getFullYear();return`${te}-${z}-${ye}`},G=()=>{const Q=["Date","Company Name","Contact Person","Designation","Email","Mobile","Landline","Phone","Country","City","Address","Website","Customer Type","Notes"],J=e.map(ke=>[M(ke.created_at),ke.company_name,ke.contact_person||"",ke.designation||"",ke.email||"",ke.mobile||"",ke.landline||"",ke.phone||"",ke.country||"",ke.city||"",ke.address||"",ke.website||"",ke.customer_type||"",ke.notes||""]),te=[Q,...J].map(ke=>ke.map(be=>`"${be}"`).join(",")).join(`
`),z=new Blob([te],{type:"text/csv"}),ye=URL.createObjectURL(z),re=document.createElement("a");re.href=ye,re.download=`customers_${new Date().toISOString().split("T")[0]}.csv`,re.click()},H=async Q=>{var te;const J=(te=Q.target.files)==null?void 0:te[0];if(J){try{const{data:{user:z}}=await de.auth.getUser();if(!z)throw new Error("Not authenticated");const re=(await J.text()).split(`
`).filter(it=>it.trim());if(re.length<2){alert("CSV file is empty or invalid");return}const ke=re[0].split(",").map(it=>it.replace(/"/g,"").trim()),be=re.slice(1),ae=ke.findIndex(it=>it.toLowerCase()==="date"),Ie=ke.findIndex(it=>it.toLowerCase()==="company name"),De=ke.findIndex(it=>it.toLowerCase()==="contact person"),pe=ke.findIndex(it=>it.toLowerCase()==="designation"),we=ke.findIndex(it=>it.toLowerCase()==="email"),Te=ke.findIndex(it=>it.toLowerCase()==="mobile"),he=ke.findIndex(it=>it.toLowerCase()==="landline"),ce=ke.findIndex(it=>it.toLowerCase()==="phone"),Se=ke.findIndex(it=>it.toLowerCase()==="country"),Pe=ke.findIndex(it=>it.toLowerCase()==="city"),Le=ke.findIndex(it=>it.toLowerCase()==="address"),Xe=ke.findIndex(it=>it.toLowerCase()==="website"),fe=ke.findIndex(it=>it.toLowerCase()==="customer type"),Ee=ke.findIndex(it=>it.toLowerCase()==="notes");if(Ie===-1){alert('CSV must have a "Company Name" column');return}const qe=it=>{const ut=[];let Mt="",ht=!1;for(let Et=0;Et<it.length;Et++){const mt=it[Et];mt==='"'?ht=!ht:mt===","&&!ht?(ut.push(Mt.trim()),Mt=""):Mt+=mt}return ut.push(Mt.trim()),ut},Qe=it=>{if(!it)return new Date().toISOString();const ut=[/^(\d{1,2})-(\d{1,2})-(\d{4})$/,/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,/^(\d{4})-(\d{1,2})-(\d{1,2})$/];for(const Mt of ut){const ht=it.match(Mt);if(ht){let Et,mt,_t;return Mt.toString().includes("\\d{4}$")?[,Et,mt,_t]=ht:[,_t,mt,Et]=ht,new Date(`${_t}-${mt.padStart(2,"0")}-${Et.padStart(2,"0")}`).toISOString()}}return new Date().toISOString()},Ye=be.map(it=>{var Et,mt,_t,Ht,bt,Ct,or,Ra,er,on,zn,Lt,Dn,Xn;const ut=qe(it),Mt=(Et=ut[Ie])==null?void 0:Et.replace(/"/g,"").trim();if(!Mt)return null;const ht=ae!==-1?Qe((mt=ut[ae])==null?void 0:mt.replace(/"/g,"").trim()):new Date().toISOString();return{company_name:Mt,contact_person:De!==-1&&((_t=ut[De])==null?void 0:_t.replace(/"/g,"").trim())||null,designation:pe!==-1&&((Ht=ut[pe])==null?void 0:Ht.replace(/"/g,"").trim())||null,email:we!==-1&&((bt=ut[we])==null?void 0:bt.replace(/"/g,"").trim())||null,mobile:Te!==-1&&((Ct=ut[Te])==null?void 0:Ct.replace(/"/g,"").trim())||null,landline:he!==-1&&((or=ut[he])==null?void 0:or.replace(/"/g,"").trim())||null,phone:ce!==-1&&((Ra=ut[ce])==null?void 0:Ra.replace(/"/g,"").trim())||null,country:Se!==-1&&((er=ut[Se])==null?void 0:er.replace(/"/g,"").trim())||null,city:Pe!==-1&&((on=ut[Pe])==null?void 0:on.replace(/"/g,"").trim())||null,address:Le!==-1&&((zn=ut[Le])==null?void 0:zn.replace(/"/g,"").trim())||null,website:Xe!==-1&&((Lt=ut[Xe])==null?void 0:Lt.replace(/"/g,"").trim())||null,customer_type:fe!==-1&&((Dn=ut[fe])==null?void 0:Dn.replace(/"/g,"").trim())||null,notes:Ee!==-1&&((Xn=ut[Ee])==null?void 0:Xn.replace(/"/g,"").trim())||null,is_active:!0,created_by:z.id,created_at:ht}}).filter(Boolean);if(Ye.length===0){alert("No valid customer data found in CSV");return}const{data:Nt,error:xt}=await de.from("crm_contacts").insert(Ye).select();if(xt)throw xt;alert(`Successfully imported ${Ye.length} customer(s)`),E()}catch(z){console.error("Error importing CSV:",z),alert("Failed to import CSV. Please check the file format.")}Q.target.value=""}},C=Q=>{const J=new Date(Q),te=J.getDate().toString().padStart(2,"0"),z=(J.getMonth()+1).toString().padStart(2,"0"),ye=J.getFullYear();return`${te}-${z}-${ye}`},L=(Q,J)=>{const te=(o==null?void 0:o.rowId)===Q.id&&(o==null?void 0:o.field)===J,z=Q[J];return J==="created_at"?i.jsx("div",{className:"px-2 py-1 h-full flex items-center",children:i.jsx("span",{className:"truncate text-xs",children:C(Q.created_at)})}):te?i.jsx("input",{type:"text",value:c,onChange:ye=>u(ye.target.value),onBlur:I,onKeyDown:U,autoFocus:!0,className:"w-full h-full px-2 py-1 border-2 border-blue-500 focus:outline-none bg-white"}):i.jsx("div",{onDoubleClick:()=>j(Q,J),className:"px-2 py-1 cursor-cell hover:bg-gray-50 h-full flex items-center",title:"Double-click to edit",children:J==="is_active"?i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${z?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:z?"Active":"Inactive"}):i.jsx("span",{className:"truncate",children:(z==null?void 0:z.toString())||"-"})})},O=(Q,J)=>{Q.preventDefault(),_({column:J,startX:Q.clientX,startWidth:x[J]})},D=()=>{if(Array.from(A).map(J=>e.find(te=>te.id===J)).filter(J=>!!J&&!!J.email).length===0){alert("Please select customers with email addresses");return}d(!0)},P=()=>Array.from(A).map(Q=>e.find(J=>J.id===Q)).filter(Q=>!!Q&&!!Q.email).map(Q=>({id:Q.id,company_name:Q.company_name,email:Q.email,contact_person:Q.contact_person}));return a?i.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading customers..."}):i.jsxs("div",{className:"flex flex-col h-full bg-white rounded-lg shadow",children:[i.jsxs("div",{className:"flex flex-col gap-3 px-4 py-3 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:q,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[i.jsx(Wn,{className:"w-3.5 h-3.5"}),"Add Customer"]}),A.size>0&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:D,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-green-600 border border-green-700 rounded-md hover:bg-green-700 transition",children:[i.jsx(Ii,{className:"w-3.5 h-3.5"}),"Send Email (",A.size,")"]}),i.jsxs("button",{onClick:V,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100 transition",children:[i.jsx(wa,{className:"w-3.5 h-3.5"}),"Delete (",A.size,")"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition cursor-pointer",children:[i.jsx(zb,{className:"w-3.5 h-3.5"}),"Import CSV",i.jsx("input",{type:"file",accept:".csv",onChange:H,className:"hidden"})]}),i.jsxs("button",{onClick:G,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[i.jsx(Qo,{className:"w-3.5 h-3.5"}),"Export CSV"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(Hc,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"text",value:v,onChange:Q=>g(Q.target.value),placeholder:"Search by company, contact person, email, or city...",className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("select",{value:y,onChange:Q=>p(Q.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"All Cities"}),T.map(Q=>i.jsx("option",{value:Q,children:Q},Q))]}),i.jsxs("select",{value:m,onChange:Q=>w(Q.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"All Types"}),S.map(Q=>i.jsx("option",{value:Q,children:Q},Q))]}),(v||y||m)&&i.jsx("button",{onClick:()=>{g(""),p(""),w("")},className:"px-3 py-2 text-xs font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Clear Filters"})]})]}),i.jsx("div",{ref:k,className:"flex-1 overflow-auto",style:{maxHeight:"calc(100vh - 250px)"},children:i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{className:"sticky top-0 bg-gray-50 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border border-gray-300 px-2 py-2 bg-gray-100 w-10",children:i.jsx("input",{type:"checkbox",checked:A.size===r.length&&r.length>0,onChange:W,className:"rounded"})}),[{key:"created_at",label:"Date"},{key:"company_name",label:"Company Name"},{key:"contact_person",label:"Contact Person"},{key:"designation",label:"Designation"},{key:"email",label:"Email"},{key:"mobile",label:"Mobile"},{key:"landline",label:"Landline"},{key:"phone",label:"Phone"},{key:"country",label:"Country"},{key:"city",label:"City"},{key:"address",label:"Address"},{key:"website",label:"Website"},{key:"customer_type",label:"Type"},{key:"notes",label:"Notes"}].map(({key:Q,label:J})=>i.jsx("th",{className:"border border-gray-300 px-2 py-2 bg-gray-100 text-left text-xs font-semibold text-gray-700 relative",style:{width:x[Q],minWidth:x[Q]},children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:J}),i.jsx("div",{onMouseDown:te=>O(te,Q),className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 hover:w-1.5 transition-all",style:{touchAction:"none"}})]})},Q))]})}),i.jsx("tbody",{children:r.map(Q=>i.jsxs("tr",{className:`${A.has(Q.id)?"bg-blue-50":"hover:bg-gray-50"} transition`,children:[i.jsx("td",{className:"border border-gray-300 px-2 py-1 text-center",children:i.jsx("input",{type:"checkbox",checked:A.has(Q.id),onChange:()=>X(Q.id),className:"rounded"})}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.created_at},children:L(Q,"created_at")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.company_name},children:L(Q,"company_name")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.contact_person},children:L(Q,"contact_person")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.designation},children:L(Q,"designation")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.email},children:L(Q,"email")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.mobile},children:L(Q,"mobile")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.landline},children:L(Q,"landline")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.phone},children:L(Q,"phone")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.country},children:L(Q,"country")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.city},children:L(Q,"city")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.address},children:L(Q,"address")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.website},children:L(Q,"website")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.customer_type},children:L(Q,"customer_type")}),i.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.notes},children:L(Q,"notes")})]},Q.id))})]})}),i.jsx("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50 text-sm text-gray-600",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{children:[r.length," customer(s)",r.length!==e.length&&` (filtered from ${e.length} total)`,A.size>0&&`  ${A.size} selected`]}),i.jsx("span",{className:"text-xs text-gray-500",children:"Double-click any cell to edit  Drag column borders to resize"})]})}),i.jsx(ir,{isOpen:f,onClose:()=>{d(!1),h(new Set)},title:"Bulk Email",children:i.jsx(Lne,{selectedCustomers:P(),onClose:()=>{d(!1),h(new Set)},onComplete:()=>{d(!1),h(new Set),E()}})})]})}function Une({inquiryId:e,customerId:t,leadId:r,onActivityLogged:n}){const{profile:a}=Dr(),{t:s}=ba(),[o,l]=Z.useState([]),[c,u]=Z.useState(!0),[A,h]=Z.useState(!1),[f,d]=Z.useState({activity_type:"phone_call",subject:"",description:"",follow_up_date:"",is_completed:!1});Z.useEffect(()=>{v()},[e,t,r]);const v=async()=>{try{let b=de.from("crm_activities").select("*, user_profiles!crm_activities_created_by_fkey(full_name)").order("created_at",{ascending:!1});r&&(b=b.eq("lead_id",r)),t&&(b=b.eq("customer_id",t));const{data:B,error:_}=await b;if(_)throw _;l(B||[])}catch(b){console.error("Error loading activities:",b)}finally{u(!1)}},g=async b=>{b.preventDefault();try{const{data:{user:B}}=await de.auth.getUser();if(!B)throw new Error("Not authenticated");const _={...f,created_by:B.id,follow_up_date:f.follow_up_date||null,completed_at:f.is_completed?new Date().toISOString():null};r&&(_.lead_id=r),t&&(_.customer_id=t);const{error:k}=await de.from("crm_activities").insert([_]);if(k)throw k;h(!1),d({activity_type:"phone_call",subject:"",description:"",follow_up_date:"",is_completed:!1}),v(),n==null||n()}catch(B){console.error("Error logging activity:",B),alert("Failed to log activity. Please try again.")}},y=async b=>{try{const{error:B}=await de.from("crm_activities").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",b);if(B)throw B;v()}catch(B){console.error("Error completing activity:",B),alert("Failed to complete activity. Please try again.")}},p=async b=>{if(confirm("Are you sure you want to delete this activity? This action cannot be undone."))try{const{error:B}=await de.from("crm_activities").delete().eq("id",b);if(B)throw B;v(),n==null||n()}catch(B){console.error("Error deleting activity:",B),alert("Failed to delete activity. Please try again.")}},m=b=>{switch(b){case"phone_call":return i.jsx(kl,{className:"w-5 h-5"});case"meeting":return i.jsx(as,{className:"w-5 h-5"});case"email":return i.jsx(_0,{className:"w-5 h-5"});case"note":return i.jsx(pr,{className:"w-5 h-5"});case"video_call":return i.jsx(yF,{className:"w-5 h-5"});case"whatsapp":return i.jsx(aR,{className:"w-5 h-5"});default:return i.jsx(pr,{className:"w-5 h-5"})}},w=b=>{switch(b){case"phone_call":return"bg-blue-50 text-blue-600 border-blue-200";case"meeting":return"bg-purple-50 text-purple-600 border-purple-200";case"email":return"bg-green-50 text-green-600 border-green-200";case"note":return"bg-gray-50 text-gray-600 border-gray-200";case"video_call":return"bg-indigo-50 text-indigo-600 border-indigo-200";case"whatsapp":return"bg-emerald-50 text-emerald-600 border-emerald-200";default:return"bg-gray-50 text-gray-600 border-gray-200"}},x=b=>({phone_call:"Phone Call",meeting:"Meeting",email:"Email",note:"Note",video_call:"Video Call",whatsapp:"WhatsApp"})[b]||b;return c?i.jsx("div",{className:"flex justify-center py-8",children:"Loading activities..."}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activity Log"}),i.jsxs("button",{onClick:()=>h(!A),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-4 h-4"}),"Log Activity"]})]}),A&&i.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:i.jsxs("form",{onSubmit:g,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activity Type *"}),i.jsxs("select",{value:f.activity_type,onChange:b=>d({...f,activity_type:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"phone_call",children:"Phone Call"}),i.jsx("option",{value:"meeting",children:"Meeting"}),i.jsx("option",{value:"email",children:"Email"}),i.jsx("option",{value:"note",children:"Note"}),i.jsx("option",{value:"video_call",children:"Video Call"}),i.jsx("option",{value:"whatsapp",children:"WhatsApp (Coming Soon)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:f.subject,onChange:b=>d({...f,subject:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Brief description",required:!0})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:f.description,onChange:b=>d({...f,description:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Detailed notes about the conversation or activity"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Date"}),i.jsx("input",{type:"datetime-local",value:f.follow_up_date,onChange:b=>d({...f,follow_up_date:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsx("div",{className:"flex items-center",children:i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:f.is_completed,onChange:b=>d({...f,is_completed:b.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm text-gray-700",children:"Mark as completed"})]})})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Log Activity"})]})]})}),i.jsx("div",{className:"space-y-3",children:o.length===0?i.jsx("div",{className:"text-center py-8 text-gray-500",children:"No activities logged yet. Start by logging your first activity!"}):o.map(b=>i.jsx("div",{className:`border rounded-lg p-4 ${b.is_completed?"bg-gray-50 border-gray-200":"bg-white border-gray-300"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg border ${w(b.activity_type)}`,children:m(b.activity_type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:b.subject}),b.is_completed&&i.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-600 bg-green-50 px-2 py-0.5 rounded",children:[i.jsx(ua,{className:"w-3 h-3"}),"Completed"]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[x(b.activity_type),"  ",new Date(b.created_at).toLocaleString()]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[!b.is_completed&&b.follow_up_date&&i.jsx("button",{onClick:()=>y(b.id),className:"text-sm px-3 py-1 text-green-600 hover:bg-green-50 rounded-lg transition",children:"Mark Complete"}),i.jsx("button",{onClick:()=>p(b.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",title:"Delete activity",children:i.jsx(wa,{className:"w-4 h-4"})})]})]}),b.description&&i.jsx("p",{className:"mt-2 text-sm text-gray-700 whitespace-pre-wrap",children:b.description}),b.follow_up_date&&!b.is_completed&&i.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-orange-600",children:[i.jsx(ts,{className:"w-4 h-4"}),"Follow-up: ",new Date(b.follow_up_date).toLocaleString()]}),b.user_profiles&&i.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["by ",b.user_profiles.full_name]})]})]})},b.id))})]})}function Pne({customerId:e,leadId:t,onAppointmentCreated:r}){const{profile:n}=Dr(),[a,s]=Z.useState([]),[o,l]=Z.useState([]),[c,u]=Z.useState(!0),[A,h]=Z.useState(!1),[f,d]=Z.useState(null),[v,g]=Z.useState({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:"",customer_id:e||""});Z.useEffect(()=>{p(),!e&&!t&&y()},[e,t]);const y=async()=>{try{const{data:E,error:T}=await de.from("crm_contacts").select("id, company_name").order("company_name",{ascending:!0});if(T)throw T;l(E||[])}catch(E){console.error("Error loading contacts:",E)}},p=async()=>{try{let E=de.from("crm_activities").select("*, user_profiles!crm_activities_created_by_fkey(full_name), crm_contacts(company_name)").in("activity_type",["meeting","video_call","phone_call"]).not("follow_up_date","is",null).order("follow_up_date",{ascending:!0});e?E=E.eq("customer_id",e):t&&(E=E.eq("lead_id",t));const{data:T,error:S}=await E;if(S)throw S;s(T||[])}catch(E){console.error("Error loading appointments:",E)}finally{u(!1)}},m=async E=>{E.preventDefault();try{const{data:{user:T}}=await de.auth.getUser();if(!T)throw new Error("Not authenticated");const S={activity_type:v.activity_type,subject:v.subject,description:v.description||null,follow_up_date:v.follow_up_date,is_completed:!1,created_by:T.id};if(e?S.customer_id=e:t?S.lead_id=t:v.customer_id&&(S.customer_id=v.customer_id),f){const{error:j}=await de.from("crm_activities").update(S).eq("id",f.id);if(j)throw j}else{const{error:j}=await de.from("crm_activities").insert([S]);if(j)throw j}h(!1),d(null),g({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:""}),p(),r==null||r()}catch(T){console.error("Error saving appointment:",T),alert("Failed to save appointment. Please try again.")}},w=E=>{d(E),g({activity_type:E.activity_type,subject:E.subject,description:E.description||"",follow_up_date:E.follow_up_date,location:"",customer_id:E.customer_id||e||""}),h(!0)},x=async E=>{if(confirm("Are you sure you want to delete this appointment?"))try{const{error:T}=await de.from("crm_activities").delete().eq("id",E);if(T)throw T;p()}catch(T){console.error("Error deleting appointment:",T),alert("Failed to delete appointment. Please try again.")}},b=async E=>{try{const{error:T}=await de.from("crm_activities").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",E);if(T)throw T;p()}catch(T){console.error("Error completing appointment:",T),alert("Failed to complete appointment. Please try again.")}},B=E=>{switch(E){case"meeting":return i.jsx(as,{className:"w-5 h-5"});case"video_call":return i.jsx(yF,{className:"w-5 h-5"});case"phone_call":return i.jsx(kl,{className:"w-5 h-5"});default:return i.jsx(as,{className:"w-5 h-5"})}},_=E=>{if(E.is_completed)return"bg-gray-50 border-gray-200 text-gray-600";const T=new Date,S=new Date(E.follow_up_date);return S<T?"bg-red-50 border-red-200 text-red-700":S<new Date(T.getTime()+24*60*60*1e3)?"bg-orange-50 border-orange-200 text-orange-700":"bg-blue-50 border-blue-200 text-blue-700"},k=E=>({meeting:"In-Person Meeting",video_call:"Video Call",phone_call:"Phone Call"})[E]||E;return c?i.jsx("div",{className:"flex justify-center py-8",children:"Loading appointments..."}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Appointments & Meetings"}),i.jsxs("button",{onClick:()=>{d(null),g({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:"",customer_id:e||""}),h(!A)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-4 h-4"}),"Schedule Appointment"]})]}),A&&i.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:i.jsxs("form",{onSubmit:m,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[!e&&!t&&i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),i.jsxs("select",{value:v.customer_id,onChange:E=>g({...v,customer_id:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select a customer..."}),o.map(E=>i.jsx("option",{value:E.id,children:E.company_name},E.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment Type *"}),i.jsxs("select",{value:v.activity_type,onChange:E=>g({...v,activity_type:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"meeting",children:"In-Person Meeting"}),i.jsx("option",{value:"video_call",children:"Video Call"}),i.jsx("option",{value:"phone_call",children:"Phone Call"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date & Time *"}),i.jsx("input",{type:"datetime-local",value:v.follow_up_date,onChange:E=>g({...v,follow_up_date:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),i.jsx("input",{type:"text",value:v.subject,onChange:E=>g({...v,subject:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Product demonstration, Price negotiation",required:!0})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description / Agenda"}),i.jsx("textarea",{value:v.description,onChange:E=>g({...v,description:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Meeting agenda, discussion points, etc."})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{h(!1),d(null)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:f?"Update Appointment":"Schedule Appointment"})]})]})}),i.jsx("div",{className:"space-y-3",children:a.length===0?i.jsx("div",{className:"text-center py-8 text-gray-500",children:"No appointments scheduled. Create your first appointment!"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Upcoming Appointments"}),a.filter(E=>!E.is_completed&&new Date(E.follow_up_date)>=new Date).map(E=>i.jsx("div",{className:`border rounded-lg p-4 ${_(E)}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0",children:B(E.activity_type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:E.subject}),E.crm_contacts&&i.jsx("p",{className:"text-sm font-medium text-blue-600 mt-1",children:E.crm_contacts.company_name}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:k(E.activity_type)}),i.jsxs("p",{className:"text-sm font-medium mt-1 flex items-center gap-1",children:[i.jsx(ts,{className:"w-4 h-4"}),new Date(E.follow_up_date).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>w(E),className:"p-1 hover:bg-white rounded transition",title:"Edit",children:i.jsx(jg,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>x(E.id),className:"p-1 hover:bg-white rounded transition",title:"Delete",children:i.jsx(wa,{className:"w-4 h-4"})})]})]}),E.description&&i.jsx("p",{className:"mt-2 text-sm text-gray-700 whitespace-pre-wrap",children:E.description}),i.jsx("div",{className:"mt-3 flex gap-2",children:i.jsx("button",{onClick:()=>b(E.id),className:"text-xs px-3 py-1 bg-white border border-current rounded hover:bg-gray-50 transition",children:"Mark as Completed"})})]})]})},E.id))]}),a.filter(E=>E.is_completed||new Date(E.follow_up_date)<new Date).length>0&&i.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Past Appointments"}),a.filter(E=>E.is_completed||new Date(E.follow_up_date)<new Date).map(E=>i.jsx("div",{className:"border rounded-lg p-4 bg-gray-50 border-gray-200",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 text-gray-400",children:B(E.activity_type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"font-medium text-gray-700",children:E.subject}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[k(E.activity_type),"  ",new Date(E.follow_up_date).toLocaleDateString()]})]})]})},E.id))]})]})})]})}function Dne({canManage:e,onRefresh:t}){const{profile:r}=Dr(),[n,a]=Z.useState([]),[s,o]=Z.useState([]),[l,c]=Z.useState(!0),[u,A]=Z.useState(""),[h,f]=Z.useState(null),[d,v]=Z.useState(!1);Z.useEffect(()=>{g()},[]),Z.useEffect(()=>{if(u){const m=n.filter(w=>w.inquiry_number.toLowerCase().includes(u.toLowerCase())||w.company_name.toLowerCase().includes(u.toLowerCase())||w.product_name.toLowerCase().includes(u.toLowerCase())||w.lost_reason&&w.lost_reason.toLowerCase().includes(u.toLowerCase()));o(m)}else o(n)},[u,n]);const g=async()=>{try{const{data:m,error:w}=await de.from("crm_inquiries").select("*").eq("pipeline_status","lost").order("lost_at",{ascending:!1});if(w)throw w;a(m||[]),o(m||[])}catch(m){console.error("Error loading archived inquiries:",m)}finally{c(!1)}},y=async m=>{if(confirm(`Reopen inquiry #${m.inquiry_number} and move it back to active deals?`))try{const{error:w}=await de.from("crm_inquiries").update({pipeline_status:"in_progress",lost_reason:null,lost_at:null,competitor_name:null,competitor_price:null}).eq("id",m.id);if(w)throw w;alert("Inquiry reopened and moved to active deals!"),g(),t()}catch(w){console.error("Error reopening inquiry:",w),alert("Failed to reopen inquiry. Please try again.")}},p=()=>{try{const m=s.map(B=>({"Inquiry No.":B.inquiry_number,Date:new Date(B.inquiry_date).toLocaleDateString("en-GB"),Company:B.company_name,Product:B.product_name,Qty:B.quantity,"Offered Price":B.offered_price?`${B.offered_price} ${B.offered_price_currency}`:"-",Supplier:B.supplier_name||"-","Lost Reason":B.lost_reason||"-",Competitor:B.competitor_name||"-","Competitor Price":B.competitor_price?`$${B.competitor_price}`:"-","Lost Date":B.lost_at?new Date(B.lost_at).toLocaleDateString("en-GB"):"-",Remarks:B.remarks||"-"})),w=hs.json_to_sheet(m);w["!cols"]=[{wch:12},{wch:12},{wch:25},{wch:30},{wch:12},{wch:15},{wch:20},{wch:40},{wch:20},{wch:15},{wch:12},{wch:30}];const x=hs.book_new();hs.book_append_sheet(x,w,"Lost Deals Archive");const b=`Archive-Lost-Deals-${new Date().toISOString().split("T")[0]}.xlsx`;Wg(x,b),alert(`Exported ${m.length} archived inquiries to ${b}`)}catch(m){console.error("Export error:",m),alert("Failed to export data. Please try again.")}};return l?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(Pa,{className:"w-6 h-6 text-red-600"}),"Lost Deals Archive"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View history of lost inquiries and analyze reasons for improvement"})]}),i.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[i.jsx(Qo,{className:"w-4 h-4"}),"Export to Excel"]})]}),i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(Hc,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),i.jsx("input",{type:"text",value:u,onChange:m=>A(m.target.value),placeholder:"Search by inquiry no, company, product, or lost reason...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:s.length})," archived inquiries"]})]})}),s.length===0?i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[i.jsx(Pa,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-500",children:u?"No archived inquiries match your search.":"No archived inquiries yet."})]}):i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"No."}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"}),(r==null?void 0:r.role)==="admin"&&i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Offered"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Supplier"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lost Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lost Date"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:s.map(m=>i.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[i.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:m.inquiry_number}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(m.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:m.company_name}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:m.product_name}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:m.quantity}),(r==null?void 0:r.role)==="admin"&&i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:m.offered_price?`$${m.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:m.supplier_name||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:i.jsxs("div",{className:"max-w-xs",children:[i.jsx("p",{className:"text-gray-900 line-clamp-2",children:m.lost_reason||"-"}),m.competitor_name&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Competitor: ",m.competitor_name,m.competitor_price&&` ($${m.competitor_price})`]})]})}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:m.lost_at?new Date(m.lost_at).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{f(m),v(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",title:"View Details",children:i.jsx(b0,{className:"w-4 h-4"})}),e&&i.jsx("button",{onClick:()=>y(m),className:"p-1 text-green-600 hover:bg-green-50 rounded transition",title:"Reopen Deal",children:i.jsx(BN,{className:"w-4 h-4"})})]})})]},m.id))})]})})}),h&&i.jsx(ir,{isOpen:d,onClose:()=>{v(!1),f(null)},title:`Inquiry #${h.inquiry_number} - Details`,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-2 pb-4 border-b",children:[i.jsx(tI,{status:"lost"}),i.jsxs("span",{className:"text-sm text-gray-500",children:["Lost on ",h.lost_at?new Date(h.lost_at).toLocaleDateString("en-GB"):"N/A"]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Company"}),i.jsx("p",{className:"text-sm text-gray-900",children:h.company_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Product"}),i.jsx("p",{className:"text-sm text-gray-900",children:h.product_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Quantity"}),i.jsx("p",{className:"text-sm text-gray-900",children:h.quantity})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Supplier"}),i.jsx("p",{className:"text-sm text-gray-900",children:h.supplier_name||"-"})]}),(r==null?void 0:r.role)==="admin"&&h.offered_price&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Offered Price"}),i.jsxs("p",{className:"text-sm text-gray-900",children:["$",h.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})," ",h.offered_price_currency]})]})]}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(ya,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-medium text-red-900 mb-1",children:"Lost Reason"}),i.jsx("p",{className:"text-sm text-red-800",children:h.lost_reason||"No reason provided"}),h.competitor_name&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-red-200",children:[i.jsx("p",{className:"text-xs font-medium text-red-900 mb-1",children:"Competitor Information"}),i.jsxs("p",{className:"text-sm text-red-800",children:[h.competitor_name,h.competitor_price&&` - $${h.competitor_price.toLocaleString("en-US",{minimumFractionDigits:2})}`]})]})]})]})}),h.remarks&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Remarks"}),i.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 rounded p-3",children:h.remarks})]}),e&&i.jsx("div",{className:"flex justify-end pt-4 border-t",children:i.jsxs("button",{onClick:()=>{y(h),v(!1)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[i.jsx(BN,{className:"w-4 h-4"}),"Reopen This Deal"]})})]})})]})}function rI({onSubmit:e,onCancel:t,initialData:r,isEditing:n=!1}){const[a,s]=Z.useState([]),[o,l]=Z.useState([]),[c,u]=Z.useState(""),[A,h]=Z.useState(!1),[f,d]=Z.useState(!1),[v,g]=Z.useState(!1),y=Z.useRef(null),[p,m]=Z.useState({product_name:(r==null?void 0:r.product_name)||"",specification:(r==null?void 0:r.specification)||"",quantity:(r==null?void 0:r.quantity)||"",priority:(r==null?void 0:r.priority)||"medium",inquiry_source:(r==null?void 0:r.inquiry_source)||"email",supplier_name:(r==null?void 0:r.supplier_name)||"",supplier_country:(r==null?void 0:r.supplier_country)||"",customer_id:(r==null?void 0:r.customer_id)||"",company_name:(r==null?void 0:r.company_name)||"",contact_person:(r==null?void 0:r.contact_person)||"",contact_email:(r==null?void 0:r.contact_email)||"",contact_phone:(r==null?void 0:r.contact_phone)||"",price_required:(r==null?void 0:r.price_required)||!1,coa_required:(r==null?void 0:r.coa_required)||!1,sample_required:(r==null?void 0:r.sample_required)||!1,agency_letter_required:(r==null?void 0:r.agency_letter_required)||!1,others_required:(r==null?void 0:r.others_required)||!1,purchase_price:(r==null?void 0:r.purchase_price)||"",purchase_price_currency:(r==null?void 0:r.purchase_price_currency)||"USD",offered_price:(r==null?void 0:r.offered_price)||"",offered_price_currency:(r==null?void 0:r.offered_price_currency)||"USD",delivery_date:(r==null?void 0:r.delivery_date)||"",delivery_terms:(r==null?void 0:r.delivery_terms)||"",aceerp_no:(r==null?void 0:r.aceerp_no)||"",mail_subject:(r==null?void 0:r.mail_subject)||"",pipeline_status:(r==null?void 0:r.pipeline_status)||"new",remarks:(r==null?void 0:r.remarks)||"",internal_notes:(r==null?void 0:r.internal_notes)||"",is_multi_product:(r==null?void 0:r.is_multi_product)||!1,products:(r==null?void 0:r.products)||[]}),[w,x]=Z.useState({company_name:"",contact_person:"",email:"",phone:"",country:"Indonesia",address:"",city:"Jakarta Pusat",npwp:"",pbf_license:"",gst_vat_type:"",payment_terms:""});Z.useEffect(()=>{b()},[]),Z.useEffect(()=>{const E=T=>{y.current&&!y.current.contains(T.target)&&h(!1)};return A&&document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[A]),Z.useEffect(()=>{if(c){const E=a.filter(T=>T.company_name.toLowerCase().includes(c.toLowerCase()));l(E)}else l(a)},[c,a]);const b=async()=>{try{const{data:E,error:T}=await de.from("customers").select("id, company_name, contact_person, email, phone, country, address, city").eq("is_active",!0).order("company_name");if(T)throw T;s(E||[]),l(E||[])}catch(E){console.error("Error loading customers:",E)}},B=E=>{m({...p,customer_id:E.id,company_name:E.company_name,contact_person:E.contact_person||"",contact_email:E.email||"",contact_phone:E.phone||""}),u(E.company_name),h(!1)},_=async()=>{if(!w.company_name){alert("Customer name is required");return}try{const{data:E,error:T}=await de.from("customers").insert({...w,is_active:!0}).select().single();if(T)throw T;await b(),B(E),d(!1),x({company_name:"",contact_person:"",email:"",phone:"",country:"Indonesia",address:"",city:"Jakarta Pusat",npwp:"",pbf_license:"",gst_vat_type:"",payment_terms:""})}catch(E){console.error("Error adding customer:",E),alert("Failed to add customer")}},k=async E=>{if(E.preventDefault(),p.is_multi_product){if(!p.company_name){alert("Please fill in Customer");return}}else if(!p.product_name||!p.quantity||!p.company_name){alert("Please fill in all required fields: Product Name, Quantity, and Customer");return}g(!0);try{await e(p)}finally{g(!1)}};return i.jsxs(i.Fragment,{children:[i.jsxs("form",{onSubmit:k,className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[i.jsx("input",{type:"checkbox",id:"multiProductToggle",checked:p.is_multi_product,onChange:E=>{const T=E.target.checked;m({...p,is_multi_product:T,products:T&&p.products.length===0?[{productName:"",specification:"",quantity:"",supplierName:"",supplierCountry:"",deliveryDate:"",deliveryTerms:""}]:p.products})},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),i.jsx("label",{htmlFor:"multiProductToggle",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Multi-Product Inquiry (Common data will be applied to all products)"})]}),!p.is_multi_product&&i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Product Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:p.product_name,onChange:E=>m({...p,product_name:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter product name",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Specification"}),i.jsx("input",{type:"text",value:p.specification,onChange:E=>m({...p,specification:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"BP / USP / EP"})]})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[!p.is_multi_product&&i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Quantity ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:p.quantity,onChange:E=>m({...p,quantity:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 500 KG",required:!0})]}),i.jsxs("div",{className:p.is_multi_product?"col-span-1":"",children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Priority ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:p.priority,onChange:E=>m({...p,priority:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"low",children:"Low"}),i.jsx("option",{value:"medium",children:"Medium"}),i.jsx("option",{value:"high",children:"High"}),i.jsx("option",{value:"urgent",children:"Urgent"})]})]}),i.jsxs("div",{className:p.is_multi_product?"col-span-2":"",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Inquiry Source"}),i.jsxs("select",{value:p.inquiry_source,onChange:E=>m({...p,inquiry_source:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"email",children:"Email"}),i.jsx("option",{value:"phone",children:"Phone"}),i.jsx("option",{value:"whatsapp",children:"WhatsApp"}),i.jsx("option",{value:"website",children:"Website"}),i.jsx("option",{value:"referral",children:"Referral"}),i.jsx("option",{value:"other",children:"Other"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Supplier Name"}),i.jsx("input",{type:"text",value:p.supplier_name,onChange:E=>m({...p,supplier_name:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Manufacturer/Supplier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Country of Origin"}),i.jsx("input",{type:"text",value:p.supplier_country,onChange:E=>m({...p,supplier_country:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Supplier country"})]}),i.jsxs("div",{ref:y,className:"relative",children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Customer ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",value:c||p.company_name,onChange:E=>{u(E.target.value),h(!0)},onFocus:()=>h(!0),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 pr-8",placeholder:"Search customer...",required:!0}),i.jsx(Hc,{className:"absolute right-2 top-2 w-4 h-4 text-gray-400"})]}),A&&i.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[o.map(E=>i.jsxs("div",{onClick:()=>B(E),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm",children:[i.jsx("div",{className:"font-medium",children:E.company_name}),E.contact_person&&i.jsx("div",{className:"text-xs text-gray-500",children:E.contact_person})]},E.id)),o.length===0&&i.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No customers found"})]}),i.jsxs("button",{type:"button",onClick:()=>d(!0),className:"mt-1 text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[i.jsx(Wn,{className:"w-3 h-3"}),"Add New Customer"]})]})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Person"}),i.jsx("input",{type:"text",value:p.contact_person,onChange:E=>m({...p,contact_person:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"text",value:p.contact_email,onChange:E=>m({...p,contact_email:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"email@example.com or multiple: email1@example.com, email2@example.com"}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Use comma (,) or semicolon (;) to separate multiple emails"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:p.contact_phone,onChange:E=>m({...p,contact_phone:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+62 xxx"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Mail Subject"}),i.jsx("input",{type:"text",value:p.mail_subject,onChange:E=>m({...p,mail_subject:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Email subject line"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Customer Requested"}),i.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.price_required,onChange:E=>m({...p,price_required:E.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"Price"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.coa_required,onChange:E=>m({...p,coa_required:E.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"COA"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.sample_required,onChange:E=>m({...p,sample_required:E.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"Sample"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.agency_letter_required,onChange:E=>m({...p,agency_letter_required:E.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"Agency Letter"})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.others_required,onChange:E=>m({...p,others_required:E.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),i.jsx("span",{className:"text-xs text-gray-700",children:"Others"})]})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[i.jsx("h3",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Pricing"}),i.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Purchase Price"}),i.jsx("input",{type:"text",value:p.purchase_price,onChange:E=>m({...p,purchase_price:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"100.00"})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Currency"}),i.jsxs("select",{value:p.purchase_price_currency,onChange:E=>m({...p,purchase_price_currency:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"USD",children:"USD"}),i.jsx("option",{value:"IDR",children:"IDR"})]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Offered Price"}),i.jsx("input",{type:"text",value:p.offered_price,onChange:E=>m({...p,offered_price:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"150.00"})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Currency"}),i.jsxs("select",{value:p.offered_price_currency,onChange:E=>m({...p,offered_price_currency:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"USD",children:"USD"}),i.jsx("option",{value:"IDR",children:"IDR"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Date"}),i.jsx("input",{type:"date",value:p.delivery_date,onChange:E=>m({...p,delivery_date:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Terms"}),i.jsxs("select",{value:p.delivery_terms,onChange:E=>m({...p,delivery_terms:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select..."}),i.jsx("option",{value:"FOB Jakarta",children:"FOB Jakarta"}),i.jsx("option",{value:"CIF Jakarta",children:"CIF Jakarta"}),i.jsx("option",{value:"FOB Surabaya",children:"FOB Surabaya"}),i.jsx("option",{value:"CIF Surabaya",children:"CIF Surabaya"}),i.jsx("option",{value:"FOB Semarang",children:"FOB Semarang"}),i.jsx("option",{value:"CIF Semarang",children:"CIF Semarang"}),i.jsx("option",{value:"EXW",children:"EXW"}),i.jsx("option",{value:"DDP",children:"DDP"}),i.jsx("option",{value:"DAP",children:"DAP"}),i.jsx("option",{value:"CFR",children:"CFR"}),i.jsx("option",{value:"FCA",children:"FCA"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"ACE ERP No"}),i.jsx("input",{type:"text",value:p.aceerp_no,onChange:E=>m({...p,aceerp_no:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pipeline Status"}),i.jsxs("select",{value:p.pipeline_status,onChange:E=>m({...p,pipeline_status:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"new",children:"New"}),i.jsx("option",{value:"contacted",children:"Contacted"}),i.jsx("option",{value:"qualified",children:"Qualified"}),i.jsx("option",{value:"proposal",children:"Proposal"}),i.jsx("option",{value:"negotiation",children:"Negotiation"}),i.jsx("option",{value:"won",children:"Won"}),i.jsx("option",{value:"lost",children:"Lost"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Remarks"}),i.jsx("textarea",{value:p.remarks,onChange:E=>m({...p,remarks:E.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Customer notes, special requirements..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Internal Notes"}),i.jsx("textarea",{value:p.internal_notes,onChange:E=>m({...p,internal_notes:E.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Private notes (not visible to customer)..."})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 sticky bottom-0 bg-white",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",disabled:v,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",disabled:v,children:v?"Saving...":n?"Update Inquiry":"Add Inquiry"})]})]}),f&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Add New Customer"}),i.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:i.jsx(An,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Company Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:w.company_name,onChange:E=>x({...w,company_name:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Company name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Person"}),i.jsx("input",{type:"text",value:w.contact_person,onChange:E=>x({...w,contact_person:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Contact name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"text",value:w.email,onChange:E=>x({...w,email:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"email@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"tel",value:w.phone,onChange:E=>x({...w,phone:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+62 xxx"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Country"}),i.jsx("input",{type:"text",value:w.country,onChange:E=>x({...w,country:E.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Indonesia"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Address"}),i.jsx("textarea",{value:w.address,onChange:E=>x({...w,address:E.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Full address"})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[i.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{onClick:_,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Add Customer"})]})]})})]})}function Rne({isOpen:e,matches:t,searchTerm:r,onSelect:n,onCreateNew:a,onCancel:s,inquiryCounts:o={}}){const[l,c]=Z.useState(null),u=()=>{const f=t.find(d=>d.customer.id===l);f&&n(f.customer)},A=f=>{switch(f){case"high":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},h=f=>{switch(f){case"exact":return"Exact Match";case"startsWith":return"Starts With";case"contains":return"Contains";case"fuzzy":return"Similar Name";default:return"Match"}};return i.jsx(ir,{isOpen:e,onClose:s,title:"Select Existing Customer",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(ya,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm text-blue-900 font-medium",children:["We found ",t.length," existing customer",t.length!==1?"s":"",' similar to "',r,'"']}),i.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Please select the correct customer or create a new one"})]})]})}),i.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:t.map(f=>{const d=o[f.customer.id]||0,v=l===f.customer.id;return i.jsx("div",{onClick:()=>c(f.customer.id),className:`border rounded-lg p-4 cursor-pointer transition-all ${v?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("input",{type:"radio",checked:v,onChange:()=>c(f.customer.id),className:"h-4 w-4 text-blue-600"}),i.jsx("h3",{className:"font-semibold text-gray-900",children:f.customer.company_name}),i.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${A(f.confidence)}`,children:[h(f.matchType)," (",f.score,"%)"]})]}),i.jsxs("div",{className:"ml-6 space-y-1",children:[f.customer.contact_person&&i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(Qu,{className:"h-4 w-4 mr-2"}),f.customer.contact_person]}),f.customer.email&&i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(la,{className:"h-4 w-4 mr-2"}),f.customer.email]}),f.customer.phone&&i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(kl,{className:"h-4 w-4 mr-2"}),f.customer.phone]}),i.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[i.jsx(as,{className:"h-4 w-4 mr-2"}),d," ",d===1?"inquiry":"inquiries"," on record"]})]})]}),v&&i.jsx(ua,{className:"h-6 w-6 text-blue-600 flex-shrink-0"})]})},f.customer.id)})}),i.jsx("div",{className:"border-t pt-4",children:i.jsxs("button",{onClick:a,className:"w-full text-left px-4 py-3 border border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[i.jsxs("div",{className:"flex items-center text-blue-600",children:[i.jsx(Qu,{className:"h-5 w-5 mr-2"}),i.jsx("span",{className:"font-medium",children:"None of these - Create New Customer"})]}),i.jsxs("p",{className:"text-xs text-gray-500 ml-7 mt-1",children:['Create a new customer record for "',r,'"']})]})}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:u,disabled:!l,className:`px-4 py-2 rounded-lg text-white ${l?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 cursor-not-allowed"}`,children:"Select Customer"})]})]})})}function Qne({isOpen:e,initialData:t,onConfirm:r,onCancel:n}){const[a,s]=Z.useState({company_name:t.company_name||"",contact_person:t.contact_person||"",email:t.email||"",phone:t.phone||"",address:t.address||"",city:t.city||"Jakarta Pusat",country:t.country||"Indonesia",pbf_license:t.pbf_license||"",npwp:t.npwp||""}),[o,l]=Z.useState(!1),[c,u]=Z.useState({}),A=()=>{const d={};return a.company_name.trim()||(d.company_name="Company name is required"),a.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)&&(d.email="Invalid email format"),u(d),Object.keys(d).length===0},h=async()=>{if(A()){l(!0);try{await r(a)}catch(d){console.error("Error creating customer:",d),alert("Failed to create customer. Please try again.")}finally{l(!1)}}},f=(d,v)=>{s(g=>({...g,[d]:v})),c[d]&&u(g=>{const y={...g};return delete y[d],y})};return i.jsx(ir,{isOpen:e,onClose:n,title:"Create New Customer",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(ya,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"Creating a new customer record"}),i.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Please verify the information below before creating"})]})]})}),i.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(Mw,{className:"inline h-4 w-4 mr-1"}),"Company Name *"]}),i.jsx("input",{type:"text",value:a.company_name,onChange:d=>f("company_name",d.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${c.company_name?"border-red-500":"border-gray-300"}`,placeholder:"Enter company name"}),c.company_name&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:c.company_name})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(to,{className:"inline h-4 w-4 mr-1"}),"Contact Person"]}),i.jsx("input",{type:"text",value:a.contact_person,onChange:d=>f("contact_person",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter contact person name"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(la,{className:"inline h-4 w-4 mr-1"}),"Email"]}),i.jsx("input",{type:"email",value:a.email,onChange:d=>f("email",d.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${c.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email address"}),c.email&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:c.email})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(kl,{className:"inline h-4 w-4 mr-1"}),"Phone"]}),i.jsx("input",{type:"text",value:a.phone,onChange:d=>f("phone",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(nR,{className:"inline h-4 w-4 mr-1"}),"Address"]}),i.jsx("textarea",{value:a.address,onChange:d=>f("address",d.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter address"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),i.jsx("select",{value:a.city,onChange:d=>f("city",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:bF.map(d=>i.jsx("option",{value:d,children:d},d))})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(dF,{className:"inline h-4 w-4 mr-1"}),"Country"]}),i.jsx("input",{type:"text",value:a.country,onChange:d=>f("country",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter country"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PBF License"}),i.jsx("input",{type:"text",value:a.pbf_license,onChange:d=>f("pbf_license",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter PBF license number"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NPWP"}),i.jsx("input",{type:"text",value:a.npwp,onChange:d=>f("npwp",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter NPWP number"})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:n,disabled:o,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:h,disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:o?"Creating...":"Create Customer"})]})]})})}function Mne({isOpen:e,customerName:t,changedFields:r,oldValues:n,newValues:a,onUpdateCustomer:s,onKeepExisting:o,onCancel:l}){const c=u=>({email:"Email",phone:"Phone",contact_person:"Contact Person",address:"Address",city:"City",country:"Country"})[u]||u;return i.jsx(ir,{isOpen:e,onClose:l,title:"Update Customer Information?",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(ya,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-yellow-900 font-medium",children:"Contact details differ from master record"}),i.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["The information you entered for ",i.jsx("span",{className:"font-semibold",children:t})," differs from what's stored in the customer database."]})]})]})}),i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:i.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Changes Detected"})}),i.jsx("div",{className:"divide-y divide-gray-200",children:r.map(u=>i.jsxs("div",{className:"px-4 py-3",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase mb-2",children:c(u)}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"flex-1 bg-red-50 border border-red-200 rounded px-3 py-2",children:[i.jsx("div",{className:"text-xs text-red-600 font-medium mb-0.5",children:"Current"}),i.jsx("div",{className:"text-sm text-gray-900",children:n[u]||i.jsx("span",{className:"text-gray-400 italic",children:"Not set"})})]}),i.jsx(M7,{className:"h-5 w-5 text-gray-400 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 bg-green-50 border border-green-200 rounded px-3 py-2",children:[i.jsx("div",{className:"text-xs text-green-600 font-medium mb-0.5",children:"New"}),i.jsx("div",{className:"text-sm text-gray-900",children:a[u]||i.jsx("span",{className:"text-gray-400 italic",children:"Not set"})})]})]})]},u))})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:i.jsxs("p",{className:"text-xs text-blue-900",children:[i.jsx("strong",{children:"Tip:"})," Updating the customer record will apply these changes to all future inquiries for this customer."]})}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Keep Existing"}),i.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update Customer Record"})]})]})})}function Xg(e){return e?e.toLowerCase().trim().replace(/\s+/g," ").replace(/\b(ltd|limited|inc|incorporated|pvt|private|llc|corp|corporation|co|company|pte|sdn bhd|tbk|pt)\b\.?/gi,"").replace(/[^\w\s]/g,"").trim():""}function Hne(e,t){const r=e.length,n=t.length,a=[];if(r===0)return n;if(n===0)return r;for(let s=0;s<=r;s++)a[s]=[s];for(let s=0;s<=n;s++)a[0][s]=s;for(let s=1;s<=r;s++)for(let o=1;o<=n;o++){const l=e[s-1]===t[o-1]?0:1;a[s][o]=Math.min(a[s-1][o]+1,a[s][o-1]+1,a[s-1][o-1]+l)}return a[r][n]}function qne(e,t){const r=Xg(e),n=Xg(t);if(r===n)return 1;const a=Math.max(r.length,n.length);return a===0?1:1-Hne(r,n)/a}function yC(e){if(!e)return"";const t=e.match(/@(.+)$/);return t?t[1].toLowerCase():""}function nI(e,t){if(!e||!t.length)return[];const r=Xg(e),n=e.toLowerCase().trim(),a=[];for(const s of t){const o=Xg(s.company_name),l=s.company_name.toLowerCase().trim();let c="fuzzy",u=0;if(o===r)c="exact",u=100;else if(l.startsWith(n))c="startsWith",u=90-(l.length-n.length);else if(l.includes(n))c="contains",u=75-l.indexOf(n)*2;else{const f=qne(e,s.company_name);if(f>=.6)u=Math.round(f*70);else continue}(s.email&&e.includes("@")?yC(s.email)===yC(e):!1)&&(u+=15);let h;u>=90?h="high":u>=70?h="medium":h="low",a.push({customer:s,score:Math.min(u,100),matchType:c,confidence:h})}return a.sort((s,o)=>o.score-s.score)}function Kne(e,t){const r=nI(e,t);return r.length>0&&r[0].score>=90?r[0]:null}function $ne(e,t){const r=[],n={},a={},s=c=>(c==null?void 0:c.toLowerCase().trim())||"",o=c=>(c==null?void 0:c.replace(/\D/g,""))||"",l=c=>(c==null?void 0:c.trim())||"";if(e.contact_email&&t.email){const c=s(e.contact_email),u=s(t.email);c!==u&&c!==""&&(r.push("email"),n.email=t.email,a.email=e.contact_email)}if(e.contact_phone&&t.phone){const c=o(e.contact_phone),u=o(t.phone);c!==u&&c!==""&&(r.push("phone"),n.phone=t.phone,a.phone=e.contact_phone)}if(e.contact_person&&t.contact_person){const c=l(e.contact_person),u=l(t.contact_person);c!==u&&c!==""&&(r.push("contact_person"),n.contact_person=t.contact_person,a.contact_person=e.contact_person)}return{hasChanges:r.length>0,changedFields:r,oldValues:n,newValues:a}}function Vne(){var D;const{profile:e}=Dr(),[t,r]=Z.useState([]),[n,a]=Z.useState(!0),[s,o]=Z.useState("table"),[l,c]=Z.useState(!1),[u,A]=Z.useState(null),[h,f]=Z.useState(!1),[d,v]=Z.useState(null),[g,y]=Z.useState(null),[p,m]=Z.useState([]),[w,x]=Z.useState(!1),[b,B]=Z.useState(!1),[_,k]=Z.useState(!1),[E,T]=Z.useState(null),[S,j]=Z.useState({});Z.useEffect(()=>{I()},[]);const I=async()=>{try{const{data:P,error:Q}=await de.from("crm_inquiries").select("*, user_profiles!crm_inquiries_assigned_to_fkey(full_name)").neq("pipeline_status","lost").order("created_at",{ascending:!1});if(Q)throw Q;r(P||[])}catch(P){console.error("Error loading inquiries:",P)}finally{a(!1)}},U=async()=>{try{const{data:P,error:Q}=await de.from("customers").select("id, company_name, contact_person, email, phone, country, address, city").eq("is_active",!0);if(Q)throw Q;return P||[]}catch(P){return console.error("Error loading customers:",P),[]}},q=async P=>{try{const{data:Q,error:J}=await de.from("crm_inquiries").select("customer_id").in("customer_id",P);if(J)throw J;const te={};Q==null||Q.forEach(z=>{z.customer_id&&(te[z.customer_id]=(te[z.customer_id]||0)+1)}),j(te)}catch(Q){console.error("Error loading inquiry counts:",Q)}},V=async P=>{if(P.customer_id){const z=(await U()).find(ye=>ye.id===P.customer_id);if(z){const ye=$ne({contact_email:P.contact_email,contact_phone:P.contact_phone,contact_person:P.contact_person},z);if(ye.hasChanges)return T({...ye,customer:z}),y(P),k(!0),!1}return!0}const Q=await U(),J=nI(P.company_name,Q);if(J.length>0){const te=Kne(P.company_name,Q);return te&&te.score>=95?(P.customer_id=te.customer.id,V(P)):(m(J),y(P),await q(J.map(z=>z.customer.id)),x(!0),!1)}else return y(P),B(!0),!1},X=P=>{const Q={...P},J=["delivery_date","inquiry_date"],te=["purchase_price","offered_price"];return J.forEach(z=>{(Q[z]===""||Q[z]===void 0)&&(Q[z]=null)}),te.forEach(z=>{Q[z]===""||Q[z]===void 0?Q[z]=null:Q[z]!==null&&(Q[z]=parseFloat(Q[z]))}),Q},W=async P=>{try{const{data:{user:Q}}=await de.auth.getUser();if(!Q)throw new Error("Not authenticated");if(!u){if(!await V(P))return;if(!P.customer_id){alert("Customer selection is required. Please select or create a customer.");return}}if(u){const{products:J,is_multi_product:te,...z}=P,ye=X({...z,specification:P.specification||null,purchase_price:P.purchase_price?parseFloat(P.purchase_price):null,offered_price:P.offered_price?parseFloat(P.offered_price):null}),{error:re}=await de.from("crm_inquiries").update(ye).eq("id",u.id);if(re)throw re}else{const{products:J,is_multi_product:te,...z}=P;if(te&&J&&J.length>0){const ye=J.map(be=>X({...z,product_name:be.productName||be.product_name,specification:be.specification||null,quantity:be.quantity,supplier_name:be.supplierName||z.supplier_name||null,supplier_country:be.supplierCountry||z.supplier_country||null,delivery_date:be.deliveryDate||null,delivery_terms:be.deliveryTerms||null,inquiry_date:new Date().toISOString().split("T")[0],assigned_to:Q.id,created_by:Q.id,purchase_price:null,offered_price:null,is_multi_product:!1,has_items:!1})),{data:re,error:ke}=await de.from("crm_inquiries").insert(ye).select();if(ke)throw ke;if(re&&re.length>0){const be=re[0].inquiry_number;for(let ae=0;ae<re.length;ae++)await de.from("crm_inquiries").update({inquiry_number:`${be}.${ae+1}`}).eq("id",re[ae].id)}}else{const ye=X({...z,specification:P.specification||null,inquiry_date:new Date().toISOString().split("T")[0],assigned_to:Q.id,created_by:Q.id,purchase_price:P.purchase_price?parseFloat(P.purchase_price):null,offered_price:P.offered_price?parseFloat(P.offered_price):null,is_multi_product:!1,has_items:!1}),{error:re}=await de.from("crm_inquiries").insert([ye]);if(re)throw re}}c(!1),A(null),I()}catch(Q){throw console.error("Error saving inquiry:",Q),alert("Failed to save inquiry. Please try again."),Q}},M=P=>{A(P),c(!0)},G=P=>{g&&(g.customer_id=P.id,x(!1),W(g))},H=async P=>{try{const{data:Q,error:J}=await de.from("customers").insert({...P,is_active:!0}).select().single();if(J)throw J;g&&(g.customer_id=Q.id,B(!1),W(g))}catch(Q){throw console.error("Error creating customer:",Q),Q}},C=async()=>{if(!(!E||!E.customer))try{const P={};E.changedFields.forEach(J=>{P[J]=E.newValues[J]});const{error:Q}=await de.from("customers").update(P).eq("id",E.customer.id);if(Q)throw Q;k(!1),g&&W(g)}catch(P){console.error("Error updating customer:",P),alert("Failed to update customer. Please try again.")}},L=()=>{k(!1),g&&W(g)},O=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="sales";return i.jsx(ca,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"flex items-center",children:i.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"CRM - Inquiry Management"})}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("div",{className:"flex overflow-x-auto",children:[i.jsxs("button",{onClick:()=>o("email"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${s==="email"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(hF,{className:"w-5 h-5"}),"Email Inbox"]}),i.jsxs("button",{onClick:()=>o("table"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${s==="table"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(uR,{className:"w-5 h-5"}),"Table View"]}),i.jsxs("button",{onClick:()=>o("pipeline"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${s==="pipeline"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(tR,{className:"w-5 h-5"}),"Pipeline"]}),i.jsxs("button",{onClick:()=>o("calendar"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${s==="calendar"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(as,{className:"w-5 h-5"}),"Calendar"]}),i.jsxs("button",{onClick:()=>o("customers"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${s==="customers"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(Qu,{className:"w-5 h-5"}),"Customers"]}),i.jsxs("button",{onClick:()=>o("activities"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${s==="activities"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(R7,{className:"w-5 h-5"}),"Activities"]}),i.jsxs("button",{onClick:()=>o("appointments"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${s==="appointments"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(ts,{className:"w-5 h-5"}),"Appointments"]}),i.jsxs("button",{onClick:()=>o("archive"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${s==="archive"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(oF,{className:"w-5 h-5"}),"Archive"]})]})}),i.jsxs("div",{className:"p-6",children:[s==="email"&&i.jsx(B$,{}),s==="table"&&i.jsx(jne,{inquiries:t,onRefresh:I,canManage:O,onAddInquiry:()=>{A(null),c(!0)}}),s==="pipeline"&&i.jsx(Tne,{canManage:O,onInquiryClick:P=>M(P)}),s==="calendar"&&i.jsx(Fne,{onReminderCreated:I}),s==="customers"&&i.jsx(One,{}),s==="activities"&&i.jsx(Une,{onActivityLogged:I}),s==="appointments"&&i.jsx(Pne,{onAppointmentCreated:I}),s==="archive"&&i.jsx(Dne,{canManage:O,onRefresh:I})]})]}),i.jsx(ir,{isOpen:l,onClose:()=>{c(!1),A(null)},title:u?"Edit Inquiry":"Add New Inquiry",children:i.jsx(rI,{onSubmit:W,onCancel:()=>{c(!1),A(null)},initialData:u,isEditing:!!u})}),i.jsx(ir,{isOpen:h,onClose:()=>{f(!1),v(null)},title:"Send Email",children:i.jsx(Ine,{inquiry:d,onClose:()=>{f(!1),v(null)},onSent:()=>{I()}})}),i.jsx(Rne,{isOpen:w,matches:p,searchTerm:(g==null?void 0:g.company_name)||"",onSelect:G,onCreateNew:()=>{x(!1),B(!0)},onCancel:()=>{x(!1),y(null)},inquiryCounts:S}),i.jsx(Qne,{isOpen:b,initialData:{company_name:(g==null?void 0:g.company_name)||"",contact_person:(g==null?void 0:g.contact_person)||"",email:(g==null?void 0:g.contact_email)||"",phone:(g==null?void 0:g.contact_phone)||"",country:(g==null?void 0:g.supplier_country)||"Indonesia"},onConfirm:H,onCancel:()=>{B(!1),y(null)}}),i.jsx(Mne,{isOpen:_,customerName:((D=E==null?void 0:E.customer)==null?void 0:D.company_name)||"",changedFields:(E==null?void 0:E.changedFields)||[],oldValues:(E==null?void 0:E.oldValues)||{},newValues:(E==null?void 0:E.newValues)||{},onUpdateCustomer:C,onKeepExisting:L,onCancel:()=>{k(!1),y(null)}})]})})}function Gne({onEmailSelect:e,selectedEmailId:t}){const[r,n]=Z.useState([]),[a,s]=Z.useState(!0),[o,l]=Z.useState(!1),[c,u]=Z.useState(null),A=Z.useCallback(async()=>{try{const{data:y,error:p}=await de.from("crm_email_inbox").select("*").eq("is_processed",!1).order("received_date",{ascending:!1}).limit(50);if(p)throw p;n(y||[])}catch(y){console.error("Error loading emails:",y)}finally{s(!1),l(!1)}},[]),h=Z.useCallback(async()=>{l(!0);try{const{data:{session:y}}=await de.auth.getSession();if(!y){console.error("Not authenticated"),l(!1);return}const p="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/sync-gmail-emails",m=new AbortController,w=setTimeout(()=>m.abort(),12e4),x=await fetch(p,{method:"POST",headers:{Authorization:`Bearer ${y.access_token}`,"Content-Type":"application/json"},signal:m.signal});if(clearTimeout(w),!x.ok)throw new Error(`Sync failed: ${x.status}`);await x.json(),await A()}catch(y){console.error("Error syncing emails:",y),await A()}finally{l(!1)}},[A]);Z.useEffect(()=>{A();const y=de.channel("email_inbox_changes").on("postgres_changes",{event:"*",schema:"public",table:"crm_email_inbox"},()=>{A()}).subscribe(),p=setInterval(()=>{h()},6e5);return()=>{y.unsubscribe(),clearInterval(p)}},[A,h]),Z.useEffect(()=>{(async()=>{const p=sessionStorage.getItem("pendingEmailForInquiry");if(p){console.log("[EmailListPanel] Found pending email in sessionStorage"),sessionStorage.removeItem("pendingEmailForInquiry"),document.body.style.cursor="wait";try{const m=JSON.parse(p);console.log("[EmailListPanel] Parsed email data:",m);const{data:{session:w}}=await de.auth.getSession();if(!w)throw console.error("[EmailListPanel] No session found"),new Error("Not authenticated");try{const{data:_}=await de.from("crm_inquiries").select("id, inquiry_number, product_name").eq("mail_subject",m.subject).maybeSingle();if(_){if(!confirm(`This email has already been processed as Inquiry #${_.inquiry_number} (${_.product_name}).

Do you want to reprocess it?`)){console.log("[EmailListPanel] User declined to reprocess existing inquiry"),sessionStorage.removeItem("pendingEmailForCommandCenter");return}console.log("[EmailListPanel] User confirmed reprocessing existing inquiry")}}catch(_){console.warn("[EmailListPanel] Could not check for duplicates (continuing anyway):",_)}console.log("[EmailListPanel] Calling parse-pharma-email edge function");const x="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/parse-pharma-email";console.log("[EmailListPanel] API URL:",x),console.log("[EmailListPanel] Request body:",{emailSubject:m.subject,emailBody:m.body.substring(0,100)+"...",fromEmail:m.fromEmail,fromName:m.fromName});const b=await fetch(x,{method:"POST",headers:{Authorization:`Bearer ${w.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({emailSubject:m.subject,emailBody:m.body,fromEmail:m.fromEmail,fromName:m.fromName})});if(console.log("[EmailListPanel] Response status:",b.status),!b.ok){const _=await b.text();throw console.error("[EmailListPanel] Response error:",_),new Error(`Edge function returned ${b.status}: ${_}`)}const B=await b.json();if(console.log("[EmailListPanel] Parse result:",B),B.success||B.fallbackData){const _={id:"gmail-"+Date.now(),from_email:m.fromEmail,from_name:m.fromName,subject:m.subject,body:m.body,received_date:m.date,is_processed:!1,is_inquiry:!1,parsed_data:null,converted_to_inquiry:null};console.log("[EmailListPanel] Calling onEmailSelect with mock email"),e(_,B.data||B.fallbackData)}else console.error("[EmailListPanel] Parse failed:",B.error),alert("Failed to parse email from Gmail: "+B.error)}catch(m){console.error("[EmailListPanel] Error processing pending email:",m),alert(`Failed to process email: ${m instanceof Error?m.message:String(m)}`)}finally{document.body.style.cursor="default"}}else console.log("[EmailListPanel] No pending email found in sessionStorage")})()},[e]);const f=async y=>{u(y.id),document.body.style.cursor="wait";try{const{data:{session:p}}=await de.auth.getSession();if(!p)throw new Error("Not authenticated");const x=await(await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/parse-pharma-email",{method:"POST",headers:{Authorization:`Bearer ${p.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({emailSubject:y.subject,emailBody:y.body,fromEmail:y.from_email,fromName:y.from_name})})).json();x.success?e(y,x.data):x.fallbackData?e(y,x.fallbackData):(alert("Failed to parse email: "+x.error),e(y,null))}catch(p){console.error("Error parsing email:",p),alert("Failed to parse email. Please try again.")}finally{u(null),document.body.style.cursor="default"}},d=y=>{var b,B;const p=((b=y.body)==null?void 0:b.toLowerCase())||"",m=((B=y.subject)==null?void 0:B.toLowerCase())||"",w=p+" "+m,x=[];return(w.includes("price")||w.includes("harga")||w.includes("quotation")||w.includes("quote"))&&x.push({icon:Ro,color:"text-green-600",label:"Price"}),(w.includes("coa")||w.includes("certificate")||w.includes("analysis"))&&x.push({icon:pr,color:"text-blue-600",label:"COA"}),(w.includes("msds")||w.includes("safety")||w.includes("data sheet"))&&x.push({icon:pr,color:"text-orange-600",label:"MSDS"}),(w.includes("sample")||w.includes("sampel"))&&x.push({icon:xF,color:"text-purple-600",label:"Sample"}),x},v=y=>{const m=(y.body||"").split(`
`).filter(B=>B.trim().length>0);let w="",x="",b="";for(const B of m.slice(0,20)){const _=B.toLowerCase();if(!w&&(_.includes("product")||_.includes("material")||_.includes("item"))&&(w=B.replace(/^[^:]+:/,"").trim().substring(0,50)),!x&&(_.includes("qty")||_.includes("quantity")||_.includes("kg")||_.includes("mt"))){const k=B.match(/\d+\s*(kg|mt|ton|units?|pcs)/i);k&&(x=k[0])}!b&&(_.includes("supplier")||_.includes("manufacturer")||_.includes("origin"))&&(b=B.replace(/^[^:]+:/,"").trim().substring(0,30))}return{product:w,quantity:x,supplier:b}},g=y=>{const p=(y.subject+" "+y.body).toLowerCase();return p.includes("urgent")||p.includes("asap")||p.includes("segera")||p.includes("mendesak")};return a?i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Loading emails..."})]})}):i.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(la,{className:"w-5 h-5 text-blue-600"}),i.jsx("h2",{className:"font-semibold text-gray-900",children:"New Emails"}),i.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:r.length})]}),i.jsx("button",{onClick:h,disabled:o,className:"p-1.5 hover:bg-gray-200 rounded-lg transition",title:"Refresh emails",children:i.jsx(Ec,{className:`w-4 h-4 text-gray-600 ${o?"animate-spin":""}`})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[i.jsx(la,{className:"w-16 h-16 text-gray-300 mb-4"}),i.jsx("p",{className:"text-gray-600 font-medium",children:"No unprocessed emails"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"New emails will appear here automatically"})]}):i.jsx("div",{className:"divide-y divide-gray-100",children:r.map(y=>{const p=v(y),m=d(y),w=g(y),x=t===y.id,b=c===y.id;return i.jsxs("div",{onClick:()=>!b&&f(y),className:`p-4 cursor-pointer transition ${x?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50 border-l-4 border-transparent"} ${b?"opacity-50 cursor-wait":""}`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"font-semibold text-gray-900 truncate",children:y.from_name||y.from_email}),w&&i.jsx("span",{className:"flex-shrink-0 px-1.5 py-0.5 text-xs font-bold bg-red-100 text-red-700 rounded",children:"URGENT"})]}),i.jsx("p",{className:"text-xs text-gray-500 truncate",children:y.from_email})]}),b&&i.jsx(cd,{className:"w-5 h-5 text-blue-600 animate-pulse flex-shrink-0 ml-2"})]}),i.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2 line-clamp-1",children:y.subject}),(p.product||p.quantity)&&i.jsxs("div",{className:"space-y-1 mb-2",children:[p.product&&i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(si,{className:"w-3.5 h-3.5 text-gray-400 mt-0.5 flex-shrink-0"}),i.jsx("span",{className:"text-xs text-gray-600 line-clamp-1",children:p.product})]}),p.quantity&&i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("span",{className:"text-xs font-medium text-blue-600",children:p.quantity})})]}),m.length>0&&i.jsx("div",{className:"flex items-center gap-2 mb-2",children:m.map((B,_)=>i.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-gray-100 rounded",title:B.label,children:[i.jsx(B.icon,{className:`w-3 h-3 ${B.color}`}),i.jsx("span",{className:"text-xs text-gray-600",children:B.label})]},_))}),i.jsxs("div",{className:"flex items-center justify-between mt-2",children:[i.jsx("span",{className:"text-xs text-gray-500",children:new Date(y.received_date).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),!b&&i.jsxs("span",{className:"text-xs text-blue-600 font-medium flex items-center gap-1",children:[i.jsx(cd,{className:"w-3 h-3"}),"AI Parse"]})]})]},y.id)})})})]})}function Wne({email:e,parsedData:t,onSave:r,saving:n}){const[a,s]=Z.useState(!1),[o,l]=Z.useState(null),[c,u]=Z.useState(!1),A=(t==null?void 0:t.products)&&t.products.length>1;Z.useEffect(()=>{var d,v;if(console.log("[InquiryFormPanel] useEffect triggered",{email:e,parsedData:t}),t){let g=t.contactPerson||"",y=t.contactEmail||"";if(typeof g=="object"&&!Array.isArray(g)?g=g.name||"":Array.isArray(g)&&(g=((d=g[0])==null?void 0:d.name)||g[0]||""),typeof y=="object"&&!Array.isArray(y)?y=y.email||"":Array.isArray(y)&&(y=((v=y[0])==null?void 0:v.email)||y[0]||""),typeof y=="string"){y=y.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim();const w=/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g,x=[];let b;for(;(b=w.exec(y))!==null;)x.includes(b[1])||x.push(b[1]);x.length>0&&(y=x.join(", "))}typeof g=="string"&&(g=g.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim());let p=t.companyName||"";typeof p=="string"&&(p=p.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim());const m={product_name:t.productName||"",specification:t.specification||"",quantity:t.quantity||"",supplier_name:t.supplierName||"",supplier_country:t.supplierCountry||"",company_name:p,contact_person:g,contact_email:y,contact_phone:t.contactPhone||"",priority:t.urgency||"medium",delivery_date:t.deliveryDateExpected||"",remarks:t.remarks||"",coa_required:A?!0:t.coaRequested||!1,sample_required:t.sampleRequested||!1,price_required:A?!0:t.priceRequested||!0,agency_letter_required:t.agencyLetterRequested||!1,aceerp_no:"",purchase_price:"",purchase_price_currency:"USD",offered_price:"",offered_price_currency:"USD",delivery_terms:"",inquiry_source:"email",mail_subject:(e==null?void 0:e.subject)||"",is_multi_product:A,products:t.products||[]};console.log("[InquiryFormPanel] Setting initialData:",m),l(m),A&&u(!0)}},[t,e,A]);const h=async d=>{const v={inquiryNumber:"",productName:d.product_name,specification:d.specification||"",quantity:d.quantity,supplierName:d.supplier_name||"",supplierCountry:d.supplier_country||"",companyName:d.company_name,contactPerson:d.contact_person||"",contactEmail:d.contact_email||"",contactPhone:d.contact_phone||"",priority:d.priority,purposeIcons:[],deliveryDateExpected:d.delivery_date||"",remarks:d.remarks||"",coaRequested:d.coa_required||!1,msdsRequested:!1,sampleRequested:d.sample_required||!1,priceRequested:d.price_required||!1,agencyLetterRequested:d.agency_letter_required||!1,aceerp_no:d.aceerp_no||"",purchasePrice:d.purchase_price||"",purchasePriceCurrency:d.purchase_price_currency||"USD",offeredPrice:d.offered_price||"",offeredPriceCurrency:d.offered_price_currency||"USD",deliveryDate:d.delivery_date||"",deliveryTerms:d.delivery_terms||"",isMultiProduct:d.is_multi_product||!1,products:d.products||[]};await r(v)},f={high:"text-green-600 bg-green-50 border-green-200",medium:"text-yellow-600 bg-yellow-50 border-yellow-200",low:"text-red-600 bg-red-50 border-red-200"};return!e||!t?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8 bg-gray-50",children:[i.jsx(pr,{className:"w-20 h-20 text-gray-300 mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Email Selected"}),i.jsx("p",{className:"text-gray-600 max-w-md",children:"Click on an email from the left panel to automatically parse and fill this inquiry form with AI"}),i.jsxs("div",{className:"mt-6 text-sm text-gray-500 space-y-1",children:[i.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[i.jsx(cd,{className:"w-4 h-4 text-blue-500"}),i.jsx("span",{children:"AI extracts product, quantity, company, contact"})]}),i.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[i.jsx(io,{className:"w-4 h-4 text-green-500"}),i.jsx("span",{children:"Only inquiry number needs manual input"})]})]})]}):i.jsxs("div",{className:"flex flex-col h-full bg-white",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-transparent",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Create Inquiry"}),t&&i.jsx("div",{className:`px-3 py-1 rounded-lg text-sm font-medium border ${f[t.confidence]}`,children:i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(cd,{className:"w-3.5 h-3.5"}),i.jsxs("span",{children:["AI Confidence: ",t.confidence.toUpperCase()]}),i.jsxs("span",{className:"text-xs",children:["(",Math.round(t.confidenceScore*100),"%)"]})]})})]}),e&&i.jsxs("div",{className:"mt-3 bg-white border border-gray-300 rounded-lg shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>s(!a),className:"w-full flex items-center justify-between px-5 py-3 hover:bg-gray-50 transition border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-sm font-bold text-blue-700",children:(e.from_name||e.from_email).charAt(0).toUpperCase()})}),i.jsxs("div",{className:"text-left flex-1 min-w-0",children:[i.jsx("p",{className:"text-base font-semibold text-gray-900 truncate",children:e.subject}),i.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[i.jsx("p",{className:"text-sm text-gray-900 font-medium",children:e.from_name||"Unknown"}),i.jsx("span",{className:"text-gray-400 text-xs",children:""}),i.jsxs("p",{className:"text-xs text-gray-500 truncate",children:["<",e.from_email,">"]})]})]})]}),a?i.jsx(Hw,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"}):i.jsx(To,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"})]}),a&&i.jsxs("div",{className:"bg-white",children:[i.jsx("div",{className:"px-5 py-3 border-b border-gray-100 bg-gray-50",children:i.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:new Date(e.received_date).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})}),i.jsx("div",{className:"px-5 py-4",children:i.jsx(KF,{htmlContent:e.body,className:"max-h-[600px]"})}),i.jsx("div",{className:"px-5 py-3 bg-blue-50 border-t border-blue-100",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[i.jsx(cd,{className:"w-4 h-4"}),i.jsx("span",{className:"font-medium",children:"AI has extracted data from this email. Review the form fields below."})]})})]})]}),(t==null?void 0:t.autoDetectedCompany)&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-700 bg-green-50 px-3 py-1.5 rounded-lg mt-3",children:[i.jsx(io,{className:"w-4 h-4"}),i.jsx("span",{children:"Company auto-detected from email domain"})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(io,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Auto-Generated Inquiry Number"}),i.jsx("p",{className:"text-xs text-green-700",children:"Inquiry number will be automatically generated when you save (format: INQ-2025-NNNN)"})]})]})}),A&&(t==null?void 0:t.products)&&i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(pF,{className:"w-5 h-5 text-blue-600"}),i.jsxs("h3",{className:"text-sm font-semibold text-blue-900",children:["Multi-Product Inquiry Detected (",t.products.length," Products)"]})]}),i.jsx("button",{type:"button",onClick:()=>u(!c),className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",children:c?i.jsxs(i.Fragment,{children:[i.jsx(Hw,{className:"w-4 h-4"}),"Hide Products"]}):i.jsxs(i.Fragment,{children:[i.jsx(To,{className:"w-4 h-4"}),"Show Products"]})})]}),i.jsxs("p",{className:"text-xs text-blue-700 mb-3",children:["This will create a parent inquiry and ",t.products.length," child inquiries with numbers like INQ-2025-001.1, INQ-2025-001.2, etc."]}),c&&i.jsx("div",{className:"bg-white rounded-lg border border-blue-200 overflow-hidden overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-blue-100",children:[i.jsx("thead",{className:"bg-blue-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"#"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Product Name"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Specification"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Quantity"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Supplier / Origin"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Delivery Date"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Delivery Terms"})]})}),i.jsx("tbody",{className:"divide-y divide-blue-100",children:t.products.map((d,v)=>i.jsxs("tr",{className:"hover:bg-blue-50",children:[i.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:v+1}),i.jsx("td",{className:"px-3 py-2 text-xs font-medium text-gray-900",children:d.productName||d.product_name}),i.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:d.specification||d.spec||"-"}),i.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:d.quantity||"-"}),i.jsxs("td",{className:"px-3 py-2 text-xs text-gray-700",children:[d.supplierName||d.supplier_name||d.origin||"-",(d.supplierCountry||d.supplier_country)&&` (${d.supplierCountry||d.supplier_country})`]}),i.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:d.deliveryDate||d.delivery_date||d.tglDatang||d.tgl_datang||"-"}),i.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:d.deliveryTerms||d.delivery_terms||"-"})]},v))})]})})]}),o&&i.jsx(rI,{onSubmit:h,onCancel:()=>{},initialData:o,isEditing:!1})]})})]})}async function zne(e,t,r,n,a){var s;try{const{data:o,error:l}=await de.from("crm_inquiries").select("*").eq("id",e).single();if(l)throw l;let c=o.status,u=!1;const A={};switch(t){case"send_price":A.price_quoted=!0,A.price_quoted_date=new Date().toISOString().split("T")[0],c="price_quoted",u=!0;break;case"send_coa":A.coa_sent=!0,A.coa_sent_date=new Date().toISOString().split("T")[0],o.price_quoted&&o.coa_sent&&(c="negotiation",u=!0);break;case"send_msds":A.msds_sent=!0,A.msds_sent_date=new Date().toISOString().split("T")[0];break;case"send_sample":A.sample_sent=!0,A.sample_sent_date=new Date().toISOString().split("T")[0],c="sample_sent",u=!0;break}if(u&&(A.status=c),Object.keys(A).length>0){const{error:v}=await de.from("crm_inquiries").update(A).eq("id",e);if(v)throw v}let h;const{data:f}=await de.rpc("auto_create_followup",{p_inquiry_id:e,p_action_type:t,p_user_id:n});f&&(h=f);const{error:d}=await de.from("crm_quick_actions_log").insert({inquiry_id:e,action_type:t,action_label:r,email_sent:!!(a!=null&&a.emailTo),email_to:(a==null?void 0:a.emailTo)||null,email_subject:(a==null?void 0:a.emailSubject)||null,email_body:(a==null?void 0:a.emailBody)||null,template_used:(a==null?void 0:a.templateId)||null,old_status:o.status,new_status:c,status_updated:u,follow_up_created:!!h,follow_up_reminder_id:h||null,notes:(a==null?void 0:a.notes)||null,performed_by:n});if(d)throw d;if(a!=null&&a.emailTo&&(a!=null&&a.emailSubject)&&(a!=null&&a.emailBody)){const{error:v}=await de.from("crm_email_activities").insert({inquiry_id:e,email_type:"sent",from_email:(s=(await de.auth.getUser()).data.user)==null?void 0:s.email,to_email:[a.emailTo],subject:a.emailSubject,body:a.emailBody,template_id:a.templateId||null,sent_date:new Date().toISOString(),created_by:n});v&&console.error("Error logging email:",v)}return{success:!0,reminderId:h}}catch(o){return console.error("Error performing quick action:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}async function Xne(e,t,r,n,a,s){try{let o=null,l="";switch(n){case"customer_will_revert":o=new Date,o.setDate(o.getDate()+2),l="Customer will revert";break;case"could_not_reach":o=new Date,o.setDate(o.getDate()+1),l="Try calling again";break;case"discussed_price":case"discussed_coa":case"discussed_sample":o=new Date,o.setDate(o.getDate()+3),l="Follow up on discussion";break;case"positive":o=new Date,o.setDate(o.getDate()+2),l="Positive response - follow up";break;case"negative":o=new Date,o.setDate(o.getDate()+7),l="Negative response - check back later";break}const{error:c}=await de.from("crm_activity_logs").insert({inquiry_id:e,activity_type:t,activity_title:r,activity_description:s||null,outcome:n,next_follow_up_date:o?o.toISOString():null,follow_up_reason:l,created_by:a});if(c)throw c;o&&await de.from("crm_inquiries").update({next_follow_up:o.toISOString(),last_contact_date:new Date().toISOString()}).eq("id",e);let u;if(o){const{data:A,error:h}=await de.from("crm_reminders").insert({inquiry_id:e,reminder_type:"follow_up",title:l,due_date:o.toISOString(),assigned_to:a,created_by:a}).select("id").single();!h&&A&&(u=A.id)}return{success:!0,reminderId:u}}catch(o){return console.error("Error logging activity:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}function Yne({inquiry:e,onActionComplete:t}){const[r,n]=Z.useState(!1),[a,s]=Z.useState("phone_call"),[o,l]=Z.useState(!1),c=[{id:"send_price",label:"Send Price",icon:Ro,color:"bg-green-50 hover:bg-green-100 text-green-700 border-green-200",description:"Auto-updates status & creates 2-day follow-up"},{id:"send_coa",label:"Send COA",icon:pr,color:"bg-blue-50 hover:bg-blue-100 text-blue-700 border-blue-200",description:"Auto-updates status & creates 1-day follow-up"},{id:"send_msds",label:"Send MSDS",icon:pr,color:"bg-orange-50 hover:bg-orange-100 text-orange-700 border-orange-200",description:"Sends MSDS document"},{id:"send_sample",label:"Send Sample",icon:xF,color:"bg-purple-50 hover:bg-purple-100 text-purple-700 border-purple-200",description:"Auto-updates status & creates 3-day follow-up"}],u=[{value:"customer_will_revert",label:"Customer Will Revert",followUpDays:2},{value:"could_not_reach",label:"Could Not Reach",followUpDays:1},{value:"discussed_price",label:"Discussed Price/COA",followUpDays:3},{value:"positive",label:"Positive Response",followUpDays:2},{value:"negative",label:"Negative Response",followUpDays:7},{value:"other",label:"Other",followUpDays:3}],A=async(f,d)=>{if(!(!e||!confirm(`Send ${d}?

This will:
- Update inquiry status
- Create automatic follow-up
- Log the action

Continue?`))){l(!0);try{const{data:{user:g}}=await de.auth.getUser();if(!g)throw new Error("Not authenticated");const y=await zne(e.id,f,d,g.id,{emailTo:e.contact_email||void 0,emailSubject:`Re: ${e.email_subject||e.product_name}`,emailBody:`Dear ${e.contact_person||"Sir/Madam"},

Thank you for your inquiry regarding ${e.product_name}.

Please find the ${d.toLowerCase()} attached.

Best regards`});y.success?(alert(`${d} sent successfully!

Status updated & follow-up created automatically.`),t()):alert(`Failed to send ${d}: ${y.error}`)}catch(g){console.error("Error performing quick action:",g),alert("Failed to perform action. Please try again.")}finally{l(!1)}}},h=async f=>{if(e){l(!0);try{const{data:{user:d}}=await de.auth.getUser();if(!d)throw new Error("Not authenticated");const v=a==="phone_call"?"Phone Call":a==="meeting"?"Meeting":"WhatsApp Message",g=await Xne(e.id,a,v,f,d.id);if(g.success){const y=u.find(p=>p.value===f);alert(`${v} logged!

Follow-up automatically created for ${y==null?void 0:y.followUpDays} days from now.`),n(!1),t()}else alert(`Failed to log activity: ${g.error}`)}catch(d){console.error("Error logging activity:",d),alert("Failed to log activity. Please try again.")}finally{l(!1)}}};return e?i.jsxs("div",{className:"flex flex-col h-full bg-white border-l border-gray-200",children:[i.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gradient-to-r from-green-50 to-transparent",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Quick Actions"}),i.jsxs("p",{className:"text-xs text-gray-600",children:["Inquiry #",e.inquiry_number]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[i.jsx(Ii,{className:"w-4 h-4"}),"Send Documents (1-Click)"]}),i.jsx("div",{className:"space-y-2",children:c.map(f=>i.jsx("button",{onClick:()=>A(f.id,f.label),disabled:o,className:`w-full p-3 rounded-lg border-2 transition ${f.color} disabled:opacity-50 disabled:cursor-not-allowed text-left`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(f.icon,{className:"w-5 h-5 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-semibold text-sm",children:f.label}),i.jsx("p",{className:"text-xs opacity-75 truncate",children:f.description})]})]})},f.id))})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[i.jsx(kl,{className:"w-4 h-4"}),"Log Activity (1-Click)"]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("button",{onClick:()=>{s("phone_call"),n(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(kl,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log Call"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Quick outcome selection"})]})]})}),i.jsx("button",{onClick:()=>{s("meeting"),n(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(as,{className:"w-5 h-5 text-purple-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log Meeting"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Record meeting outcome"})]})]})}),i.jsx("button",{onClick:()=>{s("whatsapp"),n(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(_0,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log WhatsApp"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Log WhatsApp conversation"})]})]})})]})]}),i.jsx("div",{className:"border-t border-gray-200 pt-4",children:i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(ts,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),i.jsxs("div",{className:"text-xs text-blue-800",children:[i.jsx("p",{className:"font-medium mb-1",children:"Auto-Automation Active"}),i.jsxs("ul",{className:"space-y-0.5 text-blue-700",children:[i.jsx("li",{children:" Status updates automatically"}),i.jsx("li",{children:" Follow-ups created automatically"}),i.jsx("li",{children:" All actions logged in timeline"})]})]})]})})})]}),i.jsx(ir,{isOpen:r,onClose:()=>n(!1),title:`Log ${a==="phone_call"?"Phone Call":a==="meeting"?"Meeting":"WhatsApp"}`,children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Select the outcome to automatically update follow-up date:"}),i.jsx("div",{className:"space-y-2",children:u.map(f=>i.jsx("button",{onClick:()=>h(f.value),disabled:o,className:"w-full p-4 text-left border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition disabled:opacity-50 disabled:cursor-not-allowed",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(io,{className:"w-5 h-5 text-gray-400"}),i.jsx("span",{className:"font-medium text-gray-900",children:f.label})]}),i.jsxs("span",{className:"text-xs text-gray-500",children:["+",f.followUpDays,"d follow-up"]})]})},f.value))}),i.jsx("div",{className:"pt-4 border-t border-gray-200",children:i.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Click an outcome to log and auto-create follow-up"})})]})})]}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8 bg-gray-50",children:[i.jsx(Ii,{className:"w-20 h-20 text-gray-300 mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Quick Actions"}),i.jsx("p",{className:"text-gray-600 max-w-md",children:"Save an inquiry to see quick action buttons here"}),i.jsxs("div",{className:"mt-6 text-sm text-gray-500 space-y-1",children:[i.jsx("p",{children:"One-click actions include:"}),i.jsxs("ul",{className:"list-disc list-inside text-left",children:[i.jsx("li",{children:"Send Price Quote"}),i.jsx("li",{children:"Send COA/MSDS"}),i.jsx("li",{children:"Log Phone Calls"}),i.jsx("li",{children:"Schedule Follow-ups"})]})]})]})}function Jne(e){if(!e)return null;const t=e.trim();if(!t)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const r=t.match(/^(\d{1,2})\.(\d{1,2})\.(\d{2})$/);if(r){const o=r[1].padStart(2,"0"),l=r[2].padStart(2,"0");return`${parseInt(r[3])<50?`20${r[3]}`:`19${r[3]}`}-${l}-${o}`}const n=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2})$/);if(n){const o=n[1].padStart(2,"0"),l=n[2].padStart(2,"0");return`${parseInt(n[3])<50?`20${n[3]}`:`19${n[3]}`}-${l}-${o}`}const a=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0");return`${a[3]}-${l}-${o}`}const s=t.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(s){const o=s[1].padStart(2,"0"),l=s[2].padStart(2,"0");return`${s[3]}-${l}-${o}`}try{const o=new Date(t);if(!isNaN(o.getTime()))return o.toISOString().split("T")[0]}catch{console.warn("Could not parse date:",t)}return null}function Zne(){console.log("[CRMCommandCenter] Component loaded - Dec 7 2025 v1.2");const{profile:e}=Dr(),[t,r]=Z.useState(null),[n,a]=Z.useState(null),[s,o]=Z.useState(null),[l,c]=Z.useState(!1),u=(f,d)=>{console.log("[CRMCommandCenter] handleEmailSelect called",{email:f,data:d}),r(f),a(d),o(null)},A=async f=>{var d;if(!(!t||!e)){c(!0);try{const{data:{user:v}}=await de.auth.getUser();if(!v)throw new Error("Not authenticated");let g=null;const y=f.contactEmail.split(/[,;]/)[0].trim();console.log("[CRMCommandCenter] Looking up customer with primaryEmail:",y);const{data:p,error:m}=await de.from("crm_contacts").select("id, company_name, email, contact_person, phone, address").or(`email.eq.${y},company_name.ilike.${f.companyName}`).limit(1).maybeSingle();if(m)throw console.error("[CRMCommandCenter] Customer lookup error:",m),m;if(p){g=p.id;const B={};f.contactPerson&&!p.contact_person&&(B.contact_person=f.contactPerson),f.contactPhone&&!p.phone&&(B.phone=f.contactPhone),f.contactEmail&&f.contactEmail!==p.email&&(B.email=f.contactEmail),Object.keys(B).length>0&&await de.from("crm_contacts").update({...B,updated_at:new Date().toISOString()}).eq("id",g)}else{const{data:B,error:_}=await de.from("crm_contacts").insert({company_name:f.companyName,contact_person:f.contactPerson||null,email:f.contactEmail,phone:f.contactPhone||null,is_active:!0,created_by:v.id}).select().single();if(_)throw console.error("[CRMCommandCenter] Customer creation error:",_),new Error(`Failed to create customer: ${_.message}`);B&&(g=B.id)}if(!g)throw new Error("Failed to get or create customer ID");const w={customer_id:g,inquiry_date:new Date().toISOString().split("T")[0],product_name:f.productName,specification:f.specification||null,quantity:f.quantity,supplier_name:f.supplierName||null,supplier_country:f.supplierCountry||null,company_name:f.companyName,contact_person:f.contactPerson||null,contact_email:f.contactEmail,contact_phone:f.contactPhone||null,mail_subject:t.subject,email_body:t.body,inquiry_source:"email",status:"new",pipeline_status:"new",priority:f.priority,purpose_icons:f.purposeIcons,delivery_date_expected:Jne(f.deliveryDateExpected),ai_confidence_score:(n==null?void 0:n.confidenceScore)||0,auto_detected_company:(n==null?void 0:n.autoDetectedCompany)||!1,auto_detected_contact:(n==null?void 0:n.autoDetectedContact)||!1,coa_sent:!1,msds_sent:!1,sample_sent:!1,price_quoted:!1,price_required:f.priceRequested,coa_required:f.coaRequested,sample_required:f.sampleRequested,agency_letter_required:f.agencyLetterRequested||!1,aceerp_no:f.aceerp_no||null,purchase_price:f.purchasePrice?parseFloat(f.purchasePrice):null,purchase_price_currency:f.purchasePriceCurrency||"USD",offered_price:f.offeredPrice?parseFloat(f.offeredPrice):null,offered_price_currency:f.offeredPriceCurrency||"USD",delivery_date:f.deliveryDate||null,delivery_terms:f.deliveryTerms||null,remarks:f.remarks||null,assigned_to:v.id,created_by:v.id,source:"email",source_email_id:t.id.startsWith("gmail-")?null:t.id};let x;if(f.isMultiProduct&&f.products&&f.products.length>0){const B=f.products.map(E=>({...w,product_name:E.productName,specification:E.specification||null,quantity:E.quantity,supplier_name:E.supplierName||w.supplier_name||null,supplier_country:E.supplierCountry||w.supplier_country||null,delivery_date:E.deliveryDate||w.delivery_date||null,delivery_terms:E.deliveryTerms||w.delivery_terms||null,is_multi_product:!1,has_items:!1}));console.log("[CRMCommandCenter] Inserting multi-product inquiries:",B.length,"items");const{data:_,error:k}=await de.from("crm_inquiries").insert(B).select();if(k)throw console.error("[CRMCommandCenter] Multi-product insert error:",k),k;if(_&&_.length>0){const E=_[0].inquiry_number;for(let T=0;T<_.length;T++)await de.from("crm_inquiries").update({inquiry_number:`${E}.${T+1}`}).eq("id",_[T].id);x=_[0]}}else{console.log("[CRMCommandCenter] Inserting single product inquiry");const{data:B,error:_}=await de.from("crm_inquiries").insert([{...w,is_multi_product:!1,has_items:!1}]).select().single();if(_)throw console.error("[CRMCommandCenter] Single product insert error:",_),_;x=B}if(await de.from("crm_email_inbox").update({is_processed:!0,is_inquiry:!0,converted_to_inquiry:x.id}).eq("id",t.id),f.coaRequested||f.msdsRequested||f.sampleRequested||f.priceRequested||f.agencyLetterRequested){const B=[];f.priceRequested&&B.push({inquiry_id:x.id,reminder_type:"send_price",title:"Send price quote to customer",due_date:new Date(Date.now()+1*24*60*60*1e3).toISOString(),assigned_to:v.id,created_by:v.id}),f.coaRequested&&B.push({inquiry_id:x.id,reminder_type:"send_coa",title:"Send COA to customer",due_date:new Date(Date.now()+2*24*60*60*1e3).toISOString(),assigned_to:v.id,created_by:v.id}),f.msdsRequested&&B.push({inquiry_id:x.id,reminder_type:"send_msds",title:"Send MSDS to customer",due_date:new Date(Date.now()+2*24*60*60*1e3).toISOString(),assigned_to:v.id,created_by:v.id}),f.sampleRequested&&B.push({inquiry_id:x.id,reminder_type:"send_sample",title:"Send sample to customer",due_date:new Date(Date.now()+3*24*60*60*1e3).toISOString(),assigned_to:v.id,created_by:v.id}),f.agencyLetterRequested&&B.push({inquiry_id:x.id,reminder_type:"send_agency_letter",title:"Send agency letter to customer",due_date:new Date(Date.now()+1*24*60*60*1e3).toISOString(),assigned_to:v.id,created_by:v.id}),B.length>0&&await de.from("crm_reminders").insert(B)}o(x),a(null);const b=f.isMultiProduct&&f.products?`Inquiry #${x.inquiry_number} created successfully with ${f.products.length} product line items!

Use Quick Actions to send documents for each product.`:`Inquiry #${x.inquiry_number} created successfully!

Use Quick Actions to send documents.`;alert(b)}catch(v){if(console.error("[CRMCommandCenter] Error creating inquiry:",v),console.error("[CRMCommandCenter] Error details:",JSON.stringify(v,null,2)),(d=v.message)!=null&&d.includes("duplicate key"))alert("This inquiry number already exists. Please use a different number.");else{const g=v.message||v.details||v.hint||"Unknown error";alert(`Failed to create inquiry: ${g}

Check console for details.`)}}finally{c(!1)}}},h=()=>{o(null),r(null),a(null)};return i.jsx(ca,{children:i.jsxs("div",{className:"h-screen flex flex-col",children:[i.jsx("div",{className:"flex-shrink-0 bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-2 border-b border-blue-800",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(wF,{className:"w-5 h-5 text-white"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg font-bold text-white",children:"CRM Command Center"}),i.jsx("p",{className:"text-blue-100 text-xs",children:"AI-powered inquiry processing"})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"text-xs text-blue-200",children:"Quick Actions"}),i.jsx("p",{className:"text-xl font-bold text-white",children:"2 Clicks"})]})]})}),i.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i.jsx("div",{className:"w-1/4 min-w-[300px] max-w-[400px]",children:i.jsx(Gne,{onEmailSelect:u,selectedEmailId:(t==null?void 0:t.id)||null})}),i.jsx("div",{className:"flex-1",children:i.jsx(Wne,{email:t,parsedData:n,onSave:A,saving:l})}),i.jsx("div",{className:"w-1/4 min-w-[300px] max-w-[400px]",children:i.jsx(Yne,{inquiry:s,onActionComplete:h})})]}),s&&i.jsx("div",{className:"flex-shrink-0 bg-green-50 border-t border-green-200 px-6 py-3",children:i.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-800",children:[i.jsx(io,{className:"w-5 h-5"}),i.jsxs("span",{className:"font-medium",children:["Inquiry #",s.inquiry_number," created successfully! Use Quick Actions on the right "]})]})})]})})}function eae({isOpen:e,onClose:t,taskId:r,onUpdate:n}){const{user:a}=Dr(),[s,o]=Z.useState(null),[l,c]=Z.useState([]),[u,A]=Z.useState([]),[h,f]=Z.useState(!0),[d,v]=Z.useState(""),[g,y]=Z.useState(!1),[p,m]=Z.useState(""),[w,x]=Z.useState([]),[b,B]=Z.useState(!1),[_,k]=Z.useState(!1),E=Z.useRef(null),T=Z.useRef(null);Z.useEffect(()=>{e&&r&&(S(),j(),I())},[e,r]);const S=async()=>{var O,D,P,Q;try{f(!0);const{data:J,error:te}=await de.from("tasks").select(`
          *,
          creator:created_by(full_name),
          inquiry:crm_inquiries(inquiry_number),
          customer:customers(company_name),
          product:products(name)
        `).eq("id",r).single();if(te)throw te;const z=J.assigned_users||[],{data:ye}=await de.from("user_profiles").select("id, full_name").in("id",z);o({...J,creator_name:(O=J.creator)==null?void 0:O.full_name,assignee_names:(ye==null?void 0:ye.map(re=>re.full_name))||[],inquiry_number:(D=J.inquiry)==null?void 0:D.inquiry_number,customer_name:(P=J.customer)==null?void 0:P.company_name,product_name:(Q=J.product)==null?void 0:Q.name})}catch(J){console.error("Error loading task:",J)}finally{f(!1)}},j=async()=>{try{const{data:O,error:D}=await de.from("task_comments").select(`
          *,
          user:user_id(full_name)
        `).eq("task_id",r).eq("is_deleted",!1).order("created_at",{ascending:!0});if(D)throw D;c((O||[]).map(P=>{var Q;return{...P,user_name:((Q=P.user)==null?void 0:Q.full_name)||"Unknown User"}}))}catch(O){console.error("Error loading comments:",O)}},I=async()=>{try{const{data:O,error:D}=await de.from("user_profiles").select("id, full_name, email").eq("is_active",!0).order("full_name");if(D)throw D;A(O||[])}catch(O){console.error("Error loading users:",O)}},U=O=>{const D=O.target.value;v(D);const P=D.split(" ").pop()||"";P.startsWith("@")?(m(P.slice(1)),y(!0)):y(!1)},q=(O,D)=>{var Q;const P=d.split(" ");P[P.length-1]=`@${O} `,v(P.join(" ")),y(!1),(Q=T.current)==null||Q.focus()},V=O=>{const D=/@(\w+)/g,P=[];let Q;for(;(Q=D.exec(O))!==null;){const J=Q[1],te=u.find(z=>z.full_name.replace(/\s+/g,"")===J);te&&P.push(te.id)}return P},X=async()=>{const O=[];for(const D of w){const P=`${Date.now()}_${D.name}`,Q=`tasks/${r}/comments/${P}`,{error:J}=await de.storage.from("task-attachments").upload(Q,D);J?console.error("Error uploading file:",J):O.push(Q)}return O},W=async()=>{if(!(!d.trim()&&w.length===0))try{B(!0);const O=await X(),D=V(d),{error:P}=await de.from("task_comments").insert([{task_id:r,comment_text:d,user_id:a==null?void 0:a.id,mentions:D,attachment_urls:O}]);if(P)throw P;v(""),x([]),j()}catch(O){console.error("Error adding comment:",O),alert("Failed to add comment")}finally{B(!1)}},M=async O=>{try{k(!0);const{error:D}=await de.from("tasks").update({status:O}).eq("id",r);if(D)throw D;S(),n()}catch(D){console.error("Error updating status:",D),alert("Failed to update status")}finally{k(!1)}},G=O=>{var P;const D=(P=O.split(".").pop())==null?void 0:P.toLowerCase();return["jpg","jpeg","png","gif","webp"].includes(D||"")?i.jsx(fF,{className:"w-4 h-4"}):["pdf"].includes(D||"")?i.jsx(pr,{className:"w-4 h-4"}):i.jsx(uF,{className:"w-4 h-4"})},H=async O=>{try{const{data:D,error:P}=await de.storage.from("task-attachments").download(O);if(P)throw P;const Q=URL.createObjectURL(D),J=document.createElement("a");J.href=Q,J.download=O.split("/").pop()||"download",document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(Q)}catch(D){console.error("Error downloading file:",D)}},C=O=>{const D={to_do:"bg-gray-100 text-gray-700 border-gray-300",in_progress:"bg-blue-100 text-blue-700 border-blue-300",waiting:"bg-orange-100 text-orange-700 border-orange-300",completed:"bg-green-100 text-green-700 border-green-300"};return D[O]||D.to_do},L=O=>{const D={low:"bg-gray-100 text-gray-700",medium:"bg-yellow-100 text-yellow-700",high:"bg-orange-100 text-orange-700",urgent:"bg-red-100 text-red-700"};return D[O]||D.medium};return h||!s?i.jsx(ir,{isOpen:e,onClose:t,title:"Loading...",children:i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx(Do,{className:"w-8 h-8 animate-spin text-blue-600"})})}):i.jsx(ir,{isOpen:e,onClose:t,title:s.title,size:"xl",children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${L(s.priority)}`,children:s.priority.toUpperCase()}),i.jsxs("select",{value:s.status,onChange:O=>M(O.target.value),disabled:_,className:`px-3 py-1 rounded-full text-sm font-medium border-2 ${C(s.status)} cursor-pointer disabled:opacity-50`,children:[i.jsx("option",{value:"to_do",children:"To Do"}),i.jsx("option",{value:"in_progress",children:"In Progress"}),i.jsx("option",{value:"waiting",children:"Waiting"}),i.jsx("option",{value:"completed",children:"Completed"})]})]}),s.description&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Description"}),i.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:s.description})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(as,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Deadline:"}),i.jsx("span",{className:"font-medium text-gray-900",children:new Date(s.deadline).toLocaleString()})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(to,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Created by:"}),i.jsx("span",{className:"font-medium text-gray-900",children:s.creator_name})]}),s.assignee_names.length>0&&i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(to,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Assigned to:"}),i.jsx("span",{className:"font-medium text-gray-900",children:s.assignee_names.join(", ")})]}),s.inquiry_number&&i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(Fg,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Inquiry:"}),i.jsx("span",{className:"font-medium text-blue-600",children:s.inquiry_number})]}),s.customer_name&&i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(to,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Customer:"}),i.jsx("span",{className:"font-medium text-gray-900",children:s.customer_name})]}),s.product_name&&i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(Fg,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:"Product:"}),i.jsx("span",{className:"font-medium text-gray-900",children:s.product_name})]})]}),s.attachment_urls.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[i.jsx(ki,{className:"w-4 h-4"}),"Attachments (",s.attachment_urls.length,")"]}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.attachment_urls.map((O,D)=>i.jsxs("button",{onClick:()=>H(O),className:"flex items-center gap-2 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 text-left",children:[G(O),i.jsx("span",{className:"text-sm text-gray-700 truncate",children:O.split("/").pop()}),i.jsx(Qo,{className:"w-4 h-4 ml-auto text-gray-400"})]},D))})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(_0,{className:"w-5 h-5"}),"Discussion (",l.length,")"]}),i.jsx("div",{className:"space-y-4 mb-4 max-h-96 overflow-y-auto",children:l.length===0?i.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:"No comments yet. Start the discussion!"}):l.map(O=>i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-medium text-sm",children:O.user_name.charAt(0).toUpperCase()})}),i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("span",{className:"font-medium text-sm text-gray-900",children:O.user_name}),i.jsx("span",{className:"text-xs text-gray-500",children:new Date(O.created_at).toLocaleString()})]}),i.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:O.comment_text}),O.attachment_urls.length>0&&i.jsx("div",{className:"mt-2 space-y-1",children:O.attachment_urls.map((D,P)=>i.jsxs("button",{onClick:()=>H(D),className:"flex items-center gap-2 text-xs text-blue-600 hover:text-blue-700",children:[G(D),D.split("/").pop()]},P))})]})})]},O.id))}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx("textarea",{ref:T,value:d,onChange:U,placeholder:"Add a comment... Use @ to mention someone",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3}),g&&i.jsx("div",{className:"absolute bottom-full left-0 mb-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-10",children:u.filter(O=>O.full_name.toLowerCase().includes(p.toLowerCase())).slice(0,5).map(O=>i.jsxs("button",{onClick:()=>q(O.full_name.replace(/\s+/g,""),O.id),className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2",children:[i.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center text-white text-xs",children:O.full_name.charAt(0).toUpperCase()}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:O.full_name}),i.jsx("p",{className:"text-xs text-gray-500",children:O.email})]})]},O.id))})]}),w.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2",children:w.map((O,D)=>i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-lg text-sm",children:[i.jsx(ki,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"text-gray-700",children:O.name}),i.jsx("button",{onClick:()=>x(P=>P.filter((Q,J)=>J!==D)),className:"text-gray-500 hover:text-red-600",children:i.jsx(An,{className:"w-4 h-4"})})]},D))}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("input",{ref:E,type:"file",multiple:!0,onChange:O=>{O.target.files&&x(Array.from(O.target.files))},className:"hidden"}),i.jsxs("button",{onClick:()=>{var O;return(O=E.current)==null?void 0:O.click()},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition",children:[i.jsx(ki,{className:"w-4 h-4"}),"Attach Files"]}),i.jsx("button",{onClick:W,disabled:b||!d.trim()&&w.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:b?i.jsxs(i.Fragment,{children:[i.jsx(Do,{className:"w-4 h-4 animate-spin"}),"Posting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ii,{className:"w-4 h-4"}),"Post Comment"]})})]})]})]})]})})}function tae(){const{user:e,profile:t}=Dr(),[r,n]=Z.useState([]),[a,s]=Z.useState([]),[o,l]=Z.useState(!0),[c,u]=Z.useState(""),[A,h]=Z.useState(!1),[f,d]=Z.useState(null),[v,g]=Z.useState(!1),[y,p]=Z.useState(!1),[m,w]=Z.useState(null),[x,b]=Z.useState({status:[],priority:[],assignedTo:[],view:"my-tasks"}),[B,_]=Z.useState({total:0,pending:0,completed:0,overdue:0});Z.useEffect(()=>{k()},[e]),Z.useEffect(()=>{T()},[r,x,c]);const k=async()=>{try{l(!0);let q=de.from("tasks").select(`
          *,
          creator:created_by(full_name),
          inquiry:crm_inquiries(inquiry_number),
          customer:customers(company_name),
          product:products(product_name)
        `).eq("is_deleted",!1).order("deadline",{ascending:!0});const{data:V,error:X}=await q;if(X)throw X;const W=(V==null?void 0:V.map(C=>C.id))||[],{data:M}=await de.from("task_comments").select("task_id").in("task_id",W).eq("is_deleted",!1),G={};M==null||M.forEach(C=>{G[C.task_id]=(G[C.task_id]||0)+1});const H=(V||[]).map(C=>{var L,O,D,P;return{...C,creator_name:(L=C.creator)==null?void 0:L.full_name,inquiry_number:(O=C.inquiry)==null?void 0:O.inquiry_number,customer_name:(D=C.customer)==null?void 0:D.company_name,product_name:(P=C.product)==null?void 0:P.product_name,comment_count:G[C.id]||0}});n(H),E(H)}catch(q){console.error("Error loading tasks:",q)}finally{l(!1)}},E=q=>{const V=new Date,X=q.filter(W=>W.assigned_users.includes((e==null?void 0:e.id)||"")||W.created_by===(e==null?void 0:e.id));_({total:X.length,pending:X.filter(W=>W.status!=="completed").length,completed:X.filter(W=>W.status==="completed").length,overdue:X.filter(W=>W.status!=="completed"&&new Date(W.deadline)<V).length})},T=()=>{let q=[...r];if(x.view==="my-tasks")q=q.filter(V=>V.assigned_users.includes((e==null?void 0:e.id)||"")||V.created_by===(e==null?void 0:e.id));else if(x.view==="pending")q=q.filter(V=>V.status!=="completed"&&(V.assigned_users.includes((e==null?void 0:e.id)||"")||V.created_by===(e==null?void 0:e.id)));else if(x.view==="completed")q=q.filter(V=>V.status==="completed"&&(V.assigned_users.includes((e==null?void 0:e.id)||"")||V.created_by===(e==null?void 0:e.id)));else if(x.view==="overdue"){const V=new Date;q=q.filter(X=>X.status!=="completed"&&new Date(X.deadline)<V&&(X.assigned_users.includes((e==null?void 0:e.id)||"")||X.created_by===(e==null?void 0:e.id)))}if(x.status.length>0&&(q=q.filter(V=>x.status.includes(V.status))),x.priority.length>0&&(q=q.filter(V=>x.priority.includes(V.priority))),c){const V=c.toLowerCase();q=q.filter(X=>{var W,M,G,H;return X.title.toLowerCase().includes(V)||((W=X.description)==null?void 0:W.toLowerCase().includes(V))||((M=X.customer_name)==null?void 0:M.toLowerCase().includes(V))||((G=X.product_name)==null?void 0:G.toLowerCase().includes(V))||((H=X.inquiry_number)==null?void 0:H.toLowerCase().includes(V))})}s(q)},S=q=>{switch(q){case"urgent":return i.jsx(AF,{className:"w-4 h-4 text-red-600"});case"high":return i.jsx(Qw,{className:"w-4 h-4 text-orange-600"});case"medium":return i.jsx(kg,{className:"w-4 h-4 text-yellow-600"});default:return i.jsx(lF,{className:"w-4 h-4 text-gray-400"})}},j=q=>{const V={to_do:"bg-gray-100 text-gray-700",in_progress:"bg-blue-100 text-blue-700",waiting:"bg-orange-100 text-orange-700",completed:"bg-green-100 text-green-700"},X={to_do:"To Do",in_progress:"In Progress",waiting:"Waiting",completed:"Completed"};return i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V[q]}`,children:X[q]})},I=q=>{const V=new Date(q),X=new Date,W=V.getTime()-X.getTime(),M=Math.floor(W/(1e3*60*60)),G=Math.floor(M/24);return W<0?i.jsx("span",{className:"text-red-600 font-medium",children:"Overdue"}):M<24?i.jsxs("span",{className:"text-orange-600 font-medium",children:["Due in ",M,"h"]}):G<7?i.jsxs("span",{className:"text-yellow-600 font-medium",children:["Due in ",G,"d"]}):i.jsx("span",{className:"text-gray-600",children:V.toLocaleDateString()})},U=async q=>{if(confirm("Are you sure you want to delete this task?"))try{const{error:V}=await de.from("tasks").update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_by:e==null?void 0:e.id}).eq("id",q);if(V)throw V;k()}catch(V){console.error("Error deleting task:",V),alert("Failed to delete task")}};return o?i.jsx(ca,{children:i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):i.jsxs(ca,{children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tasks"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and track team assignments"})]}),i.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),"New Task"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(io,{className:"w-6 h-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Tasks"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.total})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:i.jsx(ts,{className:"w-6 h-6 text-yellow-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.pending})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:i.jsx(io,{className:"w-6 h-6 text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.completed})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:i.jsx(ya,{className:"w-6 h-6 text-red-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.overdue})]})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"p-4 border-b border-gray-200",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[i.jsx("div",{className:"flex gap-2 flex-wrap",children:[{value:"my-tasks",label:"My Tasks"},{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"overdue",label:"Overdue"},{value:"all",label:"All Tasks"}].map(q=>i.jsx("button",{onClick:()=>b({...x,view:q.value}),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${x.view===q.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:q.label},q.value))}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"relative flex-1 sm:flex-none sm:w-64",children:[i.jsx(Hc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Search tasks...",value:c,onChange:q=>u(q.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsx("button",{onClick:()=>h(!A),className:`px-4 py-2 border rounded-lg transition ${A?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:i.jsx(Z7,{className:"w-5 h-5"})})]})]}),A&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),i.jsx("div",{className:"space-y-2",children:["to_do","in_progress","waiting","completed"].map(q=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:x.status.includes(q),onChange:V=>{V.target.checked?b({...x,status:[...x.status,q]}):b({...x,status:x.status.filter(X=>X!==q)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm text-gray-700 capitalize",children:q.replace("_"," ")})]},q))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),i.jsx("div",{className:"space-y-2",children:["urgent","high","medium","low"].map(q=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:x.priority.includes(q),onChange:V=>{V.target.checked?b({...x,priority:[...x.priority,q]}):b({...x,priority:x.priority.filter(X=>X!==q)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm text-gray-700 capitalize",children:q})]},q))})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{onClick:()=>b({...x,status:[],priority:[],assignedTo:[]}),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Clear All Filters"})})]})]}),i.jsx("div",{className:"divide-y divide-gray-200",children:a.length===0?i.jsxs("div",{className:"p-12 text-center",children:[i.jsx(io,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tasks found"}),i.jsx("p",{className:"text-gray-600 mb-6",children:c||x.status.length>0||x.priority.length>0?"Try adjusting your filters or search query":"Create your first task to get started"}),!c&&x.status.length===0&&i.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Create Task"]})]}):a.map(q=>i.jsx("div",{className:"p-4 hover:bg-gray-50 transition cursor-pointer",onClick:()=>{d(q),g(!0)},children:i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[i.jsx("div",{className:"mt-1",children:S(q.priority)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx("h3",{className:"font-medium text-gray-900 truncate",children:q.title}),q.attachment_urls.length>0&&i.jsx(ki,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})]}),q.description&&i.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:q.description}),i.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2",children:[j(q.status),i.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[i.jsx(as,{className:"w-4 h-4"}),I(q.deadline)]}),q.comment_count>0&&i.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[i.jsx(_0,{className:"w-4 h-4"}),q.comment_count]}),q.inquiry_number&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:[i.jsx(Sg,{className:"w-3 h-3"}),q.inquiry_number]}),q.customer_name&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:[i.jsx(to,{className:"w-3 h-3"}),q.customer_name]}),q.tags.length>0&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[i.jsx(Fg,{className:"w-3 h-3"}),q.tags[0],q.tags.length>1&&` +${q.tags.length-1}`]})]})]})]}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:V=>{V.stopPropagation(),w(m===q.id?null:q.id)},className:"p-1 hover:bg-gray-100 rounded transition",children:i.jsx(iR,{className:"w-5 h-5 text-gray-600"})}),m===q.id&&i.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[i.jsxs("button",{onClick:V=>{V.stopPropagation(),d(q),g(!0),w(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[i.jsx(b0,{className:"w-4 h-4"}),"View Details"]}),(q.created_by===(e==null?void 0:e.id)||(t==null?void 0:t.role)==="admin")&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:V=>{V.stopPropagation(),w(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[i.jsx(uo,{className:"w-4 h-4"}),"Edit Task"]}),i.jsxs("button",{onClick:V=>{V.stopPropagation(),U(q.id),w(null)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[i.jsx(wa,{className:"w-4 h-4"}),"Delete Task"]})]})]})]})]})},q.id))})]})]}),y&&i.jsx(eI,{isOpen:y,onClose:()=>p(!1),onSuccess:()=>{p(!1),k()}}),v&&f&&i.jsx(eae,{isOpen:v,onClose:()=>{g(!1),d(null)},taskId:f.id,onUpdate:k})]})}const rae="modulepreload",nae=function(e){return"/"+e},wC={},$v=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=nae(c),c in wC)return;wC[c]=!0;const u=c.endsWith(".css"),A=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${A}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":rae,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,d)=>{h.addEventListener("load",f),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};function Ir(e){"@babel/helpers - typeof";return Ir=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ir(e)}var fo=Uint8Array,ni=Uint16Array,Q_=Int32Array,M_=new fo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),H_=new fo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),bC=new fo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),aI=function(e,t){for(var r=new ni(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new Q_(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},sI=aI(M_,2),aae=sI.b,A2=sI.r;aae[28]=258,A2[258]=28;var sae=aI(H_,0),_C=sae.r,d2=new ni(32768);for(var Zr=0;Zr<32768;++Zr){var tc=(Zr&43690)>>1|(Zr&21845)<<1;tc=(tc&52428)>>2|(tc&13107)<<2,tc=(tc&61680)>>4|(tc&3855)<<4,d2[Zr]=((tc&65280)>>8|(tc&255)<<8)>>1}var _h=function(e,t,r){for(var n=e.length,a=0,s=new ni(t);a<n;++a)e[a]&&++s[e[a]-1];var o=new ni(t);for(a=1;a<t;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(r){l=new ni(1<<t);var c=15-t;for(a=0;a<n;++a)if(e[a])for(var u=a<<4|e[a],A=t-e[a],h=o[e[a]-1]++<<A,f=h|(1<<A)-1;h<=f;++h)l[d2[h]>>c]=u}else for(l=new ni(n),a=0;a<n;++a)e[a]&&(l[a]=d2[o[e[a]-1]++]>>15-e[a]);return l},Gu=new fo(288);for(var Zr=0;Zr<144;++Zr)Gu[Zr]=8;for(var Zr=144;Zr<256;++Zr)Gu[Zr]=9;for(var Zr=256;Zr<280;++Zr)Gu[Zr]=7;for(var Zr=280;Zr<288;++Zr)Gu[Zr]=8;var Yg=new fo(32);for(var Zr=0;Zr<32;++Zr)Yg[Zr]=5;var iae=_h(Gu,9,0),oae=_h(Yg,5,0),iI=function(e){return(e+7)/8|0},lae=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new fo(e.subarray(t,r))},ll=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Pf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Vv=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,s=r.slice();if(!a)return{t:lI,l:0};if(a==1){var o=new fo(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(b,B){return b.f-B.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,A=1,h=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};A!=a-1;)l=r[r[u].f<r[h].f?u++:h++],c=r[u!=A&&r[u].f<r[h].f?u++:h++],r[A++]={s:-1,f:l.f+c.f,l,r:c};for(var f=s[0].s,n=1;n<a;++n)s[n].s>f&&(f=s[n].s);var d=new ni(f+1),v=f2(r[A-1],d,0);if(v>t){var n=0,g=0,y=v-t,p=1<<y;for(s.sort(function(B,_){return d[_.s]-d[B.s]||B.f-_.f});n<a;++n){var m=s[n].s;if(d[m]>t)g+=p-(1<<v-d[m]),d[m]=t;else break}for(g>>=y;g>0;){var w=s[n].s;d[w]<t?g-=1<<t-d[w]++-1:++n}for(;n>=0&&g;--n){var x=s[n].s;d[x]==t&&(--d[x],++g)}v=t}return{t:new fo(d),l:v}},f2=function(e,t,r){return e.s==-1?Math.max(f2(e.l,t,r+1),f2(e.r,t,r+1)):t[e.s]=r},NC=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ni(++t),n=0,a=e[0],s=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==a&&l!=t)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=e[l]}return{c:r.subarray(0,n),n:t}},Df=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},oI=function(e,t,r){var n=r.length,a=iI(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var s=0;s<n;++s)e[a+s+4]=r[s];return(a+4+n)*8},BC=function(e,t,r,n,a,s,o,l,c,u,A){ll(t,A++,r),++a[256];for(var h=Vv(a,15),f=h.t,d=h.l,v=Vv(s,15),g=v.t,y=v.l,p=NC(f),m=p.c,w=p.n,x=NC(g),b=x.c,B=x.n,_=new ni(19),k=0;k<m.length;++k)++_[m[k]&31];for(var k=0;k<b.length;++k)++_[b[k]&31];for(var E=Vv(_,7),T=E.t,S=E.l,j=19;j>4&&!T[bC[j-1]];--j);var I=u+5<<3,U=Df(a,Gu)+Df(s,Yg)+o,q=Df(a,f)+Df(s,g)+o+14+3*j+Df(_,T)+2*_[16]+3*_[17]+7*_[18];if(c>=0&&I<=U&&I<=q)return oI(t,A,e.subarray(c,c+u));var V,X,W,M;if(ll(t,A,1+(q<U)),A+=2,q<U){V=_h(f,d,0),X=f,W=_h(g,y,0),M=g;var G=_h(T,S,0);ll(t,A,w-257),ll(t,A+5,B-1),ll(t,A+10,j-4),A+=14;for(var k=0;k<j;++k)ll(t,A+3*k,T[bC[k]]);A+=3*j;for(var H=[m,b],C=0;C<2;++C)for(var L=H[C],k=0;k<L.length;++k){var O=L[k]&31;ll(t,A,G[O]),A+=T[O],O>15&&(ll(t,A,L[k]>>5&127),A+=L[k]>>12)}}else V=iae,X=Gu,W=oae,M=Yg;for(var k=0;k<l;++k){var D=n[k];if(D>255){var O=D>>18&31;Pf(t,A,V[O+257]),A+=X[O+257],O>7&&(ll(t,A,D>>23&31),A+=M_[O]);var P=D&31;Pf(t,A,W[P]),A+=M[P],P>3&&(Pf(t,A,D>>5&8191),A+=H_[P])}else Pf(t,A,V[D]),A+=X[D]}return Pf(t,A,V[256]),A+X[256]},cae=new Q_([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),lI=new fo(0),uae=function(e,t,r,n,a,s){var o=s.z||e.length,l=new fo(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),u=s.l,A=(s.r||0)&7;if(t){A&&(c[0]=s.r>>3);for(var h=cae[t-1],f=h>>13,d=h&8191,v=(1<<r)-1,g=s.p||new ni(32768),y=s.h||new ni(v+1),p=Math.ceil(r/3),m=2*p,w=function(be){return(e[be]^e[be+1]<<p^e[be+2]<<m)&v},x=new Q_(25e3),b=new ni(288),B=new ni(32),_=0,k=0,E=s.i||0,T=0,S=s.w||0,j=0;E+2<o;++E){var I=w(E),U=E&32767,q=y[I];if(g[U]=q,y[I]=U,S<=E){var V=o-E;if((_>7e3||T>24576)&&(V>423||!u)){A=BC(e,c,0,x,b,B,k,T,j,E-j,A),T=_=k=0,j=E;for(var X=0;X<286;++X)b[X]=0;for(var X=0;X<30;++X)B[X]=0}var W=2,M=0,G=d,H=U-q&32767;if(V>2&&I==w(E-H))for(var C=Math.min(f,V)-1,L=Math.min(32767,E),O=Math.min(258,V);H<=L&&--G&&U!=q;){if(e[E+W]==e[E+W-H]){for(var D=0;D<O&&e[E+D]==e[E+D-H];++D);if(D>W){if(W=D,M=H,D>C)break;for(var P=Math.min(H,D-2),Q=0,X=0;X<P;++X){var J=E-H+X&32767,te=g[J],z=J-te&32767;z>Q&&(Q=z,q=J)}}}U=q,q=g[U],H+=U-q&32767}if(M){x[T++]=268435456|A2[W]<<18|_C[M];var ye=A2[W]&31,re=_C[M]&31;k+=M_[ye]+H_[re],++b[257+ye],++B[re],S=E+W,++_}else x[T++]=e[E],++b[e[E]]}}for(E=Math.max(E,S);E<o;++E)x[T++]=e[E],++b[e[E]];A=BC(e,c,u,x,b,B,k,T,j,E-j,A),u||(s.r=A&7|c[A/8|0]<<3,A-=7,s.h=y,s.p=g,s.i=E,s.w=S)}else{for(var E=s.w||0;E<o+u;E+=65535){var ke=E+65535;ke>=o&&(c[A/8|0]=u,ke=o),A=oI(c,A+1,e.subarray(E,ke))}s.i=o}return lae(l,0,n+iI(A)+a)},cI=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},Aae=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new fo(s.length+e.length);o.set(s),o.set(e,s.length),e=o,a.w=s.length}return uae(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},uI=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},dae=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=cI();a.p(t.dictionary),uI(e,2,a.d())}};function h2(e,t){t||(t={});var r=cI();r.p(e);var n=Aae(e,t,t.dictionary?6:2,4);return dae(n,t),uI(n,n.length-4,r.d()),n}var fae=typeof TextDecoder<"u"&&new TextDecoder,hae=0;try{fae.decode(lI,{stream:!0}),hae=1}catch{}function pae(e){if(Array.isArray(e))return e}function mae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(A){u=!0,a=A}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function CC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function gae(e,t){if(e){if(typeof e=="string")return CC(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?CC(e,t):void 0}}function xae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EC(e,t){return pae(e)||mae(e,t)||gae(e,t)||xae()}function SC(e,t="utf8"){return new TextDecoder(t).decode(e)}const vae=new TextEncoder;function yae(e){return vae.encode(e)}const wae=1024*8,bae=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Gv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class q_{constructor(t=wae,r={}){jr(this,"buffer");jr(this,"byteLength");jr(this,"byteOffset");jr(this,"length");jr(this,"offset");jr(this,"lastWrittenByte");jr(this,"littleEndian");jr(this,"_data");jr(this,"_mark");jr(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,s=t.byteLength-a;let o=a;(ArrayBuffer.isView(t)||t instanceof q_)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=Gv[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===bae&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new Gv[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new Gv[r](s);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return SC(this.readBytes(t))}decodeText(t=1,r="utf8"){return SC(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(yae(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Gd(e){let t=e.length;for(;--t>=0;)e[t]=0}const _ae=3,Nae=258,AI=29,Bae=256,Cae=Bae+1+AI,dI=30,Eae=512,Sae=new Array((Cae+2)*2);Gd(Sae);const kae=new Array(dI*2);Gd(kae);const jae=new Array(Eae);Gd(jae);const Fae=new Array(Nae-_ae+1);Gd(Fae);const Tae=new Array(AI);Gd(Tae);const Iae=new Array(dI);Gd(Iae);const Lae=(e,t,r,n)=>{let a=e&65535|0,s=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+t[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var p2=Lae;const Oae=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},Uae=new Uint32Array(Oae()),Pae=(e,t,r,n)=>{const a=Uae,s=n+r;e^=-1;for(let o=n;o<s;o++)e=e>>>8^a[(e^t[o])&255];return e^-1};var Bo=Pae,m2={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},fI={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Dae=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Rae=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)Dae(r,n)&&(e[n]=r[n])}}return e},Qae=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,s=e.length;n<s;n++){let o=e[n];r.set(o,a),a+=o.length}return r},hI={assign:Rae,flattenChunks:Qae};let pI=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{pI=!1}const A0=new Uint8Array(256);for(let e=0;e<256;e++)A0[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;A0[254]=A0[254]=1;var Mae=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,a,s,o=e.length,l=0;for(a=0;a<o;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),s=0,a=0;s<l;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const Hae=(e,t)=>{if(t<65534&&e.subarray&&pI)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var qae=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,a;const s=new Array(r*2);for(a=0,n=0;n<r;){let o=e[n++];if(o<128){s[a++]=o;continue}let l=A0[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return Hae(s,a)},Kae=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+A0[e[r]]>t?r:t},g2={string2buf:Mae,buf2string:qae,utf8border:Kae};function $ae(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Vae=$ae;const Jp=16209,Gae=16191;var Wae=function(t,r){let n,a,s,o,l,c,u,A,h,f,d,v,g,y,p,m,w,x,b,B,_,k,E,T;const S=t.state;n=t.next_in,E=t.input,a=n+(t.avail_in-5),s=t.next_out,T=t.output,o=s-(r-t.avail_out),l=s+(t.avail_out-257),c=S.dmax,u=S.wsize,A=S.whave,h=S.wnext,f=S.window,d=S.hold,v=S.bits,g=S.lencode,y=S.distcode,p=(1<<S.lenbits)-1,m=(1<<S.distbits)-1;e:do{v<15&&(d+=E[n++]<<v,v+=8,d+=E[n++]<<v,v+=8),w=g[d&p];t:for(;;){if(x=w>>>24,d>>>=x,v-=x,x=w>>>16&255,x===0)T[s++]=w&65535;else if(x&16){b=w&65535,x&=15,x&&(v<x&&(d+=E[n++]<<v,v+=8),b+=d&(1<<x)-1,d>>>=x,v-=x),v<15&&(d+=E[n++]<<v,v+=8,d+=E[n++]<<v,v+=8),w=y[d&m];r:for(;;){if(x=w>>>24,d>>>=x,v-=x,x=w>>>16&255,x&16){if(B=w&65535,x&=15,v<x&&(d+=E[n++]<<v,v+=8,v<x&&(d+=E[n++]<<v,v+=8)),B+=d&(1<<x)-1,B>c){t.msg="invalid distance too far back",S.mode=Jp;break e}if(d>>>=x,v-=x,x=s-o,B>x){if(x=B-x,x>A&&S.sane){t.msg="invalid distance too far back",S.mode=Jp;break e}if(_=0,k=f,h===0){if(_+=u-x,x<b){b-=x;do T[s++]=f[_++];while(--x);_=s-B,k=T}}else if(h<x){if(_+=u+h-x,x-=h,x<b){b-=x;do T[s++]=f[_++];while(--x);if(_=0,h<b){x=h,b-=x;do T[s++]=f[_++];while(--x);_=s-B,k=T}}}else if(_+=h-x,x<b){b-=x;do T[s++]=f[_++];while(--x);_=s-B,k=T}for(;b>2;)T[s++]=k[_++],T[s++]=k[_++],T[s++]=k[_++],b-=3;b&&(T[s++]=k[_++],b>1&&(T[s++]=k[_++]))}else{_=s-B;do T[s++]=T[_++],T[s++]=T[_++],T[s++]=T[_++],b-=3;while(b>2);b&&(T[s++]=T[_++],b>1&&(T[s++]=T[_++]))}}else if(x&64){t.msg="invalid distance code",S.mode=Jp;break e}else{w=y[(w&65535)+(d&(1<<x)-1)];continue r}break}}else if(x&64)if(x&32){S.mode=Gae;break e}else{t.msg="invalid literal/length code",S.mode=Jp;break e}else{w=g[(w&65535)+(d&(1<<x)-1)];continue t}break}}while(n<a&&s<l);b=v>>3,n-=b,v-=b<<3,d&=(1<<v)-1,t.next_in=n,t.next_out=s,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=s<l?257+(l-s):257-(s-l),S.hold=d,S.bits=v};const NA=15,kC=852,jC=592,FC=0,Wv=1,TC=2,zae=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Xae=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Yae=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Jae=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Zae=(e,t,r,n,a,s,o,l)=>{const c=l.bits;let u=0,A=0,h=0,f=0,d=0,v=0,g=0,y=0,p=0,m=0,w,x,b,B,_,k=null,E;const T=new Uint16Array(NA+1),S=new Uint16Array(NA+1);let j=null,I,U,q;for(u=0;u<=NA;u++)T[u]=0;for(A=0;A<n;A++)T[t[r+A]]++;for(d=c,f=NA;f>=1&&T[f]===0;f--);if(d>f&&(d=f),f===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(h=1;h<f&&T[h]===0;h++);for(d<h&&(d=h),y=1,u=1;u<=NA;u++)if(y<<=1,y-=T[u],y<0)return-1;if(y>0&&(e===FC||f!==1))return-1;for(S[1]=0,u=1;u<NA;u++)S[u+1]=S[u]+T[u];for(A=0;A<n;A++)t[r+A]!==0&&(o[S[t[r+A]]++]=A);if(e===FC?(k=j=o,E=20):e===Wv?(k=zae,j=Xae,E=257):(k=Yae,j=Jae,E=0),m=0,A=0,u=h,_=s,v=d,g=0,b=-1,p=1<<d,B=p-1,e===Wv&&p>kC||e===TC&&p>jC)return 1;for(;;){I=u-g,o[A]+1<E?(U=0,q=o[A]):o[A]>=E?(U=j[o[A]-E],q=k[o[A]-E]):(U=96,q=0),w=1<<u-g,x=1<<v,h=x;do x-=w,a[_+(m>>g)+x]=I<<24|U<<16|q|0;while(x!==0);for(w=1<<u-1;m&w;)w>>=1;if(w!==0?(m&=w-1,m+=w):m=0,A++,--T[u]===0){if(u===f)break;u=t[r+o[A]]}if(u>d&&(m&B)!==b){for(g===0&&(g=d),_+=h,v=u-g,y=1<<v;v+g<f&&(y-=T[v+g],!(y<=0));)v++,y<<=1;if(p+=1<<v,e===Wv&&p>kC||e===TC&&p>jC)return 1;b=m&B,a[b]=d<<24|v<<16|_-s|0}}return m!==0&&(a[_+m]=u-g<<24|64<<16|0),l.bits=d,0};var Nh=Zae;const ese=0,mI=1,gI=2,{Z_FINISH:IC,Z_BLOCK:tse,Z_TREES:Zp,Z_OK:Wu,Z_STREAM_END:rse,Z_NEED_DICT:nse,Z_STREAM_ERROR:Ui,Z_DATA_ERROR:xI,Z_MEM_ERROR:vI,Z_BUF_ERROR:ase,Z_DEFLATED:LC}=fI,$x=16180,OC=16181,UC=16182,PC=16183,DC=16184,RC=16185,QC=16186,MC=16187,HC=16188,qC=16189,Jg=16190,cl=16191,zv=16192,KC=16193,Xv=16194,$C=16195,VC=16196,GC=16197,WC=16198,em=16199,tm=16200,zC=16201,XC=16202,YC=16203,JC=16204,ZC=16205,Yv=16206,eE=16207,tE=16208,nn=16209,yI=16210,wI=16211,sse=852,ise=592,ose=15,lse=ose,rE=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function cse(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const nA=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<$x||t.mode>wI?1:0},bI=e=>{if(nA(e))return Ui;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=$x,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(sse),t.distcode=t.distdyn=new Int32Array(ise),t.sane=1,t.back=-1,Wu},_I=e=>{if(nA(e))return Ui;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,bI(e)},NI=(e,t)=>{let r;if(nA(e))return Ui;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ui:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,_I(e))},BI=(e,t)=>{if(!e)return Ui;const r=new cse;e.state=r,r.strm=e,r.window=null,r.mode=$x;const n=NI(e,t);return n!==Wu&&(e.state=null),n},use=e=>BI(e,lse);let nE=!0,Jv,Zv;const Ase=e=>{if(nE){Jv=new Int32Array(512),Zv=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Nh(mI,e.lens,0,288,Jv,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Nh(gI,e.lens,0,32,Zv,0,e.work,{bits:5}),nE=!1}e.lencode=Jv,e.lenbits=9,e.distcode=Zv,e.distbits=5},CI=(e,t,r,n)=>{let a;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(t.subarray(r-n,r-n+a),s.wnext),n-=a,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},dse=(e,t)=>{let r,n,a,s,o,l,c,u,A,h,f,d,v,g,y=0,p,m,w,x,b,B,_,k;const E=new Uint8Array(4);let T,S;const j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(nA(e)||!e.output||!e.input&&e.avail_in!==0)return Ui;r=e.state,r.mode===cl&&(r.mode=zv),o=e.next_out,a=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,A=r.bits,h=l,f=c,k=Wu;e:for(;;)switch(r.mode){case $x:if(r.wrap===0){r.mode=zv;break}for(;A<16;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=u&255,E[1]=u>>>8&255,r.check=Bo(r.check,E,2,0),u=0,A=0,r.mode=OC;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=nn;break}if((u&15)!==LC){e.msg="unknown compression method",r.mode=nn;break}if(u>>>=4,A-=4,_=(u&15)+8,r.wbits===0&&(r.wbits=_),_>15||_>r.wbits){e.msg="invalid window size",r.mode=nn;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?qC:cl,u=0,A=0;break;case OC:for(;A<16;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if(r.flags=u,(r.flags&255)!==LC){e.msg="unknown compression method",r.mode=nn;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=nn;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Bo(r.check,E,2,0)),u=0,A=0,r.mode=UC;case UC:for(;A<32;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=Bo(r.check,E,4,0)),u=0,A=0,r.mode=PC;case PC:for(;A<16;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Bo(r.check,E,2,0)),u=0,A=0,r.mode=DC;case DC:if(r.flags&1024){for(;A<16;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Bo(r.check,E,2,0)),u=0,A=0}else r.head&&(r.head.extra=null);r.mode=RC;case RC:if(r.flags&1024&&(d=r.length,d>l&&(d=l),d&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+d),_)),r.flags&512&&r.wrap&4&&(r.check=Bo(r.check,n,d,s)),l-=d,s+=d,r.length-=d),r.length))break e;r.length=0,r.mode=QC;case QC:if(r.flags&2048){if(l===0)break e;d=0;do _=n[s+d++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_));while(_&&d<l);if(r.flags&512&&r.wrap&4&&(r.check=Bo(r.check,n,d,s)),l-=d,s+=d,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=MC;case MC:if(r.flags&4096){if(l===0)break e;d=0;do _=n[s+d++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_));while(_&&d<l);if(r.flags&512&&r.wrap&4&&(r.check=Bo(r.check,n,d,s)),l-=d,s+=d,_)break e}else r.head&&(r.head.comment=null);r.mode=HC;case HC:if(r.flags&512){for(;A<16;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=nn;break}u=0,A=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=cl;break;case qC:for(;A<32;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}e.adler=r.check=rE(u),u=0,A=0,r.mode=Jg;case Jg:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=A,nse;e.adler=r.check=1,r.mode=cl;case cl:if(t===tse||t===Zp)break e;case zv:if(r.last){u>>>=A&7,A-=A&7,r.mode=Yv;break}for(;A<3;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}switch(r.last=u&1,u>>>=1,A-=1,u&3){case 0:r.mode=KC;break;case 1:if(Ase(r),r.mode=em,t===Zp){u>>>=2,A-=2;break e}break;case 2:r.mode=VC;break;case 3:e.msg="invalid block type",r.mode=nn}u>>>=2,A-=2;break;case KC:for(u>>>=A&7,A-=A&7;A<32;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=nn;break}if(r.length=u&65535,u=0,A=0,r.mode=Xv,t===Zp)break e;case Xv:r.mode=$C;case $C:if(d=r.length,d){if(d>l&&(d=l),d>c&&(d=c),d===0)break e;a.set(n.subarray(s,s+d),o),l-=d,s+=d,c-=d,o+=d,r.length-=d;break}r.mode=cl;break;case VC:for(;A<14;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if(r.nlen=(u&31)+257,u>>>=5,A-=5,r.ndist=(u&31)+1,u>>>=5,A-=5,r.ncode=(u&15)+4,u>>>=4,A-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=nn;break}r.have=0,r.mode=GC;case GC:for(;r.have<r.ncode;){for(;A<3;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}r.lens[j[r.have++]]=u&7,u>>>=3,A-=3}for(;r.have<19;)r.lens[j[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,T={bits:r.lenbits},k=Nh(ese,r.lens,0,19,r.lencode,0,r.work,T),r.lenbits=T.bits,k){e.msg="invalid code lengths set",r.mode=nn;break}r.have=0,r.mode=WC;case WC:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],p=y>>>24,m=y>>>16&255,w=y&65535,!(p<=A);){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if(w<16)u>>>=p,A-=p,r.lens[r.have++]=w;else{if(w===16){for(S=p+2;A<S;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if(u>>>=p,A-=p,r.have===0){e.msg="invalid bit length repeat",r.mode=nn;break}_=r.lens[r.have-1],d=3+(u&3),u>>>=2,A-=2}else if(w===17){for(S=p+3;A<S;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}u>>>=p,A-=p,_=0,d=3+(u&7),u>>>=3,A-=3}else{for(S=p+7;A<S;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}u>>>=p,A-=p,_=0,d=11+(u&127),u>>>=7,A-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=nn;break}for(;d--;)r.lens[r.have++]=_}}if(r.mode===nn)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=nn;break}if(r.lenbits=9,T={bits:r.lenbits},k=Nh(mI,r.lens,0,r.nlen,r.lencode,0,r.work,T),r.lenbits=T.bits,k){e.msg="invalid literal/lengths set",r.mode=nn;break}if(r.distbits=6,r.distcode=r.distdyn,T={bits:r.distbits},k=Nh(gI,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,T),r.distbits=T.bits,k){e.msg="invalid distances set",r.mode=nn;break}if(r.mode=em,t===Zp)break e;case em:r.mode=tm;case tm:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=A,Wae(e,f),o=e.next_out,a=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,A=r.bits,r.mode===cl&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],p=y>>>24,m=y>>>16&255,w=y&65535,!(p<=A);){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if(m&&!(m&240)){for(x=p,b=m,B=w;y=r.lencode[B+((u&(1<<x+b)-1)>>x)],p=y>>>24,m=y>>>16&255,w=y&65535,!(x+p<=A);){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}u>>>=x,A-=x,r.back+=x}if(u>>>=p,A-=p,r.back+=p,r.length=w,m===0){r.mode=ZC;break}if(m&32){r.back=-1,r.mode=cl;break}if(m&64){e.msg="invalid literal/length code",r.mode=nn;break}r.extra=m&15,r.mode=zC;case zC:if(r.extra){for(S=r.extra;A<S;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,A-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=XC;case XC:for(;y=r.distcode[u&(1<<r.distbits)-1],p=y>>>24,m=y>>>16&255,w=y&65535,!(p<=A);){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if(!(m&240)){for(x=p,b=m,B=w;y=r.distcode[B+((u&(1<<x+b)-1)>>x)],p=y>>>24,m=y>>>16&255,w=y&65535,!(x+p<=A);){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}u>>>=x,A-=x,r.back+=x}if(u>>>=p,A-=p,r.back+=p,m&64){e.msg="invalid distance code",r.mode=nn;break}r.offset=w,r.extra=m&15,r.mode=YC;case YC:if(r.extra){for(S=r.extra;A<S;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,A-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=nn;break}r.mode=JC;case JC:if(c===0)break e;if(d=f-c,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=nn;break}d>r.wnext?(d-=r.wnext,v=r.wsize-d):v=r.wnext-d,d>r.length&&(d=r.length),g=r.window}else g=a,v=o-r.offset,d=r.length;d>c&&(d=c),c-=d,r.length-=d;do a[o++]=g[v++];while(--d);r.length===0&&(r.mode=tm);break;case ZC:if(c===0)break e;a[o++]=r.length,c--,r.mode=tm;break;case Yv:if(r.wrap){for(;A<32;){if(l===0)break e;l--,u|=n[s++]<<A,A+=8}if(f-=c,e.total_out+=f,r.total+=f,r.wrap&4&&f&&(e.adler=r.check=r.flags?Bo(r.check,a,f,o-f):p2(r.check,a,f,o-f)),f=c,r.wrap&4&&(r.flags?u:rE(u))!==r.check){e.msg="incorrect data check",r.mode=nn;break}u=0,A=0}r.mode=eE;case eE:if(r.wrap&&r.flags){for(;A<32;){if(l===0)break e;l--,u+=n[s++]<<A,A+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=nn;break}u=0,A=0}r.mode=tE;case tE:k=rse;break e;case nn:k=xI;break e;case yI:return vI;case wI:default:return Ui}return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=A,(r.wsize||f!==e.avail_out&&r.mode<nn&&(r.mode<Yv||t!==IC))&&CI(e,e.output,e.next_out,f-e.avail_out),h-=e.avail_in,f-=e.avail_out,e.total_in+=h,e.total_out+=f,r.total+=f,r.wrap&4&&f&&(e.adler=r.check=r.flags?Bo(r.check,a,f,e.next_out-f):p2(r.check,a,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(r.mode===cl?128:0)+(r.mode===em||r.mode===Xv?256:0),(h===0&&f===0||t===IC)&&k===Wu&&(k=ase),k},fse=e=>{if(nA(e))return Ui;let t=e.state;return t.window&&(t.window=null),e.state=null,Wu},hse=(e,t)=>{if(nA(e))return Ui;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Wu):Ui},pse=(e,t)=>{const r=t.length;let n,a,s;return nA(e)||(n=e.state,n.wrap!==0&&n.mode!==Jg)?Ui:n.mode===Jg&&(a=1,a=p2(a,t,r,0),a!==n.check)?xI:(s=CI(e,t,r,r),s?(n.mode=yI,vI):(n.havedict=1,Wu))};var mse=_I,gse=NI,xse=bI,vse=use,yse=BI,wse=dse,bse=fse,_se=hse,Nse=pse,Bse="pako inflate (from Nodeca project)",ml={inflateReset:mse,inflateReset2:gse,inflateResetKeep:xse,inflateInit:vse,inflateInit2:yse,inflate:wse,inflateEnd:bse,inflateGetHeader:_se,inflateSetDictionary:Nse,inflateInfo:Bse};function Cse(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Ese=Cse;const EI=Object.prototype.toString,{Z_NO_FLUSH:Sse,Z_FINISH:kse,Z_OK:d0,Z_STREAM_END:ey,Z_NEED_DICT:ty,Z_STREAM_ERROR:jse,Z_DATA_ERROR:aE,Z_MEM_ERROR:Fse}=fI;function T0(e){this.options=hI.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Vae,this.strm.avail_out=0;let r=ml.inflateInit2(this.strm,t.windowBits);if(r!==d0)throw new Error(m2[r]);if(this.header=new Ese,ml.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=g2.string2buf(t.dictionary):EI.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=ml.inflateSetDictionary(this.strm,t.dictionary),r!==d0)))throw new Error(m2[r])}T0.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?kse:Sse,EI.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=ml.inflate(r,o),s===ty&&a&&(s=ml.inflateSetDictionary(r,a),s===d0?s=ml.inflate(r,o):s===aE&&(s=ty));r.avail_in>0&&s===ey&&r.state.wrap>0&&e[r.next_in]!==0;)ml.inflateReset(r),s=ml.inflate(r,o);switch(s){case jse:case aE:case ty:case Fse:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===ey))if(this.options.to==="string"){let c=g2.utf8border(r.output,r.next_out),u=r.next_out-c,A=g2.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(A)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===d0&&l===0)){if(s===ey)return s=ml.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};T0.prototype.onData=function(e){this.chunks.push(e)};T0.prototype.onEnd=function(e){e===d0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=hI.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Tse(e,t){const r=new T0(t);if(r.push(e),r.err)throw r.msg||m2[r.err];return r.result}var Ise=T0,Lse=Tse,Ose={Inflate:Ise,inflate:Lse};const{Inflate:Use,inflate:Pse}=Ose;var sE=Use,Dse=Pse;const SI=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;SI[e]=t}const iE=4294967295;function Rse(e,t,r){let n=e;for(let a=0;a<r;a++)n=SI[(n^t[a])&255]^n>>>8;return n}function Qse(e,t){return(Rse(iE,e,t)^iE)>>>0}function oE(e,t,r){const n=e.readUint32(),a=Qse(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function kI(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function jI(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function FI(e,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function TI(e,t,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-a]>>1)&255}else{for(;s<a;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-a]+r[s]>>1)&255}}function II(e,t,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-a]&255}else{for(;s<a;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+Mse(t[s-a],r[s],r[s-a])&255}}function Mse(e,t,r){const n=e+t-r,a=Math.abs(n-e),s=Math.abs(n-t),o=Math.abs(n-r);return a<=s&&a<=o?e:s<=o?t:r}function Hse(e,t,r,n,a,s){switch(e){case 0:kI(t,r,a);break;case 1:jI(t,r,a,s);break;case 2:FI(t,r,n,a);break;case 3:TI(t,r,n,a,s);break;case 4:II(t,r,n,a,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const qse=new Uint16Array([255]),Kse=new Uint8Array(qse.buffer),$se=Kse[0]===255;function Vse(e){const{data:t,width:r,height:n,channels:a,depth:s}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*r*l);let u=0;for(let A=0;A<7;A++){const h=o[A],f=Math.ceil((r-h.x)/h.xStep),d=Math.ceil((n-h.y)/h.yStep);if(f<=0||d<=0)continue;const v=f*l,g=new Uint8Array(v);for(let y=0;y<d;y++){const p=t[u++],m=t.subarray(u,u+v);u+=v;const w=new Uint8Array(v);Hse(p,m,w,g,v,l),g.set(w);for(let x=0;x<f;x++){const b=h.x+x*h.xStep,B=h.y+y*h.yStep;if(!(b>=r||B>=n))for(let _=0;_<l;_++)c[(B*r+b)*l+_]=w[x*l+_]}}}if(s===16){const A=new Uint16Array(c.buffer);if($se)for(let h=0;h<A.length;h++)A[h]=Gse(A[h]);return A}else return c}function Gse(e){return(e&255)<<8|e>>8&255}const Wse=new Uint16Array([255]),zse=new Uint8Array(Wse.buffer),Xse=zse[0]===255,Yse=new Uint8Array(0);function lE(e){const{data:t,width:r,height:n,channels:a,depth:s}=e,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*r),c=new Uint8Array(n*l);let u=Yse,A=0,h,f;for(let d=0;d<n;d++){switch(h=t.subarray(A+1,A+1+l),f=c.subarray(d*l,(d+1)*l),t[A]){case 0:kI(h,f,l);break;case 1:jI(h,f,l,o);break;case 2:FI(h,f,u,l);break;case 3:TI(h,f,u,l,o);break;case 4:II(h,f,u,l,o);break;default:throw new Error(`Unsupported filter: ${t[A]}`)}u=f,A+=l+1}if(s===16){const d=new Uint16Array(c.buffer);if(Xse)for(let v=0;v<d.length;v++)d[v]=Jse(d[v]);return d}else return c}function Jse(e){return(e&255)<<8|e>>8&255}const qm=Uint8Array.of(137,80,78,71,13,10,26,10);function cE(e){if(!Zse(e.readBytes(qm.length)))throw new Error("wrong PNG signature")}function Zse(e){if(e.length<qm.length)return!1;for(let t=0;t<qm.length;t++)if(e[t]!==qm[t])return!1;return!0}const eie="tEXt",tie=0,LI=new TextDecoder("latin1");function rie(e){if(aie(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const nie=/^[\u0000-\u00FF]*$/;function aie(e){if(!nie.test(e))throw new Error("invalid latin1 text")}function sie(e,t,r){const n=OI(t);e[n]=iie(t,r-n.length-1)}function OI(e){for(e.mark();e.readByte()!==tie;);const t=e.offset;e.reset();const r=LI.decode(e.readBytes(t-e.offset-1));return e.skip(1),rie(r),r}function iie(e,t){return LI.decode(e.readBytes(t))}const $s={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},ry={UNKNOWN:-1,DEFLATE:0},uE={UNKNOWN:-1,ADAPTIVE:0},ny={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},rm={NONE:0,BACKGROUND:1,PREVIOUS:2},ay={SOURCE:0,OVER:1};class oie extends q_{constructor(r,n={}){super(r);jr(this,"_checkCrc");jr(this,"_inflator");jr(this,"_png");jr(this,"_apng");jr(this,"_end");jr(this,"_hasPalette");jr(this,"_palette");jr(this,"_hasTransparency");jr(this,"_transparency");jr(this,"_compressionMethod");jr(this,"_filterMethod");jr(this,"_interlaceMethod");jr(this,"_colorType");jr(this,"_isAnimated");jr(this,"_numberOfFrames");jr(this,"_numberOfPlays");jr(this,"_frames");jr(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new sE,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=ry.UNKNOWN,this._filterMethod=uE.UNKNOWN,this._interlaceMethod=ny.UNKNOWN,this._colorType=$s.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(cE(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(cE(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case eie:sie(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?oE(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?oE(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=lie(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case $s.GREYSCALE:a=1;break;case $s.TRUECOLOUR:a=3;break;case $s.INDEXED_COLOUR:a=1;break;case $s.GREYSCALE_ALPHA:a=2;break;case $s.TRUECOLOUR_ALPHA:a=4;break;case $s.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==ry.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case $s.GREYSCALE:case $s.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case $s.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case $s.UNKNOWN:case $s.GREYSCALE_ALPHA:case $s.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=OI(this),a=this.readUint8();if(a!==ry.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:Dse(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=lE({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case rm.NONE:break;case rm.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case rm.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case ay.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let A=0;A<this._png.channels;A++)r.data[c+A]=n.data[u+A]}break;case ay.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let A=0;A<this._png.channels;A++){const h=n.data[u+this._png.channels-1]/a,f=A%(this._png.channels-1)===0?1:n.data[u+A],d=Math.floor(h*f+(1-h)*r.data[c+A]);r.data[c+A]+=d}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==uE.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===ny.NO_INTERLACE)this._png.data=lE({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===ny.ADAM7)this._png.data=Vse({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:rm.NONE,blendOp:ay.SOURCE,data:r}),this._inflator=new sE,this._writingDataChunks=!1}}function lie(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var AE;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(AE||(AE={}));function cie(e,t){return new oie(e,t).decode()}var Wt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function sy(){Wt.console&&typeof Wt.console.log=="function"&&Wt.console.log.apply(Wt.console,arguments)}var Hr={log:sy,warn:function(e){Wt.console&&(typeof Wt.console.warn=="function"?Wt.console.warn.apply(Wt.console,arguments):sy.call(null,arguments))},error:function(e){Wt.console&&(typeof Wt.console.error=="function"?Wt.console.error.apply(Wt.console,arguments):sy(e))}};function iy(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){fu(n.response,t,r)},n.onerror=function(){Hr.error("could not download file")},n.send()}function dE(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function nm(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var fu=Wt.saveAs||((typeof window>"u"?"undefined":Ir(window))!=="object"||window!==Wt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Wt.URL||Wt.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?dE(a.href)?iy(e,t,r):nm(a,a.target="_blank"):nm(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){nm(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(dE(e))iy(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){nm(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:Ir(s)!=="object"&&(Hr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return iy(e,t,r);var a=e.type==="application/octet-stream",s=/constructor/i.test(Wt.HTMLElement)||Wt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":Ir(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var A=l.result;A=o?A:A.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=A:location=A,n=null},l.readAsDataURL(e)}else{var c=Wt.URL||Wt.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function UI(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,o=a.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Km=Wt.atob.bind(Wt),fE=Wt.btoa.bind(Wt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function oy(e,t){var r=e[0],n=e[1],a=e[2],s=e[3];r=Ka(r,n,a,s,t[0],7,-680876936),s=Ka(s,r,n,a,t[1],12,-389564586),a=Ka(a,s,r,n,t[2],17,606105819),n=Ka(n,a,s,r,t[3],22,-1044525330),r=Ka(r,n,a,s,t[4],7,-176418897),s=Ka(s,r,n,a,t[5],12,1200080426),a=Ka(a,s,r,n,t[6],17,-1473231341),n=Ka(n,a,s,r,t[7],22,-45705983),r=Ka(r,n,a,s,t[8],7,1770035416),s=Ka(s,r,n,a,t[9],12,-1958414417),a=Ka(a,s,r,n,t[10],17,-42063),n=Ka(n,a,s,r,t[11],22,-1990404162),r=Ka(r,n,a,s,t[12],7,1804603682),s=Ka(s,r,n,a,t[13],12,-40341101),a=Ka(a,s,r,n,t[14],17,-1502002290),r=$a(r,n=Ka(n,a,s,r,t[15],22,1236535329),a,s,t[1],5,-165796510),s=$a(s,r,n,a,t[6],9,-1069501632),a=$a(a,s,r,n,t[11],14,643717713),n=$a(n,a,s,r,t[0],20,-373897302),r=$a(r,n,a,s,t[5],5,-701558691),s=$a(s,r,n,a,t[10],9,38016083),a=$a(a,s,r,n,t[15],14,-660478335),n=$a(n,a,s,r,t[4],20,-405537848),r=$a(r,n,a,s,t[9],5,568446438),s=$a(s,r,n,a,t[14],9,-1019803690),a=$a(a,s,r,n,t[3],14,-187363961),n=$a(n,a,s,r,t[8],20,1163531501),r=$a(r,n,a,s,t[13],5,-1444681467),s=$a(s,r,n,a,t[2],9,-51403784),a=$a(a,s,r,n,t[7],14,1735328473),r=Va(r,n=$a(n,a,s,r,t[12],20,-1926607734),a,s,t[5],4,-378558),s=Va(s,r,n,a,t[8],11,-2022574463),a=Va(a,s,r,n,t[11],16,1839030562),n=Va(n,a,s,r,t[14],23,-35309556),r=Va(r,n,a,s,t[1],4,-1530992060),s=Va(s,r,n,a,t[4],11,1272893353),a=Va(a,s,r,n,t[7],16,-155497632),n=Va(n,a,s,r,t[10],23,-1094730640),r=Va(r,n,a,s,t[13],4,681279174),s=Va(s,r,n,a,t[0],11,-358537222),a=Va(a,s,r,n,t[3],16,-722521979),n=Va(n,a,s,r,t[6],23,76029189),r=Va(r,n,a,s,t[9],4,-640364487),s=Va(s,r,n,a,t[12],11,-421815835),a=Va(a,s,r,n,t[15],16,530742520),r=Ga(r,n=Va(n,a,s,r,t[2],23,-995338651),a,s,t[0],6,-198630844),s=Ga(s,r,n,a,t[7],10,1126891415),a=Ga(a,s,r,n,t[14],15,-1416354905),n=Ga(n,a,s,r,t[5],21,-57434055),r=Ga(r,n,a,s,t[12],6,1700485571),s=Ga(s,r,n,a,t[3],10,-1894986606),a=Ga(a,s,r,n,t[10],15,-1051523),n=Ga(n,a,s,r,t[1],21,-2054922799),r=Ga(r,n,a,s,t[8],6,1873313359),s=Ga(s,r,n,a,t[15],10,-30611744),a=Ga(a,s,r,n,t[6],15,-1560198380),n=Ga(n,a,s,r,t[13],21,1309151649),r=Ga(r,n,a,s,t[4],6,-145523070),s=Ga(s,r,n,a,t[11],10,-1120210379),a=Ga(a,s,r,n,t[2],15,718787259),n=Ga(n,a,s,r,t[9],21,-343485551),e[0]=pc(r,e[0]),e[1]=pc(n,e[1]),e[2]=pc(a,e[2]),e[3]=pc(s,e[3])}function Vx(e,t,r,n,a,s){return t=pc(pc(t,e),pc(n,s)),pc(t<<a|t>>>32-a,r)}function Ka(e,t,r,n,a,s,o){return Vx(t&r|~t&n,e,t,a,s,o)}function $a(e,t,r,n,a,s,o){return Vx(t&n|r&~n,e,t,a,s,o)}function Va(e,t,r,n,a,s,o){return Vx(t^r^n,e,t,a,s,o)}function Ga(e,t,r,n,a,s,o){return Vx(r^(t|~n),e,t,a,s,o)}function PI(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)oy(n,uie(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(oy(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,oy(n,a),n}function uie(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var hE="0123456789abcdef".split("");function Aie(e){for(var t="",r=0;r<4;r++)t+=hE[e>>8*r+4&15]+hE[e>>8*r&15];return t}function die(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function x2(e){return PI(e).map(die).join("")}var fie=function(e){for(var t=0;t<e.length;t++)e[t]=Aie(e[t]);return e.join("")}(PI("hello"))!="5d41402abc4b2a76b9719d911017c592";function pc(e,t){if(fie){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function v2(e,t){var r,n,a,s;if(e!==r){for(var o=(a=e,s=1+(256/e.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var A=l[c];u=(u+A+o.charCodeAt(c))%256,l[c]=l[u],l[u]=A}r=e,n=l}else l=n;var h=t.length,f=0,d=0,v="";for(c=0;c<h;c++)d=(d+(A=l[f=(f+1)%256]))%256,l[f]=l[d],l[d]=A,o=l[(l[f]+l[d])%256],v+=String.fromCharCode(t.charCodeAt(c)^o);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var pE={print:4,modify:8,copy:16,"annot-forms":32};function UA(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(l){if(pE.perm!==void 0)throw new Error("Invalid permission: "+l);a+=pE[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=x2(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=v2(this.encryptionKey,this.padding)}function PA(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return t}function mE(e){if(Ir(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,n)}catch(l){Wt.console&&Hr.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Zg(e){if(!(this instanceof Zg))return new Zg(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function DI(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function xu(e,t,r,n,a){if(!(this instanceof xu))return new xu(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,DI.call(this,n,a)}function ZA(e,t,r,n,a){if(!(this instanceof ZA))return new ZA(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,DI.call(this,n,a)}function Ot(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",A=null;Ir(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,s=e.compress||e.compressPdf||s,(A=e.encryption||null)!==null&&(A.userPassword=A.userPassword||"",A.ownerPassword=A.ownerPassword||"",A.userPermissions=A.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,f={},d={internal:{},__private__:{}};d.__private__.PubSub=mE;var v="1.3",g=d.__private__.getPdfVersion=function(){return v};d.__private__.setPdfVersion=function(R){v=R};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return y};var p=d.__private__.getPageFormat=function(R){return y[R]};a=a||"a4";var m="compat",w="advanced",x=m;function b(){this.saveGraphicsState(),ae(new Lt(Qe,0,0,-Qe,0,Xc()*Qe).toString()+" cm"),this.setFontSize(this.getFontSize()/Qe),u="n",x=w}function B(){this.restoreGraphicsState(),u="S",x=m}var _=d.__private__.combineFontStyleAndFontWeight=function(R,ie){if(R=="bold"&&ie=="normal"||R=="bold"&&ie==400||R=="normal"&&ie=="italic"||R=="bold"&&ie=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ie&&(R=ie==400||ie==="normal"?R==="italic"?"italic":"normal":ie!=700&&ie!=="bold"||R!=="normal"?(ie==700?"bold":ie)+""+R:"bold"),R};d.advancedAPI=function(R){var ie=x===m;return ie&&b.call(this),typeof R!="function"||(R(this),ie&&B.call(this)),this},d.compatAPI=function(R){var ie=x===w;return ie&&B.call(this),typeof R!="function"||(R(this),ie&&b.call(this)),this},d.isAdvancedAPI=function(){return x===w};var k,E=function(R){if(x!==w)throw new Error(R+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},T=d.roundToPrecision=d.__private__.roundToPrecision=function(R,ie){var Ce=t||ie;if(isNaN(R)||isNaN(Ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return R.toFixed(Ce).replace(/0+$/,"")};k=d.hpf=d.__private__.hpf=typeof c=="number"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return T(R,c)}:c==="smart"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return T(R,R>-1&&R<1?16:5)}:function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return T(R,16)};var S=d.f2=d.__private__.f2=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f2");return T(R,2)},j=d.__private__.f3=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f3");return T(R,3)},I=d.scale=d.__private__.scale=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.scale");return x===m?R*Qe:x===w?R:void 0},U=function(R){return I(function(ie){return x===m?Xc()-ie:x===w?ie:void 0}(R))};d.__private__.setPrecision=d.setPrecision=function(R){typeof parseInt(R,10)=="number"&&(t=parseInt(R,10))};var q,V="00000000000000000000000000000000",X=d.__private__.getFileId=function(){return V},W=d.__private__.setFileId=function(R){return V=R!==void 0&&/^[a-fA-F0-9]{32}$/.test(R)?R.toUpperCase():V.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),A!==null&&(Yn=new UA(A.userPermissions,A.userPassword,A.ownerPassword,V)),V};d.setFileId=function(R){return W(R),this},d.getFileId=function(){return X()};var M=d.__private__.convertDateToPDFDate=function(R){var ie=R.getTimezoneOffset(),Ce=ie<0?"+":"-",Fe=Math.floor(Math.abs(ie/60)),Ke=Math.abs(ie%60),nt=[Ce,O(Fe),"'",O(Ke),"'"].join("");return["D:",R.getFullYear(),O(R.getMonth()+1),O(R.getDate()),O(R.getHours()),O(R.getMinutes()),O(R.getSeconds()),nt].join("")},G=d.__private__.convertPDFDateToDate=function(R){var ie=parseInt(R.substr(2,4),10),Ce=parseInt(R.substr(6,2),10)-1,Fe=parseInt(R.substr(8,2),10),Ke=parseInt(R.substr(10,2),10),nt=parseInt(R.substr(12,2),10),lt=parseInt(R.substr(14,2),10);return new Date(ie,Ce,Fe,Ke,nt,lt,0)},H=d.__private__.setCreationDate=function(R){var ie;if(R===void 0&&(R=new Date),R instanceof Date)ie=M(R);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(R))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ie=R}return q=ie},C=d.__private__.getCreationDate=function(R){var ie=q;return R==="jsDate"&&(ie=G(q)),ie};d.setCreationDate=function(R){return H(R),this},d.getCreationDate=function(R){return C(R)};var L,O=d.__private__.padd2=function(R){return("0"+parseInt(R)).slice(-2)},D=d.__private__.padd2Hex=function(R){return("00"+(R=R.toString())).substr(R.length)},P=0,Q=[],J=[],te=0,z=[],ye=[],re=!1,ke=J;d.__private__.setCustomOutputDestination=function(R){re=!0,ke=R};var be=function(R){re||(ke=R)};d.__private__.resetCustomOutputDestination=function(){re=!1,ke=J};var ae=d.__private__.out=function(R){return R=R.toString(),te+=R.length+1,ke.push(R),ke},Ie=d.__private__.write=function(R){return ae(arguments.length===1?R.toString():Array.prototype.join.call(arguments," "))},De=d.__private__.getArrayBuffer=function(R){for(var ie=R.length,Ce=new ArrayBuffer(ie),Fe=new Uint8Array(Ce);ie--;)Fe[ie]=R.charCodeAt(ie);return Ce},pe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return pe};var we=e.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(R){return we=x===w?R/Qe:R,this};var Te,he=d.__private__.getFontSize=d.getFontSize=function(){return x===m?we:we*Qe},ce=e.R2L||!1;d.__private__.setR2L=d.setR2L=function(R){return ce=R,this},d.__private__.getR2L=d.getR2L=function(){return ce};var Se,Pe=d.__private__.setZoomMode=function(R){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(R))Te=R;else if(isNaN(R)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(R)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+R+'" is not recognized.');Te=R}else Te=parseInt(R,10)};d.__private__.getZoomMode=function(){return Te};var Le,Xe=d.__private__.setPageMode=function(R){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(R)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+R+'" is not recognized.');Se=R};d.__private__.getPageMode=function(){return Se};var fe=d.__private__.setLayoutMode=function(R){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(R)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+R+'" is not recognized.');Le=R};d.__private__.getLayoutMode=function(){return Le},d.__private__.setDisplayMode=d.setDisplayMode=function(R,ie,Ce){return Pe(R),fe(ie),Xe(Ce),this};var Ee={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(R){if(Object.keys(Ee).indexOf(R)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ee[R]},d.__private__.getDocumentProperties=function(){return Ee},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(R){for(var ie in Ee)Ee.hasOwnProperty(ie)&&R[ie]&&(Ee[ie]=R[ie]);return this},d.__private__.setDocumentProperty=function(R,ie){if(Object.keys(Ee).indexOf(R)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ee[R]=ie};var qe,Qe,Ye,Nt,xt,it={},ut={},Mt=[],ht={},Et={},mt={},_t={},Ht=null,bt=0,Ct=[],or=new mE(d),Ra=e.hotfixes||[],er={},on={},zn=[],Lt=function R(ie,Ce,Fe,Ke,nt,lt){if(!(this instanceof R))return new R(ie,Ce,Fe,Ke,nt,lt);isNaN(ie)&&(ie=1),isNaN(Ce)&&(Ce=0),isNaN(Fe)&&(Fe=0),isNaN(Ke)&&(Ke=1),isNaN(nt)&&(nt=0),isNaN(lt)&&(lt=0),this._matrix=[ie,Ce,Fe,Ke,nt,lt]};Object.defineProperty(Lt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(Lt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(Lt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(Lt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(Lt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(Lt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(Lt.prototype,"a",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(Lt.prototype,"b",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(Lt.prototype,"c",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(Lt.prototype,"d",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(Lt.prototype,"e",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(Lt.prototype,"f",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(Lt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Lt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Lt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Lt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Lt.prototype.join=function(R){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(k).join(R)},Lt.prototype.multiply=function(R){var ie=R.sx*this.sx+R.shy*this.shx,Ce=R.sx*this.shy+R.shy*this.sy,Fe=R.shx*this.sx+R.sy*this.shx,Ke=R.shx*this.shy+R.sy*this.sy,nt=R.tx*this.sx+R.ty*this.shx+this.tx,lt=R.tx*this.shy+R.ty*this.sy+this.ty;return new Lt(ie,Ce,Fe,Ke,nt,lt)},Lt.prototype.decompose=function(){var R=this.sx,ie=this.shy,Ce=this.shx,Fe=this.sy,Ke=this.tx,nt=this.ty,lt=Math.sqrt(R*R+ie*ie),Ft=(R/=lt)*Ce+(ie/=lt)*Fe;Ce-=R*Ft,Fe-=ie*Ft;var Pt=Math.sqrt(Ce*Ce+Fe*Fe);return Ft/=Pt,R*(Fe/=Pt)<ie*(Ce/=Pt)&&(R=-R,ie=-ie,Ft=-Ft,lt=-lt),{scale:new Lt(lt,0,0,Pt,0,0),translate:new Lt(1,0,0,1,Ke,nt),rotate:new Lt(R,ie,-ie,R,0,0),skew:new Lt(1,0,Ft,1,0,0)}},Lt.prototype.toString=function(R){return this.join(" ")},Lt.prototype.inversed=function(){var R=this.sx,ie=this.shy,Ce=this.shx,Fe=this.sy,Ke=this.tx,nt=this.ty,lt=1/(R*Fe-ie*Ce),Ft=Fe*lt,Pt=-ie*lt,Xt=-Ce*lt,tr=R*lt;return new Lt(Ft,Pt,Xt,tr,-Ft*Ke-Xt*nt,-Pt*Ke-tr*nt)},Lt.prototype.applyToPoint=function(R){var ie=R.x*this.sx+R.y*this.shx+this.tx,Ce=R.x*this.shy+R.y*this.sy+this.ty;return new Yo(ie,Ce)},Lt.prototype.applyToRectangle=function(R){var ie=this.applyToPoint(R),Ce=this.applyToPoint(new Yo(R.x+R.w,R.y+R.h));return new ef(ie.x,ie.y,Ce.x-ie.x,Ce.y-ie.y)},Lt.prototype.clone=function(){var R=this.sx,ie=this.shy,Ce=this.shx,Fe=this.sy,Ke=this.tx,nt=this.ty;return new Lt(R,ie,Ce,Fe,Ke,nt)},d.Matrix=Lt;var Dn=d.matrixMult=function(R,ie){return ie.multiply(R)},Xn=new Lt(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=Xn;var Nn=function(R,ie){if(!Et[R]){var Ce=(ie instanceof xu?"Sh":"P")+(Object.keys(ht).length+1).toString(10);ie.id=Ce,Et[R]=Ce,ht[Ce]=ie,or.publish("addPattern",ie)}};d.ShadingPattern=xu,d.TilingPattern=ZA,d.addShadingPattern=function(R,ie){return E("addShadingPattern()"),Nn(R,ie),this},d.beginTilingPattern=function(R){E("beginTilingPattern()"),tf(R.boundingBox[0],R.boundingBox[1],R.boundingBox[2]-R.boundingBox[0],R.boundingBox[3]-R.boundingBox[1],R.matrix)},d.endTilingPattern=function(R,ie){E("endTilingPattern()"),ie.stream=ye[L].join(`
`),Nn(R,ie),or.publish("endTilingPattern",ie),zn.pop().restore()};var da,Ar=d.__private__.newObject=function(){var R=Br();return le(R,!0),R},Br=d.__private__.newObjectDeferred=function(){return P++,Q[P]=function(){return te},P},le=function(R,ie){return ie=typeof ie=="boolean"&&ie,Q[R]=te,ie&&ae(R+" 0 obj"),R},ee=d.__private__.newAdditionalObject=function(){var R={objId:Br(),content:""};return z.push(R),R},se=Br(),ne=Br(),xe=d.__private__.decodeColorString=function(R){var ie=R.split(" ");if(ie.length!==2||ie[1]!=="g"&&ie[1]!=="G")ie.length!==5||ie[4]!=="k"&&ie[4]!=="K"||(ie=[(1-ie[0])*(1-ie[3]),(1-ie[1])*(1-ie[3]),(1-ie[2])*(1-ie[3]),"r"]);else{var Ce=parseFloat(ie[0]);ie=[Ce,Ce,Ce,"r"]}for(var Fe="#",Ke=0;Ke<3;Ke++)Fe+=("0"+Math.floor(255*parseFloat(ie[Ke])).toString(16)).slice(-2);return Fe},me=d.__private__.encodeColorString=function(R){var ie;typeof R=="string"&&(R={ch1:R});var Ce=R.ch1,Fe=R.ch2,Ke=R.ch3,nt=R.ch4,lt=R.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ce=="string"&&Ce.charAt(0)!=="#"){var Ft=new UI(Ce);if(Ft.ok)Ce=Ft.toHex();else if(!/^\d*\.?\d*$/.test(Ce))throw new Error('Invalid color "'+Ce+'" passed to jsPDF.encodeColorString.')}if(typeof Ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ce)&&(Ce="#"+Ce[1]+Ce[1]+Ce[2]+Ce[2]+Ce[3]+Ce[3]),typeof Ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ce)){var Pt=parseInt(Ce.substr(1),16);Ce=Pt>>16&255,Fe=Pt>>8&255,Ke=255&Pt}if(Fe===void 0||nt===void 0&&Ce===Fe&&Fe===Ke)ie=typeof Ce=="string"?Ce+" "+lt[0]:R.precision===2?S(Ce/255)+" "+lt[0]:j(Ce/255)+" "+lt[0];else if(nt===void 0||Ir(nt)==="object"){if(nt&&!isNaN(nt.a)&&nt.a===0)return["1.","1.","1.",lt[1]].join(" ");ie=typeof Ce=="string"?[Ce,Fe,Ke,lt[1]].join(" "):R.precision===2?[S(Ce/255),S(Fe/255),S(Ke/255),lt[1]].join(" "):[j(Ce/255),j(Fe/255),j(Ke/255),lt[1]].join(" ")}else ie=typeof Ce=="string"?[Ce,Fe,Ke,nt,lt[2]].join(" "):R.precision===2?[S(Ce),S(Fe),S(Ke),S(nt),lt[2]].join(" "):[j(Ce),j(Fe),j(Ke),j(nt),lt[2]].join(" ");return ie},Ue=d.__private__.getFilters=function(){return o},Me=d.__private__.putStream=function(R){var ie=(R=R||{}).data||"",Ce=R.filters||Ue(),Fe=R.alreadyAppliedFilters||[],Ke=R.addLength1||!1,nt=ie.length,lt=R.objectId,Ft=function(Jn){return Jn};if(A!==null&&lt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");A!==null&&(Ft=Yn.encryptor(lt,0));var Pt={};Ce===!0&&(Ce=["FlateEncode"]);var Xt=R.additionalKeyValues||[],tr=(Pt=Ot.API.processDataByFilters!==void 0?Ot.API.processDataByFilters(ie,Ce):{data:ie,reverseChain:[]}).reverseChain+(Array.isArray(Fe)?Fe.join(" "):Fe.toString());if(Pt.data.length!==0&&(Xt.push({key:"Length",value:Pt.data.length}),Ke===!0&&Xt.push({key:"Length1",value:nt})),tr.length!=0)if(tr.split("/").length-1==1)Xt.push({key:"Filter",value:tr});else{Xt.push({key:"Filter",value:"["+tr+"]"});for(var xr=0;xr<Xt.length;xr+=1)if(Xt[xr].key==="DecodeParms"){for(var ln=[],Qn=0;Qn<Pt.reverseChain.split("/").length-1;Qn+=1)ln.push("null");ln.push(Xt[xr].value),Xt[xr].value="["+ln.join(" ")+"]"}}ae("<<");for(var qr=0;qr<Xt.length;qr++)ae("/"+Xt[qr].key+" "+Xt[qr].value);ae(">>"),Pt.data.length!==0&&(ae("stream"),ae(Ft(Pt.data)),ae("endstream"))},$e=d.__private__.putPage=function(R){var ie=R.number,Ce=R.data,Fe=R.objId,Ke=R.contentsObjId;le(Fe,!0),ae("<</Type /Page"),ae("/Parent "+R.rootDictionaryObjId+" 0 R"),ae("/Resources "+R.resourceDictionaryObjId+" 0 R"),ae("/MediaBox ["+parseFloat(k(R.mediaBox.bottomLeftX))+" "+parseFloat(k(R.mediaBox.bottomLeftY))+" "+k(R.mediaBox.topRightX)+" "+k(R.mediaBox.topRightY)+"]"),R.cropBox!==null&&ae("/CropBox ["+k(R.cropBox.bottomLeftX)+" "+k(R.cropBox.bottomLeftY)+" "+k(R.cropBox.topRightX)+" "+k(R.cropBox.topRightY)+"]"),R.bleedBox!==null&&ae("/BleedBox ["+k(R.bleedBox.bottomLeftX)+" "+k(R.bleedBox.bottomLeftY)+" "+k(R.bleedBox.topRightX)+" "+k(R.bleedBox.topRightY)+"]"),R.trimBox!==null&&ae("/TrimBox ["+k(R.trimBox.bottomLeftX)+" "+k(R.trimBox.bottomLeftY)+" "+k(R.trimBox.topRightX)+" "+k(R.trimBox.topRightY)+"]"),R.artBox!==null&&ae("/ArtBox ["+k(R.artBox.bottomLeftX)+" "+k(R.artBox.bottomLeftY)+" "+k(R.artBox.topRightX)+" "+k(R.artBox.topRightY)+"]"),typeof R.userUnit=="number"&&R.userUnit!==1&&ae("/UserUnit "+R.userUnit),or.publish("putPage",{objId:Fe,pageContext:Ct[ie],pageNumber:ie,page:Ce}),ae("/Contents "+Ke+" 0 R"),ae(">>"),ae("endobj");var nt=Ce.join(`
`);return x===w&&(nt+=`
Q`),le(Ke,!0),Me({data:nt,filters:Ue(),objectId:Ke}),ae("endobj"),Fe},Ge=d.__private__.putPages=function(){var R,ie,Ce=[];for(R=1;R<=bt;R++)Ct[R].objId=Br(),Ct[R].contentsObjId=Br();for(R=1;R<=bt;R++)Ce.push($e({number:R,data:ye[R],objId:Ct[R].objId,contentsObjId:Ct[R].contentsObjId,mediaBox:Ct[R].mediaBox,cropBox:Ct[R].cropBox,bleedBox:Ct[R].bleedBox,trimBox:Ct[R].trimBox,artBox:Ct[R].artBox,userUnit:Ct[R].userUnit,rootDictionaryObjId:se,resourceDictionaryObjId:ne}));le(se,!0),ae("<</Type /Pages");var Fe="/Kids [";for(ie=0;ie<bt;ie++)Fe+=Ce[ie]+" 0 R ";ae(Fe+"]"),ae("/Count "+bt),ae(">>"),ae("endobj"),or.publish("postPutPages")},je=function(R){or.publish("putFont",{font:R,out:ae,newObject:Ar,putStream:Me}),R.isAlreadyPutted!==!0&&(R.objectNumber=Ar(),ae("<<"),ae("/Type /Font"),ae("/BaseFont /"+PA(R.postScriptName)),ae("/Subtype /Type1"),typeof R.encoding=="string"&&ae("/Encoding /"+R.encoding),ae("/FirstChar 32"),ae("/LastChar 255"),ae(">>"),ae("endobj"))},_e=function(R){R.objectNumber=Ar();var ie=[];ie.push({key:"Type",value:"/XObject"}),ie.push({key:"Subtype",value:"/Form"}),ie.push({key:"BBox",value:"["+[k(R.x),k(R.y),k(R.x+R.width),k(R.y+R.height)].join(" ")+"]"}),ie.push({key:"Matrix",value:"["+R.matrix.toString()+"]"});var Ce=R.pages[1].join(`
`);Me({data:Ce,additionalKeyValues:ie,objectId:R.objectNumber}),ae("endobj")},He=function(R,ie){ie||(ie=21);var Ce=Ar(),Fe=function(lt,Ft){var Pt,Xt=[],tr=1/(Ft-1);for(Pt=0;Pt<1;Pt+=tr)Xt.push(Pt);if(Xt.push(1),lt[0].offset!=0){var xr={offset:0,color:lt[0].color};lt.unshift(xr)}if(lt[lt.length-1].offset!=1){var ln={offset:1,color:lt[lt.length-1].color};lt.push(ln)}for(var Qn="",qr=0,Jn=0;Jn<Xt.length;Jn++){for(Pt=Xt[Jn];Pt>lt[qr+1].offset;)qr++;var Mn=lt[qr].offset,Na=(Pt-Mn)/(lt[qr+1].offset-Mn),el=lt[qr].color,Qi=lt[qr+1].color;Qn+=D(Math.round((1-Na)*el[0]+Na*Qi[0]).toString(16))+D(Math.round((1-Na)*el[1]+Na*Qi[1]).toString(16))+D(Math.round((1-Na)*el[2]+Na*Qi[2]).toString(16))}return Qn.trim()}(R.colors,ie),Ke=[];Ke.push({key:"FunctionType",value:"0"}),Ke.push({key:"Domain",value:"[0.0 1.0]"}),Ke.push({key:"Size",value:"["+ie+"]"}),Ke.push({key:"BitsPerSample",value:"8"}),Ke.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ke.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Me({data:Fe,additionalKeyValues:Ke,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ce}),ae("endobj"),R.objectNumber=Ar(),ae("<< /ShadingType "+R.type),ae("/ColorSpace /DeviceRGB");var nt="/Coords ["+k(parseFloat(R.coords[0]))+" "+k(parseFloat(R.coords[1]))+" ";R.type===2?nt+=k(parseFloat(R.coords[2]))+" "+k(parseFloat(R.coords[3])):nt+=k(parseFloat(R.coords[2]))+" "+k(parseFloat(R.coords[3]))+" "+k(parseFloat(R.coords[4]))+" "+k(parseFloat(R.coords[5])),ae(nt+="]"),R.matrix&&ae("/Matrix ["+R.matrix.toString()+"]"),ae("/Function "+Ce+" 0 R"),ae("/Extend [true true]"),ae(">>"),ae("endobj")},Je=function(R,ie){var Ce=Br(),Fe=Ar();ie.push({resourcesOid:Ce,objectOid:Fe}),R.objectNumber=Fe;var Ke=[];Ke.push({key:"Type",value:"/Pattern"}),Ke.push({key:"PatternType",value:"1"}),Ke.push({key:"PaintType",value:"1"}),Ke.push({key:"TilingType",value:"1"}),Ke.push({key:"BBox",value:"["+R.boundingBox.map(k).join(" ")+"]"}),Ke.push({key:"XStep",value:k(R.xStep)}),Ke.push({key:"YStep",value:k(R.yStep)}),Ke.push({key:"Resources",value:Ce+" 0 R"}),R.matrix&&Ke.push({key:"Matrix",value:"["+R.matrix.toString()+"]"}),Me({data:R.stream,additionalKeyValues:Ke,objectId:R.objectNumber}),ae("endobj")},st=function(R){for(var ie in R.objectNumber=Ar(),ae("<<"),R)switch(ie){case"opacity":ae("/ca "+S(R[ie]));break;case"stroke-opacity":ae("/CA "+S(R[ie]))}ae(">>"),ae("endobj")},tt=function(R){le(R.resourcesOid,!0),ae("<<"),ae("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ie in ae("/Font <<"),it)it.hasOwnProperty(ie)&&(h===!1||h===!0&&f.hasOwnProperty(ie))&&ae("/"+ie+" "+it[ie].objectNumber+" 0 R");ae(">>")}(),function(){if(Object.keys(ht).length>0){for(var ie in ae("/Shading <<"),ht)ht.hasOwnProperty(ie)&&ht[ie]instanceof xu&&ht[ie].objectNumber>=0&&ae("/"+ie+" "+ht[ie].objectNumber+" 0 R");or.publish("putShadingPatternDict"),ae(">>")}}(),function(ie){if(Object.keys(ht).length>0){for(var Ce in ae("/Pattern <<"),ht)ht.hasOwnProperty(Ce)&&ht[Ce]instanceof d.TilingPattern&&ht[Ce].objectNumber>=0&&ht[Ce].objectNumber<ie&&ae("/"+Ce+" "+ht[Ce].objectNumber+" 0 R");or.publish("putTilingPatternDict"),ae(">>")}}(R.objectOid),function(){if(Object.keys(mt).length>0){var ie;for(ie in ae("/ExtGState <<"),mt)mt.hasOwnProperty(ie)&&mt[ie].objectNumber>=0&&ae("/"+ie+" "+mt[ie].objectNumber+" 0 R");or.publish("putGStateDict"),ae(">>")}}(),function(){for(var ie in ae("/XObject <<"),er)er.hasOwnProperty(ie)&&er[ie].objectNumber>=0&&ae("/"+ie+" "+er[ie].objectNumber+" 0 R");or.publish("putXobjectDict"),ae(">>")}(),ae(">>"),ae("endobj")},yt=function(R){ut[R.fontName]=ut[R.fontName]||{},ut[R.fontName][R.fontStyle]=R.id},zt=function(R,ie,Ce,Fe,Ke){var nt={id:"F"+(Object.keys(it).length+1).toString(10),postScriptName:R,fontName:ie,fontStyle:Ce,encoding:Fe,isStandardFont:Ke||!1,metadata:{}};return or.publish("addFont",{font:nt,instance:this}),it[nt.id]=nt,yt(nt),nt.id},$t=d.__private__.pdfEscape=d.pdfEscape=function(R,ie){return function(Ce,Fe){var Ke,nt,lt,Ft,Pt,Xt,tr,xr,ln;if(lt=(Fe=Fe||{}).sourceEncoding||"Unicode",Pt=Fe.outputEncoding,(Fe.autoencode||Pt)&&it[qe].metadata&&it[qe].metadata[lt]&&it[qe].metadata[lt].encoding&&(Ft=it[qe].metadata[lt].encoding,!Pt&&it[qe].encoding&&(Pt=it[qe].encoding),!Pt&&Ft.codePages&&(Pt=Ft.codePages[0]),typeof Pt=="string"&&(Pt=Ft[Pt]),Pt)){for(tr=!1,Xt=[],Ke=0,nt=Ce.length;Ke<nt;Ke++)(xr=Pt[Ce.charCodeAt(Ke)])?Xt.push(String.fromCharCode(xr)):Xt.push(Ce[Ke]),Xt[Ke].charCodeAt(0)>>8&&(tr=!0);Ce=Xt.join("")}for(Ke=Ce.length;tr===void 0&&Ke!==0;)Ce.charCodeAt(Ke-1)>>8&&(tr=!0),Ke--;if(!tr)return Ce;for(Xt=Fe.noBOM?[]:[254,255],Ke=0,nt=Ce.length;Ke<nt;Ke++){if((ln=(xr=Ce.charCodeAt(Ke))>>8)>>8)throw new Error("Character at position "+Ke+" of string '"+Ce+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Xt.push(ln),Xt.push(xr-(ln<<8))}return String.fromCharCode.apply(void 0,Xt)}(R,ie).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},_r=d.__private__.beginPage=function(R){ye[++bt]=[],Ct[bt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(R[0]),topRightY:Number(R[1])}},Wr(bt),be(ye[L])},_a=function(R,ie){var Ce,Fe,Ke;switch(r=ie||r,typeof R=="string"&&(Ce=p(R.toLowerCase()),Array.isArray(Ce)&&(Fe=Ce[0],Ke=Ce[1])),Array.isArray(R)&&(Fe=R[0]*Qe,Ke=R[1]*Qe),isNaN(Fe)&&(Fe=a[0],Ke=a[1]),(Fe>14400||Ke>14400)&&(Hr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Fe=Math.min(14400,Fe),Ke=Math.min(14400,Ke)),a=[Fe,Ke],r.substr(0,1)){case"l":Ke>Fe&&(a=[Ke,Fe]);break;case"p":Fe>Ke&&(a=[Ke,Fe])}_r(a),Yt(Xd),ae(lA),Jd!==0&&ae(Jd+" J"),Zd!==0&&ae(Zd+" j"),or.publish("addPage",{pageNumber:bt})},lr=function(R){R>0&&R<=bt&&(ye.splice(R,1),Ct.splice(R,1),bt--,L>bt&&(L=bt),this.setPage(L))},Wr=function(R){R>0&&R<=bt&&(L=R)},Rr=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return ye.length-1},Di=function(R,ie,Ce){var Fe,Ke=void 0;return Ce=Ce||{},R=R!==void 0?R:it[qe].fontName,ie=ie!==void 0?ie:it[qe].fontStyle,Fe=R.toLowerCase(),ut[Fe]!==void 0&&ut[Fe][ie]!==void 0?Ke=ut[Fe][ie]:ut[R]!==void 0&&ut[R][ie]!==void 0?Ke=ut[R][ie]:Ce.disableWarning===!1&&Hr.warn("Unable to look up font label for font '"+R+"', '"+ie+"'. Refer to getFontList() for available fonts."),Ke||Ce.noFallback||(Ke=ut.times[ie])==null&&(Ke=ut.times.normal),Ke},mn=d.__private__.putInfo=function(){var R=Ar(),ie=function(Fe){return Fe};for(var Ce in A!==null&&(ie=Yn.encryptor(R,0)),ae("<<"),ae("/Producer ("+$t(ie("jsPDF "+Ot.version))+")"),Ee)Ee.hasOwnProperty(Ce)&&Ee[Ce]&&ae("/"+Ce.substr(0,1).toUpperCase()+Ce.substr(1)+" ("+$t(ie(Ee[Ce]))+")");ae("/CreationDate ("+$t(ie(q))+")"),ae(">>"),ae("endobj")},sA=d.__private__.putCatalog=function(R){var ie=(R=R||{}).rootDictionaryObjId||se;switch(Ar(),ae("<<"),ae("/Type /Catalog"),ae("/Pages "+ie+" 0 R"),Te||(Te="fullwidth"),Te){case"fullwidth":ae("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ae("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ae("/OpenAction [3 0 R /Fit]");break;case"original":ae("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ce=""+Te;Ce.substr(Ce.length-1)==="%"&&(Te=parseInt(Te)/100),typeof Te=="number"&&ae("/OpenAction [3 0 R /XYZ null null "+S(Te)+"]")}switch(Le||(Le="continuous"),Le){case"continuous":ae("/PageLayout /OneColumn");break;case"single":ae("/PageLayout /SinglePage");break;case"two":case"twoleft":ae("/PageLayout /TwoColumnLeft");break;case"tworight":ae("/PageLayout /TwoColumnRight")}Se&&ae("/PageMode /"+Se),or.publish("putCatalog"),ae(">>"),ae("endobj")},a1=d.__private__.putTrailer=function(){ae("trailer"),ae("<<"),ae("/Size "+(P+1)),ae("/Root "+P+" 0 R"),ae("/Info "+(P-1)+" 0 R"),A!==null&&ae("/Encrypt "+Yn.oid+" 0 R"),ae("/ID [ <"+V+"> <"+V+"> ]"),ae(">>")},Rn=d.__private__.putHeader=function(){ae("%PDF-"+v),ae("%")},O0=d.__private__.putXRef=function(){var R="0000000000";ae("xref"),ae("0 "+(P+1)),ae("0000000000 65535 f ");for(var ie=1;ie<=P;ie++)typeof Q[ie]=="function"?ae((R+Q[ie]()).slice(-10)+" 00000 n "):Q[ie]!==void 0?ae((R+Q[ie]).slice(-10)+" 00000 n "):ae("0000000000 00000 n ")},go=d.__private__.buildDocument=function(){var R;P=0,te=0,J=[],Q=[],z=[],se=Br(),ne=Br(),be(J),or.publish("buildDocument"),Rn(),Ge(),function(){or.publish("putAdditionalObjects");for(var Ce=0;Ce<z.length;Ce++){var Fe=z[Ce];le(Fe.objId,!0),ae(Fe.content),ae("endobj")}or.publish("postPutAdditionalObjects")}(),R=[],function(){for(var Ce in it)it.hasOwnProperty(Ce)&&(h===!1||h===!0&&f.hasOwnProperty(Ce))&&je(it[Ce])}(),function(){var Ce;for(Ce in mt)mt.hasOwnProperty(Ce)&&st(mt[Ce])}(),function(){for(var Ce in er)er.hasOwnProperty(Ce)&&_e(er[Ce])}(),function(Ce){var Fe;for(Fe in ht)ht.hasOwnProperty(Fe)&&(ht[Fe]instanceof xu?He(ht[Fe]):ht[Fe]instanceof ZA&&Je(ht[Fe],Ce))}(R),or.publish("putResources"),R.forEach(tt),tt({resourcesOid:ne,objectOid:Number.MAX_SAFE_INTEGER}),or.publish("postPutResources"),A!==null&&(Yn.oid=Ar(),ae("<<"),ae("/Filter /Standard"),ae("/V "+Yn.v),ae("/R "+Yn.r),ae("/U <"+Yn.toHexString(Yn.U)+">"),ae("/O <"+Yn.toHexString(Yn.O)+">"),ae("/P "+Yn.P),ae(">>"),ae("endobj")),mn(),sA();var ie=te;return O0(),a1(),ae("startxref"),ae(""+ie),ae("%%EOF"),be(ye[L]),J.join(`
`)},iA=d.__private__.getBlob=function(R){return new Blob([De(R)],{type:"application/pdf"})},U0=d.output=d.__private__.output=(da=function(R,ie){switch(typeof(ie=ie||{})=="string"?ie={filename:ie}:ie.filename=ie.filename||"generated.pdf",R){case void 0:return go();case"save":d.save(ie.filename);break;case"arraybuffer":return De(go());case"blob":return iA(go());case"bloburi":case"bloburl":if(Wt.URL!==void 0&&typeof Wt.URL.createObjectURL=="function")return Wt.URL&&Wt.URL.createObjectURL(iA(go()))||void 0;Hr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ce="",Fe=go();try{Ce=fE(Fe)}catch{Ce=fE(unescape(encodeURIComponent(Fe)))}return"data:application/pdf;filename="+ie.filename+";base64,"+Ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Wt)==="[object Window]"){var Ke="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",nt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ie.pdfObjectUrl&&(Ke=ie.pdfObjectUrl,nt="");var lt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ke+'"'+nt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ie)+");<\/script></body></html>",Ft=Wt.open();return Ft!==null&&Ft.document.write(lt),Ft}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Wt)==="[object Window]"){var Pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ie.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ie.filename+'" width="500px" height="400px" /></body></html>',Xt=Wt.open();if(Xt!==null){Xt.document.write(Pt);var tr=this;Xt.document.documentElement.querySelector("#pdfViewer").onload=function(){Xt.document.title=ie.filename,Xt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(tr.output("bloburl"))}}return Xt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Wt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var xr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ie)+'"></iframe></body></html>',ln=Wt.open();if(ln!==null&&(ln.document.write(xr),ln.document.title=ie.filename),ln||typeof safari>"u")return ln;break;case"datauri":case"dataurl":return Wt.document.location.href=this.output("datauristring",ie);default:return null}},da.foo=function(){try{return da.apply(this,arguments)}catch(Ce){var R=Ce.stack||"";~R.indexOf(" at ")&&(R=R.split(" at ")[1]);var ie="Error in function "+R.split(`
`)[0].split("<")[0]+": "+Ce.message;if(!Wt.console)throw new Error(ie);Wt.console.error(ie,Ce),Wt.alert&&alert(ie)}},da.foo.bar=da,da.foo),ui=function(R){return Array.isArray(Ra)===!0&&Ra.indexOf(R)>-1};switch(n){case"pt":Qe=1;break;case"mm":Qe=72/25.4;break;case"cm":Qe=72/2.54;break;case"in":Qe=72;break;case"px":Qe=ui("px_scaling")==1?.75:96/72;break;case"pc":case"em":Qe=12;break;case"ex":Qe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Qe=n}var Yn=null;H(),W();var Go=d.__private__.getPageInfo=d.getPageInfo=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ct[R].objId,pageNumber:R,pageContext:Ct[R]}},P0=d.__private__.getPageInfoByObjId=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ie in Ct)if(Ct[ie].objId===R)break;return Go(ie)},s1=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:Ct[L].objId,pageNumber:L,pageContext:Ct[L]}};d.addPage=function(){return _a.apply(this,arguments),this},d.setPage=function(){return Wr.apply(this,arguments),be.call(this,ye[L]),this},d.insertPage=function(R){return this.addPage(),this.movePage(L,R),this},d.movePage=function(R,ie){var Ce,Fe;if(R>ie){Ce=ye[R],Fe=Ct[R];for(var Ke=R;Ke>ie;Ke--)ye[Ke]=ye[Ke-1],Ct[Ke]=Ct[Ke-1];ye[ie]=Ce,Ct[ie]=Fe,this.setPage(ie)}else if(R<ie){Ce=ye[R],Fe=Ct[R];for(var nt=R;nt<ie;nt++)ye[nt]=ye[nt+1],Ct[nt]=Ct[nt+1];ye[ie]=Ce,Ct[ie]=Fe,this.setPage(ie)}return this},d.deletePage=function(){return lr.apply(this,arguments),this},d.__private__.text=d.text=function(R,ie,Ce,Fe,Ke){var nt,lt,Ft,Pt,Xt,tr,xr,ln,Qn,qr=(Fe=Fe||{}).scope||this;if(typeof R=="number"&&typeof ie=="number"&&(typeof Ce=="string"||Array.isArray(Ce))){var Jn=Ce;Ce=ie,ie=R,R=Jn}if(arguments[3]instanceof Lt==0?(Ft=arguments[4],Pt=arguments[5],Ir(xr=arguments[3])==="object"&&xr!==null||(typeof Ft=="string"&&(Pt=Ft,Ft=null),typeof xr=="string"&&(Pt=xr,xr=null),typeof xr=="number"&&(Ft=xr,xr=null),Fe={flags:xr,angle:Ft,align:Pt})):(E("The transform parameter of text() with a Matrix value"),Qn=Ke),isNaN(ie)||isNaN(Ce)||R==null)throw new Error("Invalid arguments passed to jsPDF.text");if(R.length===0)return qr;var Mn,Na="",el=typeof Fe.lineHeightFactor=="number"?Fe.lineHeightFactor:Gc,Qi=qr.internal.scaleFactor;function tl(Cr){return Cr=Cr.split("	").join(Array(Fe.TabLen||9).join(" ")),$t(Cr,xr)}function nf(Cr){for(var Qr,Cn=Cr.concat(),Zn=[],al=Cn.length;al--;)typeof(Qr=Cn.shift())=="string"?Zn.push(Qr):Array.isArray(Cr)&&(Qr.length===1||Qr[1]===void 0&&Qr[2]===void 0)?Zn.push(Qr[0]):Zn.push([Qr[0],Qr[1],Qr[2]]);return Zn}function uA(Cr,Qr){var Cn;if(typeof Cr=="string")Cn=Qr(Cr)[0];else if(Array.isArray(Cr)){for(var Zn,al,hf=Cr.concat(),fA=[],W0=hf.length;W0--;)typeof(Zn=hf.shift())=="string"?fA.push(Qr(Zn)[0]):Array.isArray(Zn)&&typeof Zn[0]=="string"&&(al=Qr(Zn[0],Zn[1],Zn[2]),fA.push([al[0],al[1],al[2]]));Cn=fA}return Cn}var Pl=!1,Yc=!0;if(typeof R=="string")Pl=!0;else if(Array.isArray(R)){var Jc=R.concat();lt=[];for(var Dl,Ba=Jc.length;Ba--;)(typeof(Dl=Jc.shift())!="string"||Array.isArray(Dl)&&typeof Dl[0]!="string")&&(Yc=!1);Pl=Yc}if(Pl===!1)throw new Error('Type of text must be string or Array. "'+R+'" is not recognized.');typeof R=="string"&&(R=R.match(/[\r?\n]/)?R.split(/\r\n|\r|\n/g):[R]);var Zc=we/qr.internal.scaleFactor,eu=Zc*(el-1);switch(Fe.baseline){case"bottom":Ce-=eu;break;case"top":Ce+=Zc-eu;break;case"hanging":Ce+=Zc-2*eu;break;case"middle":Ce+=Zc/2-eu}if((tr=Fe.maxWidth||0)>0&&(typeof R=="string"?R=qr.splitTextToSize(R,tr):Object.prototype.toString.call(R)==="[object Array]"&&(R=R.reduce(function(Cr,Qr){return Cr.concat(qr.splitTextToSize(Qr,tr))},[]))),nt={text:R,x:ie,y:Ce,options:Fe,mutex:{pdfEscape:$t,activeFontKey:qe,fonts:it,activeFontSize:we}},or.publish("preProcessText",nt),R=nt.text,Ft=(Fe=nt.options).angle,Qn instanceof Lt==0&&Ft&&typeof Ft=="number"){Ft*=Math.PI/180,Fe.rotationDirection===0&&(Ft=-Ft),x===w&&(Ft=-Ft);var af=Math.cos(Ft),sf=Math.sin(Ft);Qn=new Lt(af,sf,-sf,af,0,0)}else Ft&&Ft instanceof Lt&&(Qn=Ft);x!==w||Qn||(Qn=Xn),(Xt=Fe.charSpace||Xo)!==void 0&&(Na+=k(I(Xt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ln=Fe.horizontalScale)!==void 0&&(Na+=k(100*ln)+` Tz
`),Fe.lang;var os=-1,rl=Fe.renderingMode!==void 0?Fe.renderingMode:Fe.stroke,AA=qr.internal.getCurrentPageInfo().pageContext;switch(rl){case 0:case!1:case"fill":os=0;break;case 1:case!0:case"stroke":os=1;break;case 2:case"fillThenStroke":os=2;break;case 3:case"invisible":os=3;break;case 4:case"fillAndAddForClipping":os=4;break;case 5:case"strokeAndAddPathForClipping":os=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":os=6;break;case 7:case"addToPathForClipping":os=7}var V0=AA.usedRenderingMode!==void 0?AA.usedRenderingMode:-1;os!==-1?Na+=os+` Tr
`:V0!==-1&&(Na+=`0 Tr
`),os!==-1&&(AA.usedRenderingMode=os),Pt=Fe.align||"left";var Ai,tu=we*el,of=qr.internal.pageSize.getWidth(),lf=it[qe];Xt=Fe.charSpace||Xo,tr=Fe.maxWidth||0,xr=Object.assign({autoencode:!0,noBOM:!0},Fe.flags);var Rl=[],ru=function(Cr){return qr.getStringUnitWidth(Cr,{font:lf,charSpace:Xt,fontSize:we,doKerning:!1})*we/Qi};if(Object.prototype.toString.call(R)==="[object Array]"){var Ps;lt=nf(R),Pt!=="left"&&(Ai=lt.map(ru));var Ds,Ql=0;if(Pt==="right"){ie-=Ai[0],R=[],Ba=lt.length;for(var nl=0;nl<Ba;nl++)nl===0?(Ds=Wo(ie),Ps=zo(Ce)):(Ds=I(Ql-Ai[nl]),Ps=-tu),R.push([lt[nl],Ds,Ps]),Ql=Ai[nl]}else if(Pt==="center"){ie-=Ai[0]/2,R=[],Ba=lt.length;for(var Ml=0;Ml<Ba;Ml++)Ml===0?(Ds=Wo(ie),Ps=zo(Ce)):(Ds=I((Ql-Ai[Ml])/2),Ps=-tu),R.push([lt[Ml],Ds,Ps]),Ql=Ai[Ml]}else if(Pt==="left"){R=[],Ba=lt.length;for(var cf=0;cf<Ba;cf++)R.push(lt[cf])}else if(Pt==="justify"&&lf.encoding==="Identity-H"){R=[],Ba=lt.length,tr=tr!==0?tr:of;for(var dA=0,Bn=0;Bn<Ba;Bn++)if(Ps=Bn===0?zo(Ce):-tu,Ds=Bn===0?Wo(ie):dA,Bn<Ba-1){var G0=I((tr-Ai[Bn])/(lt[Bn].split(" ").length-1)),vo=lt[Bn].split(" ");R.push([vo[0]+" ",Ds,Ps]),dA=0;for(var yo=1;yo<vo.length;yo++){var uf=(ru(vo[yo-1]+" "+vo[yo])-ru(vo[yo]))*Qi+G0;yo==vo.length-1?R.push([vo[yo],uf,0]):R.push([vo[yo]+" ",uf,0]),dA-=uf}}else R.push([lt[Bn],Ds,Ps]);R.push(["",dA,0])}else{if(Pt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(R=[],Ba=lt.length,tr=tr!==0?tr:of,Bn=0;Bn<Ba;Bn++){Ps=Bn===0?zo(Ce):-tu,Ds=Bn===0?Wo(ie):0;var Af=lt[Bn].split(" ").length-1,df=Af>0?(tr-Ai[Bn])/Af:0;Bn<Ba-1?Rl.push(k(I(df))):Rl.push(0),R.push([lt[Bn],Ds,Ps])}}}(typeof Fe.R2L=="boolean"?Fe.R2L:ce)===!0&&(R=uA(R,function(Cr,Qr,Cn){return[Cr.split("").reverse().join(""),Qr,Cn]})),nt={text:R,x:ie,y:Ce,options:Fe,mutex:{pdfEscape:$t,activeFontKey:qe,fonts:it,activeFontSize:we}},or.publish("postProcessText",nt),R=nt.text,Mn=nt.mutex.isHex||!1;var ff=it[qe].encoding;ff!=="WinAnsiEncoding"&&ff!=="StandardEncoding"||(R=uA(R,function(Cr,Qr,Cn){return[tl(Cr),Qr,Cn]})),lt=nf(R),R=[];for(var Hl,ql,Kl,nu=Array.isArray(lt[0])?1:0,$l="",au=function(Cr,Qr,Cn){var Zn="";return Cn instanceof Lt?(Cn=typeof Fe.angle=="number"?Dn(Cn,new Lt(1,0,0,1,Cr,Qr)):Dn(new Lt(1,0,0,1,Cr,Qr),Cn),x===w&&(Cn=Dn(new Lt(1,0,0,-1,0,0),Cn)),Zn=Cn.join(" ")+` Tm
`):Zn=k(Cr)+" "+k(Qr)+` Td
`,Zn},di=0;di<lt.length;di++){switch($l="",nu){case 1:Kl=(Mn?"<":"(")+lt[di][0]+(Mn?">":")"),Hl=parseFloat(lt[di][1]),ql=parseFloat(lt[di][2]);break;case 0:Kl=(Mn?"<":"(")+lt[di]+(Mn?">":")"),Hl=Wo(ie),ql=zo(Ce)}Rl!==void 0&&Rl[di]!==void 0&&($l=Rl[di]+` Tw
`),di===0?R.push($l+au(Hl,ql,Qn)+Kl):nu===0?R.push($l+Kl):nu===1&&R.push($l+au(Hl,ql,Qn)+Kl)}R=nu===0?R.join(` Tj
T* `):R.join(` Tj
`),R+=` Tj
`;var wo=`BT
/`;return wo+=qe+" "+we+` Tf
`,wo+=k(we*el)+` TL
`,wo+=Wc+`
`,wo+=Na,wo+=R,ae(wo+="ET"),f[qe]=!0,qr};var i1=d.__private__.clip=d.clip=function(R){return ae(R==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return i1("evenodd")},d.__private__.discardPath=d.discardPath=function(){return ae("n"),this};var xo=d.__private__.isValidStyle=function(R){var ie=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(R)!==-1&&(ie=!0),ie};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(R){return xo(R)&&(u=R),this};var D0=d.__private__.getStyle=d.getStyle=function(R){var ie=u;switch(R){case"D":case"S":ie="S";break;case"F":ie="f";break;case"FD":case"DF":ie="B";break;case"f":case"f*":case"B":case"B*":ie=R}return ie},R0=d.close=function(){return ae("h"),this};d.stroke=function(){return ae("S"),this},d.fill=function(R){return oA("f",R),this},d.fillEvenOdd=function(R){return oA("f*",R),this},d.fillStroke=function(R){return oA("B",R),this},d.fillStrokeEvenOdd=function(R){return oA("B*",R),this};var oA=function(R,ie){Ir(ie)==="object"?l1(ie,R):ae(R)},Vc=function(R){R===null||x===w&&R===void 0||(R=D0(R),ae(R))};function o1(R,ie,Ce,Fe,Ke){var nt=new ZA(ie||this.boundingBox,Ce||this.xStep,Fe||this.yStep,this.gState,Ke||this.matrix);nt.stream=this.stream;var lt=R+"$$"+this.cloneIndex+++"$$";return Nn(lt,nt),nt}var l1=function(R,ie){var Ce=Et[R.key],Fe=ht[Ce];if(Fe instanceof xu)ae("q"),ae(c1(ie)),Fe.gState&&d.setGState(Fe.gState),ae(R.matrix.toString()+" cm"),ae("/"+Ce+" sh"),ae("Q");else if(Fe instanceof ZA){var Ke=new Lt(1,0,0,-1,0,Xc());R.matrix&&(Ke=Ke.multiply(R.matrix||Xn),Ce=o1.call(Fe,R.key,R.boundingBox,R.xStep,R.yStep,Ke).id),ae("q"),ae("/Pattern cs"),ae("/"+Ce+" scn"),Fe.gState&&d.setGState(Fe.gState),ae(ie),ae("Q")}},c1=function(R){switch(R){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},zd=d.moveTo=function(R,ie){return ae(k(I(R))+" "+k(U(ie))+" m"),this},Q0=d.lineTo=function(R,ie){return ae(k(I(R))+" "+k(U(ie))+" l"),this},Ri=d.curveTo=function(R,ie,Ce,Fe,Ke,nt){return ae([k(I(R)),k(U(ie)),k(I(Ce)),k(U(Fe)),k(I(Ke)),k(U(nt)),"c"].join(" ")),this};d.__private__.line=d.line=function(R,ie,Ce,Fe,Ke){if(isNaN(R)||isNaN(ie)||isNaN(Ce)||isNaN(Fe)||!xo(Ke))throw new Error("Invalid arguments passed to jsPDF.line");return x===m?this.lines([[Ce-R,Fe-ie]],R,ie,[1,1],Ke||"S"):this.lines([[Ce-R,Fe-ie]],R,ie,[1,1]).stroke()},d.__private__.lines=d.lines=function(R,ie,Ce,Fe,Ke,nt){var lt,Ft,Pt,Xt,tr,xr,ln,Qn,qr,Jn,Mn,Na;if(typeof R=="number"&&(Na=Ce,Ce=ie,ie=R,R=Na),Fe=Fe||[1,1],nt=nt||!1,isNaN(ie)||isNaN(Ce)||!Array.isArray(R)||!Array.isArray(Fe)||!xo(Ke)||typeof nt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(zd(ie,Ce),lt=Fe[0],Ft=Fe[1],Xt=R.length,Jn=ie,Mn=Ce,Pt=0;Pt<Xt;Pt++)(tr=R[Pt]).length===2?(Jn=tr[0]*lt+Jn,Mn=tr[1]*Ft+Mn,Q0(Jn,Mn)):(xr=tr[0]*lt+Jn,ln=tr[1]*Ft+Mn,Qn=tr[2]*lt+Jn,qr=tr[3]*Ft+Mn,Jn=tr[4]*lt+Jn,Mn=tr[5]*Ft+Mn,Ri(xr,ln,Qn,qr,Jn,Mn));return nt&&R0(),Vc(Ke),this},d.path=function(R){for(var ie=0;ie<R.length;ie++){var Ce=R[ie],Fe=Ce.c;switch(Ce.op){case"m":zd(Fe[0],Fe[1]);break;case"l":Q0(Fe[0],Fe[1]);break;case"c":Ri.apply(this,Fe);break;case"h":R0()}}return this},d.__private__.rect=d.rect=function(R,ie,Ce,Fe,Ke){if(isNaN(R)||isNaN(ie)||isNaN(Ce)||isNaN(Fe)||!xo(Ke))throw new Error("Invalid arguments passed to jsPDF.rect");return x===m&&(Fe=-Fe),ae([k(I(R)),k(U(ie)),k(I(Ce)),k(I(Fe)),"re"].join(" ")),Vc(Ke),this},d.__private__.triangle=d.triangle=function(R,ie,Ce,Fe,Ke,nt,lt){if(isNaN(R)||isNaN(ie)||isNaN(Ce)||isNaN(Fe)||isNaN(Ke)||isNaN(nt)||!xo(lt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ce-R,Fe-ie],[Ke-Ce,nt-Fe],[R-Ke,ie-nt]],R,ie,[1,1],lt,!0),this},d.__private__.roundedRect=d.roundedRect=function(R,ie,Ce,Fe,Ke,nt,lt){if(isNaN(R)||isNaN(ie)||isNaN(Ce)||isNaN(Fe)||isNaN(Ke)||isNaN(nt)||!xo(lt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ft=4/3*(Math.SQRT2-1);return Ke=Math.min(Ke,.5*Ce),nt=Math.min(nt,.5*Fe),this.lines([[Ce-2*Ke,0],[Ke*Ft,0,Ke,nt-nt*Ft,Ke,nt],[0,Fe-2*nt],[0,nt*Ft,-Ke*Ft,nt,-Ke,nt],[2*Ke-Ce,0],[-Ke*Ft,0,-Ke,-nt*Ft,-Ke,-nt],[0,2*nt-Fe],[0,-nt*Ft,Ke*Ft,-nt,Ke,-nt]],R+Ke,ie,[1,1],lt,!0),this},d.__private__.ellipse=d.ellipse=function(R,ie,Ce,Fe,Ke){if(isNaN(R)||isNaN(ie)||isNaN(Ce)||isNaN(Fe)||!xo(Ke))throw new Error("Invalid arguments passed to jsPDF.ellipse");var nt=4/3*(Math.SQRT2-1)*Ce,lt=4/3*(Math.SQRT2-1)*Fe;return zd(R+Ce,ie),Ri(R+Ce,ie-lt,R+nt,ie-Fe,R,ie-Fe),Ri(R-nt,ie-Fe,R-Ce,ie-lt,R-Ce,ie),Ri(R-Ce,ie+lt,R-nt,ie+Fe,R,ie+Fe),Ri(R+nt,ie+Fe,R+Ce,ie+lt,R+Ce,ie),Vc(Ke),this},d.__private__.circle=d.circle=function(R,ie,Ce,Fe){if(isNaN(R)||isNaN(ie)||isNaN(Ce)||!xo(Fe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(R,ie,Ce,Ce,Fe)},d.setFont=function(R,ie,Ce){return Ce&&(ie=_(ie,Ce)),qe=Di(R,ie,{disableWarning:!1}),this};var u1=d.__private__.getFont=d.getFont=function(){return it[Di.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var R,ie,Ce={};for(R in ut)if(ut.hasOwnProperty(R))for(ie in Ce[R]=[],ut[R])ut[R].hasOwnProperty(ie)&&Ce[R].push(ie);return Ce},d.addFont=function(R,ie,Ce,Fe,Ke){var nt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&nt.indexOf(arguments[3])!==-1?Ke=arguments[3]:arguments[3]&&nt.indexOf(arguments[3])==-1&&(Ce=_(Ce,Fe)),zt.call(this,R,ie,Ce,Ke=Ke||"Identity-H")};var Gc,Xd=e.lineWidth||.200025,A1=d.__private__.getLineWidth=d.getLineWidth=function(){return Xd},Yt=d.__private__.setLineWidth=d.setLineWidth=function(R){return Xd=R,ae(k(I(R))+" w"),this};d.__private__.setLineDash=Ot.API.setLineDash=Ot.API.setLineDashPattern=function(R,ie){if(R=R||[],ie=ie||0,isNaN(ie)||!Array.isArray(R))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return R=R.map(function(Ce){return k(I(Ce))}).join(" "),ie=k(I(ie)),ae("["+R+"] "+ie+" d"),this};var d1=d.__private__.getLineHeight=d.getLineHeight=function(){return we*Gc};d.__private__.getLineHeight=d.getLineHeight=function(){return we*Gc};var f1=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(R){return typeof(R=R||1.15)=="number"&&(Gc=R),this},h1=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Gc};f1(e.lineHeight);var Wo=d.__private__.getHorizontalCoordinate=function(R){return I(R)},zo=d.__private__.getVerticalCoordinate=function(R){return x===w?R:Ct[L].mediaBox.topRightY-Ct[L].mediaBox.bottomLeftY-I(R)},p1=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(R){return k(Wo(R))},m1=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(R){return k(zo(R))},lA=e.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return xe(lA)},d.__private__.setStrokeColor=d.setDrawColor=function(R,ie,Ce,Fe){return lA=me({ch1:R,ch2:ie,ch3:Ce,ch4:Fe,pdfColorType:"draw",precision:2}),ae(lA),this};var Yd=e.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return xe(Yd)},d.__private__.setFillColor=d.setFillColor=function(R,ie,Ce,Fe){return Yd=me({ch1:R,ch2:ie,ch3:Ce,ch4:Fe,pdfColorType:"fill",precision:2}),ae(Yd),this};var Wc=e.textColor||"0 g",g1=d.__private__.getTextColor=d.getTextColor=function(){return xe(Wc)};d.__private__.setTextColor=d.setTextColor=function(R,ie,Ce,Fe){return Wc=me({ch1:R,ch2:ie,ch3:Ce,ch4:Fe,pdfColorType:"text",precision:3}),this};var Xo=e.charSpace,x1=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(Xo||0)};d.__private__.setCharSpace=d.setCharSpace=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Xo=R,this};var Jd=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(R){var ie=d.CapJoinStyles[R];if(ie===void 0)throw new Error("Line cap style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Jd=ie,ae(ie+" J"),this};var Zd=0;d.__private__.setLineJoin=d.setLineJoin=function(R){var ie=d.CapJoinStyles[R];if(ie===void 0)throw new Error("Line join style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zd=ie,ae(ie+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(R){if(R=R||0,isNaN(R))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ae(k(I(R))+" M"),this},d.GState=Zg,d.setGState=function(R){(R=typeof R=="string"?mt[_t[R]]:M0(null,R)).equals(Ht)||(ae("/"+R.id+" gs"),Ht=R)};var M0=function(R,ie){if(!R||!_t[R]){var Ce=!1;for(var Fe in mt)if(mt.hasOwnProperty(Fe)&&mt[Fe].equals(ie)){Ce=!0;break}if(Ce)ie=mt[Fe];else{var Ke="GS"+(Object.keys(mt).length+1).toString(10);mt[Ke]=ie,ie.id=Ke}return R&&(_t[R]=ie.id),or.publish("addGState",ie),ie}};d.addGState=function(R,ie){return M0(R,ie),this},d.saveGraphicsState=function(){return ae("q"),Mt.push({key:qe,size:we,color:Wc}),this},d.restoreGraphicsState=function(){ae("Q");var R=Mt.pop();return qe=R.key,we=R.size,Wc=R.color,Ht=null,this},d.setCurrentTransformationMatrix=function(R){return ae(R.toString()+" cm"),this},d.comment=function(R){return ae("#"+R),this};var Yo=function(R,ie){var Ce=R||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ce},set:function(nt){isNaN(nt)||(Ce=parseFloat(nt))}});var Fe=ie||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Fe},set:function(nt){isNaN(nt)||(Fe=parseFloat(nt))}});var Ke="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ke},set:function(nt){Ke=nt.toString()}}),this},ef=function(R,ie,Ce,Fe){Yo.call(this,R,ie),this.type="rect";var Ke=Ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ke},set:function(lt){isNaN(lt)||(Ke=parseFloat(lt))}});var nt=Fe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return nt},set:function(lt){isNaN(lt)||(nt=parseFloat(lt))}}),this},cA=function(){this.page=bt,this.currentPage=L,this.pages=ye.slice(0),this.pagesContext=Ct.slice(0),this.x=Ye,this.y=Nt,this.matrix=xt,this.width=rf(L),this.height=q0(L),this.outputDestination=ke,this.id="",this.objectNumber=-1};cA.prototype.restore=function(){bt=this.page,L=this.currentPage,Ct=this.pagesContext,ye=this.pages,Ye=this.x,Nt=this.y,xt=this.matrix,H0(L,this.width),Jo(L,this.height),ke=this.outputDestination};var tf=function(R,ie,Ce,Fe,Ke){zn.push(new cA),bt=L=0,ye=[],Ye=R,Nt=ie,xt=Ke,_r([Ce,Fe])};for(var zc in d.beginFormObject=function(R,ie,Ce,Fe,Ke){return tf(R,ie,Ce,Fe,Ke),this},d.endFormObject=function(R){return function(ie){if(on[ie])zn.pop().restore();else{var Ce=new cA,Fe="Xo"+(Object.keys(er).length+1).toString(10);Ce.id=Fe,on[ie]=Fe,er[Fe]=Ce,or.publish("addFormObject",Ce),zn.pop().restore()}}(R),this},d.doFormObject=function(R,ie){var Ce=er[on[R]];return ae("q"),ae(ie.toString()+" cm"),ae("/"+Ce.id+" Do"),ae("Q"),this},d.getFormObject=function(R){var ie=er[on[R]];return{x:ie.x,y:ie.y,width:ie.width,height:ie.height,matrix:ie.matrix}},d.save=function(R,ie){return R=R||"generated.pdf",(ie=ie||{}).returnPromise=ie.returnPromise||!1,ie.returnPromise===!1?(fu(iA(go()),R),typeof fu.unload=="function"&&Wt.setTimeout&&setTimeout(fu.unload,911),this):new Promise(function(Ce,Fe){try{var Ke=fu(iA(go()),R);typeof fu.unload=="function"&&Wt.setTimeout&&setTimeout(fu.unload,911),Ce(Ke)}catch(nt){Fe(nt.message)}})},Ot.API)Ot.API.hasOwnProperty(zc)&&(zc==="events"&&Ot.API.events.length?function(R,ie){var Ce,Fe,Ke;for(Ke=ie.length-1;Ke!==-1;Ke--)Ce=ie[Ke][0],Fe=ie[Ke][1],R.subscribe.apply(R,[Ce].concat(typeof Fe=="function"?[Fe]:Fe))}(or,Ot.API.events):d[zc]=Ot.API[zc]);function rf(R){return Ct[R].mediaBox.topRightX-Ct[R].mediaBox.bottomLeftX}function H0(R,ie){Ct[R].mediaBox.topRightX=ie+Ct[R].mediaBox.bottomLeftX}function q0(R){return Ct[R].mediaBox.topRightY-Ct[R].mediaBox.bottomLeftY}function Jo(R,ie){Ct[R].mediaBox.topRightY=ie+Ct[R].mediaBox.bottomLeftY}var Zo=d.getPageWidth=function(R){return rf(R=R||L)/Qe},K0=d.setPageWidth=function(R,ie){H0(R,ie*Qe)},Xc=d.getPageHeight=function(R){return q0(R=R||L)/Qe},$0=d.setPageHeight=function(R,ie){Jo(R,ie*Qe)};return d.internal={pdfEscape:$t,getStyle:D0,getFont:u1,getFontSize:he,getCharSpace:x1,getTextColor:g1,getLineHeight:d1,getLineHeightFactor:h1,getLineWidth:A1,write:Ie,getHorizontalCoordinate:Wo,getVerticalCoordinate:zo,getCoordinateString:p1,getVerticalCoordinateString:m1,collections:{},newObject:Ar,newAdditionalObject:ee,newObjectDeferred:Br,newObjectDeferredBegin:le,getFilters:Ue,putStream:Me,events:or,scaleFactor:Qe,pageSize:{getWidth:function(){return Zo(L)},setWidth:function(R){K0(L,R)},getHeight:function(){return Xc(L)},setHeight:function(R){$0(L,R)}},encryptionOptions:A,encryption:Yn,getEncryptor:function(R){return A!==null?Yn.encryptor(R,0):function(ie){return ie}},output:U0,getNumberOfPages:Rr,get pages(){return ye},out:ae,f2:S,f3:j,getPageInfo:Go,getPageInfoByObjId:P0,getCurrentPageInfo:s1,getPDFVersion:g,Point:Yo,Rectangle:ef,Matrix:Lt,hasHotfix:ui},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return Zo(L)},set:function(R){K0(L,R)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return Xc(L)},set:function(R){$0(L,R)},enumerable:!0,configurable:!0}),(function(R){for(var ie=0,Ce=pe.length;ie<Ce;ie++){var Fe=zt.call(this,R[ie][0],R[ie][1],R[ie][2],pe[ie][3],!0);h===!1&&(f[Fe]=!0);var Ke=R[ie][0].split("-");yt({id:Fe,fontName:Ke[0],fontStyle:Ke[1]||""})}or.publish("addFonts",{fonts:it,dictionary:ut})}).call(d,pe),qe="F1",_a(a,r),or.publish("initialized"),d}UA.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},UA.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},UA.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},UA.prototype.processOwnerPassword=function(e,t){return v2(x2(t).substr(0,5),e)},UA.prototype.encryptor=function(e,t){var r=x2(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return v2(r,n)}},Zg.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Ir(e)!==Ir(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Ot.API={events:[]},Ot.version="3.0.4";var vn=Ot.API,K_=1,aA=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},BA=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Jt=function(e){return e.toFixed(2)},rc=function(e){return e.toFixed(5)};vn.__acroform__={};var Us=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},gE=function(e){return e*K_},ko=function(e){var t=new QI,r=jt.internal.getHeight(e)||0,n=jt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Jt(n)),Number(Jt(r))],t},hie=vn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},pie=vn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},mie=vn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},In=vn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return mie(e,t-1)},Ln=vn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return hie(e,t-1)},On=vn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return pie(e,t-1)},gie=vn.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],s=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(s)||0,[Number(Jt(c.lowerLeft_X)),Number(Jt(c.lowerLeft_Y)),Number(Jt(c.upperRight_X)),Number(Jt(c.upperRight_Y))]},xie=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=y2(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Jt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=ko(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},y2=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(S){return S.split(`
`)}):a.map(function(S){return[S]});var s=r,o=jt.internal.getHeight(e)||0;o=o<0?-o:o;var l=jt.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(S,j,I){if(S+1<a.length){var U=j+" "+a[S+1][0];return am(U,e,I).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var u,A,h=am("3",e,s).height,f=e.multiline?o-s:(o-h)/2,d=f+=2,v=0,g=0,y=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+am(t,e,s=12).width+", FieldWidth:"+l+`
`;break}for(var p="",m=0,w=0;w<a.length;w++)if(a.hasOwnProperty(w)){var x=!1;if(a[w].length!==1&&y!==a[w].length-1){if((h+2)*(m+2)+2>o)continue e;p+=a[w][y],x=!0,g=w,w--}else{p=(p+=a[w][y]+" ").substr(p.length-1)==" "?p.substr(0,p.length-1):p;var b=parseInt(w),B=c(b,p,s),_=w>=a.length-1;if(B&&!_){p+=" ",y=0;continue}if(B||_){if(_)g=b;else if(e.multiline&&(h+2)*(m+2)+2>o)continue e}else{if(!e.multiline||(h+2)*(m+2)+2>o)continue e;g=b}}for(var k="",E=v;E<=g;E++){var T=a[E];if(e.multiline){if(E===g){k+=T[y]+" ",y=(y+1)%T.length;continue}if(E===v){k+=T[T.length-1]+" ";continue}}k+=T[0]+" "}switch(k=k.substr(k.length-1)==" "?k.substr(0,k.length-1):k,A=am(k,e,s).width,e.textAlign){case"right":u=l-A-2;break;case"center":u=(l-A)/2;break;default:u=2}t+=Jt(u)+" "+Jt(d)+` Td
`,t+="("+aA(k)+`) Tj
`,t+=-Jt(u)+` 0 Td
`,d=-(s+2),A=0,v=x?g:g+1,m++,p=""}break}return n.text=t,n.fontSize=s,n},am=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},vie={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},yie=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},wie=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ho.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(vie)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");K_=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new MI,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&yie(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=gie(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=jt.createDefaultAppearanceStream(l),Ir(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var A=xie(l);c.push({key:"AP",value:"<</N "+A+">>"}),a.internal.acroformPlugin.xForms.push(A)}if(l.appearanceStreamContent){var h="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var d=l.appearanceStreamContent[f];if(h+="/"+f+" ",h+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var o in d)if(d.hasOwnProperty(o)){var v=d[o];typeof v=="function"&&(v=v.call(a,l)),h+="/"+o+" "+v+" ",a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v)}}else typeof(v=d)=="function"&&(v=v.call(a,l)),h+="/"+o+" "+v,a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(g,y){for(var p in g)if(g.hasOwnProperty(p)){var m=p,w=g[p];y.internal.newObjectDeferredBegin(w.objId,!0),Ir(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[m]}}(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},RI=vn.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var a="[",s=0;s<e.length;s++)switch(s!==0&&(a+=" "),Ir(e[s])){case"boolean":case"number":case"object":a+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+aA(n(e[s].toString()))+")"):a+=e[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ly=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+aA(n(e))+")"},Lo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Lo.prototype.toString=function(){return this.objId+" 0 R"},Lo.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Lo.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:RI(a,this.objId,this.scope)}):a instanceof Lo?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var QI=function(){Lo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Us(QI,Lo);var MI=function(){Lo.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+aA(r(e))+")"}},set:function(r){e=r}})};Us(MI,Lo);var ho=function e(){Lo.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(p){if(isNaN(p))throw new Error('Invalid value "'+p+'" for attribute F supplied.');t=p}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!In(t,3)},set:function(p){p?this.F=Ln(t,3):this.F=On(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(p){if(isNaN(p))throw new Error('Invalid value "'+p+'" for attribute Ff supplied.');r=p}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(p){n=p!==void 0?p:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(p){n[0]=p}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(p){n[1]=p}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(p){n[2]=p}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(p){n[3]=p}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(p){switch(p){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=p;break;default:throw new Error('Invalid value "'+p+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof ex)return;s="FieldObject"+e.FieldNum++}var p=function(m){return m};return this.scope&&(p=this.scope.internal.getEncryptor(this.objId)),"("+aA(p(s))+")"},set:function(p){s=p.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(p){s=p}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(p){o=p}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(p){l=p}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(p){c=p}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/K_:u},set:function(p){u=p}});var A="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return A},set:function(p){A=p}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof ex||this instanceof Tu))return ly(h,this.objId,this.scope)},set:function(p){p=p.toString(),h=p}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof ma==0?ly(f,this.objId,this.scope):f},set:function(p){p=p.toString(),f=this instanceof ma==0?p.substr(0,1)==="("?BA(p.substr(1,p.length-2)):BA(p):p}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ma==1?BA(f.substr(1,f.length-1)):f},set:function(p){p=p.toString(),f=this instanceof ma==1?"/"+p:p}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(p){this.V=p}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof ma==0?ly(d,this.objId,this.scope):d},set:function(p){p=p.toString(),d=this instanceof ma==0?p.substr(0,1)==="("?BA(p.substr(1,p.length-2)):BA(p):p}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ma==1?BA(d.substr(1,d.length-1)):d},set:function(p){p=p.toString(),d=this instanceof ma==1?"/"+p:p}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(p){p=!!p,g=p}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(p){v=p}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,1)},set:function(p){p?this.Ff=Ln(this.Ff,1):this.Ff=On(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,2)},set:function(p){p?this.Ff=Ln(this.Ff,2):this.Ff=On(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,3)},set:function(p){p?this.Ff=Ln(this.Ff,3):this.Ff=On(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(p){if([0,1,2].indexOf(p)===-1)throw new Error('Invalid value "'+p+'" for attribute Q supplied.');y=p}}),Object.defineProperty(this,"textAlign",{get:function(){var p;switch(y){case 0:default:p="left";break;case 1:p="center";break;case 2:p="right"}return p},configurable:!0,enumerable:!0,set:function(p){switch(p){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Us(ho,Lo);var hd=function(){ho.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return RI(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,18)},set:function(r){r?this.Ff=Ln(this.Ff,18):this.Ff=On(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Ln(this.Ff,19):this.Ff=On(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,20)},set:function(r){r?(this.Ff=Ln(this.Ff,20),t.sort()):this.Ff=On(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,22)},set:function(r){r?this.Ff=Ln(this.Ff,22):this.Ff=On(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,23)},set:function(r){r?this.Ff=Ln(this.Ff,23):this.Ff=On(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,27)},set:function(r){r?this.Ff=Ln(this.Ff,27):this.Ff=On(this.Ff,27)}}),this.hasAppearanceStream=!1};Us(hd,ho);var pd=function(){hd.call(this),this.fontName="helvetica",this.combo=!1};Us(pd,hd);var md=function(){pd.call(this),this.combo=!0};Us(md,pd);var $m=function(){md.call(this),this.edit=!0};Us($m,md);var ma=function(){ho.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,15)},set:function(r){r?this.Ff=Ln(this.Ff,15):this.Ff=On(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,16)},set:function(r){r?this.Ff=Ln(this.Ff,16):this.Ff=On(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,17)},set:function(r){r?this.Ff=Ln(this.Ff,17):this.Ff=On(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,26)},set:function(r){r?this.Ff=Ln(this.Ff,26):this.Ff=On(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+aA(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){Ir(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Us(ma,ho);var Vm=function(){ma.call(this),this.pushButton=!0};Us(Vm,ma);var gd=function(){ma.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Us(gd,ma);var ex=function(){var e,t;ho.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+aA(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){Ir(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=jt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Us(ex,ho),gd.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},gd.prototype.createOption=function(e){var t=new ex;return t.Parent=this,t.optionName=e,this.Kids.push(t),bie.call(this.scope,t),t};var Gm=function(){ma.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=jt.CheckBox.createAppearanceStream()};Us(Gm,ma);var Tu=function(){ho.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,13)},set:function(t){t?this.Ff=Ln(this.Ff,13):this.Ff=On(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,21)},set:function(t){t?this.Ff=Ln(this.Ff,21):this.Ff=On(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,23)},set:function(t){t?this.Ff=Ln(this.Ff,23):this.Ff=On(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,24)},set:function(t){t?this.Ff=Ln(this.Ff,24):this.Ff=On(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,25)},set:function(t){t?this.Ff=Ln(this.Ff,25):this.Ff=On(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,26)},set:function(t){t?this.Ff=Ln(this.Ff,26):this.Ff=On(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Us(Tu,ho);var Wm=function(){Tu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,14)},set:function(e){e?this.Ff=Ln(this.Ff,14):this.Ff=On(this.Ff,14)}}),this.password=!0};Us(Wm,Tu);var jt={CheckBox:{createAppearanceStream:function(){return{N:{On:jt.CheckBox.YesNormal},D:{On:jt.CheckBox.YesPushDown,Off:jt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=ko(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=y2(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Jt(jt.internal.getWidth(e))+" "+Jt(jt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Jt(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=ko(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],s=jt.internal.getHeight(e),o=jt.internal.getWidth(e),l=y2(e,e.caption);return a.push("1 g"),a.push("0 0 "+Jt(o)+" "+Jt(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Jt(o-1)+" "+Jt(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Jt(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=ko(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Jt(jt.internal.getWidth(e))+" "+Jt(jt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:jt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=jt.RadioButton.Circle.YesNormal,t.D[e]=jt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=ko(e);t.scope=e.scope;var r=[],n=jt.internal.getWidth(e)<=jt.internal.getHeight(e)?jt.internal.getWidth(e)/4:jt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=jt.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+rc(jt.internal.getWidth(e)/2)+" "+rc(jt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=ko(e);t.scope=e.scope;var r=[],n=jt.internal.getWidth(e)<=jt.internal.getHeight(e)?jt.internal.getWidth(e)/4:jt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*jt.internal.Bezier_C).toFixed(5)),o=Number((n*jt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+rc(jt.internal.getWidth(e)/2)+" "+rc(jt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+rc(jt.internal.getWidth(e)/2)+" "+rc(jt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=ko(e);t.scope=e.scope;var r=[],n=jt.internal.getWidth(e)<=jt.internal.getHeight(e)?jt.internal.getWidth(e)/4:jt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*jt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+rc(jt.internal.getWidth(e)/2)+" "+rc(jt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:jt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=jt.RadioButton.Cross.YesNormal,t.D[e]=jt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=ko(e);t.scope=e.scope;var r=[],n=jt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Jt(jt.internal.getWidth(e)-2)+" "+Jt(jt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Jt(n.x1.x)+" "+Jt(n.x1.y)+" m"),r.push(Jt(n.x2.x)+" "+Jt(n.x2.y)+" l"),r.push(Jt(n.x4.x)+" "+Jt(n.x4.y)+" m"),r.push(Jt(n.x3.x)+" "+Jt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=ko(e);t.scope=e.scope;var r=jt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Jt(jt.internal.getWidth(e))+" "+Jt(jt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Jt(jt.internal.getWidth(e)-2)+" "+Jt(jt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Jt(r.x1.x)+" "+Jt(r.x1.y)+" m"),n.push(Jt(r.x2.x)+" "+Jt(r.x2.y)+" l"),n.push(Jt(r.x4.x)+" "+Jt(r.x4.y)+" m"),n.push(Jt(r.x3.x)+" "+Jt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=ko(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Jt(jt.internal.getWidth(e))+" "+Jt(jt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};jt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=jt.internal.getWidth(e),r=jt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},jt.internal.getWidth=function(e){var t=0;return Ir(e)==="object"&&(t=gE(e.Rect[2])),t},jt.internal.getHeight=function(e){var t=0;return Ir(e)==="object"&&(t=gE(e.Rect[3])),t};var bie=vn.addField=function(e){if(wie(this,e),!(e instanceof ho))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};vn.AcroFormChoiceField=hd,vn.AcroFormListBox=pd,vn.AcroFormComboBox=md,vn.AcroFormEditBox=$m,vn.AcroFormButton=ma,vn.AcroFormPushButton=Vm,vn.AcroFormRadioButton=gd,vn.AcroFormCheckBox=Gm,vn.AcroFormTextField=Tu,vn.AcroFormPasswordField=Wm,vn.AcroFormAppearance=jt,vn.AcroForm={ChoiceField:hd,ListBox:pd,ComboBox:md,EditBox:$m,Button:ma,PushButton:Vm,RadioButton:gd,CheckBox:Gm,TextField:Tu,PasswordField:Wm,Appearance:jt},Ot.AcroForm={ChoiceField:hd,ListBox:pd,ComboBox:md,EditBox:$m,Button:ma,PushButton:Vm,RadioButton:gd,CheckBox:Gm,TextField:Tu,PasswordField:Wm,Appearance:jt};Ot.AcroForm;function HI(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(S,j){var I,U,q,V,X,W=r;if((j=j||r)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if(B(S))for(X in n)for(q=n[X],I=0;I<q.length;I+=1){for(V=!0,U=0;U<q[I].length;U+=1)if(q[I][U]!==void 0&&q[I][U]!==S[U]){V=!1;break}if(V===!0){W=X;break}}else for(X in n)for(q=n[X],I=0;I<q.length;I+=1){for(V=!0,U=0;U<q[I].length;U+=1)if(q[I][U]!==void 0&&q[I][U]!==S.charCodeAt(U)){V=!1;break}if(V===!0){W=X;break}}return W===r&&j!==r&&(W=j),W},s=function S(j){for(var I=this.internal.write,U=this.internal.putStream,q=(0,this.internal.getFilters)();q.indexOf("FlateEncode")!==-1;)q.splice(q.indexOf("FlateEncode"),1);j.objectId=this.internal.newObject();var V=[];if(V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Image"}),V.push({key:"Width",value:j.width}),V.push({key:"Height",value:j.height}),j.colorSpace===p.INDEXED?V.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(j.palette.length/3-1)+" "+("sMask"in j&&j.sMask!==void 0?j.objectId+2:j.objectId+1)+" 0 R]"}):(V.push({key:"ColorSpace",value:"/"+j.colorSpace}),j.colorSpace===p.DEVICE_CMYK&&V.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),V.push({key:"BitsPerComponent",value:j.bitsPerComponent}),"decodeParameters"in j&&j.decodeParameters!==void 0&&V.push({key:"DecodeParms",value:"<<"+j.decodeParameters+">>"}),"transparency"in j&&Array.isArray(j.transparency)&&j.transparency.length>0){for(var X="",W=0,M=j.transparency.length;W<M;W++)X+=j.transparency[W]+" "+j.transparency[W]+" ";V.push({key:"Mask",value:"["+X+"]"})}j.sMask!==void 0&&V.push({key:"SMask",value:j.objectId+1+" 0 R"});var G=j.filter!==void 0?["/"+j.filter]:void 0;if(U({data:j.data,additionalKeyValues:V,alreadyAppliedFilters:G,objectId:j.objectId}),I("endobj"),"sMask"in j&&j.sMask!==void 0){var H,C=(H=j.sMaskBitsPerComponent)!==null&&H!==void 0?H:j.bitsPerComponent,L={width:j.width,height:j.height,colorSpace:"DeviceGray",bitsPerComponent:C,data:j.sMask};"filter"in j&&(L.decodeParameters="/Predictor ".concat(j.predictor," /Colors 1 /BitsPerComponent ").concat(C," /Columns ").concat(j.width),L.filter=j.filter),S.call(this,L)}if(j.colorSpace===p.INDEXED){var O=this.internal.newObject();U({data:k(new Uint8Array(j.palette)),objectId:O}),I("endobj")}},o=function(){var S=this.internal.collections[t+"images"];for(var j in S)s.call(this,S[j])},l=function(){var S,j=this.internal.collections[t+"images"],I=this.internal.write;for(var U in j)I("/I"+(S=j[U]).index,S.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var S=this.internal.collections[t+"images"];return c.call(this),S},A=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(S){return typeof e["process"+S.toUpperCase()]=="function"},f=function(S){return Ir(S)==="object"&&S.nodeType===1},d=function(S,j){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var I=""+S.getAttribute("src");if(I.indexOf("data:image/")===0)return Km(unescape(I).split("base64,").pop());var U=e.loadFile(I,!0);if(U!==void 0)return U}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var q;switch(j){case"PNG":q="image/png";break;case"WEBP":q="image/webp";break;default:q="image/jpeg"}return Km(S.toDataURL(q,1).split("base64,").pop())}},v=function(S){var j=this.internal.collections[t+"images"];if(j){for(var I in j)if(S===j[I].alias)return j[I]}},g=function(S,j,I){return S||j||(S=-96,j=-96),S<0&&(S=-1*I.width*72/S/this.internal.scaleFactor),j<0&&(j=-1*I.height*72/j/this.internal.scaleFactor),S===0&&(S=j*I.width/I.height),j===0&&(j=S*I.height/I.width),[S,j]},y=function(S,j,I,U,q,V){var X=g.call(this,I,U,q),W=this.internal.getCoordinateString,M=this.internal.getVerticalCoordinateString,G=u.call(this);if(I=X[0],U=X[1],G[q.index]=q,V){V*=Math.PI/180;var H=Math.cos(V),C=Math.sin(V),L=function(D){return D.toFixed(4)},O=[L(H),L(C),L(-1*C),L(H),0,0,"cm"]}this.internal.write("q"),V?(this.internal.write([1,"0","0",1,W(S),M(j+U),"cm"].join(" ")),this.internal.write(O.join(" ")),this.internal.write([W(I),"0","0",W(U),"0","0","cm"].join(" "))):this.internal.write([W(I),"0","0",W(U),W(S),M(j+U),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+q.index+" Do"),this.internal.write("Q")},p=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var m=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(S){var j,I,U=0;if(typeof S=="string")for(I=S.length,j=0;j<I;j++)U=(U<<5)-U+S.charCodeAt(j),U|=0;else if(B(S))for(I=S.byteLength/2,j=0;j<I;j++)U=(U<<5)-U+S[j],U|=0;return U},x=e.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var j=!0;return S.length===0&&(j=!1),S.length%4!=0&&(j=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(j=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(j=!1),j},b=e.__addimage__.extractImageFromDataUrl=function(S){if(S==null||!(S=S.trim()).startsWith("data:"))return null;var j=S.indexOf(",");return j<0?null:S.substring(0,j).trim().endsWith("base64")?S.substring(j+1):null};e.__addimage__.isArrayBuffer=function(S){return S instanceof ArrayBuffer};var B=e.__addimage__.isArrayBufferView=function(S){return S instanceof Int8Array||S instanceof Uint8Array||S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array},_=e.__addimage__.binaryStringToUint8Array=function(S){for(var j=S.length,I=new Uint8Array(j),U=0;U<j;U++)I[U]=S.charCodeAt(U);return I},k=e.__addimage__.arrayBufferToBinaryString=function(S){for(var j="",I=B(S)?S:new Uint8Array(S),U=0;U<I.length;U+=8192)j+=String.fromCharCode.apply(null,I.subarray(U,U+8192));return j};e.addImage=function(){var S,j,I,U,q,V,X,W,M;if(typeof arguments[1]=="number"?(j=r,I=arguments[1],U=arguments[2],q=arguments[3],V=arguments[4],X=arguments[5],W=arguments[6],M=arguments[7]):(j=arguments[1],I=arguments[2],U=arguments[3],q=arguments[4],V=arguments[5],X=arguments[6],W=arguments[7],M=arguments[8]),Ir(S=arguments[0])==="object"&&!f(S)&&"imageData"in S){var G=S;S=G.imageData,j=G.format||j||r,I=G.x||I||0,U=G.y||U||0,q=G.w||G.width||q,V=G.h||G.height||V,X=G.alias||X,W=G.compression||W,M=G.rotation||G.angle||M}var H=this.internal.getFilters();if(W===void 0&&H.indexOf("FlateEncode")!==-1&&(W="SLOW"),isNaN(I)||isNaN(U))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var C=E.call(this,S,j,X,W);return y.call(this,I,U,q,V,C,M),this};var E=function(S,j,I,U){var q,V,X;if(typeof S=="string"&&a(S)===r){S=unescape(S);var W=T(S,!1);(W!==""||(W=e.loadFile(S,!0))!==void 0)&&(S=W)}if(f(S)&&(S=d(S,j)),j=a(S,j),!h(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(((X=I)==null||X.length===0)&&(I=function(M){return typeof M=="string"||B(M)?w(M):B(M.data)?w(M.data):null}(S)),(q=v.call(this,I))||(S instanceof Uint8Array||j==="RGBA"||(V=S,S=_(S)),q=this["process"+j.toUpperCase()](S,A.call(this),I,function(M){return M&&typeof M=="string"&&(M=M.toUpperCase()),M in e.image_compression?M:m.NONE}(U),V)),!q)throw new Error("An unknown error occurred whilst processing the image.");return q},T=e.__addimage__.convertBase64ToBinaryString=function(S,j){j=typeof j!="boolean"||j;var I,U="";if(typeof S=="string"){var q;I=(q=b(S))!==null&&q!==void 0?q:S;try{U=Km(I)}catch(V){if(j)throw x(I)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+V.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return U};e.getImageProperties=function(S){var j,I,U="";if(f(S)&&(S=d(S)),typeof S=="string"&&a(S)===r&&((U=T(S,!1))===""&&(U=e.loadFile(S)||""),S=U),I=a(S),!h(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(S instanceof Uint8Array||(S=_(S)),!(j=this["process"+I.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return j.fileType=I,j}})(Ot.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Ot.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,A=!1,h=0;h<u.length&&!A;h++)switch((n=u[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(A=!0);break;case"reference":case"text":case"freetext":A=!0}if(A!=0){this.internal.write("/Annots [");for(var f=0;f<u.length;f++){n=u[f];var d=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),p=this.internal.getEncryptor(g.objId),m=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+d(p(n.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+d(p(m))+") >>",g.content=s;var w=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var x=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+d(v(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+x+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var b=this.annotations._nameMap[n.options.name];n.options.pageNumber=b.page,n.options.top=b.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+d(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var B=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+B+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+s)},options:o,type:"link"})},e.textWithLink=function(r,n,a,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var A=this.splitTextToSize(r,l).length;o=Math.ceil(u*A)}else l=c,o=u;return this.text(r,n,a,s),a+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-u,l,o,s),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Ot.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var A=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(g){var y=0,p=r,m="",w=0;for(y=0;y<g.length;y+=1)p[g.charCodeAt(y)]!==void 0?(w++,typeof(p=p[g.charCodeAt(y)])=="number"&&(m+=String.fromCharCode(p),p=r,w=0),y===g.length-1&&(p=r,m+=g.charAt(y-(w-1)),y-=w-1,w=0)):(p=r,m+=g.charAt(y-w),y-=w,w=0);return m};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var f=e.__arabicParser__.getCorrectForm=function(g,y,p){return o(g)?s(g)===!1?-1:!u(g)||!o(y)&&!o(p)||!o(p)&&l(y)||l(g)&&!o(y)||l(g)&&c(y)||l(g)&&l(y)?0:A(g)&&o(y)&&!l(y)&&o(p)&&u(p)?3:l(g)||!o(p)?1:2:-1},d=function(g){var y=0,p=0,m=0,w="",x="",b="",B=(g=g||"").split("\\s+"),_=[];for(y=0;y<B.length;y+=1){for(_.push(""),p=0;p<B[y].length;p+=1)w=B[y][p],x=B[y][p-1],b=B[y][p+1],o(w)?(m=f(w,x,b),_[y]+=m!==-1?String.fromCharCode(t[w.charCodeAt(0)][m]):w):_[y]+=w;_[y]=h(_[y])}return _.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,p=[];if(Array.isArray(y)){var m=0;for(p=[],m=0;m<y.length;m+=1)Array.isArray(y[m])?p.push([d(y[m][0]),y[m][1],y[m][2]]):p.push([d(y[m])]);g=p}else g=d(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",v])}(Ot.API),Ot.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Ot.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var A=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return A},set:function(g){A=g}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(g){v=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var A=(u=u||{}).fontSize||this.getFontSize(),h=u.font||this.getFont(),f=u.scaleFactor||this.internal.scaleFactor,d=0,v=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var p=u.maxWidth;p>0?typeof c=="string"?c=this.splitTextToSize(c,p):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,x){return w.concat(y.splitTextToSize(x,p))},[])):c=Array.isArray(c)?c:[c];for(var m=0;m<c.length;m++)d<(g=this.getStringUnitWidth(c[m],{font:h})*A)&&(d=g);return d!==0&&(v=c.length),{w:d/=f,h:Math.max((v*A*this.getLineHeightFactor()-A*(this.getLineHeightFactor()-1))/f,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,A=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,f=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,d&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-A,c.y+A,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+A,{align:"center",baseline:"top",maxWidth:c.width-A-A}):this.text(c.text,c.x+A,c.y+A,{align:"left",baseline:"top",maxWidth:c.width-A-A})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,A,h,f){if(n.call(this),!A)throw new Error("No data for PDF table.");var d,v,g,y,p=[],m=[],w=[],x={},b={},B=[],_=[],k=(f=f||{}).autoSize||!1,E=f.printHeaders!==!1,T=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,S=f.margins||Object.assign({width:this.getPageWidth()},t),j=typeof f.padding=="number"?f.padding:3,I=f.headerBackgroundColor||"#c8c8c8",U=f.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=T,this.internal.__cell__.padding=j,this.internal.__cell__.headerBackgroundColor=I,this.internal.__cell__.headerTextColor=U,this.setFontSize(T),h==null)m=p=Object.keys(A[0]),w=p.map(function(){return"left"});else if(Array.isArray(h)&&Ir(h[0])==="object")for(p=h.map(function(G){return G.name}),m=h.map(function(G){return G.prompt||G.name||""}),w=h.map(function(G){return G.align||"left"}),d=0;d<h.length;d+=1)b[h[d].name]=.7499990551181103*h[d].width;else Array.isArray(h)&&typeof h[0]=="string"&&(m=p=h,w=p.map(function(){return"left"}));if(k||Array.isArray(h)&&typeof h[0]=="string")for(d=0;d<p.length;d+=1){for(x[y=p[d]]=A.map(function(G){return G[y]}),this.setFont(void 0,"bold"),B.push(this.getTextDimensions(m[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=x[y],this.setFont(void 0,"normal"),g=0;g<v.length;g+=1)B.push(this.getTextDimensions(v[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);b[y]=Math.max.apply(null,B)+j+j,B=[]}if(E){var q={};for(d=0;d<p.length;d+=1)q[p[d]]={},q[p[d]].text=m[d],q[p[d]].align=w[d];var V=l.call(this,q,b);_=p.map(function(G){return new s(c,u,b[G],V,q[G].text,void 0,q[G].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var X=h.reduce(function(G,H){return G[H.name]=H.align,G},{});for(d=0;d<A.length;d+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:d,data:A[d]},this);var W=l.call(this,A[d],b);for(g=0;g<p.length;g+=1){var M=A[d][p[g]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:d,col:g,data:M},this),o.call(this,new s(c,u,b[p[g]],W,M,d+2,X[p[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var A=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(d){var v=c[d];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,u[d]-A-A)},this).map(function(d){return this.getLineHeightFactor()*d.length*h/f+A+A},this).reduce(function(d,v){return Math.max(d,v)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var A;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){A=this.internal.__cell__.tableHeaderRow[d].clone(),u&&(A.y=this.internal.__cell__.margins.top||0,f.push(A)),A.lineNumber=c;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,A),this.setTextColor(v)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(Ot.API);var qI={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},KI=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],w2=HI(KI),$I=[100,200,300,400,500,600,700,800,900],_ie=HI($I);function cy(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return qI[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),a=function(s){return typeof w2[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function xE(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var Nie={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},vE={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function yE(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function wE(e){return e.trimLeft()}function Bie(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function Cie(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var sm,bE,_E,CA,im,NE,BE,CE,uy=["times"];function EE(e,t,r,n,a){var s=4,o=kE;switch(a){case Ot.API.image_compression.FAST:s=1,o=SE;break;case Ot.API.image_compression.MEDIUM:s=6,o=jE;break;case Ot.API.image_compression.SLOW:s=9,o=FE}e=function(c,u,A,h){for(var f,d=c.length/u,v=new Uint8Array(c.length+d),g=[Eie,SE,kE,jE,FE],y=0;y<d;y+=1){var p=y*u,m=c.subarray(p,p+u);if(h)v.set(h(m,A,f),p+y);else{for(var w=g.length,x=[],b=0;b<w;b+=1)x[b]=g[b](m,A,f);var B=kie(x.concat());v.set(x[B],p+y)}f=m}return v}(e,t,Math.ceil(r*n/8),o);var l=h2(e,{level:s});return Ot.API.__addimage__.arrayBufferToBinaryString(l)}function Eie(e){var t=Array.apply([],e);return t.unshift(0),t}function SE(e,t){var r=e.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=e[a-t]||0;n[a+1]=e[a]-s+256&255}return n}function kE(e,t,r){var n=e.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;a[s+1]=e[s]-o+256&255}return a}function jE(e,t,r){var n=e.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=e[s-t]||0,l=r&&r[s]||0;a[s+1]=e[s]+256-(o+l>>>1)&255}return a}function FE(e,t,r){var n=e.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=Sie(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);a[s+1]=e[s]-o+256&255}return a}function Sie(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),a=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=a&&n<=s?e:a<=s?t:r}function kie(e){var t=e.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function Ay(e,t,r){var n=t*r,a=Math.floor(n/8),s=16-(n-8*a+r),o=(1<<r)-1;return VI(e,a)>>s&o}function TE(e,t,r,n){var a=r*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(t&l)<<o;(function(u,A,h){if(A+1<u.byteLength)u.setUint16(A,h,!1);else{var f=h>>8&255;u.setUint8(A,f)}})(e,s,VI(e,s)&~(l<<o)&65535|c)}function VI(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function jie(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],s=a>>7,o=1<<1+(7&a);e[t++],e[t++];var l=null,c=null;s&&(l=t,c=o,t+=3*o);var u=!0,A=[],h=0,f=null,d=0,v=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];h=e[t++]|e[t++]<<8,f=e[t++],1&g||(f=null),d=g>>2&7,t++;break;case 254:for(;;){if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,p=e[t++]|e[t++]<<8,m=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,x=e[t++],b=x>>6&1,B=1<<1+(7&x),_=l,k=c,E=!1;x>>7&&(E=!0,_=t,k=B,t+=3*B);var T=t;for(t++;;){var S;if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}A.push({x:y,y:p,width:m,height:w,has_local_palette:E,palette_offset:_,palette_size:k,data_offset:T,data_length:t-T,transparent_index:f,interlaced:!!b,delay:h,disposal:d});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return A.length},this.loopCount=function(){return v},this.frameInfo=function(j){if(j<0||j>=A.length)throw new Error("Frame index out of range.");return A[j]},this.decodeAndBlitFrameBGRA=function(j,I){var U=this.frameInfo(j),q=U.width*U.height,V=new Uint8Array(q);IE(e,U.data_offset,V,q);var X=U.palette_offset,W=U.transparent_index;W===null&&(W=256);var M=U.width,G=r-M,H=M,C=4*(U.y*r+U.x),L=4*((U.y+U.height)*r+U.x),O=C,D=4*G;U.interlaced===!0&&(D+=4*r*7);for(var P=8,Q=0,J=V.length;Q<J;++Q){var te=V[Q];if(H===0&&(H=M,(O+=D)>=L&&(D=4*G+4*r*(P-1),O=C+(M+G)*(P<<1),P>>=1)),te===W)O+=4;else{var z=e[X+3*te],ye=e[X+3*te+1],re=e[X+3*te+2];I[O++]=re,I[O++]=ye,I[O++]=z,I[O++]=255}--H}},this.decodeAndBlitFrameRGBA=function(j,I){var U=this.frameInfo(j),q=U.width*U.height,V=new Uint8Array(q);IE(e,U.data_offset,V,q);var X=U.palette_offset,W=U.transparent_index;W===null&&(W=256);var M=U.width,G=r-M,H=M,C=4*(U.y*r+U.x),L=4*((U.y+U.height)*r+U.x),O=C,D=4*G;U.interlaced===!0&&(D+=4*r*7);for(var P=8,Q=0,J=V.length;Q<J;++Q){var te=V[Q];if(H===0&&(H=M,(O+=D)>=L&&(D=4*G+4*r*(P-1),O=C+(M+G)*(P<<1),P>>=1)),te===W)O+=4;else{var z=e[X+3*te],ye=e[X+3*te+1],re=e[X+3*te+2];I[O++]=z,I[O++]=ye,I[O++]=re,I[O++]=255}--H}}}function IE(e,t,r,n){for(var a=e[t++],s=1<<a,o=s+1,l=o+1,c=a+1,u=(1<<c)-1,A=0,h=0,f=0,d=e[t++],v=new Int32Array(4096),g=null;;){for(;A<16&&d!==0;)h|=e[t++]<<A,A+=8,d===1?d=e[t++]:--d;if(A<c)break;var y=h&u;if(h>>=c,A-=c,y!==s){if(y===o)break;for(var p=y<l?y:g,m=0,w=p;w>s;)w=v[w]>>8,++m;var x=w;if(f+m+(p!==y?1:0)>n)return void Hr.log("Warning, gif stream longer than expected.");r[f++]=x;var b=f+=m;for(p!==y&&(r[f++]=x),w=p;m--;)w=v[w],r[--b]=255&w,w>>=8;g!==null&&l<4096&&(v[l++]=g<<8|x,l>=u+1&&c<12&&(++c,u=u<<1|1)),g=y}else l=o+1,u=(1<<(c=a+1))-1,g=null}return f!==n&&Hr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function dy(e){var t,r,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),A=new Array(64),h=new Array(65535),f=new Array(65535),d=new Array(64),v=new Array(64),g=[],y=0,p=7,m=new Array(64),w=new Array(64),x=new Array(64),b=new Array(256),B=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],k=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],j=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function V(C,L){for(var O=0,D=0,P=new Array,Q=1;Q<=16;Q++){for(var J=1;J<=C[Q];J++)P[L[D]]=[],P[L[D]][0]=O,P[L[D]][1]=Q,D++,O++;O*=2}return P}function X(C){for(var L=C[0],O=C[1]-1;O>=0;)L&1<<O&&(y|=1<<p),O--,--p<0&&(y==255?(W(255),W(0)):W(y),p=7,y=0)}function W(C){g.push(C)}function M(C){W(C>>8&255),W(255&C)}function G(C,L,O,D,P){for(var Q,J=P[0],te=P[240],z=function(we,Te){var he,ce,Se,Pe,Le,Xe,fe,Ee,qe,Qe,Ye=0;for(qe=0;qe<8;++qe){he=we[Ye],ce=we[Ye+1],Se=we[Ye+2],Pe=we[Ye+3],Le=we[Ye+4],Xe=we[Ye+5],fe=we[Ye+6];var Nt=he+(Ee=we[Ye+7]),xt=he-Ee,it=ce+fe,ut=ce-fe,Mt=Se+Xe,ht=Se-Xe,Et=Pe+Le,mt=Pe-Le,_t=Nt+Et,Ht=Nt-Et,bt=it+Mt,Ct=it-Mt;we[Ye]=_t+bt,we[Ye+4]=_t-bt;var or=.707106781*(Ct+Ht);we[Ye+2]=Ht+or,we[Ye+6]=Ht-or;var Ra=.382683433*((_t=mt+ht)-(Ct=ut+xt)),er=.5411961*_t+Ra,on=1.306562965*Ct+Ra,zn=.707106781*(bt=ht+ut),Lt=xt+zn,Dn=xt-zn;we[Ye+5]=Dn+er,we[Ye+3]=Dn-er,we[Ye+1]=Lt+on,we[Ye+7]=Lt-on,Ye+=8}for(Ye=0,qe=0;qe<8;++qe){he=we[Ye],ce=we[Ye+8],Se=we[Ye+16],Pe=we[Ye+24],Le=we[Ye+32],Xe=we[Ye+40],fe=we[Ye+48];var Xn=he+(Ee=we[Ye+56]),Nn=he-Ee,da=ce+fe,Ar=ce-fe,Br=Se+Xe,le=Se-Xe,ee=Pe+Le,se=Pe-Le,ne=Xn+ee,xe=Xn-ee,me=da+Br,Ue=da-Br;we[Ye]=ne+me,we[Ye+32]=ne-me;var Me=.707106781*(Ue+xe);we[Ye+16]=xe+Me,we[Ye+48]=xe-Me;var $e=.382683433*((ne=se+le)-(Ue=Ar+Nn)),Ge=.5411961*ne+$e,je=1.306562965*Ue+$e,_e=.707106781*(me=le+Ar),He=Nn+_e,Je=Nn-_e;we[Ye+40]=Je+Ge,we[Ye+24]=Je-Ge,we[Ye+8]=He+je,we[Ye+56]=He-je,Ye++}for(qe=0;qe<64;++qe)Qe=we[qe]*Te[qe],d[qe]=Qe>0?Qe+.5|0:Qe-.5|0;return d}(C,L),ye=0;ye<64;++ye)v[_[ye]]=z[ye];var re=v[0]-O;O=v[0],re==0?X(D[0]):(X(D[f[Q=32767+re]]),X(h[Q]));for(var ke=63;ke>0&&v[ke]==0;)ke--;if(ke==0)return X(J),O;for(var be,ae=1;ae<=ke;){for(var Ie=ae;v[ae]==0&&ae<=ke;)++ae;var De=ae-Ie;if(De>=16){be=De>>4;for(var pe=1;pe<=be;++pe)X(te);De&=15}Q=32767+v[ae],X(P[(De<<4)+f[Q]]),X(h[Q]),ae++}return ke!=63&&X(J),O}function H(C){C=Math.min(Math.max(C,1),100),s!=C&&(function(L){for(var O=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],D=0;D<64;D++){var P=o((O[D]*L+50)/100);P=Math.min(Math.max(P,1),255),l[_[D]]=P}for(var Q=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],J=0;J<64;J++){var te=o((Q[J]*L+50)/100);te=Math.min(Math.max(te,1),255),c[_[J]]=te}for(var z=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ye=0,re=0;re<8;re++)for(var ke=0;ke<8;ke++)u[ye]=1/(l[_[ye]]*z[re]*z[ke]*8),A[ye]=1/(c[_[ye]]*z[re]*z[ke]*8),ye++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),s=C)}this.encode=function(C,L){L&&H(L),g=new Array,y=0,p=7,M(65496),M(65504),M(16),W(74),W(70),W(73),W(70),W(0),W(1),W(1),W(0),M(1),M(1),W(0),W(0),function(){M(65499),M(132),W(0);for(var ce=0;ce<64;ce++)W(l[ce]);W(1);for(var Se=0;Se<64;Se++)W(c[Se])}(),function(ce,Se){M(65472),M(17),W(8),M(Se),M(ce),W(3),W(1),W(17),W(0),W(2),W(17),W(1),W(3),W(17),W(1)}(C.width,C.height),function(){M(65476),M(418),W(0);for(var ce=0;ce<16;ce++)W(k[ce+1]);for(var Se=0;Se<=11;Se++)W(E[Se]);W(16);for(var Pe=0;Pe<16;Pe++)W(T[Pe+1]);for(var Le=0;Le<=161;Le++)W(S[Le]);W(1);for(var Xe=0;Xe<16;Xe++)W(j[Xe+1]);for(var fe=0;fe<=11;fe++)W(I[fe]);W(17);for(var Ee=0;Ee<16;Ee++)W(U[Ee+1]);for(var qe=0;qe<=161;qe++)W(q[qe])}(),M(65498),M(12),W(3),W(1),W(0),W(2),W(17),W(3),W(17),W(0),W(63),W(0);var O=0,D=0,P=0;y=0,p=7,this.encode.displayName="_encode_";for(var Q,J,te,z,ye,re,ke,be,ae,Ie=C.data,De=C.width,pe=C.height,we=4*De,Te=0;Te<pe;){for(Q=0;Q<we;){for(ye=we*Te+Q,ke=-1,be=0,ae=0;ae<64;ae++)re=ye+(be=ae>>3)*we+(ke=4*(7&ae)),Te+be>=pe&&(re-=we*(Te+1+be-pe)),Q+ke>=we&&(re-=Q+ke-we+4),J=Ie[re++],te=Ie[re++],z=Ie[re++],m[ae]=(B[J]+B[te+256|0]+B[z+512|0]>>16)-128,w[ae]=(B[J+768|0]+B[te+1024|0]+B[z+1280|0]>>16)-128,x[ae]=(B[J+1280|0]+B[te+1536|0]+B[z+1792|0]>>16)-128;O=G(m,u,O,t,n),D=G(w,A,D,r,a),P=G(x,A,P,r,a),Q+=32}Te+=8}if(p>=0){var he=[];he[1]=p+1,he[0]=(1<<p+1)-1,X(he)}return M(65497),new Uint8Array(g)},e=e||50,function(){for(var C=String.fromCharCode,L=0;L<256;L++)b[L]=C(L)}(),t=V(k,E),r=V(j,I),n=V(T,S),a=V(U,q),function(){for(var C=1,L=2,O=1;O<=15;O++){for(var D=C;D<L;D++)f[32767+D]=O,h[32767+D]=[],h[32767+D][1]=O,h[32767+D][0]=D;for(var P=-(L-1);P<=-C;P++)f[32767+P]=O,h[32767+P]=[],h[32767+P][1]=O,h[32767+P][0]=L-1+P;C<<=1,L<<=1}}(),function(){for(var C=0;C<256;C++)B[C]=19595*C,B[C+256|0]=38470*C,B[C+512|0]=7471*C+32768,B[C+768|0]=-11059*C,B[C+1024|0]=-21709*C,B[C+1280|0]=32768*C+8421375,B[C+1536|0]=-27439*C,B[C+1792|0]=-5329*C}(),H(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Vi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function LE(e){function t(E){if(!E)throw Error("assert :P")}function r(E,T,S){for(var j=0;4>j;j++)if(E[T+j]!=S.charCodeAt(j))return!0;return!1}function n(E,T,S,j,I){for(var U=0;U<I;U++)E[T+U]=S[j+U]}function a(E,T,S,j){for(var I=0;I<j;I++)E[T+I]=S}function s(E){return new Int32Array(E)}function o(E,T){for(var S=[],j=0;j<E;j++)S.push(new T);return S}function l(E,T){var S=[];return function j(I,U,q){for(var V=q[U],X=0;X<V&&(I.push(q.length>U+1?[]:new T),!(q.length<U+1));X++)j(I[X],U+1,q)}(S,0,E),S}var c=function(){var E=this;function T(N,F){for(var K=1<<F-1>>>0;N&K;)K>>>=1;return K?(N&K-1)+K:N}function S(N,F,K,Y,oe){t(!(Y%K));do N[F+(Y-=K)]=oe;while(0<Y)}function j(N,F,K,Y,oe){if(t(2328>=oe),512>=oe)var ue=s(512);else if((ue=s(oe))==null)return 0;return function(Ae,ge,ve,Ne,Oe,ze){var Be,Re,Ve=ge,et=1<<ve,We=s(16),rt=s(16);for(t(Oe!=0),t(Ne!=null),t(Ae!=null),t(0<ve),Re=0;Re<Oe;++Re){if(15<Ne[Re])return 0;++We[Ne[Re]]}if(We[0]==Oe)return 0;for(rt[1]=0,Be=1;15>Be;++Be){if(We[Be]>1<<Be)return 0;rt[Be+1]=rt[Be]+We[Be]}for(Re=0;Re<Oe;++Re)Be=Ne[Re],0<Ne[Re]&&(ze[rt[Be]++]=Re);if(rt[15]==1)return(Ne=new I).g=0,Ne.value=ze[0],S(Ae,Ve,1,et,Ne),et;var at,At=-1,ct=et-1,Dt=0,kt=1,nr=1,Tt=1<<ve;for(Re=0,Be=1,Oe=2;Be<=ve;++Be,Oe<<=1){if(kt+=nr<<=1,0>(nr-=We[Be]))return 0;for(;0<We[Be];--We[Be])(Ne=new I).g=Be,Ne.value=ze[Re++],S(Ae,Ve+Dt,Oe,Tt,Ne),Dt=T(Dt,Be)}for(Be=ve+1,Oe=2;15>=Be;++Be,Oe<<=1){if(kt+=nr<<=1,0>(nr-=We[Be]))return 0;for(;0<We[Be];--We[Be]){if(Ne=new I,(Dt&ct)!=At){for(Ve+=Tt,at=1<<(At=Be)-ve;15>At&&!(0>=(at-=We[At]));)++At,at<<=1;et+=Tt=1<<(at=At-ve),Ae[ge+(At=Dt&ct)].g=at+ve,Ae[ge+At].value=Ve-ge-At}Ne.g=Be-ve,Ne.value=ze[Re++],S(Ae,Ve+(Dt>>ve),Oe,Tt,Ne),Dt=T(Dt,Be)}}return kt!=2*rt[15]-1?0:et}(N,F,K,Y,oe,ue)}function I(){this.value=this.g=0}function U(){this.value=this.g=0}function q(){this.G=o(5,I),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(ru,U)}function V(N,F,K,Y){t(N!=null),t(F!=null),t(2147483648>Y),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=F,N.pa=K,N.Jd=F,N.Yc=K+Y,N.Zc=4<=Y?K+Y-4+1:K,J(N)}function X(N,F){for(var K=0;0<F--;)K|=z(N,128)<<F;return K}function W(N,F){var K=X(N,F);return te(N)?-K:K}function M(N,F,K,Y){var oe,ue=0;for(t(N!=null),t(F!=null),t(4294967288>Y),N.Sb=Y,N.Ra=0,N.u=0,N.h=0,4<Y&&(Y=4),oe=0;oe<Y;++oe)ue+=F[K+oe]<<8*oe;N.Ra=ue,N.bb=Y,N.oa=F,N.pa=K}function G(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<Ql-8>>>0,++N.bb,N.u-=8;D(N)&&(N.h=1,N.u=0)}function H(N,F){if(t(0<=F),!N.h&&F<=Ds){var K=O(N)&Ps[F];return N.u+=F,G(N),K}return N.h=1,N.u=0}function C(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function L(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(N){return N.Ra>>>(N.u&Ql-1)>>>0}function D(N){return t(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>Ql}function P(N,F){N.u=F,N.h=D(N)}function Q(N){N.u>=nl&&(t(N.u>=nl),G(N))}function J(N){t(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(t(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function te(N){return X(N,1)}function z(N,F){var K=N.Ca;0>N.b&&J(N);var Y=N.b,oe=K*F>>>8,ue=(N.I>>>Y>oe)+0;for(ue?(K-=oe,N.I-=oe+1<<Y>>>0):K=oe+1,Y=K,oe=0;256<=Y;)oe+=8,Y>>=8;return Y=7^oe+Ml[Y],N.b-=Y,N.Ca=(K<<Y)-1,ue}function ye(N,F,K){N[F+0]=K>>24&255,N[F+1]=K>>16&255,N[F+2]=K>>8&255,N[F+3]=255&K}function re(N,F){return N[F+0]|N[F+1]<<8}function ke(N,F){return re(N,F)|N[F+2]<<16}function be(N,F){return re(N,F)|re(N,F+2)<<16}function ae(N,F){var K=1<<F;return t(N!=null),t(0<F),N.X=s(K),N.X==null?0:(N.Mb=32-F,N.Xa=F,1)}function Ie(N,F){t(N!=null),t(F!=null),t(N.Xa==F.Xa),n(F.X,0,N.X,0,1<<F.Xa)}function De(){this.X=[],this.Xa=this.Mb=0}function pe(N,F,K,Y){t(K!=null),t(Y!=null);var oe=K[0],ue=Y[0];return oe==0&&(oe=(N*ue+F/2)/F),ue==0&&(ue=(F*oe+N/2)/N),0>=oe||0>=ue?0:(K[0]=oe,Y[0]=ue,1)}function we(N,F){return N+(1<<F)-1>>>F}function Te(N,F){return((4278255360&N)+(4278255360&F)>>>0&4278255360)+((16711935&N)+(16711935&F)>>>0&16711935)>>>0}function he(N,F){E[F]=function(K,Y,oe,ue,Ae,ge,ve){var Ne;for(Ne=0;Ne<Ae;++Ne){var Oe=E[N](ge[ve+Ne-1],oe,ue+Ne);ge[ve+Ne]=Te(K[Y+Ne],Oe)}}}function ce(){this.ud=this.hd=this.jd=0}function Se(N,F){return((4278124286&(N^F))>>>1)+(N&F)>>>0}function Pe(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function Le(N,F){return Pe(N+(N-F+.5>>1))}function Xe(N,F,K){return Math.abs(F-K)-Math.abs(N-K)}function fe(N,F,K,Y,oe,ue,Ae){for(Y=ue[Ae-1],K=0;K<oe;++K)ue[Ae+K]=Y=Te(N[F+K],Y)}function Ee(N,F,K,Y,oe){var ue;for(ue=0;ue<K;++ue){var Ae=N[F+ue],ge=Ae>>8&255,ve=16711935&(ve=(ve=16711935&Ae)+((ge<<16)+ge));Y[oe+ue]=(4278255360&Ae)+ve>>>0}}function qe(N,F){F.jd=255&N,F.hd=N>>8&255,F.ud=N>>16&255}function Qe(N,F,K,Y,oe,ue){var Ae;for(Ae=0;Ae<Y;++Ae){var ge=F[K+Ae],ve=ge>>>8,Ne=ge,Oe=255&(Oe=(Oe=ge>>>16)+((N.jd<<24>>24)*(ve<<24>>24)>>>5));Ne=255&(Ne=(Ne+=(N.hd<<24>>24)*(ve<<24>>24)>>>5)+((N.ud<<24>>24)*(Oe<<24>>24)>>>5)),oe[ue+Ae]=(4278255360&ge)+(Oe<<16)+Ne}}function Ye(N,F,K,Y,oe){E[F]=function(ue,Ae,ge,ve,Ne,Oe,ze,Be,Re){for(ve=ze;ve<Be;++ve)for(ze=0;ze<Re;++ze)Ne[Oe++]=oe(ge[Y(ue[Ae++])])},E[N]=function(ue,Ae,ge,ve,Ne,Oe,ze){var Be=8>>ue.b,Re=ue.Ea,Ve=ue.K[0],et=ue.w;if(8>Be)for(ue=(1<<ue.b)-1,et=(1<<Be)-1;Ae<ge;++Ae){var We,rt=0;for(We=0;We<Re;++We)We&ue||(rt=Y(ve[Ne++])),Oe[ze++]=oe(Ve[rt&et]),rt>>=Be}else E["VP8LMapColor"+K](ve,Ne,Ve,et,Oe,ze,Ae,ge,Re)}}function Nt(N,F,K,Y,oe){for(K=F+K;F<K;){var ue=N[F++];Y[oe++]=ue>>16&255,Y[oe++]=ue>>8&255,Y[oe++]=255&ue}}function xt(N,F,K,Y,oe){for(K=F+K;F<K;){var ue=N[F++];Y[oe++]=ue>>16&255,Y[oe++]=ue>>8&255,Y[oe++]=255&ue,Y[oe++]=ue>>24&255}}function it(N,F,K,Y,oe){for(K=F+K;F<K;){var ue=(Ae=N[F++])>>16&240|Ae>>12&15,Ae=240&Ae|Ae>>28&15;Y[oe++]=ue,Y[oe++]=Ae}}function ut(N,F,K,Y,oe){for(K=F+K;F<K;){var ue=(Ae=N[F++])>>16&248|Ae>>13&7,Ae=Ae>>5&224|Ae>>3&31;Y[oe++]=ue,Y[oe++]=Ae}}function Mt(N,F,K,Y,oe){for(K=F+K;F<K;){var ue=N[F++];Y[oe++]=255&ue,Y[oe++]=ue>>8&255,Y[oe++]=ue>>16&255}}function ht(N,F,K,Y,oe,ue){if(ue==0)for(K=F+K;F<K;)ye(Y,((ue=N[F++])[0]>>24|ue[1]>>8&65280|ue[2]<<8&16711680|ue[3]<<24)>>>0),oe+=32;else n(Y,oe,N,F,K)}function Et(N,F){E[F][0]=E[N+"0"],E[F][1]=E[N+"1"],E[F][2]=E[N+"2"],E[F][3]=E[N+"3"],E[F][4]=E[N+"4"],E[F][5]=E[N+"5"],E[F][6]=E[N+"6"],E[F][7]=E[N+"7"],E[F][8]=E[N+"8"],E[F][9]=E[N+"9"],E[F][10]=E[N+"10"],E[F][11]=E[N+"11"],E[F][12]=E[N+"12"],E[F][13]=E[N+"13"],E[F][14]=E[N+"0"],E[F][15]=E[N+"0"]}function mt(N){return N==w1||N==b1||N==ep||N==_1}function _t(){this.eb=[],this.size=this.A=this.fb=0}function Ht(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function bt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new _t,this.f.kb=new Ht,this.sd=null}function Ct(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function or(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ra(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function er(N,F){var K=N.T,Y=F.ba.f.RGBA,oe=Y.eb,ue=Y.fb+N.ka*Y.A,Ae=hi[F.ba.S],ge=N.y,ve=N.O,Ne=N.f,Oe=N.N,ze=N.ea,Be=N.W,Re=F.cc,Ve=F.dc,et=F.Mc,We=F.Nc,rt=N.ka,at=N.ka+N.T,At=N.U,ct=At+1>>1;for(rt==0?Ae(ge,ve,null,null,Ne,Oe,ze,Be,Ne,Oe,ze,Be,oe,ue,null,null,At):(Ae(F.ec,F.fc,ge,ve,Re,Ve,et,We,Ne,Oe,ze,Be,oe,ue-Y.A,oe,ue,At),++K);rt+2<at;rt+=2)Re=Ne,Ve=Oe,et=ze,We=Be,Oe+=N.Rc,Be+=N.Rc,ue+=2*Y.A,Ae(ge,(ve+=2*N.fa)-N.fa,ge,ve,Re,Ve,et,We,Ne,Oe,ze,Be,oe,ue-Y.A,oe,ue,At);return ve+=N.fa,N.j+at<N.o?(n(F.ec,F.fc,ge,ve,At),n(F.cc,F.dc,Ne,Oe,ct),n(F.Mc,F.Nc,ze,Be,ct),K--):1&at||Ae(ge,ve,null,null,Ne,Oe,ze,Be,Ne,Oe,ze,Be,oe,ue+Y.A,null,null,At),K}function on(N,F,K){var Y=N.F,oe=[N.J];if(Y!=null){var ue=N.U,Ae=F.ba.S,ge=Ae==Z0||Ae==ep;F=F.ba.f.RGBA;var ve=[0],Ne=N.ka;ve[0]=N.T,N.Kb&&(Ne==0?--ve[0]:(--Ne,oe[0]-=N.width),N.j+N.ka+N.T==N.o&&(ve[0]=N.o-N.j-Ne));var Oe=F.eb;Ne=F.fb+Ne*F.A,N=i5(Y,oe[0],N.width,ue,ve,Oe,Ne+(ge?0:3),F.A),t(K==ve),N&&mt(Ae)&&pf(Oe,Ne,ge,ue,ve,F.A)}return 0}function zn(N){var F=N.ma,K=F.ba.S,Y=11>K,oe=K==Y0||K==J0||K==Z0||K==y1||K==12||mt(K);if(F.memory=null,F.Ib=null,F.Jb=null,F.Nd=null,!of(F.Oa,N,oe?11:12))return 0;if(oe&&mt(K)&&nf(),N.da)alert("todo:use_scaling");else{if(Y){if(F.Ib=Ra,N.Kb){if(K=N.U+1>>1,F.memory=s(N.U+2*K),F.memory==null)return 0;F.ec=F.memory,F.fc=0,F.cc=F.ec,F.dc=F.fc+N.U,F.Mc=F.cc,F.Nc=F.dc+K,F.Ib=er,nf()}}else alert("todo:EmitYUV");oe&&(F.Jb=on,Y&&Qi())}if(Y&&!b5){for(N=0;256>N;++N)mL[N]=89858*(N-128)+rp>>tp,vL[N]=-22014*(N-128)+rp,xL[N]=-45773*(N-128),gL[N]=113618*(N-128)+rp>>tp;for(N=gf;N<C1;++N)F=76283*(N-16)+rp>>tp,yL[N-gf]=mn(F,255),wL[N-gf]=mn(F+8>>4,15);b5=1}return 1}function Lt(N){var F=N.ma,K=N.U,Y=N.T;return t(!(1&N.ka)),0>=K||0>=Y?0:(K=F.Ib(N,F),F.Jb!=null&&F.Jb(N,F,K),F.Dc+=K,1)}function Dn(N){N.ma.memory=null}function Xn(N,F,K,Y){return H(N,8)!=47?0:(F[0]=H(N,14)+1,K[0]=H(N,14)+1,Y[0]=H(N,1),H(N,3)!=0?0:!N.h)}function Nn(N,F){if(4>N)return N+1;var K=N-2>>1;return(2+(1&N)<<K)+H(F,K)+1}function da(N,F){return 120<F?F-120:1<=(K=((K=rL[F-1])>>4)*N+(8-(15&K)))?K:1;var K}function Ar(N,F,K){var Y=O(K),oe=N[F+=255&Y].g-8;return 0<oe&&(P(K,K.u+8),Y=O(K),F+=N[F].value,F+=Y&(1<<oe)-1),P(K,K.u+N[F].g),N[F].value}function Br(N,F,K){return K.g+=N.g,K.value+=N.value<<F>>>0,t(8>=K.g),N.g}function le(N,F,K){var Y=N.xc;return t((F=Y==0?0:N.vc[N.md*(K>>Y)+(F>>Y)])<N.Wb),N.Ya[F]}function ee(N,F,K,Y){var oe=N.ab,ue=N.c*F,Ae=N.C;F=Ae+F;var ge=K,ve=Y;for(Y=N.Ta,K=N.Ua;0<oe--;){var Ne=N.gc[oe],Oe=Ae,ze=F,Be=ge,Re=ve,Ve=(ve=Y,ge=K,Ne.Ea);switch(t(Oe<ze),t(ze<=Ne.nc),Ne.hc){case 2:Bn(Be,Re,(ze-Oe)*Ve,ve,ge);break;case 0:var et=Oe,We=ze,rt=ve,at=ge,At=(Tt=Ne).Ea;et==0&&(cf(Be,Re,null,null,1,rt,at),fe(Be,Re+1,0,0,At-1,rt,at+1),Re+=At,at+=At,++et);for(var ct=1<<Tt.b,Dt=ct-1,kt=we(At,Tt.b),nr=Tt.K,Tt=Tt.w+(et>>Tt.b)*kt;et<We;){var mr=nr,ea=Tt,ar=1;for(dA(Be,Re,rt,at-At,1,rt,at);ar<At;){var It=(ar&~Dt)+ct;It>At&&(It=At),(0,Af[mr[ea++]>>8&15])(Be,Re+ +ar,rt,at+ar-At,It-ar,rt,at+ar),ar=It}Re+=At,at+=At,++et&Dt||(Tt+=kt)}ze!=Ne.nc&&n(ve,ge-Ve,ve,ge+(ze-Oe-1)*Ve,Ve);break;case 1:for(Ve=Be,We=Re,At=(Be=Ne.Ea)-(at=Be&~(rt=(Re=1<<Ne.b)-1)),et=we(Be,Ne.b),ct=Ne.K,Ne=Ne.w+(Oe>>Ne.b)*et;Oe<ze;){for(Dt=ct,kt=Ne,nr=new ce,Tt=We+at,mr=We+Be;We<Tt;)qe(Dt[kt++],nr),df(nr,Ve,We,Re,ve,ge),We+=Re,ge+=Re;We<mr&&(qe(Dt[kt++],nr),df(nr,Ve,We,At,ve,ge),We+=At,ge+=At),++Oe&rt||(Ne+=et)}break;case 3:if(Be==ve&&Re==ge&&0<Ne.b){for(We=ve,Be=Ve=ge+(ze-Oe)*Ve-(at=(ze-Oe)*we(Ne.Ea,Ne.b)),Re=ve,rt=ge,et=[],at=(At=at)-1;0<=at;--at)et[at]=Re[rt+at];for(at=At-1;0<=at;--at)We[Be+at]=et[at];G0(Ne,Oe,ze,ve,Ve,ve,ge)}else G0(Ne,Oe,ze,Be,Re,ve,ge)}ge=Y,ve=K}ve!=K&&n(Y,K,ge,ve,ue)}function se(N,F){var K=N.V,Y=N.Ba+N.c*N.C,oe=F-N.C;if(t(F<=N.l.o),t(16>=oe),0<oe){var ue=N.l,Ae=N.Ta,ge=N.Ua,ve=ue.width;if(ee(N,oe,K,Y),oe=ge=[ge],t((K=N.C)<(Y=F)),t(ue.v<ue.va),Y>ue.o&&(Y=ue.o),K<ue.j){var Ne=ue.j-K;K=ue.j,oe[0]+=Ne*ve}if(K>=Y?K=0:(oe[0]+=4*ue.v,ue.ka=K-ue.j,ue.U=ue.va-ue.v,ue.T=Y-K,K=1),K){if(ge=ge[0],11>(K=N.ca).S){var Oe=K.f.RGBA,ze=(Y=K.S,oe=ue.U,ue=ue.T,Ne=Oe.eb,Oe.A),Be=ue;for(Oe=Oe.fb+N.Ma*Oe.A;0<Be--;){var Re=Ae,Ve=ge,et=oe,We=Ne,rt=Oe;switch(Y){case X0:ff(Re,Ve,et,We,rt);break;case Y0:Hl(Re,Ve,et,We,rt);break;case w1:Hl(Re,Ve,et,We,rt),pf(We,rt,0,et,1,0);break;case f5:nu(Re,Ve,et,We,rt);break;case J0:ht(Re,Ve,et,We,rt,1);break;case b1:ht(Re,Ve,et,We,rt,1),pf(We,rt,0,et,1,0);break;case Z0:ht(Re,Ve,et,We,rt,0);break;case ep:ht(Re,Ve,et,We,rt,0),pf(We,rt,1,et,1,0);break;case y1:ql(Re,Ve,et,We,rt);break;case _1:ql(Re,Ve,et,We,rt),s5(We,rt,et,1,0);break;case h5:Kl(Re,Ve,et,We,rt);break;default:t(0)}ge+=ve,Oe+=ze}N.Ma+=ue}else alert("todo:EmitRescaledRowsYUVA");t(N.Ma<=K.height)}}N.C=F,t(N.C<=N.i)}function ne(N){var F;if(0<N.ua)return 0;for(F=0;F<N.Wb;++F){var K=N.Ya[F].G,Y=N.Ya[F].H;if(0<K[1][Y[1]+0].g||0<K[2][Y[2]+0].g||0<K[3][Y[3]+0].g)return 0}return 1}function xe(N,F,K,Y,oe,ue){if(N.Z!=0){var Ae=N.qd,ge=N.rd;for(t(Gl[N.Z]!=null);F<K;++F)Gl[N.Z](Ae,ge,Y,oe,Y,oe,ue),Ae=Y,ge=oe,oe+=ue;N.qd=Ae,N.rd=ge}}function me(N,F){var K=N.l.ma,Y=K.Z==0||K.Z==1?N.l.j:N.C;if(Y=N.C<Y?Y:N.C,t(F<=N.l.o),F>Y){var oe=N.l.width,ue=K.ca,Ae=K.tb+oe*Y,ge=N.V,ve=N.Ba+N.c*Y,Ne=N.gc;t(N.ab==1),t(Ne[0].hc==3),yo(Ne[0],Y,F,ge,ve,ue,Ae),xe(K,Y,F,ue,Ae,oe)}N.C=N.Ma=F}function Ue(N,F,K,Y,oe,ue,Ae){var ge=N.$/Y,ve=N.$%Y,Ne=N.m,Oe=N.s,ze=K+N.$,Be=ze;oe=K+Y*oe;var Re=K+Y*ue,Ve=280+Oe.ua,et=N.Pb?ge:16777216,We=0<Oe.ua?Oe.Wa:null,rt=Oe.wc,at=ze<Re?le(Oe,ve,ge):null;t(N.C<ue),t(Re<=oe);var At=!1;e:for(;;){for(;At||ze<Re;){var ct=0;if(ge>=et){var Dt=ze-K;t((et=N).Pb),et.wd=et.m,et.xd=Dt,0<et.s.ua&&Ie(et.s.Wa,et.s.vb),et=ge+aL}if(ve&rt||(at=le(Oe,ve,ge)),t(at!=null),at.Qb&&(F[ze]=at.qb,At=!0),!At)if(Q(Ne),at.jc){ct=Ne,Dt=F;var kt=ze,nr=at.pd[O(ct)&ru-1];t(at.jc),256>nr.g?(P(ct,ct.u+nr.g),Dt[kt]=nr.value,ct=0):(P(ct,ct.u+nr.g-256),t(256<=nr.value),ct=nr.value),ct==0&&(At=!0)}else ct=Ar(at.G[0],at.H[0],Ne);if(Ne.h)break;if(At||256>ct){if(!At)if(at.nd)F[ze]=(at.qb|ct<<8)>>>0;else{if(Q(Ne),At=Ar(at.G[1],at.H[1],Ne),Q(Ne),Dt=Ar(at.G[2],at.H[2],Ne),kt=Ar(at.G[3],at.H[3],Ne),Ne.h)break;F[ze]=(kt<<24|At<<16|ct<<8|Dt)>>>0}if(At=!1,++ze,++ve>=Y&&(ve=0,++ge,Ae!=null&&ge<=ue&&!(ge%16)&&Ae(N,ge),We!=null))for(;Be<ze;)ct=F[Be++],We.X[(506832829*ct&4294967295)>>>We.Mb]=ct}else if(280>ct){if(ct=Nn(ct-256,Ne),Dt=Ar(at.G[4],at.H[4],Ne),Q(Ne),Dt=da(Y,Dt=Nn(Dt,Ne)),Ne.h)break;if(ze-K<Dt||oe-ze<ct)break e;for(kt=0;kt<ct;++kt)F[ze+kt]=F[ze+kt-Dt];for(ze+=ct,ve+=ct;ve>=Y;)ve-=Y,++ge,Ae!=null&&ge<=ue&&!(ge%16)&&Ae(N,ge);if(t(ze<=oe),ve&rt&&(at=le(Oe,ve,ge)),We!=null)for(;Be<ze;)ct=F[Be++],We.X[(506832829*ct&4294967295)>>>We.Mb]=ct}else{if(!(ct<Ve))break e;for(At=ct-280,t(We!=null);Be<ze;)ct=F[Be++],We.X[(506832829*ct&4294967295)>>>We.Mb]=ct;ct=ze,t(!(At>>>(Dt=We).Xa)),F[ct]=Dt.X[At],At=!0}At||t(Ne.h==D(Ne))}if(N.Pb&&Ne.h&&ze<oe)t(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&Ie(N.s.vb,N.s.Wa);else{if(Ne.h)break e;Ae!=null&&Ae(N,ge>ue?ue:ge),N.a=0,N.$=ze-K}return 1}return N.a=3,0}function Me(N){t(N!=null),N.vc=null,N.yc=null,N.Ya=null;var F=N.Wa;F!=null&&(F.X=null),N.vb=null,t(N!=null)}function $e(){var N=new Xt;return N==null?null:(N.a=0,N.xb=g5,Et("Predictor","VP8LPredictors"),Et("Predictor","VP8LPredictors_C"),Et("PredictorAdd","VP8LPredictorsAdd"),Et("PredictorAdd","VP8LPredictorsAdd_C"),Bn=Ee,df=Qe,ff=Nt,Hl=xt,ql=it,Kl=ut,nu=Mt,E.VP8LMapColor32b=vo,E.VP8LMapColor8b=uf,N)}function Ge(N,F,K,Y,oe){var ue=1,Ae=[N],ge=[F],ve=Y.m,Ne=Y.s,Oe=null,ze=0;e:for(;;){if(K)for(;ue&&H(ve,1);){var Be=Ae,Re=ge,Ve=Y,et=1,We=Ve.m,rt=Ve.gc[Ve.ab],at=H(We,2);if(Ve.Oc&1<<at)ue=0;else{switch(Ve.Oc|=1<<at,rt.hc=at,rt.Ea=Be[0],rt.nc=Re[0],rt.K=[null],++Ve.ab,t(4>=Ve.ab),at){case 0:case 1:rt.b=H(We,3)+2,et=Ge(we(rt.Ea,rt.b),we(rt.nc,rt.b),0,Ve,rt.K),rt.K=rt.K[0];break;case 3:var At,ct=H(We,8)+1,Dt=16<ct?0:4<ct?1:2<ct?2:3;if(Be[0]=we(rt.Ea,Dt),rt.b=Dt,At=et=Ge(ct,1,0,Ve,rt.K)){var kt,nr=ct,Tt=rt,mr=1<<(8>>Tt.b),ea=s(mr);if(ea==null)At=0;else{var ar=Tt.K[0],It=Tt.w;for(ea[0]=Tt.K[0][0],kt=1;kt<1*nr;++kt)ea[kt]=Te(ar[It+kt],ea[kt-1]);for(;kt<4*mr;++kt)ea[kt]=0;Tt.K[0]=null,Tt.K[0]=ea,At=1}}et=At;break;case 2:break;default:t(0)}ue=et}}if(Ae=Ae[0],ge=ge[0],ue&&H(ve,1)&&!(ue=1<=(ze=H(ve,4))&&11>=ze)){Y.a=3;break e}var vt;if(vt=ue)t:{var En,Zt,gr,zr=Y,Ca=Ae,ls=ge,gn=ze,Qa=K,cs=zr.m,ta=zr.s,vr=[null],Sr=1,xn=0,kr=nL[gn];r:for(;;){if(Qa&&H(cs,1)){var Ea=H(cs,3)+2,Hi=we(Ca,Ea),Sn=we(ls,Ea),Ns=Hi*Sn;if(!Ge(Hi,Sn,0,zr,vr))break r;for(vr=vr[0],ta.xc=Ea,En=0;En<Ns;++En){var Mr=vr[En]>>8&65535;vr[En]=Mr,Mr>=Sr&&(Sr=Mr+1)}}if(cs.h)break r;for(Zt=0;5>Zt;++Zt){var ra=p5[Zt];!Zt&&0<gn&&(ra+=1<<gn),xn<ra&&(xn=ra)}var Qs=o(Sr*kr,I),us=Sr,Ms=o(us,q);if(Ms==null)var Hs=null;else t(65536>=us),Hs=Ms;var Bs=s(xn);if(Hs==null||Bs==null||Qs==null){zr.a=1;break r}var qs=Qs;for(En=gr=0;En<Sr;++En){var Kr=Hs[En],Ks=Kr.G,qi=Kr.H,su=0,il=1,Sa=0;for(Zt=0;5>Zt;++Zt){ra=p5[Zt],Ks[Zt]=qs,qi[Zt]=gr,!Zt&&0<gn&&(ra+=1<<gn);a:{var ap,E1=ra,sp=zr,xf=Bs,NL=qs,BL=gr,S1=0,Wl=sp.m,CL=H(Wl,1);if(a(xf,0,0,E1),CL){var EL=H(Wl,1)+1,SL=H(Wl,1),B5=H(Wl,SL==0?1:8);xf[B5]=1,EL==2&&(xf[B5=H(Wl,8)]=1);var ip=1}else{var C5=s(19),E5=H(Wl,4)+4;if(19<E5){sp.a=3;var op=0;break a}for(ap=0;ap<E5;++ap)C5[tL[ap]]=H(Wl,3);var k1=void 0,vf=void 0,S5=sp,kL=C5,lp=E1,k5=xf,j1=0,zl=S5.m,j5=8,F5=o(128,I);n:for(;j(F5,0,7,kL,19);){if(H(zl,1)){var jL=2+2*H(zl,3);if((k1=2+H(zl,jL))>lp)break n}else k1=lp;for(vf=0;vf<lp&&k1--;){Q(zl);var T5=F5[0+(127&O(zl))];P(zl,zl.u+T5.g);var hA=T5.value;if(16>hA)k5[vf++]=hA,hA!=0&&(j5=hA);else{var FL=hA==16,I5=hA-16,TL=Z8[I5],L5=H(zl,J8[I5])+TL;if(vf+L5>lp)break n;for(var IL=FL?j5:0;0<L5--;)k5[vf++]=IL}}j1=1;break n}j1||(S5.a=3),ip=j1}(ip=ip&&!Wl.h)&&(S1=j(NL,BL,8,xf,E1)),ip&&S1!=0?op=S1:(sp.a=3,op=0)}if(op==0)break r;if(il&&eL[Zt]==1&&(il=qs[gr].g==0),su+=qs[gr].g,gr+=op,3>=Zt){var yf,F1=Bs[0];for(yf=1;yf<ra;++yf)Bs[yf]>F1&&(F1=Bs[yf]);Sa+=F1}}if(Kr.nd=il,Kr.Qb=0,il&&(Kr.qb=(Ks[3][qi[3]+0].value<<24|Ks[1][qi[1]+0].value<<16|Ks[2][qi[2]+0].value)>>>0,su==0&&256>Ks[0][qi[0]+0].value&&(Kr.Qb=1,Kr.qb+=Ks[0][qi[0]+0].value<<8)),Kr.jc=!Kr.Qb&&6>Sa,Kr.jc){var cp,ol=Kr;for(cp=0;cp<ru;++cp){var Xl=cp,Yl=ol.pd[Xl],up=ol.G[0][ol.H[0]+Xl];256<=up.value?(Yl.g=up.g+256,Yl.value=up.value):(Yl.g=0,Yl.value=0,Xl>>=Br(up,8,Yl),Xl>>=Br(ol.G[1][ol.H[1]+Xl],16,Yl),Xl>>=Br(ol.G[2][ol.H[2]+Xl],0,Yl),Br(ol.G[3][ol.H[3]+Xl],24,Yl))}}}ta.vc=vr,ta.Wb=Sr,ta.Ya=Hs,ta.yc=Qs,vt=1;break t}vt=0}if(!(ue=vt)){Y.a=3;break e}if(0<ze){if(Ne.ua=1<<ze,!ae(Ne.Wa,ze)){Y.a=1,ue=0;break e}}else Ne.ua=0;var T1=Y,O5=Ae,LL=ge,I1=T1.s,L1=I1.xc;if(T1.c=O5,T1.i=LL,I1.md=we(O5,L1),I1.wc=L1==0?-1:(1<<L1)-1,K){Y.xb=AL;break e}if((Oe=s(Ae*ge))==null){Y.a=1,ue=0;break e}ue=(ue=Ue(Y,Oe,0,Ae,ge,ge,null))&&!ve.h;break e}return ue?(oe!=null?oe[0]=Oe:(t(Oe==null),t(K)),Y.$=0,K||Me(Ne)):Me(Ne),ue}function je(N,F){var K=N.c*N.i,Y=K+F+16*F;return t(N.c<=F),N.V=s(Y),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+K+F,1)}function _e(N,F){var K=N.C,Y=F-K,oe=N.V,ue=N.Ba+N.c*K;for(t(F<=N.l.o);0<Y;){var Ae=16<Y?16:Y,ge=N.l.ma,ve=N.l.width,Ne=ve*Ae,Oe=ge.ca,ze=ge.tb+ve*K,Be=N.Ta,Re=N.Ua;ee(N,Ae,oe,ue),o5(Be,Re,Oe,ze,Ne),xe(ge,K,K+Ae,Oe,ze,ve),Y-=Ae,oe+=Ae*N.c,K+=Ae}t(K==F),N.C=N.Ma=F}function He(){this.ub=this.yd=this.td=this.Rb=0}function Je(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function st(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function tt(){this.Yb=function(){var N=[];return function F(K,Y,oe){for(var ue=oe[Y],Ae=0;Ae<ue&&(K.push(oe.length>Y+1?[]:0),!(oe.length<Y+1));Ae++)F(K[Ae],Y+1,oe)}(N,0,[3,11]),N}()}function yt(){this.jb=s(3),this.Wc=l([4,8],tt),this.Xc=l([4,17],tt)}function zt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function $t(){this.ld=this.La=this.dd=this.tc=0}function _r(){this.Na=this.la=0}function _a(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function lr(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Wr(){this.uc=this.M=this.Nb=0,this.wa=Array(new $t),this.Y=0,this.ya=Array(new lr),this.aa=0,this.l=new sA}function Rr(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Di(){this.cb=this.a=0,this.sc="",this.m=new C,this.Od=new He,this.Kc=new Je,this.ed=new zt,this.Qa=new st,this.Ic=this.$c=this.Aa=0,this.D=new Wr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,C),this.ia=0,this.pb=o(4,_a),this.Pa=new yt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Rr),this.Hd=0,this.rb=Array(new _r),this.sb=0,this.wa=Array(new $t),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new lr),this.L=this.aa=0,this.gd=l([4,2],$t),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function mn(N,F){return 0>N?0:N>F?F:N}function sA(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function a1(){var N=new Di;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,mf||(mf=iA)),N}function Rn(N,F,K){return N.a==0&&(N.a=F,N.sc=K,N.cb=0),0}function O0(N,F,K){return 3<=K&&N[F+0]==157&&N[F+1]==1&&N[F+2]==42}function go(N,F){if(N==null)return 0;if(N.a=0,N.sc="OK",F==null)return Rn(N,2,"null VP8Io passed to VP8GetHeaders()");var K=F.data,Y=F.w,oe=F.ha;if(4>oe)return Rn(N,7,"Truncated header.");var ue=K[Y+0]|K[Y+1]<<8|K[Y+2]<<16,Ae=N.Od;if(Ae.Rb=!(1&ue),Ae.td=ue>>1&7,Ae.yd=ue>>4&1,Ae.ub=ue>>5,3<Ae.td)return Rn(N,3,"Incorrect keyframe parameters.");if(!Ae.yd)return Rn(N,4,"Frame not displayable.");Y+=3,oe-=3;var ge=N.Kc;if(Ae.Rb){if(7>oe)return Rn(N,7,"cannot parse picture header");if(!O0(K,Y,oe))return Rn(N,3,"Bad code word");ge.c=16383&(K[Y+4]<<8|K[Y+3]),ge.Td=K[Y+4]>>6,ge.i=16383&(K[Y+6]<<8|K[Y+5]),ge.Ud=K[Y+6]>>6,Y+=7,oe-=7,N.za=ge.c+15>>4,N.Ub=ge.i+15>>4,F.width=ge.c,F.height=ge.i,F.Da=0,F.j=0,F.v=0,F.va=F.width,F.o=F.height,F.da=0,F.ib=F.width,F.hb=F.height,F.U=F.width,F.T=F.height,a((ue=N.Pa).jb,0,255,ue.jb.length),t((ue=N.Qa)!=null),ue.Cb=0,ue.Bb=0,ue.Fb=1,a(ue.Zb,0,0,ue.Zb.length),a(ue.Lb,0,0,ue.Lb)}if(Ae.ub>oe)return Rn(N,7,"bad partition length");V(ue=N.m,K,Y,Ae.ub),Y+=Ae.ub,oe-=Ae.ub,Ae.Rb&&(ge.Ld=te(ue),ge.Kd=te(ue)),ge=N.Qa;var ve,Ne=N.Pa;if(t(ue!=null),t(ge!=null),ge.Cb=te(ue),ge.Cb){if(ge.Bb=te(ue),te(ue)){for(ge.Fb=te(ue),ve=0;4>ve;++ve)ge.Zb[ve]=te(ue)?W(ue,7):0;for(ve=0;4>ve;++ve)ge.Lb[ve]=te(ue)?W(ue,6):0}if(ge.Bb)for(ve=0;3>ve;++ve)Ne.jb[ve]=te(ue)?X(ue,8):255}else ge.Bb=0;if(ue.Ka)return Rn(N,3,"cannot parse segment header");if((ge=N.ed).zd=te(ue),ge.Tb=X(ue,6),ge.wb=X(ue,3),ge.Pc=te(ue),ge.Pc&&te(ue)){for(Ne=0;4>Ne;++Ne)te(ue)&&(ge.vd[Ne]=W(ue,6));for(Ne=0;4>Ne;++Ne)te(ue)&&(ge.od[Ne]=W(ue,6))}if(N.L=ge.Tb==0?0:ge.zd?1:2,ue.Ka)return Rn(N,3,"cannot parse filter header");var Oe=oe;if(oe=ve=Y,Y=ve+Oe,ge=Oe,N.Xb=(1<<X(N.m,2))-1,Oe<3*(Ne=N.Xb))K=7;else{for(ve+=3*Ne,ge-=3*Ne,Oe=0;Oe<Ne;++Oe){var ze=K[oe+0]|K[oe+1]<<8|K[oe+2]<<16;ze>ge&&(ze=ge),V(N.Jc[+Oe],K,ve,ze),ve+=ze,ge-=ze,oe+=3}V(N.Jc[+Ne],K,ve,ge),K=ve<Y?0:5}if(K!=0)return Rn(N,K,"cannot parse partitions");for(K=X(ve=N.m,7),oe=te(ve)?W(ve,4):0,Y=te(ve)?W(ve,4):0,ge=te(ve)?W(ve,4):0,Ne=te(ve)?W(ve,4):0,ve=te(ve)?W(ve,4):0,Oe=N.Qa,ze=0;4>ze;++ze){if(Oe.Cb){var Be=Oe.Zb[ze];Oe.Fb||(Be+=K)}else{if(0<ze){N.pb[ze]=N.pb[0];continue}Be=K}var Re=N.pb[ze];Re.Sc[0]=N1[mn(Be+oe,127)],Re.Sc[1]=B1[mn(Be+0,127)],Re.Eb[0]=2*N1[mn(Be+Y,127)],Re.Eb[1]=101581*B1[mn(Be+ge,127)]>>16,8>Re.Eb[1]&&(Re.Eb[1]=8),Re.Qc[0]=N1[mn(Be+Ne,117)],Re.Qc[1]=B1[mn(Be+ve,127)],Re.lc=Be+ve}if(!Ae.Rb)return Rn(N,4,"Not a key frame.");for(te(ue),Ae=N.Pa,K=0;4>K;++K){for(oe=0;8>oe;++oe)for(Y=0;3>Y;++Y)for(ge=0;11>ge;++ge)Ne=z(ue,cL[K][oe][Y][ge])?X(ue,8):oL[K][oe][Y][ge],Ae.Wc[K][oe].Yb[Y][ge]=Ne;for(oe=0;17>oe;++oe)Ae.Xc[K][oe]=Ae.Wc[K][uL[oe]]}return N.kc=te(ue),N.kc&&(N.Bd=X(ue,8)),N.cb=1}function iA(N,F,K,Y,oe,ue,Ae){var ge=F[oe].Yb[K];for(K=0;16>oe;++oe){if(!z(N,ge[K+0]))return oe;for(;!z(N,ge[K+1]);)if(ge=F[++oe].Yb[0],K=0,oe==16)return 16;var ve=F[oe+1].Yb;if(z(N,ge[K+2])){var Ne=N,Oe=0;if(z(Ne,(Be=ge)[(ze=K)+3]))if(z(Ne,Be[ze+6])){for(ge=0,ze=2*(Oe=z(Ne,Be[ze+8]))+(Be=z(Ne,Be[ze+9+Oe])),Oe=0,Be=sL[ze];Be[ge];++ge)Oe+=Oe+z(Ne,Be[ge]);Oe+=3+(8<<ze)}else z(Ne,Be[ze+7])?(Oe=7+2*z(Ne,165),Oe+=z(Ne,145)):Oe=5+z(Ne,159);else Oe=z(Ne,Be[ze+4])?3+z(Ne,Be[ze+5]):2;ge=ve[2]}else Oe=1,ge=ve[1];ve=Ae+iL[oe],0>(Ne=N).b&&J(Ne);var ze,Be=Ne.b,Re=(ze=Ne.Ca>>1)-(Ne.I>>Be)>>31;--Ne.b,Ne.Ca+=Re,Ne.Ca|=1,Ne.I-=(ze+1&Re)<<Be,ue[ve]=((Oe^Re)-Re)*Y[(0<oe)+0]}return 16}function U0(N){var F=N.rb[N.sb-1];F.la=0,F.Na=0,a(N.zc,0,0,N.zc.length),N.ja=0}function ui(N,F,K,Y,oe){oe=N[F+K+32*Y]+(oe>>3),N[F+K+32*Y]=-256&oe?0>oe?0:255:oe}function Yn(N,F,K,Y,oe,ue){ui(N,F,0,K,Y+oe),ui(N,F,1,K,Y+ue),ui(N,F,2,K,Y-ue),ui(N,F,3,K,Y-oe)}function Go(N){return(20091*N>>16)+N}function P0(N,F,K,Y){var oe,ue=0,Ae=s(16);for(oe=0;4>oe;++oe){var ge=N[F+0]+N[F+8],ve=N[F+0]-N[F+8],Ne=(35468*N[F+4]>>16)-Go(N[F+12]),Oe=Go(N[F+4])+(35468*N[F+12]>>16);Ae[ue+0]=ge+Oe,Ae[ue+1]=ve+Ne,Ae[ue+2]=ve-Ne,Ae[ue+3]=ge-Oe,ue+=4,F++}for(oe=ue=0;4>oe;++oe)ge=(N=Ae[ue+0]+4)+Ae[ue+8],ve=N-Ae[ue+8],Ne=(35468*Ae[ue+4]>>16)-Go(Ae[ue+12]),ui(K,Y,0,0,ge+(Oe=Go(Ae[ue+4])+(35468*Ae[ue+12]>>16))),ui(K,Y,1,0,ve+Ne),ui(K,Y,2,0,ve-Ne),ui(K,Y,3,0,ge-Oe),ue++,Y+=32}function s1(N,F,K,Y){var oe=N[F+0]+4,ue=35468*N[F+4]>>16,Ae=Go(N[F+4]),ge=35468*N[F+1]>>16;Yn(K,Y,0,oe+Ae,N=Go(N[F+1]),ge),Yn(K,Y,1,oe+ue,N,ge),Yn(K,Y,2,oe-ue,N,ge),Yn(K,Y,3,oe-Ae,N,ge)}function i1(N,F,K,Y,oe){P0(N,F,K,Y),oe&&P0(N,F+16,K,Y+4)}function xo(N,F,K,Y){au(N,F+0,K,Y,1),au(N,F+32,K,Y+128,1)}function D0(N,F,K,Y){var oe;for(N=N[F+0]+4,oe=0;4>oe;++oe)for(F=0;4>F;++F)ui(K,Y,F,oe,N)}function R0(N,F,K,Y){N[F+0]&&Cr(N,F+0,K,Y),N[F+16]&&Cr(N,F+16,K,Y+4),N[F+32]&&Cr(N,F+32,K,Y+128),N[F+48]&&Cr(N,F+48,K,Y+128+4)}function oA(N,F,K,Y){var oe,ue=s(16);for(oe=0;4>oe;++oe){var Ae=N[F+0+oe]+N[F+12+oe],ge=N[F+4+oe]+N[F+8+oe],ve=N[F+4+oe]-N[F+8+oe],Ne=N[F+0+oe]-N[F+12+oe];ue[0+oe]=Ae+ge,ue[8+oe]=Ae-ge,ue[4+oe]=Ne+ve,ue[12+oe]=Ne-ve}for(oe=0;4>oe;++oe)Ae=(N=ue[0+4*oe]+3)+ue[3+4*oe],ge=ue[1+4*oe]+ue[2+4*oe],ve=ue[1+4*oe]-ue[2+4*oe],Ne=N-ue[3+4*oe],K[Y+0]=Ae+ge>>3,K[Y+16]=Ne+ve>>3,K[Y+32]=Ae-ge>>3,K[Y+48]=Ne-ve>>3,Y+=64}function Vc(N,F,K){var Y,oe=F-32,ue=Rs,Ae=255-N[oe-1];for(Y=0;Y<K;++Y){var ge,ve=ue,Ne=Ae+N[F-1];for(ge=0;ge<K;++ge)N[F+ge]=ve[Ne+N[oe+ge]];F+=32}}function o1(N,F){Vc(N,F,4)}function l1(N,F){Vc(N,F,8)}function c1(N,F){Vc(N,F,16)}function zd(N,F){var K;for(K=0;16>K;++K)n(N,F+32*K,N,F-32,16)}function Q0(N,F){var K;for(K=16;0<K;--K)a(N,F,N[F-1],16),F+=32}function Ri(N,F,K){var Y;for(Y=0;16>Y;++Y)a(F,K+32*Y,N,16)}function u1(N,F){var K,Y=16;for(K=0;16>K;++K)Y+=N[F-1+32*K]+N[F+K-32];Ri(Y>>5,N,F)}function Gc(N,F){var K,Y=8;for(K=0;16>K;++K)Y+=N[F-1+32*K];Ri(Y>>4,N,F)}function Xd(N,F){var K,Y=8;for(K=0;16>K;++K)Y+=N[F+K-32];Ri(Y>>4,N,F)}function A1(N,F){Ri(128,N,F)}function Yt(N,F,K){return N+2*F+K+2>>2}function d1(N,F){var K,Y=F-32;for(Y=new Uint8Array([Yt(N[Y-1],N[Y+0],N[Y+1]),Yt(N[Y+0],N[Y+1],N[Y+2]),Yt(N[Y+1],N[Y+2],N[Y+3]),Yt(N[Y+2],N[Y+3],N[Y+4])]),K=0;4>K;++K)n(N,F+32*K,Y,0,Y.length)}function f1(N,F){var K=N[F-1],Y=N[F-1+32],oe=N[F-1+64],ue=N[F-1+96];ye(N,F+0,16843009*Yt(N[F-1-32],K,Y)),ye(N,F+32,16843009*Yt(K,Y,oe)),ye(N,F+64,16843009*Yt(Y,oe,ue)),ye(N,F+96,16843009*Yt(oe,ue,ue))}function h1(N,F){var K,Y=4;for(K=0;4>K;++K)Y+=N[F+K-32]+N[F-1+32*K];for(Y>>=3,K=0;4>K;++K)a(N,F+32*K,Y,4)}function Wo(N,F){var K=N[F-1+0],Y=N[F-1+32],oe=N[F-1+64],ue=N[F-1-32],Ae=N[F+0-32],ge=N[F+1-32],ve=N[F+2-32],Ne=N[F+3-32];N[F+0+96]=Yt(Y,oe,N[F-1+96]),N[F+1+96]=N[F+0+64]=Yt(K,Y,oe),N[F+2+96]=N[F+1+64]=N[F+0+32]=Yt(ue,K,Y),N[F+3+96]=N[F+2+64]=N[F+1+32]=N[F+0+0]=Yt(Ae,ue,K),N[F+3+64]=N[F+2+32]=N[F+1+0]=Yt(ge,Ae,ue),N[F+3+32]=N[F+2+0]=Yt(ve,ge,Ae),N[F+3+0]=Yt(Ne,ve,ge)}function zo(N,F){var K=N[F+1-32],Y=N[F+2-32],oe=N[F+3-32],ue=N[F+4-32],Ae=N[F+5-32],ge=N[F+6-32],ve=N[F+7-32];N[F+0+0]=Yt(N[F+0-32],K,Y),N[F+1+0]=N[F+0+32]=Yt(K,Y,oe),N[F+2+0]=N[F+1+32]=N[F+0+64]=Yt(Y,oe,ue),N[F+3+0]=N[F+2+32]=N[F+1+64]=N[F+0+96]=Yt(oe,ue,Ae),N[F+3+32]=N[F+2+64]=N[F+1+96]=Yt(ue,Ae,ge),N[F+3+64]=N[F+2+96]=Yt(Ae,ge,ve),N[F+3+96]=Yt(ge,ve,ve)}function p1(N,F){var K=N[F-1+0],Y=N[F-1+32],oe=N[F-1+64],ue=N[F-1-32],Ae=N[F+0-32],ge=N[F+1-32],ve=N[F+2-32],Ne=N[F+3-32];N[F+0+0]=N[F+1+64]=ue+Ae+1>>1,N[F+1+0]=N[F+2+64]=Ae+ge+1>>1,N[F+2+0]=N[F+3+64]=ge+ve+1>>1,N[F+3+0]=ve+Ne+1>>1,N[F+0+96]=Yt(oe,Y,K),N[F+0+64]=Yt(Y,K,ue),N[F+0+32]=N[F+1+96]=Yt(K,ue,Ae),N[F+1+32]=N[F+2+96]=Yt(ue,Ae,ge),N[F+2+32]=N[F+3+96]=Yt(Ae,ge,ve),N[F+3+32]=Yt(ge,ve,Ne)}function m1(N,F){var K=N[F+0-32],Y=N[F+1-32],oe=N[F+2-32],ue=N[F+3-32],Ae=N[F+4-32],ge=N[F+5-32],ve=N[F+6-32],Ne=N[F+7-32];N[F+0+0]=K+Y+1>>1,N[F+1+0]=N[F+0+64]=Y+oe+1>>1,N[F+2+0]=N[F+1+64]=oe+ue+1>>1,N[F+3+0]=N[F+2+64]=ue+Ae+1>>1,N[F+0+32]=Yt(K,Y,oe),N[F+1+32]=N[F+0+96]=Yt(Y,oe,ue),N[F+2+32]=N[F+1+96]=Yt(oe,ue,Ae),N[F+3+32]=N[F+2+96]=Yt(ue,Ae,ge),N[F+3+64]=Yt(Ae,ge,ve),N[F+3+96]=Yt(ge,ve,Ne)}function lA(N,F){var K=N[F-1+0],Y=N[F-1+32],oe=N[F-1+64],ue=N[F-1+96];N[F+0+0]=K+Y+1>>1,N[F+2+0]=N[F+0+32]=Y+oe+1>>1,N[F+2+32]=N[F+0+64]=oe+ue+1>>1,N[F+1+0]=Yt(K,Y,oe),N[F+3+0]=N[F+1+32]=Yt(Y,oe,ue),N[F+3+32]=N[F+1+64]=Yt(oe,ue,ue),N[F+3+64]=N[F+2+64]=N[F+0+96]=N[F+1+96]=N[F+2+96]=N[F+3+96]=ue}function Yd(N,F){var K=N[F-1+0],Y=N[F-1+32],oe=N[F-1+64],ue=N[F-1+96],Ae=N[F-1-32],ge=N[F+0-32],ve=N[F+1-32],Ne=N[F+2-32];N[F+0+0]=N[F+2+32]=K+Ae+1>>1,N[F+0+32]=N[F+2+64]=Y+K+1>>1,N[F+0+64]=N[F+2+96]=oe+Y+1>>1,N[F+0+96]=ue+oe+1>>1,N[F+3+0]=Yt(ge,ve,Ne),N[F+2+0]=Yt(Ae,ge,ve),N[F+1+0]=N[F+3+32]=Yt(K,Ae,ge),N[F+1+32]=N[F+3+64]=Yt(Y,K,Ae),N[F+1+64]=N[F+3+96]=Yt(oe,Y,K),N[F+1+96]=Yt(ue,oe,Y)}function Wc(N,F){var K;for(K=0;8>K;++K)n(N,F+32*K,N,F-32,8)}function g1(N,F){var K;for(K=0;8>K;++K)a(N,F,N[F-1],8),F+=32}function Xo(N,F,K){var Y;for(Y=0;8>Y;++Y)a(F,K+32*Y,N,8)}function x1(N,F){var K,Y=8;for(K=0;8>K;++K)Y+=N[F+K-32]+N[F-1+32*K];Xo(Y>>4,N,F)}function Jd(N,F){var K,Y=4;for(K=0;8>K;++K)Y+=N[F+K-32];Xo(Y>>3,N,F)}function Zd(N,F){var K,Y=4;for(K=0;8>K;++K)Y+=N[F-1+32*K];Xo(Y>>3,N,F)}function M0(N,F){Xo(128,N,F)}function Yo(N,F,K){var Y=N[F-K],oe=N[F+0],ue=3*(oe-Y)+v1[1020+N[F-2*K]-N[F+K]],Ae=z0[112+(ue+4>>3)];N[F-K]=Rs[255+Y+z0[112+(ue+3>>3)]],N[F+0]=Rs[255+oe-Ae]}function ef(N,F,K,Y){var oe=N[F+0],ue=N[F+K];return fi[255+N[F-2*K]-N[F-K]]>Y||fi[255+ue-oe]>Y}function cA(N,F,K,Y){return 4*fi[255+N[F-K]-N[F+0]]+fi[255+N[F-2*K]-N[F+K]]<=Y}function tf(N,F,K,Y,oe){var ue=N[F-3*K],Ae=N[F-2*K],ge=N[F-K],ve=N[F+0],Ne=N[F+K],Oe=N[F+2*K],ze=N[F+3*K];return 4*fi[255+ge-ve]+fi[255+Ae-Ne]>Y?0:fi[255+N[F-4*K]-ue]<=oe&&fi[255+ue-Ae]<=oe&&fi[255+Ae-ge]<=oe&&fi[255+ze-Oe]<=oe&&fi[255+Oe-Ne]<=oe&&fi[255+Ne-ve]<=oe}function zc(N,F,K,Y){var oe=2*Y+1;for(Y=0;16>Y;++Y)cA(N,F+Y,K,oe)&&Yo(N,F+Y,K)}function rf(N,F,K,Y){var oe=2*Y+1;for(Y=0;16>Y;++Y)cA(N,F+Y*K,1,oe)&&Yo(N,F+Y*K,1)}function H0(N,F,K,Y){var oe;for(oe=3;0<oe;--oe)zc(N,F+=4*K,K,Y)}function q0(N,F,K,Y){var oe;for(oe=3;0<oe;--oe)rf(N,F+=4,K,Y)}function Jo(N,F,K,Y,oe,ue,Ae,ge){for(ue=2*ue+1;0<oe--;){if(tf(N,F,K,ue,Ae))if(ef(N,F,K,ge))Yo(N,F,K);else{var ve=N,Ne=F,Oe=K,ze=ve[Ne-2*Oe],Be=ve[Ne-Oe],Re=ve[Ne+0],Ve=ve[Ne+Oe],et=ve[Ne+2*Oe],We=27*(at=v1[1020+3*(Re-Be)+v1[1020+ze-Ve]])+63>>7,rt=18*at+63>>7,at=9*at+63>>7;ve[Ne-3*Oe]=Rs[255+ve[Ne-3*Oe]+at],ve[Ne-2*Oe]=Rs[255+ze+rt],ve[Ne-Oe]=Rs[255+Be+We],ve[Ne+0]=Rs[255+Re-We],ve[Ne+Oe]=Rs[255+Ve-rt],ve[Ne+2*Oe]=Rs[255+et-at]}F+=Y}}function Zo(N,F,K,Y,oe,ue,Ae,ge){for(ue=2*ue+1;0<oe--;){if(tf(N,F,K,ue,Ae))if(ef(N,F,K,ge))Yo(N,F,K);else{var ve=N,Ne=F,Oe=K,ze=ve[Ne-Oe],Be=ve[Ne+0],Re=ve[Ne+Oe],Ve=z0[112+(4+(et=3*(Be-ze))>>3)],et=z0[112+(et+3>>3)],We=Ve+1>>1;ve[Ne-2*Oe]=Rs[255+ve[Ne-2*Oe]+We],ve[Ne-Oe]=Rs[255+ze+et],ve[Ne+0]=Rs[255+Be-Ve],ve[Ne+Oe]=Rs[255+Re-We]}F+=Y}}function K0(N,F,K,Y,oe,ue){Jo(N,F,K,1,16,Y,oe,ue)}function Xc(N,F,K,Y,oe,ue){Jo(N,F,1,K,16,Y,oe,ue)}function $0(N,F,K,Y,oe,ue){var Ae;for(Ae=3;0<Ae;--Ae)Zo(N,F+=4*K,K,1,16,Y,oe,ue)}function R(N,F,K,Y,oe,ue){var Ae;for(Ae=3;0<Ae;--Ae)Zo(N,F+=4,1,K,16,Y,oe,ue)}function ie(N,F,K,Y,oe,ue,Ae,ge){Jo(N,F,oe,1,8,ue,Ae,ge),Jo(K,Y,oe,1,8,ue,Ae,ge)}function Ce(N,F,K,Y,oe,ue,Ae,ge){Jo(N,F,1,oe,8,ue,Ae,ge),Jo(K,Y,1,oe,8,ue,Ae,ge)}function Fe(N,F,K,Y,oe,ue,Ae,ge){Zo(N,F+4*oe,oe,1,8,ue,Ae,ge),Zo(K,Y+4*oe,oe,1,8,ue,Ae,ge)}function Ke(N,F,K,Y,oe,ue,Ae,ge){Zo(N,F+4,1,oe,8,ue,Ae,ge),Zo(K,Y+4,1,oe,8,ue,Ae,ge)}function nt(){this.ba=new bt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new or,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function lt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ft(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Pt(){this.ua=0,this.Wa=new De,this.vb=new De,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new q,this.yc=new I}function Xt(){this.xb=this.a=0,this.l=new sA,this.ca=new bt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new L,this.Pb=0,this.wd=new L,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Pt,this.ab=0,this.gc=o(4,Ft),this.Oc=0}function tr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new sA,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function xr(N,F,K,Y,oe,ue,Ae){for(N=N==null?0:N[F+0],F=0;F<Ae;++F)oe[ue+F]=N+K[Y+F]&255,N=oe[ue+F]}function ln(N,F,K,Y,oe,ue,Ae){var ge;if(N==null)xr(null,null,K,Y,oe,ue,Ae);else for(ge=0;ge<Ae;++ge)oe[ue+ge]=N[F+ge]+K[Y+ge]&255}function Qn(N,F,K,Y,oe,ue,Ae){if(N==null)xr(null,null,K,Y,oe,ue,Ae);else{var ge,ve=N[F+0],Ne=ve,Oe=ve;for(ge=0;ge<Ae;++ge)Ne=Oe+(ve=N[F+ge])-Ne,Oe=K[Y+ge]+(-256&Ne?0>Ne?0:255:Ne)&255,Ne=ve,oe[ue+ge]=Oe}}function qr(N,F,K,Y){var oe=F.width,ue=F.o;if(t(N!=null&&F!=null),0>K||0>=Y||K+Y>ue)return null;if(!N.Cc){if(N.ga==null){var Ae;if(N.ga=new tr,(Ae=N.ga==null)||(Ae=F.width*F.o,t(N.Gb.length==0),N.Gb=s(Ae),N.Uc=0,N.Gb==null?Ae=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,Ae=1),Ae=!Ae),!Ae){Ae=N.ga;var ge=N.Fa,ve=N.P,Ne=N.qc,Oe=N.mb,ze=N.nb,Be=ve+1,Re=Ne-1,Ve=Ae.l;if(t(ge!=null&&Oe!=null&&F!=null),Gl[0]=null,Gl[1]=xr,Gl[2]=ln,Gl[3]=Qn,Ae.ca=Oe,Ae.tb=ze,Ae.c=F.width,Ae.i=F.height,t(0<Ae.c&&0<Ae.i),1>=Ne)F=0;else if(Ae.$a=3&ge[ve+0],Ae.Z=ge[ve+0]>>2&3,Ae.Lc=ge[ve+0]>>4&3,ve=ge[ve+0]>>6&3,0>Ae.$a||1<Ae.$a||4<=Ae.Z||1<Ae.Lc||ve)F=0;else if(Ve.put=Lt,Ve.ac=zn,Ve.bc=Dn,Ve.ma=Ae,Ve.width=F.width,Ve.height=F.height,Ve.Da=F.Da,Ve.v=F.v,Ve.va=F.va,Ve.j=F.j,Ve.o=F.o,Ae.$a)e:{t(Ae.$a==1),F=$e();t:for(;;){if(F==null){F=0;break e}if(t(Ae!=null),Ae.mc=F,F.c=Ae.c,F.i=Ae.i,F.l=Ae.l,F.l.ma=Ae,F.l.width=Ae.c,F.l.height=Ae.i,F.a=0,M(F.m,ge,Be,Re),!Ge(Ae.c,Ae.i,1,F,null)||(F.ab==1&&F.gc[0].hc==3&&ne(F.s)?(Ae.ic=1,ge=F.c*F.i,F.Ta=null,F.Ua=0,F.V=s(ge),F.Ba=0,F.V==null?(F.a=1,F=0):F=1):(Ae.ic=0,F=je(F,Ae.c)),!F))break t;F=1;break e}Ae.mc=null,F=0}else F=Re>=Ae.c*Ae.i;Ae=!F}if(Ae)return null;N.ga.Lc!=1?N.Ga=0:Y=ue-K}t(N.ga!=null),t(K+Y<=ue);e:{if(F=(ge=N.ga).c,ue=ge.l.o,ge.$a==0){if(Be=N.rc,Re=N.Vc,Ve=N.Fa,ve=N.P+1+K*F,Ne=N.mb,Oe=N.nb+K*F,t(ve<=N.P+N.qc),ge.Z!=0)for(t(Gl[ge.Z]!=null),Ae=0;Ae<Y;++Ae)Gl[ge.Z](Be,Re,Ve,ve,Ne,Oe,F),Be=Ne,Re=Oe,Oe+=F,ve+=F;else for(Ae=0;Ae<Y;++Ae)n(Ne,Oe,Ve,ve,F),Be=Ne,Re=Oe,Oe+=F,ve+=F;N.rc=Be,N.Vc=Re}else{if(t(ge.mc!=null),F=K+Y,t((Ae=ge.mc)!=null),t(F<=Ae.i),Ae.C>=F)F=1;else if(ge.ic||Qi(),ge.ic){ge=Ae.V,Be=Ae.Ba,Re=Ae.c;var et=Ae.i,We=(Ve=1,ve=Ae.$/Re,Ne=Ae.$%Re,Oe=Ae.m,ze=Ae.s,Ae.$),rt=Re*et,at=Re*F,At=ze.wc,ct=We<at?le(ze,Ne,ve):null;t(We<=rt),t(F<=et),t(ne(ze));t:for(;;){for(;!Oe.h&&We<at;){if(Ne&At||(ct=le(ze,Ne,ve)),t(ct!=null),Q(Oe),256>(et=Ar(ct.G[0],ct.H[0],Oe)))ge[Be+We]=et,++We,++Ne>=Re&&(Ne=0,++ve<=F&&!(ve%16)&&me(Ae,ve));else{if(!(280>et)){Ve=0;break t}et=Nn(et-256,Oe);var Dt,kt=Ar(ct.G[4],ct.H[4],Oe);if(Q(Oe),!(We>=(kt=da(Re,kt=Nn(kt,Oe)))&&rt-We>=et)){Ve=0;break t}for(Dt=0;Dt<et;++Dt)ge[Be+We+Dt]=ge[Be+We+Dt-kt];for(We+=et,Ne+=et;Ne>=Re;)Ne-=Re,++ve<=F&&!(ve%16)&&me(Ae,ve);We<at&&Ne&At&&(ct=le(ze,Ne,ve))}t(Oe.h==D(Oe))}me(Ae,ve>F?F:ve);break t}!Ve||Oe.h&&We<rt?(Ve=0,Ae.a=Oe.h?5:3):Ae.$=We,F=Ve}else F=Ue(Ae,Ae.V,Ae.Ba,Ae.c,Ae.i,F,_e);if(!F){Y=0;break e}}K+Y>=ue&&(N.Cc=1),Y=1}if(!Y)return null;if(N.Cc&&((Y=N.ga)!=null&&(Y.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+K*oe}function Jn(N,F,K,Y,oe,ue){for(;0<oe--;){var Ae,ge=N,ve=F+(K?1:0),Ne=N,Oe=F+(K?0:3);for(Ae=0;Ae<Y;++Ae){var ze=Ne[Oe+4*Ae];ze!=255&&(ze*=32897,ge[ve+4*Ae+0]=ge[ve+4*Ae+0]*ze>>23,ge[ve+4*Ae+1]=ge[ve+4*Ae+1]*ze>>23,ge[ve+4*Ae+2]=ge[ve+4*Ae+2]*ze>>23)}F+=ue}}function Mn(N,F,K,Y,oe){for(;0<Y--;){var ue;for(ue=0;ue<K;++ue){var Ae=N[F+2*ue+0],ge=15&(Ne=N[F+2*ue+1]),ve=4369*ge,Ne=(240&Ne|Ne>>4)*ve>>16;N[F+2*ue+0]=(240&Ae|Ae>>4)*ve>>16&240|(15&Ae|Ae<<4)*ve>>16>>4&15,N[F+2*ue+1]=240&Ne|ge}F+=oe}}function Na(N,F,K,Y,oe,ue,Ae,ge){var ve,Ne,Oe=255;for(Ne=0;Ne<oe;++Ne){for(ve=0;ve<Y;++ve){var ze=N[F+ve];ue[Ae+4*ve]=ze,Oe&=ze}F+=K,Ae+=ge}return Oe!=255}function el(N,F,K,Y,oe){var ue;for(ue=0;ue<oe;++ue)K[Y+ue]=N[F+ue]>>8}function Qi(){pf=Jn,s5=Mn,i5=Na,o5=el}function tl(N,F,K){E[N]=function(Y,oe,ue,Ae,ge,ve,Ne,Oe,ze,Be,Re,Ve,et,We,rt,at,At){var ct,Dt=At-1>>1,kt=ge[ve+0]|Ne[Oe+0]<<16,nr=ze[Be+0]|Re[Ve+0]<<16;t(Y!=null);var Tt=3*kt+nr+131074>>2;for(F(Y[oe+0],255&Tt,Tt>>16,et,We),ue!=null&&(Tt=3*nr+kt+131074>>2,F(ue[Ae+0],255&Tt,Tt>>16,rt,at)),ct=1;ct<=Dt;++ct){var mr=ge[ve+ct]|Ne[Oe+ct]<<16,ea=ze[Be+ct]|Re[Ve+ct]<<16,ar=kt+mr+nr+ea+524296,It=ar+2*(mr+nr)>>3;Tt=It+kt>>1,kt=(ar=ar+2*(kt+ea)>>3)+mr>>1,F(Y[oe+2*ct-1],255&Tt,Tt>>16,et,We+(2*ct-1)*K),F(Y[oe+2*ct-0],255&kt,kt>>16,et,We+(2*ct-0)*K),ue!=null&&(Tt=ar+nr>>1,kt=It+ea>>1,F(ue[Ae+2*ct-1],255&Tt,Tt>>16,rt,at+(2*ct-1)*K),F(ue[Ae+2*ct+0],255&kt,kt>>16,rt,at+(2*ct+0)*K)),kt=mr,nr=ea}1&At||(Tt=3*kt+nr+131074>>2,F(Y[oe+At-1],255&Tt,Tt>>16,et,We+(At-1)*K),ue!=null&&(Tt=3*nr+kt+131074>>2,F(ue[Ae+At-1],255&Tt,Tt>>16,rt,at+(At-1)*K)))}}function nf(){hi[X0]=dL,hi[Y0]=x5,hi[f5]=fL,hi[J0]=v5,hi[Z0]=y5,hi[y1]=w5,hi[h5]=hL,hi[w1]=x5,hi[b1]=v5,hi[ep]=y5,hi[_1]=w5}function uA(N){return N&-16384?0>N?0:255:N>>pL}function Pl(N,F){return uA((19077*N>>8)+(26149*F>>8)-14234)}function Yc(N,F,K){return uA((19077*N>>8)-(6419*F>>8)-(13320*K>>8)+8708)}function Jc(N,F){return uA((19077*N>>8)+(33050*F>>8)-17685)}function Dl(N,F,K,Y,oe){Y[oe+0]=Pl(N,K),Y[oe+1]=Yc(N,F,K),Y[oe+2]=Jc(N,F)}function Ba(N,F,K,Y,oe){Y[oe+0]=Jc(N,F),Y[oe+1]=Yc(N,F,K),Y[oe+2]=Pl(N,K)}function Zc(N,F,K,Y,oe){var ue=Yc(N,F,K);F=ue<<3&224|Jc(N,F)>>3,Y[oe+0]=248&Pl(N,K)|ue>>5,Y[oe+1]=F}function eu(N,F,K,Y,oe){var ue=240&Jc(N,F)|15;Y[oe+0]=240&Pl(N,K)|Yc(N,F,K)>>4,Y[oe+1]=ue}function af(N,F,K,Y,oe){Y[oe+0]=255,Dl(N,F,K,Y,oe+1)}function sf(N,F,K,Y,oe){Ba(N,F,K,Y,oe),Y[oe+3]=255}function os(N,F,K,Y,oe){Dl(N,F,K,Y,oe),Y[oe+3]=255}function rl(N,F,K){E[N]=function(Y,oe,ue,Ae,ge,ve,Ne,Oe,ze){for(var Be=Oe+(-2&ze)*K;Oe!=Be;)F(Y[oe+0],ue[Ae+0],ge[ve+0],Ne,Oe),F(Y[oe+1],ue[Ae+0],ge[ve+0],Ne,Oe+K),oe+=2,++Ae,++ve,Oe+=2*K;1&ze&&F(Y[oe+0],ue[Ae+0],ge[ve+0],Ne,Oe)}}function AA(N,F,K){return K==0?N==0?F==0?6:5:F==0?4:0:K}function V0(N,F,K,Y,oe){switch(N>>>30){case 3:au(F,K,Y,oe,0);break;case 2:di(F,K,Y,oe);break;case 1:Cr(F,K,Y,oe)}}function Ai(N,F){var K,Y,oe=F.M,ue=F.Nb,Ae=N.oc,ge=N.pc+40,ve=N.oc,Ne=N.pc+584,Oe=N.oc,ze=N.pc+600;for(K=0;16>K;++K)Ae[ge+32*K-1]=129;for(K=0;8>K;++K)ve[Ne+32*K-1]=129,Oe[ze+32*K-1]=129;for(0<oe?Ae[ge-1-32]=ve[Ne-1-32]=Oe[ze-1-32]=129:(a(Ae,ge-32-1,127,21),a(ve,Ne-32-1,127,9),a(Oe,ze-32-1,127,9)),Y=0;Y<N.za;++Y){var Be=F.ya[F.aa+Y];if(0<Y){for(K=-1;16>K;++K)n(Ae,ge+32*K-4,Ae,ge+32*K+12,4);for(K=-1;8>K;++K)n(ve,Ne+32*K-4,ve,Ne+32*K+4,4),n(Oe,ze+32*K-4,Oe,ze+32*K+4,4)}var Re=N.Gd,Ve=N.Hd+Y,et=Be.ad,We=Be.Hc;if(0<oe&&(n(Ae,ge-32,Re[Ve].y,0,16),n(ve,Ne-32,Re[Ve].f,0,8),n(Oe,ze-32,Re[Ve].ea,0,8)),Be.Za){var rt=Ae,at=ge-32+16;for(0<oe&&(Y>=N.za-1?a(rt,at,Re[Ve].y[15],4):n(rt,at,Re[Ve+1].y,0,4)),K=0;4>K;K++)rt[at+128+K]=rt[at+256+K]=rt[at+384+K]=rt[at+0+K];for(K=0;16>K;++K,We<<=2)rt=Ae,at=ge+_5[K],Mi[Be.Ob[K]](rt,at),V0(We,et,16*+K,rt,at)}else if(rt=AA(Y,oe,Be.Ob[0]),Vl[rt](Ae,ge),We!=0)for(K=0;16>K;++K,We<<=2)V0(We,et,16*+K,Ae,ge+_5[K]);for(K=Be.Gc,rt=AA(Y,oe,Be.Dd),sl[rt](ve,Ne),sl[rt](Oe,ze),We=et,rt=ve,at=Ne,255&(Be=0|K)&&(170&Be?wo(We,256,rt,at):Qr(We,256,rt,at)),Be=Oe,We=ze,255&(K>>=8)&&(170&K?wo(et,320,Be,We):Qr(et,320,Be,We)),oe<N.Ub-1&&(n(Re[Ve].y,0,Ae,ge+480,16),n(Re[Ve].f,0,ve,Ne+224,8),n(Re[Ve].ea,0,Oe,ze+224,8)),K=8*ue*N.B,Re=N.sa,Ve=N.ta+16*Y+16*ue*N.R,et=N.qa,Be=N.ra+8*Y+K,We=N.Ha,rt=N.Ia+8*Y+K,K=0;16>K;++K)n(Re,Ve+K*N.R,Ae,ge+32*K,16);for(K=0;8>K;++K)n(et,Be+K*N.B,ve,Ne+32*K,8),n(We,rt+K*N.B,Oe,ze+32*K,8)}}function tu(N,F,K,Y,oe,ue,Ae,ge,ve){var Ne=[0],Oe=[0],ze=0,Be=ve!=null?ve.kd:0,Re=ve??new lt;if(N==null||12>K)return 7;Re.data=N,Re.w=F,Re.ha=K,F=[F],K=[K],Re.gb=[Re.gb];e:{var Ve=F,et=K,We=Re.gb;if(t(N!=null),t(et!=null),t(We!=null),We[0]=0,12<=et[0]&&!r(N,Ve[0],"RIFF")){if(r(N,Ve[0]+8,"WEBP")){We=3;break e}var rt=be(N,Ve[0]+4);if(12>rt||4294967286<rt){We=3;break e}if(Be&&rt>et[0]-8){We=7;break e}We[0]=rt,Ve[0]+=12,et[0]-=12}We=0}if(We!=0)return We;for(rt=0<Re.gb[0],K=K[0];;){e:{var at=N;et=F,We=K;var At=Ne,ct=Oe,Dt=Ve=[0];if((Tt=ze=[ze])[0]=0,8>We[0])We=7;else{if(!r(at,et[0],"VP8X")){if(be(at,et[0]+4)!=10){We=3;break e}if(18>We[0]){We=7;break e}var kt=be(at,et[0]+8),nr=1+ke(at,et[0]+12);if(2147483648<=nr*(at=1+ke(at,et[0]+15))){We=3;break e}Dt!=null&&(Dt[0]=kt),At!=null&&(At[0]=nr),ct!=null&&(ct[0]=at),et[0]+=18,We[0]-=18,Tt[0]=1}We=0}}if(ze=ze[0],Ve=Ve[0],We!=0)return We;if(et=!!(2&Ve),!rt&&ze)return 3;if(ue!=null&&(ue[0]=!!(16&Ve)),Ae!=null&&(Ae[0]=et),ge!=null&&(ge[0]=0),Ae=Ne[0],Ve=Oe[0],ze&&et&&ve==null){We=0;break}if(4>K){We=7;break}if(rt&&ze||!rt&&!ze&&!r(N,F[0],"ALPH")){K=[K],Re.na=[Re.na],Re.P=[Re.P],Re.Sa=[Re.Sa];e:{kt=N,We=F,rt=K;var Tt=Re.gb;At=Re.na,ct=Re.P,Dt=Re.Sa,nr=22,t(kt!=null),t(rt!=null),at=We[0];var mr=rt[0];for(t(At!=null),t(Dt!=null),At[0]=null,ct[0]=null,Dt[0]=0;;){if(We[0]=at,rt[0]=mr,8>mr){We=7;break e}var ea=be(kt,at+4);if(4294967286<ea){We=3;break e}var ar=8+ea+1&-2;if(nr+=ar,0<Tt&&nr>Tt){We=3;break e}if(!r(kt,at,"VP8 ")||!r(kt,at,"VP8L")){We=0;break e}if(mr[0]<ar){We=7;break e}r(kt,at,"ALPH")||(At[0]=kt,ct[0]=at+8,Dt[0]=ea),at+=ar,mr-=ar}}if(K=K[0],Re.na=Re.na[0],Re.P=Re.P[0],Re.Sa=Re.Sa[0],We!=0)break}K=[K],Re.Ja=[Re.Ja],Re.xa=[Re.xa];e:if(Tt=N,We=F,rt=K,At=Re.gb[0],ct=Re.Ja,Dt=Re.xa,kt=We[0],at=!r(Tt,kt,"VP8 "),nr=!r(Tt,kt,"VP8L"),t(Tt!=null),t(rt!=null),t(ct!=null),t(Dt!=null),8>rt[0])We=7;else{if(at||nr){if(Tt=be(Tt,kt+4),12<=At&&Tt>At-12){We=3;break e}if(Be&&Tt>rt[0]-8){We=7;break e}ct[0]=Tt,We[0]+=8,rt[0]-=8,Dt[0]=nr}else Dt[0]=5<=rt[0]&&Tt[kt+0]==47&&!(Tt[kt+4]>>5),ct[0]=rt[0];We=0}if(K=K[0],Re.Ja=Re.Ja[0],Re.xa=Re.xa[0],F=F[0],We!=0)break;if(4294967286<Re.Ja)return 3;if(ge==null||et||(ge[0]=Re.xa?2:1),Ae=[Ae],Ve=[Ve],Re.xa){if(5>K){We=7;break}ge=Ae,Be=Ve,et=ue,N==null||5>K?N=0:5<=K&&N[F+0]==47&&!(N[F+4]>>5)?(rt=[0],Tt=[0],At=[0],M(ct=new L,N,F,K),Xn(ct,rt,Tt,At)?(ge!=null&&(ge[0]=rt[0]),Be!=null&&(Be[0]=Tt[0]),et!=null&&(et[0]=At[0]),N=1):N=0):N=0}else{if(10>K){We=7;break}ge=Ve,N==null||10>K||!O0(N,F+3,K-3)?N=0:(Be=N[F+0]|N[F+1]<<8|N[F+2]<<16,et=16383&(N[F+7]<<8|N[F+6]),N=16383&(N[F+9]<<8|N[F+8]),1&Be||3<(Be>>1&7)||!(Be>>4&1)||Be>>5>=Re.Ja||!et||!N?N=0:(Ae&&(Ae[0]=et),ge&&(ge[0]=N),N=1))}if(!N||(Ae=Ae[0],Ve=Ve[0],ze&&(Ne[0]!=Ae||Oe[0]!=Ve)))return 3;ve!=null&&(ve[0]=Re,ve.offset=F-ve.w,t(4294967286>F-ve.w),t(ve.offset==ve.ha-K));break}return We==0||We==7&&ze&&ve==null?(ue!=null&&(ue[0]|=Re.na!=null&&0<Re.na.length),Y!=null&&(Y[0]=Ae),oe!=null&&(oe[0]=Ve),0):We}function of(N,F,K){var Y=F.width,oe=F.height,ue=0,Ae=0,ge=Y,ve=oe;if(F.Da=N!=null&&0<N.Da,F.Da&&(ge=N.cd,ve=N.bd,ue=N.v,Ae=N.j,11>K||(ue&=-2,Ae&=-2),0>ue||0>Ae||0>=ge||0>=ve||ue+ge>Y||Ae+ve>oe))return 0;if(F.v=ue,F.j=Ae,F.va=ue+ge,F.o=Ae+ve,F.U=ge,F.T=ve,F.da=N!=null&&0<N.da,F.da){if(!pe(ge,ve,K=[N.ib],ue=[N.hb]))return 0;F.ib=K[0],F.hb=ue[0]}return F.ob=N!=null&&N.ob,F.Kb=N==null||!N.Sd,F.da&&(F.ob=F.ib<3*Y/4&&F.hb<3*oe/4,F.Kb=0),1}function lf(N){if(N==null)return 2;if(11>N.S){var F=N.f.RGBA;F.fb+=(N.height-1)*F.A,F.A=-F.A}else F=N.f.kb,N=N.height,F.O+=(N-1)*F.fa,F.fa=-F.fa,F.N+=(N-1>>1)*F.Ab,F.Ab=-F.Ab,F.W+=(N-1>>1)*F.Db,F.Db=-F.Db,F.F!=null&&(F.J+=(N-1)*F.lb,F.lb=-F.lb);return 0}function Rl(N,F,K,Y){if(Y==null||0>=N||0>=F)return 2;if(K!=null){if(K.Da){var oe=K.cd,ue=K.bd,Ae=-2&K.v,ge=-2&K.j;if(0>Ae||0>ge||0>=oe||0>=ue||Ae+oe>N||ge+ue>F)return 2;N=oe,F=ue}if(K.da){if(!pe(N,F,oe=[K.ib],ue=[K.hb]))return 2;N=oe[0],F=ue[0]}}Y.width=N,Y.height=F;e:{var ve=Y.width,Ne=Y.height;if(N=Y.S,0>=ve||0>=Ne||!(N>=X0&&13>N))N=2;else{if(0>=Y.Rd&&Y.sd==null){Ae=ue=oe=F=0;var Oe=(ge=ve*N5[N])*Ne;if(11>N||(ue=(Ne+1)/2*(F=(ve+1)/2),N==12&&(Ae=(oe=ve)*Ne)),(Ne=s(Oe+2*ue+Ae))==null){N=1;break e}Y.sd=Ne,11>N?((ve=Y.f.RGBA).eb=Ne,ve.fb=0,ve.A=ge,ve.size=Oe):((ve=Y.f.kb).y=Ne,ve.O=0,ve.fa=ge,ve.Fd=Oe,ve.f=Ne,ve.N=0+Oe,ve.Ab=F,ve.Cd=ue,ve.ea=Ne,ve.W=0+Oe+ue,ve.Db=F,ve.Ed=ue,N==12&&(ve.F=Ne,ve.J=0+Oe+2*ue),ve.Tc=Ae,ve.lb=oe)}if(F=1,oe=Y.S,ue=Y.width,Ae=Y.height,oe>=X0&&13>oe)if(11>oe)N=Y.f.RGBA,F&=(ge=Math.abs(N.A))*(Ae-1)+ue<=N.size,F&=ge>=ue*N5[oe],F&=N.eb!=null;else{N=Y.f.kb,ge=(ue+1)/2,Oe=(Ae+1)/2,ve=Math.abs(N.fa),Ne=Math.abs(N.Ab);var ze=Math.abs(N.Db),Be=Math.abs(N.lb),Re=Be*(Ae-1)+ue;F&=ve*(Ae-1)+ue<=N.Fd,F&=Ne*(Oe-1)+ge<=N.Cd,F=(F&=ze*(Oe-1)+ge<=N.Ed)&ve>=ue&Ne>=ge&ze>=ge,F&=N.y!=null,F&=N.f!=null,F&=N.ea!=null,oe==12&&(F&=Be>=ue,F&=Re<=N.Tc,F&=N.F!=null)}else F=0;N=F?0:2}}return N!=0||K!=null&&K.fd&&(N=lf(Y)),N}var ru=64,Ps=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ds=24,Ql=32,nl=8,Ml=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];he("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(N){return N},E.Predictor2=function(N,F,K){return F[K+0]},E.Predictor3=function(N,F,K){return F[K+1]},E.Predictor4=function(N,F,K){return F[K-1]},E.Predictor5=function(N,F,K){return Se(Se(N,F[K+1]),F[K+0])},E.Predictor6=function(N,F,K){return Se(N,F[K-1])},E.Predictor7=function(N,F,K){return Se(N,F[K+0])},E.Predictor8=function(N,F,K){return Se(F[K-1],F[K+0])},E.Predictor9=function(N,F,K){return Se(F[K+0],F[K+1])},E.Predictor10=function(N,F,K){return Se(Se(N,F[K-1]),Se(F[K+0],F[K+1]))},E.Predictor11=function(N,F,K){var Y=F[K+0];return 0>=Xe(Y>>24&255,N>>24&255,(F=F[K-1])>>24&255)+Xe(Y>>16&255,N>>16&255,F>>16&255)+Xe(Y>>8&255,N>>8&255,F>>8&255)+Xe(255&Y,255&N,255&F)?Y:N},E.Predictor12=function(N,F,K){var Y=F[K+0];return(Pe((N>>24&255)+(Y>>24&255)-((F=F[K-1])>>24&255))<<24|Pe((N>>16&255)+(Y>>16&255)-(F>>16&255))<<16|Pe((N>>8&255)+(Y>>8&255)-(F>>8&255))<<8|Pe((255&N)+(255&Y)-(255&F)))>>>0},E.Predictor13=function(N,F,K){var Y=F[K-1];return(Le((N=Se(N,F[K+0]))>>24&255,Y>>24&255)<<24|Le(N>>16&255,Y>>16&255)<<16|Le(N>>8&255,Y>>8&255)<<8|Le(255&N,255&Y))>>>0};var cf=E.PredictorAdd0;E.PredictorAdd1=fe,he("Predictor2","PredictorAdd2"),he("Predictor3","PredictorAdd3"),he("Predictor4","PredictorAdd4"),he("Predictor5","PredictorAdd5"),he("Predictor6","PredictorAdd6"),he("Predictor7","PredictorAdd7"),he("Predictor8","PredictorAdd8"),he("Predictor9","PredictorAdd9"),he("Predictor10","PredictorAdd10"),he("Predictor11","PredictorAdd11"),he("Predictor12","PredictorAdd12"),he("Predictor13","PredictorAdd13");var dA=E.PredictorAdd2;Ye("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),Ye("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var Bn,G0=E.ColorIndexInverseTransform,vo=E.MapARGB,yo=E.VP8LColorIndexInverseTransformAlpha,uf=E.MapAlpha,Af=E.VP8LPredictorsAdd=[];Af.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var df,ff,Hl,ql,Kl,nu,$l,au,di,wo,Cr,Qr,Cn,Zn,al,hf,fA,W0,Z_,e5,t5,r5,n5,a5,pf,s5,i5,o5,l5=s(511),c5=s(2041),u5=s(225),A5=s(767),d5=0,v1=c5,z0=u5,Rs=A5,fi=l5,X0=0,Y0=1,f5=2,J0=3,Z0=4,y1=5,h5=6,w1=7,b1=8,ep=9,_1=10,J8=[2,3,7],Z8=[3,3,11],p5=[280,256,256,256,40],eL=[0,1,1,1,0],tL=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],rL=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],nL=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],aL=8,N1=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],B1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],mf=null,sL=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],iL=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],m5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],oL=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],lL=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],cL=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],uL=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Vl=[],Mi=[],sl=[],AL=1,g5=2,Gl=[],hi=[];tl("UpsampleRgbLinePair",Dl,3),tl("UpsampleBgrLinePair",Ba,3),tl("UpsampleRgbaLinePair",os,4),tl("UpsampleBgraLinePair",sf,4),tl("UpsampleArgbLinePair",af,4),tl("UpsampleRgba4444LinePair",eu,2),tl("UpsampleRgb565LinePair",Zc,2);var dL=E.UpsampleRgbLinePair,fL=E.UpsampleBgrLinePair,x5=E.UpsampleRgbaLinePair,v5=E.UpsampleBgraLinePair,y5=E.UpsampleArgbLinePair,w5=E.UpsampleRgba4444LinePair,hL=E.UpsampleRgb565LinePair,tp=16,rp=1<<tp-1,gf=-227,C1=482,pL=6,b5=0,mL=s(256),gL=s(256),xL=s(256),vL=s(256),yL=s(C1-gf),wL=s(C1-gf);rl("YuvToRgbRow",Dl,3),rl("YuvToBgrRow",Ba,3),rl("YuvToRgbaRow",os,4),rl("YuvToBgraRow",sf,4),rl("YuvToArgbRow",af,4),rl("YuvToRgba4444Row",eu,2),rl("YuvToRgb565Row",Zc,2);var _5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],np=[0,2,8],bL=[8,7,6,4,4,2,2,2,1,1,1,1],_L=1;this.WebPDecodeRGBA=function(N,F,K,Y,oe){var ue=Y0,Ae=new nt,ge=new bt;Ae.ba=ge,ge.S=ue,ge.width=[ge.width],ge.height=[ge.height];var ve=ge.width,Ne=ge.height,Oe=new Ct;if(Oe==null||N==null)var ze=2;else t(Oe!=null),ze=tu(N,F,K,Oe.width,Oe.height,Oe.Pd,Oe.Qd,Oe.format,null);if(ze!=0?ve=0:(ve!=null&&(ve[0]=Oe.width[0]),Ne!=null&&(Ne[0]=Oe.height[0]),ve=1),ve){ge.width=ge.width[0],ge.height=ge.height[0],Y!=null&&(Y[0]=ge.width),oe!=null&&(oe[0]=ge.height);e:{if(Y=new sA,(oe=new lt).data=N,oe.w=F,oe.ha=K,oe.kd=1,F=[0],t(oe!=null),((N=tu(oe.data,oe.w,oe.ha,null,null,null,F,null,oe))==0||N==7)&&F[0]&&(N=4),(F=N)==0){if(t(Ae!=null),Y.data=oe.data,Y.w=oe.w+oe.offset,Y.ha=oe.ha-oe.offset,Y.put=Lt,Y.ac=zn,Y.bc=Dn,Y.ma=Ae,oe.xa){if((N=$e())==null){Ae=1;break e}if(function(Be,Re){var Ve=[0],et=[0],We=[0];t:for(;;){if(Be==null)return 0;if(Re==null)return Be.a=2,0;if(Be.l=Re,Be.a=0,M(Be.m,Re.data,Re.w,Re.ha),!Xn(Be.m,Ve,et,We)){Be.a=3;break t}if(Be.xb=g5,Re.width=Ve[0],Re.height=et[0],!Ge(Ve[0],et[0],1,Be,null))break t;return 1}return t(Be.a!=0),0}(N,Y)){if(Y=(F=Rl(Y.width,Y.height,Ae.Oa,Ae.ba))==0){t:{Y=N;r:for(;;){if(Y==null){Y=0;break t}if(t(Y.s.yc!=null),t(Y.s.Ya!=null),t(0<Y.s.Wb),t((K=Y.l)!=null),t((oe=K.ma)!=null),Y.xb!=0){if(Y.ca=oe.ba,Y.tb=oe.tb,t(Y.ca!=null),!of(oe.Oa,K,J0)){Y.a=2;break r}if(!je(Y,K.width)||K.da)break r;if((K.da||mt(Y.ca.S))&&Qi(),11>Y.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Y.ca.f.kb.F!=null&&Qi()),Y.Pb&&0<Y.s.ua&&Y.s.vb.X==null&&!ae(Y.s.vb,Y.s.Wa.Xa)){Y.a=1;break r}Y.xb=0}if(!Ue(Y,Y.V,Y.Ba,Y.c,Y.i,K.o,se))break r;oe.Dc=Y.Ma,Y=1;break t}t(Y.a!=0),Y=0}Y=!Y}Y&&(F=N.a)}else F=N.a}else{if((N=new a1)==null){Ae=1;break e}if(N.Fa=oe.na,N.P=oe.P,N.qc=oe.Sa,go(N,Y)){if((F=Rl(Y.width,Y.height,Ae.Oa,Ae.ba))==0){if(N.Aa=0,K=Ae.Oa,t((oe=N)!=null),K!=null){if(0<(ve=0>(ve=K.Md)?0:100<ve?255:255*ve/100)){for(Ne=Oe=0;4>Ne;++Ne)12>(ze=oe.pb[Ne]).lc&&(ze.ia=ve*bL[0>ze.lc?0:ze.lc]>>3),Oe|=ze.ia;Oe&&(alert("todo:VP8InitRandom"),oe.ia=1)}oe.Ga=K.Id,100<oe.Ga?oe.Ga=100:0>oe.Ga&&(oe.Ga=0)}(function(Be,Re){if(Be==null)return 0;if(Re==null)return Rn(Be,2,"NULL VP8Io parameter in VP8Decode().");if(!Be.cb&&!go(Be,Re))return 0;if(t(Be.cb),Re.ac==null||Re.ac(Re)){Re.ob&&(Be.L=0);var Ve=np[Be.L];if(Be.L==2?(Be.yb=0,Be.zb=0):(Be.yb=Re.v-Ve>>4,Be.zb=Re.j-Ve>>4,0>Be.yb&&(Be.yb=0),0>Be.zb&&(Be.zb=0)),Be.Va=Re.o+15+Ve>>4,Be.Hb=Re.va+15+Ve>>4,Be.Hb>Be.za&&(Be.Hb=Be.za),Be.Va>Be.Ub&&(Be.Va=Be.Ub),0<Be.L){var et=Be.ed;for(Ve=0;4>Ve;++Ve){var We;if(Be.Qa.Cb){var rt=Be.Qa.Lb[Ve];Be.Qa.Fb||(rt+=et.Tb)}else rt=et.Tb;for(We=0;1>=We;++We){var at=Be.gd[Ve][We],At=rt;if(et.Pc&&(At+=et.vd[0],We&&(At+=et.od[0])),0<(At=0>At?0:63<At?63:At)){var ct=At;0<et.wb&&(ct=4<et.wb?ct>>2:ct>>1)>9-et.wb&&(ct=9-et.wb),1>ct&&(ct=1),at.dd=ct,at.tc=2*At+ct,at.ld=40<=At?2:15<=At?1:0}else at.tc=0;at.La=We}}}Ve=0}else Rn(Be,6,"Frame setup failed"),Ve=Be.a;if(Ve=Ve==0){if(Ve){Be.$c=0,0<Be.Aa||(Be.Ic=_L);t:{Ve=Be.Ic,et=4*(ct=Be.za);var Dt=32*ct,kt=ct+1,nr=0<Be.L?ct*(0<Be.Aa?2:1):0,Tt=(Be.Aa==2?2:1)*ct;if((at=et+832+(We=3*(16*Ve+np[Be.L])/2*Dt)+(rt=Be.Fa!=null&&0<Be.Fa.length?Be.Kc.c*Be.Kc.i:0))!=at)Ve=0;else{if(at>Be.Vb){if(Be.Vb=0,Be.Ec=s(at),Be.Fc=0,Be.Ec==null){Ve=Rn(Be,1,"no memory during frame initialization.");break t}Be.Vb=at}at=Be.Ec,At=Be.Fc,Be.Ac=at,Be.Bc=At,At+=et,Be.Gd=o(Dt,Rr),Be.Hd=0,Be.rb=o(kt+1,_r),Be.sb=1,Be.wa=nr?o(nr,$t):null,Be.Y=0,Be.D.Nb=0,Be.D.wa=Be.wa,Be.D.Y=Be.Y,0<Be.Aa&&(Be.D.Y+=ct),t(!0),Be.oc=at,Be.pc=At,At+=832,Be.ya=o(Tt,lr),Be.aa=0,Be.D.ya=Be.ya,Be.D.aa=Be.aa,Be.Aa==2&&(Be.D.aa+=ct),Be.R=16*ct,Be.B=8*ct,ct=(Dt=np[Be.L])*Be.R,Dt=Dt/2*Be.B,Be.sa=at,Be.ta=At+ct,Be.qa=Be.sa,Be.ra=Be.ta+16*Ve*Be.R+Dt,Be.Ha=Be.qa,Be.Ia=Be.ra+8*Ve*Be.B+Dt,Be.$c=0,At+=We,Be.mb=rt?at:null,Be.nb=rt?At:null,t(At+rt<=Be.Fc+Be.Vb),U0(Be),a(Be.Ac,Be.Bc,0,et),Ve=1}}if(Ve){if(Re.ka=0,Re.y=Be.sa,Re.O=Be.ta,Re.f=Be.qa,Re.N=Be.ra,Re.ea=Be.Ha,Re.Vd=Be.Ia,Re.fa=Be.R,Re.Rc=Be.B,Re.F=null,Re.J=0,!d5){for(Ve=-255;255>=Ve;++Ve)l5[255+Ve]=0>Ve?-Ve:Ve;for(Ve=-1020;1020>=Ve;++Ve)c5[1020+Ve]=-128>Ve?-128:127<Ve?127:Ve;for(Ve=-112;112>=Ve;++Ve)u5[112+Ve]=-16>Ve?-16:15<Ve?15:Ve;for(Ve=-255;510>=Ve;++Ve)A5[255+Ve]=0>Ve?0:255<Ve?255:Ve;d5=1}$l=oA,au=i1,wo=xo,Cr=D0,Qr=R0,di=s1,Cn=K0,Zn=Xc,al=ie,hf=Ce,fA=$0,W0=R,Z_=Fe,e5=Ke,t5=zc,r5=rf,n5=H0,a5=q0,Mi[0]=h1,Mi[1]=o1,Mi[2]=d1,Mi[3]=f1,Mi[4]=Wo,Mi[5]=p1,Mi[6]=zo,Mi[7]=m1,Mi[8]=Yd,Mi[9]=lA,Vl[0]=u1,Vl[1]=c1,Vl[2]=zd,Vl[3]=Q0,Vl[4]=Gc,Vl[5]=Xd,Vl[6]=A1,sl[0]=x1,sl[1]=l1,sl[2]=Wc,sl[3]=g1,sl[4]=Zd,sl[5]=Jd,sl[6]=M0,Ve=1}else Ve=0}Ve&&(Ve=function(mr,ea){for(mr.M=0;mr.M<mr.Va;++mr.M){var ar,It=mr.Jc[mr.M&mr.Xb],vt=mr.m,En=mr;for(ar=0;ar<En.za;++ar){var Zt=vt,gr=En,zr=gr.Ac,Ca=gr.Bc+4*ar,ls=gr.zc,gn=gr.ya[gr.aa+ar];if(gr.Qa.Bb?gn.$b=z(Zt,gr.Pa.jb[0])?2+z(Zt,gr.Pa.jb[2]):z(Zt,gr.Pa.jb[1]):gn.$b=0,gr.kc&&(gn.Ad=z(Zt,gr.Bd)),gn.Za=!z(Zt,145)+0,gn.Za){var Qa=gn.Ob,cs=0;for(gr=0;4>gr;++gr){var ta,vr=ls[0+gr];for(ta=0;4>ta;++ta){vr=lL[zr[Ca+ta]][vr];for(var Sr=m5[z(Zt,vr[0])];0<Sr;)Sr=m5[2*Sr+z(Zt,vr[Sr])];vr=-Sr,zr[Ca+ta]=vr}n(Qa,cs,zr,Ca,4),cs+=4,ls[0+gr]=vr}}else vr=z(Zt,156)?z(Zt,128)?1:3:z(Zt,163)?2:0,gn.Ob[0]=vr,a(zr,Ca,vr,4),a(ls,0,vr,4);gn.Dd=z(Zt,142)?z(Zt,114)?z(Zt,183)?1:3:2:0}if(En.m.Ka)return Rn(mr,7,"Premature end-of-partition0 encountered.");for(;mr.ja<mr.za;++mr.ja){if(En=It,Zt=(vt=mr).rb[vt.sb-1],zr=vt.rb[vt.sb+vt.ja],ar=vt.ya[vt.aa+vt.ja],Ca=vt.kc?ar.Ad:0)Zt.la=zr.la=0,ar.Za||(Zt.Na=zr.Na=0),ar.Hc=0,ar.Gc=0,ar.ia=0;else{var xn,kr;if(Zt=zr,zr=En,Ca=vt.Pa.Xc,ls=vt.ya[vt.aa+vt.ja],gn=vt.pb[ls.$b],gr=ls.ad,Qa=0,cs=vt.rb[vt.sb-1],vr=ta=0,a(gr,Qa,0,384),ls.Za)var Ea=0,Hi=Ca[3];else{Sr=s(16);var Sn=Zt.Na+cs.Na;if(Sn=mf(zr,Ca[1],Sn,gn.Eb,0,Sr,0),Zt.Na=cs.Na=(0<Sn)+0,1<Sn)$l(Sr,0,gr,Qa);else{var Ns=Sr[0]+3>>3;for(Sr=0;256>Sr;Sr+=16)gr[Qa+Sr]=Ns}Ea=1,Hi=Ca[0]}var Mr=15&Zt.la,ra=15&cs.la;for(Sr=0;4>Sr;++Sr){var Qs=1&ra;for(Ns=kr=0;4>Ns;++Ns)Mr=Mr>>1|(Qs=(Sn=mf(zr,Hi,Sn=Qs+(1&Mr),gn.Sc,Ea,gr,Qa))>Ea)<<7,kr=kr<<2|(3<Sn?3:1<Sn?2:gr[Qa+0]!=0),Qa+=16;Mr>>=4,ra=ra>>1|Qs<<7,ta=(ta<<8|kr)>>>0}for(Hi=Mr,Ea=ra>>4,xn=0;4>xn;xn+=2){for(kr=0,Mr=Zt.la>>4+xn,ra=cs.la>>4+xn,Sr=0;2>Sr;++Sr){for(Qs=1&ra,Ns=0;2>Ns;++Ns)Sn=Qs+(1&Mr),Mr=Mr>>1|(Qs=0<(Sn=mf(zr,Ca[2],Sn,gn.Qc,0,gr,Qa)))<<3,kr=kr<<2|(3<Sn?3:1<Sn?2:gr[Qa+0]!=0),Qa+=16;Mr>>=2,ra=ra>>1|Qs<<5}vr|=kr<<4*xn,Hi|=Mr<<4<<xn,Ea|=(240&ra)<<xn}Zt.la=Hi,cs.la=Ea,ls.Hc=ta,ls.Gc=vr,ls.ia=43690&vr?0:gn.ia,Ca=!(ta|vr)}if(0<vt.L&&(vt.wa[vt.Y+vt.ja]=vt.gd[ar.$b][ar.Za],vt.wa[vt.Y+vt.ja].La|=!Ca),En.Ka)return Rn(mr,7,"Premature end-of-file encountered.")}if(U0(mr),vt=ea,En=1,ar=(It=mr).D,Zt=0<It.L&&It.M>=It.zb&&It.M<=It.Va,It.Aa==0)t:{if(ar.M=It.M,ar.uc=Zt,Ai(It,ar),En=1,ar=(kr=It.D).Nb,Zt=(vr=np[It.L])*It.R,zr=vr/2*It.B,Sr=16*ar*It.R,Ns=8*ar*It.B,Ca=It.sa,ls=It.ta-Zt+Sr,gn=It.qa,gr=It.ra-zr+Ns,Qa=It.Ha,cs=It.Ia-zr+Ns,ra=(Mr=kr.M)==0,ta=Mr>=It.Va-1,It.Aa==2&&Ai(It,kr),kr.uc)for(Qs=(Sn=It).D.M,t(Sn.D.uc),kr=Sn.yb;kr<Sn.Hb;++kr){Ea=kr,Hi=Qs;var us=(Ms=(Sa=Sn).D).Nb;xn=Sa.R;var Ms=Ms.wa[Ms.Y+Ea],Hs=Sa.sa,Bs=Sa.ta+16*us*xn+16*Ea,qs=Ms.dd,Kr=Ms.tc;if(Kr!=0)if(t(3<=Kr),Sa.L==1)0<Ea&&r5(Hs,Bs,xn,Kr+4),Ms.La&&a5(Hs,Bs,xn,Kr),0<Hi&&t5(Hs,Bs,xn,Kr+4),Ms.La&&n5(Hs,Bs,xn,Kr);else{var Ks=Sa.B,qi=Sa.qa,su=Sa.ra+8*us*Ks+8*Ea,il=Sa.Ha,Sa=Sa.Ia+8*us*Ks+8*Ea;us=Ms.ld,0<Ea&&(Zn(Hs,Bs,xn,Kr+4,qs,us),hf(qi,su,il,Sa,Ks,Kr+4,qs,us)),Ms.La&&(W0(Hs,Bs,xn,Kr,qs,us),e5(qi,su,il,Sa,Ks,Kr,qs,us)),0<Hi&&(Cn(Hs,Bs,xn,Kr+4,qs,us),al(qi,su,il,Sa,Ks,Kr+4,qs,us)),Ms.La&&(fA(Hs,Bs,xn,Kr,qs,us),Z_(qi,su,il,Sa,Ks,Kr,qs,us))}}if(It.ia&&alert("todo:DitherRow"),vt.put!=null){if(kr=16*Mr,Mr=16*(Mr+1),ra?(vt.y=It.sa,vt.O=It.ta+Sr,vt.f=It.qa,vt.N=It.ra+Ns,vt.ea=It.Ha,vt.W=It.Ia+Ns):(kr-=vr,vt.y=Ca,vt.O=ls,vt.f=gn,vt.N=gr,vt.ea=Qa,vt.W=cs),ta||(Mr-=vr),Mr>vt.o&&(Mr=vt.o),vt.F=null,vt.J=null,It.Fa!=null&&0<It.Fa.length&&kr<Mr&&(vt.J=qr(It,vt,kr,Mr-kr),vt.F=It.mb,vt.F==null&&vt.F.length==0)){En=Rn(It,3,"Could not decode alpha data.");break t}kr<vt.j&&(vr=vt.j-kr,kr=vt.j,t(!(1&vr)),vt.O+=It.R*vr,vt.N+=It.B*(vr>>1),vt.W+=It.B*(vr>>1),vt.F!=null&&(vt.J+=vt.width*vr)),kr<Mr&&(vt.O+=vt.v,vt.N+=vt.v>>1,vt.W+=vt.v>>1,vt.F!=null&&(vt.J+=vt.v),vt.ka=kr-vt.j,vt.U=vt.va-vt.v,vt.T=Mr-kr,En=vt.put(vt))}ar+1!=It.Ic||ta||(n(It.sa,It.ta-Zt,Ca,ls+16*It.R,Zt),n(It.qa,It.ra-zr,gn,gr+8*It.B,zr),n(It.Ha,It.Ia-zr,Qa,cs+8*It.B,zr))}if(!En)return Rn(mr,6,"Output aborted.")}return 1}(Be,Re)),Re.bc!=null&&Re.bc(Re),Ve&=1}return Ve?(Be.cb=0,Ve):0})(N,Y)||(F=N.a)}}else F=N.a}F==0&&Ae.Oa!=null&&Ae.Oa.fd&&(F=lf(Ae.ba))}Ae=F}ue=Ae!=0?null:11>ue?ge.f.RGBA.eb:ge.f.kb.y}else ue=null;return ue};var N5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(E,T){for(var S="",j=0;j<4;j++)S+=String.fromCharCode(E[T++]);return S}function A(E,T){return E[T+0]|E[T+1]<<8}function h(E,T){return(E[T+0]|E[T+1]<<8|E[T+2]<<16)>>>0}function f(E,T){return(E[T+0]|E[T+1]<<8|E[T+2]<<16|E[T+3]<<24)>>>0}new c;var d=[0],v=[0],g=[],y=new c,p=e,m=function(E,T){var S={},j=0,I=!1,U=0,q=0;if(S.frames=[],!function(C,L){for(var O=0;O<4;O++)if(C[L+O]!="RIFF".charCodeAt(O))return!0;return!1}(E,T)){for(f(E,T+=4),T+=8;T<E.length;){var V=u(E,T),X=f(E,T+=4);T+=4;var W=X+(1&X);switch(V){case"VP8 ":case"VP8L":S.frames[j]===void 0&&(S.frames[j]={}),(H=S.frames[j]).src_off=I?q:T-8,H.src_size=U+X+8,j++,I&&(I=!1,U=0,q=0);break;case"VP8X":(H=S.header={}).feature_flags=E[T];var M=T+4;H.canvas_width=1+h(E,M),M+=3,H.canvas_height=1+h(E,M),M+=3;break;case"ALPH":I=!0,U=W+8,q=T-8;break;case"ANIM":(H=S.header).bgcolor=f(E,T),M=T+4,H.loop_count=A(E,M),M+=2;break;case"ANMF":var G,H;(H=S.frames[j]={}).offset_x=2*h(E,T),T+=3,H.offset_y=2*h(E,T),T+=3,H.width=1+h(E,T),T+=3,H.height=1+h(E,T),T+=3,H.duration=h(E,T),T+=3,G=E[T++],H.dispose=1&G,H.blend=G>>1&1}V!="ANMF"&&(T+=W)}return S}}(p,0);m.response=p,m.rgbaoutput=!0,m.dataurl=!1;var w=m.header?m.header:null,x=m.frames?m.frames:null;if(w){w.loop_counter=w.loop_count,d=[w.canvas_height],v=[w.canvas_width];for(var b=0;b<x.length&&x[b].blend!=0;b++);}var B=x[0],_=y.WebPDecodeRGBA(p,B.src_off,B.src_size,v,d);B.rgba=_,B.imgwidth=v[0],B.imgheight=d[0];for(var k=0;k<v[0]*d[0]*4;k++)g[k]=_[k];return this.width=v,this.height=d,this.data=g,this}(function(e){var t,r,n,a,s,o,l,c,u,A=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new c,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new o,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new o,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new A}]);var h=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var L=C;Object.defineProperty(this,"pdf",{get:function(){return L}});var O=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return O},set:function(ae){O=!!ae}});var D=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return D},set:function(ae){D=!!ae}});var P=0;Object.defineProperty(this,"posX",{get:function(){return P},set:function(ae){isNaN(ae)||(P=ae)}});var Q=0;Object.defineProperty(this,"posY",{get:function(){return Q},set:function(ae){isNaN(ae)||(Q=ae)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(ae){var Ie;typeof ae=="number"?Ie=[ae,ae,ae,ae]:((Ie=new Array(4))[0]=ae[0],Ie[1]=ae.length>=2?ae[1]:Ie[0],Ie[2]=ae.length>=3?ae[2]:Ie[0],Ie[3]=ae.length>=4?ae[3]:Ie[1]),u.margin=Ie}});var J=!1;Object.defineProperty(this,"autoPaging",{get:function(){return J},set:function(ae){J=ae}});var te=0;Object.defineProperty(this,"lastBreak",{get:function(){return te},set:function(ae){te=ae}});var z=[];Object.defineProperty(this,"pageBreaks",{get:function(){return z},set:function(ae){z=ae}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(ae){ae instanceof A&&(u=ae)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(ae){u.path=ae}});var ye=[];Object.defineProperty(this,"ctxStack",{get:function(){return ye},set:function(ae){ye=ae}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ae){var Ie;Ie=f(ae),this.ctx.fillStyle=Ie.style,this.ctx.isFillTransparent=Ie.a===0,this.ctx.fillOpacity=Ie.a,this.pdf.setFillColor(Ie.r,Ie.g,Ie.b,{a:Ie.a}),this.pdf.setTextColor(Ie.r,Ie.g,Ie.b,{a:Ie.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ae){var Ie=f(ae);this.ctx.strokeStyle=Ie.style,this.ctx.isStrokeTransparent=Ie.a===0,this.ctx.strokeOpacity=Ie.a,Ie.a===0?this.pdf.setDrawColor(255,255,255):(Ie.a,this.pdf.setDrawColor(Ie.r,Ie.g,Ie.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ae){["butt","round","square"].indexOf(ae)!==-1&&(this.ctx.lineCap=ae,this.pdf.setLineCap(ae))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ae){isNaN(ae)||(this.ctx.lineWidth=ae,this.pdf.setLineWidth(ae))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ae){["bevel","round","miter"].indexOf(ae)!==-1&&(this.ctx.lineJoin=ae,this.pdf.setLineJoin(ae))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ae){isNaN(ae)||(this.ctx.miterLimit=ae,this.pdf.setMiterLimit(ae))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ae){this.ctx.textBaseline=ae}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ae){["right","end","center","left","start"].indexOf(ae)!==-1&&(this.ctx.textAlign=ae)}});var re=null,ke=null,be=null;Object.defineProperty(this,"fontFaces",{get:function(){return be},set:function(ae){re=null,ke=null,be=ae}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ae){var Ie;if(this.ctx.font=ae,(Ie=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(ae))!==null){var De=Ie[1];Ie[2];var pe=Ie[3],we=Ie[4];Ie[5];var Te=Ie[6],he=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(we)[2];we=Math.floor(he==="px"?parseFloat(we)*this.pdf.internal.scaleFactor:he==="em"?parseFloat(we)*this.pdf.getFontSize():parseFloat(we)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(we);var ce=function(Ye){var Nt,xt,it=[],ut=Ye.trim();if(ut==="")return uy;if(ut in vE)return[vE[ut]];for(;ut!=="";){switch(xt=null,Nt=(ut=wE(ut)).charAt(0)){case'"':case"'":xt=Bie(ut.substring(1),Nt);break;default:xt=Cie(ut)}if(xt===null||(it.push(xt[0]),(ut=wE(xt[1]))!==""&&ut.charAt(0)!==","))return uy;ut=ut.replace(/^,/,"")}return it}(Te);if(this.fontFaces){var Se=function(Ye,Nt){var xt=Ye.getFontList(),it=JSON.stringify(xt);if(re===null||ke!==it){var ut=function(Mt){var ht=[];return Object.keys(Mt).forEach(function(Et){Mt[Et].forEach(function(mt){var _t=null;switch(mt){case"bold":_t={family:Et,weight:"bold"};break;case"italic":_t={family:Et,style:"italic"};break;case"bolditalic":_t={family:Et,weight:"bold",style:"italic"};break;case"":case"normal":_t={family:Et}}_t!==null&&(_t.ref={name:Et,style:mt},ht.push(_t))})}),ht}(xt);re=function(Mt){for(var ht={},Et=0;Et<Mt.length;++Et){var mt=cy(Mt[Et]),_t=mt.family,Ht=mt.stretch,bt=mt.style,Ct=mt.weight;ht[_t]=ht[_t]||{},ht[_t][Ht]=ht[_t][Ht]||{},ht[_t][Ht][bt]=ht[_t][Ht][bt]||{},ht[_t][Ht][bt][Ct]=mt}return ht}(ut.concat(Nt)),ke=it}return re}(this.pdf,this.fontFaces),Pe=ce.map(function(Ye){return{family:Ye,stretch:"normal",weight:pe,style:De}}),Le=function(Ye,Nt,xt){for(var it=(xt=xt||{}).defaultFontFamily||"times",ut=Object.assign({},Nie,xt.genericFontFamilies||{}),Mt=null,ht=null,Et=0;Et<Nt.length;++Et)if(ut[(Mt=cy(Nt[Et])).family]&&(Mt.family=ut[Mt.family]),Ye.hasOwnProperty(Mt.family)){ht=Ye[Mt.family];break}if(!(ht=ht||Ye[it]))throw new Error("Could not find a font-family for the rule '"+yE(Mt)+"' and default family '"+it+"'.");if(ht=function(mt,_t){if(_t[mt])return _t[mt];var Ht=w2[mt],bt=Ht<=w2.normal?-1:1,Ct=xE(_t,KI,Ht,bt);if(!Ct)throw new Error("Could not find a matching font-stretch value for "+mt);return Ct}(Mt.stretch,ht),ht=function(mt,_t){if(_t[mt])return _t[mt];for(var Ht=qI[mt],bt=0;bt<Ht.length;++bt)if(_t[Ht[bt]])return _t[Ht[bt]];throw new Error("Could not find a matching font-style for "+mt)}(Mt.style,ht),!(ht=function(mt,_t){if(_t[mt])return _t[mt];if(mt===400&&_t[500])return _t[500];if(mt===500&&_t[400])return _t[400];var Ht=_ie[mt],bt=xE(_t,$I,Ht,mt<400?-1:1);if(!bt)throw new Error("Could not find a matching font-weight for value "+mt);return bt}(Mt.weight,ht)))throw new Error("Failed to resolve a font for the rule '"+yE(Mt)+"'.");return ht}(Se,Pe);this.pdf.setFont(Le.ref.name,Le.ref.style)}else{var Xe="";(pe==="bold"||parseInt(pe,10)>=700||De==="bold")&&(Xe="bold"),De==="italic"&&(Xe+="italic"),Xe.length===0&&(Xe="normal");for(var fe="",Ee={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},qe=0;qe<ce.length;qe++){if(this.pdf.internal.getFont(ce[qe],Xe,{noFallback:!0,disableWarning:!0})!==void 0){fe=ce[qe];break}if(Xe==="bolditalic"&&this.pdf.internal.getFont(ce[qe],"bold",{noFallback:!0,disableWarning:!0})!==void 0)fe=ce[qe],Xe="bold";else if(this.pdf.internal.getFont(ce[qe],"normal",{noFallback:!0,disableWarning:!0})!==void 0){fe=ce[qe],Xe="normal";break}}if(fe===""){for(var Qe=0;Qe<ce.length;Qe++)if(Ee[ce[Qe]]){fe=Ee[ce[Qe]];break}}fe=fe===""?"Times":fe,this.pdf.setFont(fe,Xe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ae){this.ctx.globalCompositeOperation=ae}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ae){this.ctx.globalAlpha=ae}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ae){this.ctx.lineDashOffset=ae,H.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ae){this.ctx.lineDash=ae,H.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ae){this.ctx.ignoreClearRect=!!ae}})};h.prototype.setLineDash=function(C){this.lineDash=C},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){x.call(this,"fill",!1)},h.prototype.stroke=function(){x.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(C,L){if(isNaN(C)||isNaN(L))throw Hr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var O=this.ctx.transform.applyToPoint(new o(C,L));this.path.push({type:"mt",x:O.x,y:O.y}),this.ctx.lastPoint=new o(C,L)},h.prototype.closePath=function(){var C=new o(0,0),L=0;for(L=this.path.length-1;L!==-1;L--)if(this.path[L].type==="begin"&&Ir(this.path[L+1])==="object"&&typeof this.path[L+1].x=="number"){C=new o(this.path[L+1].x,this.path[L+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(C.x,C.y)},h.prototype.lineTo=function(C,L){if(isNaN(C)||isNaN(L))throw Hr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var O=this.ctx.transform.applyToPoint(new o(C,L));this.path.push({type:"lt",x:O.x,y:O.y}),this.ctx.lastPoint=new o(O.x,O.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),x.call(this,null,!0)},h.prototype.quadraticCurveTo=function(C,L,O,D){if(isNaN(O)||isNaN(D)||isNaN(C)||isNaN(L))throw Hr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var P=this.ctx.transform.applyToPoint(new o(O,D)),Q=this.ctx.transform.applyToPoint(new o(C,L));this.path.push({type:"qct",x1:Q.x,y1:Q.y,x:P.x,y:P.y}),this.ctx.lastPoint=new o(P.x,P.y)},h.prototype.bezierCurveTo=function(C,L,O,D,P,Q){if(isNaN(P)||isNaN(Q)||isNaN(C)||isNaN(L)||isNaN(O)||isNaN(D))throw Hr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var J=this.ctx.transform.applyToPoint(new o(P,Q)),te=this.ctx.transform.applyToPoint(new o(C,L)),z=this.ctx.transform.applyToPoint(new o(O,D));this.path.push({type:"bct",x1:te.x,y1:te.y,x2:z.x,y2:z.y,x:J.x,y:J.y}),this.ctx.lastPoint=new o(J.x,J.y)},h.prototype.arc=function(C,L,O,D,P,Q){if(isNaN(C)||isNaN(L)||isNaN(O)||isNaN(D)||isNaN(P))throw Hr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Q=!!Q,!this.ctx.transform.isIdentity){var J=this.ctx.transform.applyToPoint(new o(C,L));C=J.x,L=J.y;var te=this.ctx.transform.applyToPoint(new o(0,O)),z=this.ctx.transform.applyToPoint(new o(0,0));O=Math.sqrt(Math.pow(te.x-z.x,2)+Math.pow(te.y-z.y,2))}Math.abs(P-D)>=2*Math.PI&&(D=0,P=2*Math.PI),this.path.push({type:"arc",x:C,y:L,radius:O,startAngle:D,endAngle:P,counterclockwise:Q})},h.prototype.arcTo=function(C,L,O,D,P){throw new Error("arcTo not implemented.")},h.prototype.rect=function(C,L,O,D){if(isNaN(C)||isNaN(L)||isNaN(O)||isNaN(D))throw Hr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,L),this.lineTo(C+O,L),this.lineTo(C+O,L+D),this.lineTo(C,L+D),this.lineTo(C,L),this.lineTo(C+O,L),this.lineTo(C,L)},h.prototype.fillRect=function(C,L,O,D){if(isNaN(C)||isNaN(L)||isNaN(O)||isNaN(D))throw Hr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var P={};this.lineCap!=="butt"&&(P.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(P.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,L,O,D),this.fill(),P.hasOwnProperty("lineCap")&&(this.lineCap=P.lineCap),P.hasOwnProperty("lineJoin")&&(this.lineJoin=P.lineJoin)}},h.prototype.strokeRect=function(C,L,O,D){if(isNaN(C)||isNaN(L)||isNaN(O)||isNaN(D))throw Hr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(C,L,O,D),this.stroke())},h.prototype.clearRect=function(C,L,O,D){if(isNaN(C)||isNaN(L)||isNaN(O)||isNaN(D))throw Hr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,L,O,D))},h.prototype.save=function(C){C=typeof C!="boolean"||C;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("q");if(this.pdf.setPage(L),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var D=new A(this.ctx);this.ctxStack.push(this.ctx),this.ctx=D}},h.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("Q");this.pdf.setPage(L),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(C){var L,O,D,P;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))L=0,O=0,D=0,P=0;else{var Q=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(Q!==null)L=parseInt(Q[1]),O=parseInt(Q[2]),D=parseInt(Q[3]),P=1;else if((Q=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)L=parseInt(Q[1]),O=parseInt(Q[2]),D=parseInt(Q[3]),P=parseFloat(Q[4]);else{if(P=1,typeof C=="string"&&C.charAt(0)!=="#"){var J=new UI(C);C=J.ok?J.toHex():"#000000"}C.length===4?(L=C.substring(1,2),L+=L,O=C.substring(2,3),O+=O,D=C.substring(3,4),D+=D):(L=C.substring(1,3),O=C.substring(3,5),D=C.substring(5,7)),L=parseInt(L,16),O=parseInt(O,16),D=parseInt(D,16)}}return{r:L,g:O,b:D,a:P,style:C}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(C,L,O,D){if(isNaN(L)||isNaN(O)||typeof C!="string")throw Hr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(D=isNaN(D)?void 0:D,!d.call(this)){var P=W(this.ctx.transform.rotation),Q=this.ctx.transform.scaleX;j.call(this,{text:C,x:L,y:O,scale:Q,angle:P,align:this.textAlign,maxWidth:D})}},h.prototype.strokeText=function(C,L,O,D){if(isNaN(L)||isNaN(O)||typeof C!="string")throw Hr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){D=isNaN(D)?void 0:D;var P=W(this.ctx.transform.rotation),Q=this.ctx.transform.scaleX;j.call(this,{text:C,x:L,y:O,scale:Q,renderingMode:"stroke",angle:P,align:this.textAlign,maxWidth:D})}},h.prototype.measureText=function(C){if(typeof C!="string")throw Hr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var L=this.pdf,O=this.pdf.internal.scaleFactor,D=L.internal.getFontSize(),P=L.getStringUnitWidth(C)*D/L.internal.scaleFactor;return new function(Q){var J=(Q=Q||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return J}}),this}({width:P*=Math.round(96*O/72*1e4)/1e4})},h.prototype.scale=function(C,L){if(isNaN(C)||isNaN(L))throw Hr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var O=new c(C,0,0,L,0,0);this.ctx.transform=this.ctx.transform.multiply(O)},h.prototype.rotate=function(C){if(isNaN(C))throw Hr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var L=new c(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(L)},h.prototype.translate=function(C,L){if(isNaN(C)||isNaN(L))throw Hr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var O=new c(1,0,0,1,C,L);this.ctx.transform=this.ctx.transform.multiply(O)},h.prototype.transform=function(C,L,O,D,P,Q){if(isNaN(C)||isNaN(L)||isNaN(O)||isNaN(D)||isNaN(P)||isNaN(Q))throw Hr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var J=new c(C,L,O,D,P,Q);this.ctx.transform=this.ctx.transform.multiply(J)},h.prototype.setTransform=function(C,L,O,D,P,Q){C=isNaN(C)?1:C,L=isNaN(L)?0:L,O=isNaN(O)?0:O,D=isNaN(D)?1:D,P=isNaN(P)?0:P,Q=isNaN(Q)?0:Q,this.ctx.transform=new c(C,L,O,D,P,Q)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(C,L,O,D,P,Q,J,te,z){var ye=this.pdf.getImageProperties(C),re=1,ke=1,be=1,ae=1;D!==void 0&&te!==void 0&&(be=te/D,ae=z/P,re=ye.width/D*te/D,ke=ye.height/P*z/P),Q===void 0&&(Q=L,J=O,L=0,O=0),D!==void 0&&te===void 0&&(te=D,z=P),D===void 0&&te===void 0&&(te=ye.width,z=ye.height);var Ie=this.ctx.transform.decompose(),De=W(Ie.rotate.shx),pe=new c,we=(pe=(pe=(pe=pe.multiply(Ie.translate)).multiply(Ie.skew)).multiply(Ie.scale)).applyToRectangle(new l(Q-L*be,J-O*ae,D*re,P*ke));if(this.autoPaging){for(var Te,he=y.call(this,we),ce=[],Se=0;Se<he.length;Se+=1)ce.indexOf(he[Se])===-1&&ce.push(he[Se]);w(ce);for(var Pe=ce[0],Le=ce[ce.length-1],Xe=Pe;Xe<Le+1;Xe++){this.pdf.setPage(Xe);var fe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ee=Xe===1?this.posY+this.margin[0]:this.margin[0],qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ye=Xe===1?0:qe+(Xe-2)*Qe;if(this.ctx.clip_path.length!==0){var Nt=this.path;Te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=m(Te,this.posX+this.margin[3],-Ye+Ee+this.ctx.prevPageLastElemOffset),b.call(this,"fill",!0),this.path=Nt}var xt=JSON.parse(JSON.stringify(we));xt=m([xt],this.posX+this.margin[3],-Ye+Ee+this.ctx.prevPageLastElemOffset)[0];var it=(Xe>Pe||Xe<Le)&&g.call(this);it&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],fe,Qe,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",xt.x,xt.y,xt.w,xt.h,null,null,De),it&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(C,"JPEG",we.x,we.y,we.w,we.h,null,null,De)};var y=function(C,L,O){var D=[];L=L||this.pdf.internal.pageSize.width,O=O||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var P=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":D.push(Math.floor((C.y+P)/O)+1);break;case"arc":D.push(Math.floor((C.y+P-C.radius)/O)+1),D.push(Math.floor((C.y+P+C.radius)/O)+1);break;case"qct":var Q=M(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);D.push(Math.floor((Q.y+P)/O)+1),D.push(Math.floor((Q.y+Q.h+P)/O)+1);break;case"bct":var J=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);D.push(Math.floor((J.y+P)/O)+1),D.push(Math.floor((J.y+J.h+P)/O)+1);break;case"rect":D.push(Math.floor((C.y+P)/O)+1),D.push(Math.floor((C.y+C.h+P)/O)+1)}for(var te=0;te<D.length;te+=1)for(;this.pdf.internal.getNumberOfPages()<D[te];)p.call(this);return D},p=function(){var C=this.fillStyle,L=this.strokeStyle,O=this.font,D=this.lineCap,P=this.lineWidth,Q=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=L,this.font=O,this.lineCap=D,this.lineWidth=P,this.lineJoin=Q},m=function(C,L,O){for(var D=0;D<C.length;D++)switch(C[D].type){case"bct":C[D].x2+=L,C[D].y2+=O;case"qct":C[D].x1+=L,C[D].y1+=O;default:C[D].x+=L,C[D].y+=O}return C},w=function(C){return C.sort(function(L,O){return L-O})},x=function(C,L){var O=this.fillStyle,D=this.strokeStyle,P=this.lineCap,Q=this.lineWidth,J=Math.abs(Q*this.ctx.transform.scaleX),te=this.lineJoin;if(this.autoPaging){for(var z,ye,re=JSON.parse(JSON.stringify(this.path)),ke=JSON.parse(JSON.stringify(this.path)),be=[],ae=0;ae<ke.length;ae++)if(ke[ae].x!==void 0)for(var Ie=y.call(this,ke[ae]),De=0;De<Ie.length;De+=1)be.indexOf(Ie[De])===-1&&be.push(Ie[De]);for(var pe=0;pe<be.length;pe++)for(;this.pdf.internal.getNumberOfPages()<be[pe];)p.call(this);w(be);for(var we=be[0],Te=be[be.length-1],he=we;he<Te+1;he++){this.pdf.setPage(he),this.fillStyle=O,this.strokeStyle=D,this.lineCap=P,this.lineWidth=J,this.lineJoin=te;var ce=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Se=he===1?this.posY+this.margin[0]:this.margin[0],Pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Le=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xe=he===1?0:Pe+(he-2)*Le;if(this.ctx.clip_path.length!==0){var fe=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=m(z,this.posX+this.margin[3],-Xe+Se+this.ctx.prevPageLastElemOffset),b.call(this,C,!0),this.path=fe}if(ye=JSON.parse(JSON.stringify(re)),this.path=m(ye,this.posX+this.margin[3],-Xe+Se+this.ctx.prevPageLastElemOffset),L===!1||he===0){var Ee=(he>we||he<Te)&&g.call(this);Ee&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ce,Le,null).clip().discardPath()),b.call(this,C,L),Ee&&this.pdf.restoreGraphicsState()}this.lineWidth=Q}this.path=re}else this.lineWidth=J,b.call(this,C,L),this.lineWidth=Q},b=function(C,L){if((C!=="stroke"||L||!v.call(this))&&(C==="stroke"||L||!d.call(this))){for(var O,D,P=[],Q=this.path,J=0;J<Q.length;J++){var te=Q[J];switch(te.type){case"begin":P.push({begin:!0});break;case"close":P.push({close:!0});break;case"mt":P.push({start:te,deltas:[],abs:[]});break;case"lt":var z=P.length;if(Q[J-1]&&!isNaN(Q[J-1].x)&&(O=[te.x-Q[J-1].x,te.y-Q[J-1].y],z>0)){for(;z>=0;z--)if(P[z-1].close!==!0&&P[z-1].begin!==!0){P[z-1].deltas.push(O),P[z-1].abs.push(te);break}}break;case"bct":O=[te.x1-Q[J-1].x,te.y1-Q[J-1].y,te.x2-Q[J-1].x,te.y2-Q[J-1].y,te.x-Q[J-1].x,te.y-Q[J-1].y],P[P.length-1].deltas.push(O);break;case"qct":var ye=Q[J-1].x+2/3*(te.x1-Q[J-1].x),re=Q[J-1].y+2/3*(te.y1-Q[J-1].y),ke=te.x+2/3*(te.x1-te.x),be=te.y+2/3*(te.y1-te.y),ae=te.x,Ie=te.y;O=[ye-Q[J-1].x,re-Q[J-1].y,ke-Q[J-1].x,be-Q[J-1].y,ae-Q[J-1].x,Ie-Q[J-1].y],P[P.length-1].deltas.push(O);break;case"arc":P.push({deltas:[],abs:[],arc:!0}),Array.isArray(P[P.length-1].abs)&&P[P.length-1].abs.push(te)}}D=L?null:C==="stroke"?"stroke":"fill";for(var De=!1,pe=0;pe<P.length;pe++)if(P[pe].arc)for(var we=P[pe].abs,Te=0;Te<we.length;Te++){var he=we[Te];he.type==="arc"?k.call(this,he.x,he.y,he.radius,he.startAngle,he.endAngle,he.counterclockwise,void 0,L,!De):I.call(this,he.x,he.y),De=!0}else if(P[pe].close===!0)this.pdf.internal.out("h"),De=!1;else if(P[pe].begin!==!0){var ce=P[pe].start.x,Se=P[pe].start.y;U.call(this,P[pe].deltas,ce,Se),De=!0}D&&E.call(this,D),L&&T.call(this)}},B=function(C){var L=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,O=L*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-O;case"top":return C+L-O;case"hanging":return C+L-2*O;case"middle":return C+L/2-O;default:return C}},_=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(L,O){this.colorStops.push([L,O])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var k=function(C,L,O,D,P,Q,J,te,z){for(var ye=V.call(this,O,D,P,Q),re=0;re<ye.length;re++){var ke=ye[re];re===0&&(z?S.call(this,ke.x1+C,ke.y1+L):I.call(this,ke.x1+C,ke.y1+L)),q.call(this,C,L,ke.x2,ke.y2,ke.x3,ke.y3,ke.x4,ke.y4)}te?T.call(this):E.call(this,J)},E=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},T=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(C,L){this.pdf.internal.out(r(C)+" "+n(L)+" m")},j=function(C){var L;switch(C.align){case"right":case"end":L="right";break;case"center":L="center";break;default:L="left"}var O,D,P,Q=this.pdf.getTextDimensions(C.text),J=B.call(this,C.y),te=_.call(this,J)-Q.h,z=this.ctx.transform.applyToPoint(new o(C.x,J));if(this.autoPaging){var ye=this.ctx.transform.decompose(),re=new c;re=(re=(re=re.multiply(ye.translate)).multiply(ye.skew)).multiply(ye.scale);for(var ke=this.ctx.transform.applyToRectangle(new l(C.x,J,Q.w,Q.h)),be=re.applyToRectangle(new l(C.x,te,Q.w,Q.h)),ae=y.call(this,be),Ie=[],De=0;De<ae.length;De+=1)Ie.indexOf(ae[De])===-1&&Ie.push(ae[De]);w(Ie);for(var pe=Ie[0],we=Ie[Ie.length-1],Te=pe;Te<we+1;Te++){this.pdf.setPage(Te);var he=Te===1?this.posY+this.margin[0]:this.margin[0],ce=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Se=this.pdf.internal.pageSize.height-this.margin[2],Pe=Se-this.margin[0],Le=this.pdf.internal.pageSize.width-this.margin[1],Xe=Le-this.margin[3],fe=Te===1?0:ce+(Te-2)*Pe;if(this.ctx.clip_path.length!==0){var Ee=this.path;O=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=m(O,this.posX+this.margin[3],-1*fe+he),b.call(this,"fill",!0),this.path=Ee}var qe=m([JSON.parse(JSON.stringify(be))],this.posX+this.margin[3],-fe+he+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(D=this.pdf.internal.getFontSize(),this.pdf.setFontSize(D*C.scale),P=this.lineWidth,this.lineWidth=P*C.scale);var Qe=this.autoPaging!=="text";if(Qe||qe.y+qe.h<=Se){if(Qe||qe.y>=he&&qe.x<=Le){var Ye=Qe?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||Le-qe.x)[0],Nt=m([JSON.parse(JSON.stringify(ke))],this.posX+this.margin[3],-fe+he+this.ctx.prevPageLastElemOffset)[0],xt=Qe&&(Te>pe||Te<we)&&g.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xe,Pe,null).clip().discardPath()),this.pdf.text(Ye,Nt.x,Nt.y,{angle:C.angle,align:L,renderingMode:C.renderingMode}),xt&&this.pdf.restoreGraphicsState()}}else qe.y<Se&&(this.ctx.prevPageLastElemOffset+=Se-qe.y);C.scale>=.01&&(this.pdf.setFontSize(D),this.lineWidth=P)}}else C.scale>=.01&&(D=this.pdf.internal.getFontSize(),this.pdf.setFontSize(D*C.scale),P=this.lineWidth,this.lineWidth=P*C.scale),this.pdf.text(C.text,z.x+this.posX,z.y+this.posY,{angle:C.angle,align:L,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(D),this.lineWidth=P)},I=function(C,L,O,D){O=O||0,D=D||0,this.pdf.internal.out(r(C+O)+" "+n(L+D)+" l")},U=function(C,L,O){return this.pdf.lines(C,L,O,null,null)},q=function(C,L,O,D,P,Q,J,te){this.pdf.internal.out([t(a(O+C)),t(s(D+L)),t(a(P+C)),t(s(Q+L)),t(a(J+C)),t(s(te+L)),"c"].join(" "))},V=function(C,L,O,D){for(var P=2*Math.PI,Q=Math.PI/2;L>O;)L-=P;var J=Math.abs(O-L);J<P&&D&&(J=P-J);for(var te=[],z=D?-1:1,ye=L;J>1e-5;){var re=ye+z*Math.min(J,Q);te.push(X.call(this,C,ye,re)),J-=Math.abs(re-ye),ye=re}return te},X=function(C,L,O){var D=(O-L)/2,P=C*Math.cos(D),Q=C*Math.sin(D),J=P,te=-Q,z=J*J+te*te,ye=z+J*P+te*Q,re=4/3*(Math.sqrt(2*z*ye)-ye)/(J*Q-te*P),ke=J-re*te,be=te+re*J,ae=ke,Ie=-be,De=D+L,pe=Math.cos(De),we=Math.sin(De);return{x1:C*Math.cos(L),y1:C*Math.sin(L),x2:ke*pe-be*we,y2:ke*we+be*pe,x3:ae*pe-Ie*we,y3:ae*we+Ie*pe,x4:C*Math.cos(O),y4:C*Math.sin(O)}},W=function(C){return 180*C/Math.PI},M=function(C,L,O,D,P,Q){var J=C+.5*(O-C),te=L+.5*(D-L),z=P+.5*(O-P),ye=Q+.5*(D-Q),re=Math.min(C,P,J,z),ke=Math.max(C,P,J,z),be=Math.min(L,Q,te,ye),ae=Math.max(L,Q,te,ye);return new l(re,be,ke-re,ae-be)},G=function(C,L,O,D,P,Q,J,te){var z,ye,re,ke,be,ae,Ie,De,pe,we,Te,he,ce,Se,Pe=O-C,Le=D-L,Xe=P-O,fe=Q-D,Ee=J-P,qe=te-Q;for(ye=0;ye<41;ye++)pe=(Ie=(re=C+(z=ye/40)*Pe)+z*((be=O+z*Xe)-re))+z*(be+z*(P+z*Ee-be)-Ie),we=(De=(ke=L+z*Le)+z*((ae=D+z*fe)-ke))+z*(ae+z*(Q+z*qe-ae)-De),ye==0?(Te=pe,he=we,ce=pe,Se=we):(Te=Math.min(Te,pe),he=Math.min(he,we),ce=Math.max(ce,pe),Se=Math.max(Se,we));return new l(Math.round(Te),Math.round(he),Math.round(ce-Te),Math.round(Se-he))},H=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,L,O=(C=this.ctx.lineDash,L=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:L}));this.prevLineDash!==O&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=O)}}})(Ot.API),function(e){var t=function(o){var l,c,u,A,h,f,d,v,g,y;for(c=[],u=0,A=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;A>u;u+=4)(h=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(f=(h=((h=((h=((h=(h-(y=h%85))/85)-(g=h%85))/85)-(v=h%85))/85)-(d=h%85))/85)%85,c.push(f+33,d+33,v+33,g+33,y+33)):c.push(122);return function(p,m){for(var w=m;w>0;w--)p.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,A,h,f=String,d="length",v=255,g="charCodeAt",y="slice",p="replace";for(o[y](-2),o=o[y](0,-2)[p](/\s/g,"")[p]("z","!!!!!"),u=[],A=0,h=(o+=l="uuuuu"[y](o[d]%5||5))[d];h>A;A+=5)c=52200625*(o[g](A)-33)+614125*(o[g](A+1)-33)+7225*(o[g](A+2)-33)+85*(o[g](A+3)-33)+(o[g](A+4)-33),u.push(v&c>>24,v&c>>16,v&c>>8,v&c);return function(m,w){for(var x=w;x>0;x--)m.pop()}(u,l[d]),f.fromCharCode.apply(f,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=h2(l)).reduce(function(u,A){return u+String.fromCharCode(A)},"")};e.processDataByFilters=function(o,l){var c=0,u=o||"",A=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),A.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),A.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),A.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),A.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),A.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:A.reverse().join(" ")}}}(Ot.API),function(e){e.loadFile=function(t,r,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,A){var h=new XMLHttpRequest,f=0,d=function(v){var g=v.length,y=[],p=String.fromCharCode;for(f=0;f<g;f+=1)y.push(p(255&v.charCodeAt(f)));return y.join("")};if(h.open("GET",c,!u),h.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(h.onload=function(){h.status===200?A(d(this.responseText)):A(void 0)}),h.send(null),u&&h.status===200)return d(h.responseText)}(a,s,o)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Ot.API),function(e){function t(){return(Wt.html2canvas?Promise.resolve(Wt.html2canvas):$v(()=>Promise.resolve().then(()=>mde),void 0)).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Wt.DOMPurify?Promise.resolve(Wt.DOMPurify):$v(()=>Promise.resolve().then(()=>N$),void 0)).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Ir(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var u=document.createElement(l);for(var A in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[A]=c.style[A];return u},s=function l(c,u){for(var A=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),h=c.firstChild;h;h=h.nextSibling)u!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||A.appendChild(l(h,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(A.width=c.width,A.height=c.height,A.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(A.value=c.value),A.addEventListener("load",function(){A.scrollTop=c.scrollTop,A.scrollLeft=c.scrollLeft},!0)),A},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),A=l.convert(Promise.resolve(),u);return(A=A.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:a("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=this.opt.jsPDF,A=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=A,A)for(var d=0;d<A.length;++d){var v=A[d],g=v.src.find(function(y){return y.format==="truetype"});g&&u.addFont(g.url,v.ref.name,v.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,u.context2d.save(!0),c(this.prop.container,f)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,A){return Math.floor(u*A/72*96)}return this.then(function(){(l=l||Ot.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,A){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),A!=null&&(this.progress.stack=A),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,A){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,A?this.progress.stack.concat(A):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(A,h){return u.updateProgress(null,null,1,[A]),Promise.prototype.then.call(this,function(f){return u.updateProgress(null,A),f}).then(A,h).then(function(f){return u.updateProgress(1),f})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var A=this;l&&(l=l.bind(A)),c&&(c=c.bind(A));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?A:o.convert(Object.assign({},A),Promise.prototype),f=u.call(h,l,c);return o.convert(f,A.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Ot.getPageSize=function(l,c,u){if(Ir(l)==="object"){var A=l;l=A.orientation,c=A.unit||c,u=A.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var h,f=(""+u).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+c}var v,g=0,y=0;if(d.hasOwnProperty(f))g=d[f][1]/h,y=d[f][0]/h;else try{g=u[1],y=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",y>g&&(v=y,y=g,g=v);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(v=y,y=g,g=v)}return{width:y,height:g,unit:c,k:h,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(cy):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(Ot.API),Ot.API.addJS=function(e){return _E=e,this.internal.events.subscribe("postPutResources",function(){sm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(sm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),bE=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+_E+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){sm!==void 0&&bE!==void 0&&this.internal.out("/Names <</JavaScript "+sm+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,A=[];for(s=0;s<u;s++){var h=r.internal.newObject();A.push(h);var f=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var d=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<A.length;s++)r.internal.write("(page_"+(s+1)+")"+A[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+d+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(Ot.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,s,o,l){var c,u=this.decode.DCT_DECODE,A=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(h){for(var f,d=256*h.charCodeAt(4)+h.charCodeAt(5),v=h.length,g={width:0,height:0,numcomponents:1},y=4;y<v;y+=2){if(y+=d,t.indexOf(h.charCodeAt(y+1))!==-1){f=256*h.charCodeAt(y+5)+h.charCodeAt(y+6),g={width:256*h.charCodeAt(y+7)+h.charCodeAt(y+8),height:f,numcomponents:h.charCodeAt(y+9)};break}d=256*h.charCodeAt(y+2)+h.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}A={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:a}}return A}}(Ot.API),Ot.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,s=cie(e,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,A=s.depth;a=u&&c===1?function(k){for(var E=k.width,T=k.height,S=k.data,j=k.palette,I=k.depth,U=!1,q=[],V=[],X=void 0,W=!1,M=0,G=0;G<j.length;G++){var H=EC(j[G],4),C=H[0],L=H[1],O=H[2],D=H[3];q.push(C,L,O),D!=null&&(D===0?(M++,V.length<1&&V.push(G)):D<255&&(W=!0))}if(W||M>1){U=!0,V=void 0;var P=E*T;X=new Uint8Array(P);for(var Q=new DataView(S.buffer),J=0;J<P;J++){var te=Ay(Q,J,I),z=EC(j[te],4)[3];X[J]=z}}else M===0&&(V=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:U?8:void 0,colorBytes:S,alphaBytes:X,needSMask:U,palette:q,mask:V}}(s):c===2||c===4?function(k){for(var E=k.data,T=k.width,S=k.height,j=k.channels,I=k.depth,U=j===2?"DeviceGray":"DeviceRGB",q=j-1,V=T*S,X=q,W=V*X,M=1*V,G=Math.ceil(W*I/8),H=Math.ceil(M*I/8),C=new Uint8Array(G),L=new Uint8Array(H),O=new DataView(E.buffer),D=new DataView(C.buffer),P=new DataView(L.buffer),Q=!1,J=0;J<V;J++){for(var te=J*j,z=0;z<X;z++)TE(D,Ay(O,te+z,I),J*X+z,I);var ye=Ay(O,te+X,I);ye<(1<<I)-1&&(Q=!0),TE(P,ye,1*J,I)}return{colorSpace:U,colorsPerPixel:q,sMaskBitsPerComponent:Q?I:void 0,colorBytes:C,alphaBytes:L,needSMask:Q}}(s):function(k){var E=k.data,T=k.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:T,colorsPerPixel:T==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(S){for(var j=S.length,I=new Uint8Array(2*j),U=new DataView(I.buffer,I.byteOffset,I.byteLength),q=0;q<j;q++)U.setUint16(2*q,S[q],!1);return I}(E):E,needSMask:!1}}(s);var h,f,d,v=a,g=v.colorSpace,y=v.colorsPerPixel,p=v.sMaskBitsPerComponent,m=v.colorBytes,w=v.alphaBytes,x=v.needSMask,b=v.palette,B=v.mask,_=null;return n!==Ot.API.image_compression.NONE&&typeof h2=="function"?(_=function(k){var E;switch(k){case Ot.API.image_compression.FAST:E=11;break;case Ot.API.image_compression.MEDIUM:E=13;break;case Ot.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),h=this.decode.FLATE_DECODE,f="/Predictor ".concat(_," /Colors ").concat(y," /BitsPerComponent ").concat(A," /Columns ").concat(o),e=EE(m,Math.ceil(o*y*A/8),y,A,n),x&&(d=EE(w,Math.ceil(o*p/8),1,p,n))):(h=void 0,f=void 0,e=m,x&&(d=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:r,data:e,index:t,filter:h,decodeParameters:f,transparency:B,palette:b,sMask:d,predictor:_,width:o,height:l,bitsPerComponent:A,sMaskBitsPerComponent:p,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,a){var s=new jie(t),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},A=new dy(100).encode(u,100);return e.processJPEG.call(this,A,r,n,a)},e.processGIF87A=e.processGIF89A}(Ot.API),Vi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Vi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Hr.log("bit decode error:"+r)}},Vi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Vi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Vi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},Vi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,u=s>>15?255:0,A=n*this.width*4+4*a;this.data[A]=c,this.data[A+1]=l,this.data[A+2]=o,this.data[A+3]=u}this.pos+=e}},Vi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,A=a*this.width*4+4*s;this.data[A]=u,this.data[A+1]=c,this.data[A+2]=l,this.data[A+3]=255}this.pos+=e}},Vi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Vi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},Vi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var s=new Vi(t,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new dy(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}}(Ot.API),LE.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var s=new LE(t),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new dy(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}}(Ot.API),Ot.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,u=0;u<a;u+=4){var A=n[u],h=n[u+1],f=n[u+2],d=n[u+3];s[l++]=A,s[l++]=h,s[l++]=f,o[c++]=d}var v=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ot.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},CA=Ot.API,im=CA.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:a.metadata.Unicode.kerning,A=u.fof?u.fof:1,h=t.doKerning!==!1,f=0,d=e.length,v=0,g=l[0]||c,y=[];for(r=0;r<d;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?y.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(f=h&&Ir(u[n])==="object"&&!isNaN(parseInt(u[n][v],10))?u[n][v]/A:0,y.push((l[n]||g)/c+f)),v=n;return y},NE=CA.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return CA.processArabic&&(e=CA.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:im.apply(this,arguments).reduce(function(s,o){return s+o},0)},BE=function(e,t,r,n){for(var a=[],s=0,o=e.length,l=0;s!==o&&l+t[s]<r;)l+=t[s],s++;a.push(e.slice(0,s));var c=s;for(l=0;s!==o;)l+t[s]>n&&(a.push(e.slice(c,s)),l=0,c=s),l+=t[s],s++;return c!==s&&a.push(e.slice(c,s)),a},CE=function(e,t,r){r||(r={});var n,a,s,o,l,c,u,A=[],h=[A],f=r.textIndent||0,d=0,v=0,g=e.split(" "),y=im.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var p=Array(c).join(" "),m=[];g.map(function(x){(x=x.split(/\s*\n/)).length>1?m=m.concat(x.map(function(b,B){return(B&&b.length?`
`:"")+b})):m.push(x[0])}),g=m,c=NE.apply(this,[p,r])}for(s=0,o=g.length;s<o;s++){var w=0;if(n=g[s],c&&n[0]==`
`&&(n=n.substr(1),w=1),f+d+(v=(a=im.apply(this,[n,r])).reduce(function(x,b){return x+b},0))>t||w){if(v>t){for(l=BE.apply(this,[n,a,t-(f+d),t]),A.push(l.shift()),A=[l.pop()];l.length;)h.push([l.shift()]);v=a.slice(n.length-(A[0]?A[0].length:0)).reduce(function(x,b){return x+b},0)}else A=[n];h.push(A),f=v+c,d=y}else A.push(n),f+=d+v,d=y}return u=c?function(x,b){return(b?p:"")+x.join(" ")}:function(x){return x.join(" ")},h.map(u)},CA.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(A){if(A.widths&&A.kerning)return{widths:A.widths,kerning:A.kerning};var h=this.internal.getFont(A.fontName,A.fontStyle),f="Unicode";return h.metadata[f]?{widths:h.metadata[f].widths||{0:1},kerning:h.metadata[f].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(CE.apply(this,[n[l],o,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=t[s],a[t[s]]=r[s];var o=function(f){return"0x"+parseInt(f,10).toString(16)},l=e.__fontmetrics__.compress=function(f){var d,v,g,y,p=["{"];for(var m in f){if(d=f[m],isNaN(parseInt(m,10))?v="'"+m+"'":(m=parseInt(m,10),v=(v=o(m).slice(2)).slice(0,-1)+a[v.slice(-1)]),typeof d=="number")d<0?(g=o(d).slice(3),y="-"):(g=o(d).slice(2),y=""),g=y+g.slice(0,-1)+a[g.slice(-1)];else{if(Ir(d)!=="object")throw new Error("Don't know what to do with value type "+Ir(d)+".");g=l(d)}p.push(v+g)}return p.push("}"),p.join("")},c=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,v,g,y,p={},m=1,w=p,x=[],b="",B="",_=f.length-1,k=1;k<_;k+=1)(y=f[k])=="'"?d?(g=d.join(""),d=void 0):d=[]:d?d.push(y):y=="{"?(x.push([w,g]),w={},g=void 0):y=="}"?((v=x.pop())[0][v[1]]=w,g=void 0,w=v[0]):y=="-"?m=-1:g===void 0?n.hasOwnProperty(y)?(b+=n[y],g=parseInt(b,16)*m,m=1,b=""):b+=y:n.hasOwnProperty(y)?(B+=n[y],w[g]=parseInt(B,16)*m,m=1,g=void 0,B=""):B+=y;return p},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},A={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},h={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var d=f.font,v=h.Unicode[d.postScriptName];v&&(d.metadata.Unicode={},d.metadata.Unicode.widths=v.widths,d.metadata.Unicode.kerning=v.kerning);var g=A.Unicode[d.postScriptName];g&&(d.metadata.Unicode.encoding=g,d.encoding=g.codePages[0])}])}(Ot.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Km(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(Ot),Ot.API.addSvgAsImage=function(e,t,r,n,a,s,o,l){if(isNaN(t)||isNaN(r))throw Hr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw Hr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var A={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Wt.canvg?Promise.resolve(Wt.canvg):$v(()=>import("./index.es-DK9bbmRi.js"),[])).catch(function(f){return Promise.reject(new Error("Could not load canvg: "+f))}).then(function(f){return f.default?f.default:f}).then(function(f){return f.fromString(u,e,A)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(f){return f.render(A)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,r,n,a,o,l)})},Ot.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},Ot.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,A=0,h=0;function f(v,g){var y,p=!1;for(y=0;y<v.length;y+=1)v[y]===g&&(p=!0);return p}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var d=l.length;for(h=0;h<d;h+=1)r[l[h]].value=r[l[h]].defaultValue,r[l[h]].explicitSet=!1}if(Ir(e)==="object"){for(a in e)if(s=e[a],f(l,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&f(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(A=0;A<s[u].length;A+=1)typeof s[u][A]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,g=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?g.push("/"+v+" /"+r[v].value):g.push("/"+v+" "+r[v].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Ot.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],A=[""],h=0,f=s.length;h<f;++h){if(l=o.metadata.characterToGlyph(s.charCodeAt(h)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(h),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return A.join("");l=l.toString(16),A.push(u[4-l.length],l)}return A.join("")},n=function(s){var o,l,c,u,A,h,f;for(A=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,f=(l=Object.keys(s).sort(function(d,v){return d-v})).length;h<f;h++)o=l[h],c.length>=100&&(A+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(A+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),A+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,A=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var h=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),d="",v=0;v<f.length;v++)d+=String.fromCharCode(f[v]);var g=u();A({data:d,addLength1:!0,objectId:g}),c("endobj");var y=u();A({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var p=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+PA(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var m=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+PA(l.fontName)),c("/FontDescriptor "+p+" 0 R"),c("/W "+e.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+PA(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+m+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,A=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var h=l.metadata.rawData,f="",d=0;d<h.length;d++)f+=String.fromCharCode(h[d]);var v=u();A({data:f,addLength1:!0,objectId:v}),c("endobj");var g=u();A({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+v+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+PA(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var p=0;p<l.metadata.hmtx.widths.length;p++)l.metadata.hmtx.widths[p]=parseInt(l.metadata.hmtx.widths[p]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+PA(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,u=s.y,A=s.options||{},h=s.mutex||{},f=h.pdfEscape,d=h.activeFontKey,v=h.fonts,g=d,y="",p=0,m="",w=v[g].encoding;if(v[g].encoding!=="Identity-H")return{text:l,x:c,y:u,options:A,mutex:h};for(m=l,g=d,Array.isArray(l)&&(m=l[0]),p=0;p<m.length;p+=1)v[g].metadata.hasOwnProperty("cmap")&&(o=v[g].metadata.cmap.unicode.codeMap[m[p].charCodeAt(0)]),o||m[p].charCodeAt(0)<256&&v[g].metadata.hasOwnProperty("Unicode")?y+=m[p]:y+="";var x="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?x=f(y,g).split("").map(function(b){return b.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(x=r(y,v[g])),h.isHex=!0,{text:x,x:c,y:u,options:A,mutex:h}};t.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([a(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(a(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(Ot),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Ot.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,s,o,l,c,u,A,h=t,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],p=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),m=!1,w=0;this.__bidiEngine__={};var x=function(S){var j=S.charCodeAt(),I=j>>8,U=g[I];return U!==void 0?h[256*U+(255&j)]:I===252||I===253?"AL":p.test(I)?"L":I===8?"R":"N"},b=function(S){for(var j,I=0;I<S.length;I++){if((j=x(S.charAt(I)))==="L")return!1;if(j==="R")return!0}return!1},B=function(S,j,I,U){var q,V,X,W,M=j[U];switch(M){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":m=!1;break;case"N":case"AN":break;case"EN":m&&(M="AN");break;case"AL":m=!0,M="R";break;case"WS":case"BN":M="N";break;case"CS":U<1||U+1>=j.length||(q=I[U-1])!=="EN"&&q!=="AN"||(V=j[U+1])!=="EN"&&V!=="AN"?M="N":m&&(V="AN"),M=V===q?V:"N";break;case"ES":M=(q=U>0?I[U-1]:"B")==="EN"&&U+1<j.length&&j[U+1]==="EN"?"EN":"N";break;case"ET":if(U>0&&I[U-1]==="EN"){M="EN";break}if(m){M="N";break}for(X=U+1,W=j.length;X<W&&j[X]==="ET";)X++;M=X<W&&j[X]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(W=j.length,X=U+1;X<W&&j[X]==="NSM";)X++;if(X<W){var G=S[U],H=G>=1425&&G<=2303||G===64286;if(q=j[X],H&&(q==="R"||q==="AL")){M="R";break}}}M=U<1||(q=j[U-1])==="B"?"N":I[U-1];break;case"B":m=!1,a=!0,M=w;break;case"S":s=!0,M="N"}return M},_=function(S,j,I){var U=S.split("");return I&&k(U,I,{hiLevel:w}),U.reverse(),j&&j.reverse(),U.join("")},k=function(S,j,I){var U,q,V,X,W,M=-1,G=S.length,H=0,C=[],L=w?d:f,O=[];for(m=!1,a=!1,s=!1,q=0;q<G;q++)O[q]=x(S[q]);for(V=0;V<G;V++){if(W=H,C[V]=B(S,O,C,V),U=240&(H=L[W][v[C[V]]]),H&=15,j[V]=X=L[H][5],U>0)if(U===16){for(q=M;q<V;q++)j[q]=1;M=-1}else M=-1;if(L[H][6])M===-1&&(M=V);else if(M>-1){for(q=M;q<V;q++)j[q]=X;M=-1}O[V]==="B"&&(j[V]=0),I.hiLevel|=X}s&&function(D,P,Q){for(var J=0;J<Q;J++)if(D[J]==="S"){P[J]=w;for(var te=J-1;te>=0&&D[te]==="WS";te--)P[te]=w}}(O,j,G)},E=function(S,j,I,U,q){if(!(q.hiLevel<S)){if(S===1&&w===1&&!a)return j.reverse(),void(I&&I.reverse());for(var V,X,W,M,G=j.length,H=0;H<G;){if(U[H]>=S){for(W=H+1;W<G&&U[W]>=S;)W++;for(M=H,X=W-1;M<X;M++,X--)V=j[M],j[M]=j[X],j[X]=V,I&&(V=I[M],I[M]=I[X],I[X]=V);H=W}H++}}},T=function(S,j,I){var U=S.split(""),q={hiLevel:w};return I||(I=[]),k(U,I,q),function(V,X,W){if(W.hiLevel!==0&&A)for(var M,G=0;G<V.length;G++)X[G]===1&&(M=y.indexOf(V[G]))>=0&&(V[G]=y[M+1])}(U,I,q),E(2,U,j,I,q),E(1,U,j,I,q),U.join("")};return this.__bidiEngine__.doBidiReorder=function(S,j,I){if(function(q,V){if(V)for(var X=0;X<q.length;X++)V[X]=X;l===void 0&&(l=b(q)),u===void 0&&(u=b(q))}(S,j),o||!c||u)if(o&&c&&l^u)w=l?1:0,S=_(S,j,I);else if(!o&&c&&u)w=l?1:0,S=T(S,j,I),S=_(S,j);else if(!o||l||c||u){if(o&&!c&&l^u)S=_(S,j),l?(w=0,S=T(S,j,I)):(w=1,S=T(S,j,I),S=_(S,j));else if(o&&l&&!c&&u)w=1,S=T(S,j,I),S=_(S,j);else if(!o&&!c&&l^u){var U=A;l?(w=1,S=T(S,j,I),w=0,A=!1,S=T(S,j,I),A=U):(w=0,S=T(S,j,I),S=_(S,j),w=1,A=!1,S=T(S,j,I),A=U,S=_(S,j))}}else w=0,S=T(S,j,I);else w=l?1:0,S=T(S,j,I);return S},this.__bidiEngine__.setOptions=function(S){S&&(o=S.isInputVisual,c=S.isOutputVisual,l=S.isInputRtl,u=S.isOutputRtl,A=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(Ot),Ot.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Uc(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new $ie(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new Fie(this.contents),this.head=new Iie(this),this.name=new Die(this),this.cmap=new GI(this),this.toUnicode={},this.hhea=new Lie(this),this.maxp=new Rie(this),this.hmtx=new Qie(this),this.post=new Uie(this),this.os2=new Oie(this),this.loca=new Kie(this),this.glyf=new Mie(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,s,o,l;for(o=0,s=0,l=(t=""+t).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var po,Uc=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,s,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,s;for(s=[],n=0,a=t.length;n<a;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),Fie=function(){var e;function t(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,s,o,l,c,u,A,h,f,d,v,g;for(g in d=Object.keys(r).length,c=Math.log(2),h=16*Math.floor(Math.log(d)/c),o=Math.floor(h/c),A=16*d-h,(a=new Uc).writeInt(this.scalarType),a.writeShort(d),a.writeShort(h),a.writeShort(o),a.writeShort(A),s=16*d,u=a.pos+s,l=null,v=[],r)for(f=r[g],a.writeString(g),a.writeInt(e(f)),a.writeInt(u),a.writeInt(f.length),v=v.concat(f),g==="head"&&(l=u),u+=f.length;u%4;)v.push(0),u++;return a.write(v),n=2981146554-e(a.data),a.pos=l+8,a.writeUInt32(n),a.data},e=function(r){var n,a,s,o;for(r=WI.call(r);r.length%4;)r.push(0);for(s=new Uc(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},t}(),Tie={}.hasOwnProperty,Ko=function(e,t){for(var r in t)Tie.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};po=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Iie=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Uc).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),OE=function(){function e(t,r){var n,a,s,o,l,c,u,A,h,f,d,v,g,y,p,m,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(d=t.readUInt16(),f=d/2,t.pos+=6,s=function(){var x,b;for(b=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)b.push(t.readUInt16());return b}(),t.pos+=2,g=function(){var x,b;for(b=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)b.push(t.readUInt16());return b}(),u=function(){var x,b;for(b=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)b.push(t.readUInt16());return b}(),A=function(){var x,b;for(b=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)b.push(t.readUInt16());return b}(),a=(this.length-t.pos+this.offset)/2,l=function(){var x,b;for(b=[],c=x=0;0<=a?x<a:x>a;c=0<=a?++x:--x)b.push(t.readUInt16());return b}(),c=p=0,w=s.length;p<w;c=++p)for(y=s[c],n=m=v=g[c];v<=y?m<=y:m>=y;n=v<=y?++m:--m)A[c]===0?o=n+u[c]:(o=l[A[c]/2+(n-v)-(f-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}t.pos=h}return e.encode=function(t,r){var n,a,s,o,l,c,u,A,h,f,d,v,g,y,p,m,w,x,b,B,_,k,E,T,S,j,I,U,q,V,X,W,M,G,H,C,L,O,D,P,Q,J,te,z,ye,re;switch(U=new Uc,o=Object.keys(t).sort(function(ke,be){return ke-be}),r){case"macroman":for(g=0,y=function(){var ke=[];for(v=0;v<256;++v)ke.push(0);return ke}(),m={0:0},s={},q=0,M=o.length;q<M;q++)m[te=t[a=o[q]]]==null&&(m[te]=++g),s[a]={old:t[a],new:m[t[a]]},y[a]=m[t[a]];return U.writeUInt16(1),U.writeUInt16(0),U.writeUInt32(12),U.writeUInt16(0),U.writeUInt16(262),U.writeUInt16(0),U.write(y),{charMap:s,subtable:U.data,maxGlyphID:g+1};case"unicode":for(j=[],h=[],w=0,m={},n={},p=u=null,V=0,G=o.length;V<G;V++)m[b=t[a=o[V]]]==null&&(m[b]=++w),n[a]={old:b,new:m[b]},l=m[b]-a,p!=null&&l===u||(p&&h.push(p),j.push(a),u=l),p=a;for(p&&h.push(p),h.push(65535),j.push(65535),T=2*(E=j.length),k=2*Math.pow(Math.log(E)/Math.LN2,2),f=Math.log(k/2)/Math.LN2,_=2*E-k,c=[],B=[],d=[],v=X=0,H=j.length;X<H;v=++X){if(S=j[v],A=h[v],S===65535){c.push(0),B.push(0);break}if(S-(I=n[S].new)>=32768)for(c.push(0),B.push(2*(d.length+E-v)),a=W=S;S<=A?W<=A:W>=A;a=S<=A?++W:--W)d.push(n[a].new);else c.push(I-S),B.push(0)}for(U.writeUInt16(3),U.writeUInt16(1),U.writeUInt32(12),U.writeUInt16(4),U.writeUInt16(16+8*E+2*d.length),U.writeUInt16(0),U.writeUInt16(T),U.writeUInt16(k),U.writeUInt16(f),U.writeUInt16(_),Q=0,C=h.length;Q<C;Q++)a=h[Q],U.writeUInt16(a);for(U.writeUInt16(0),J=0,L=j.length;J<L;J++)a=j[J],U.writeUInt16(a);for(z=0,O=c.length;z<O;z++)l=c[z],U.writeUInt16(l);for(ye=0,D=B.length;ye<D;ye++)x=B[ye],U.writeUInt16(x);for(re=0,P=d.length;re<P;re++)g=d[re],U.writeUInt16(g);return{charMap:n,subtable:U.data,maxGlyphID:w+1}}},e}(),GI=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new OE(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,a;return r==null&&(r="macroman"),n=OE.encode(t,r),(a=new Uc).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},e}(),Lie=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),Oie=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),Uie=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)r=t.readByte(),a.push(this.names.push(t.readString(r)));return a;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),Pie=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Die=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,a,s,o,l,c,u,A,h,f;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},s=A=0,h=n.length;A<h;s=++A)a=n[s],t.pos=a.offset,u=t.readString(a.length),o=new Pie(u,a),c[f=a.nameID]==null&&(c[f]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),Rie=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),Qie=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,a,s,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,A;for(A=[],r=u=0;0<=a?u<a:u>a;r=0<=a?++u:--u)A.push(t.readInt16());return A}(),this.widths=(function(){var u,A,h,f;for(f=[],u=0,A=(h=this.metrics).length;u<A;u++)s=h[u],f.push(s.advance);return f}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),WI=[].slice,Mie=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,a,s,o,l,c,u,A,h;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(a=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new Uc(r.read(a))).readShort(),u=l.readShort(),h=l.readShort(),c=l.readShort(),A=l.readShort(),this.cache[t]=o===-1?new qie(l,u,h,c,A):new Hie(l,o,u,h,c,A),this.cache[t]))},e.prototype.encode=function(t,r,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)a=t[r[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},e}(),Hie=function(){function e(t,r,n,a,s,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),qie=function(){function e(t,r,n,a,s){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Uc(WI.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),Kie=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ko(e,po),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<r.length&&r[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var u=new Array(4*n.length),A=0;A<n.length;++A)u[4*A+3]=255&n[A],u[4*A+2]=(65280&n[A])>>8,u[4*A+1]=(16711680&n[A])>>16,u[4*A]=(4278190080&n[A])>>24;return u},e}(),$ie=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,s,o,l,c;for(a={},o=0,l=t.length;o<l;o++)a[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},e.prototype.encode=function(t,r){var n,a,s,o,l,c,u,A,h,f,d,v,g,y,p;for(a in n=GI.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),d={0:0},p=n.charMap)d[(c=p[a]).old]=c.new;for(v in f=n.maxGlyphID,o)v in d||(d[v]=f++);return A=function(m){var w,x;for(w in x={},m)x[m[w]]=w;return x}(d),h=Object.keys(A).sort(function(m,w){return m-w}),g=function(){var m,w,x;for(x=[],m=0,w=h.length;m<w;m++)l=h[m],x.push(A[l]);return x}(),s=this.font.glyf.encode(o,g,d),u=this.font.loca.encode(s.offsets,g),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Ot.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)o=r[a],s.push("/"+a+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var b2=function(e,t){return b2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},b2(e,t)};function mo(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");b2(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var _2=function(){return _2=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},_2.apply(this,arguments)};function ds(e,t,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(A){try{u(n.next(A))}catch(h){o(h)}}function c(A){try{u(n.throw(A))}catch(h){o(h)}}function u(A){A.done?s(A.value):a(A.value).then(l,c)}u((n=n.apply(e,[])).next())})}function Wa(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(A){return c([u,A])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(A){u=[6,A],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function om(e,t,r){if(arguments.length===2)for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||t)}var Fl=function(){function e(t,r,n,a){this.left=t,this.top=r,this.width=n,this.height=a}return e.prototype.add=function(t,r,n,a){return new e(this.left+t,this.top+r,this.width+n,this.height+a)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find(function(a){return a.width!==0});return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),Gx=function(e,t){return Fl.fromClientRect(e,t.getBoundingClientRect())},Vie=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),a=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new Fl(0,0,n,a)},Wx=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=e.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((a&1023)<<10)+(s&1023)+65536):(t.push(a),r--)}else t.push(a)}return t},Fn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=e[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},UE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Gie=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var lm=0;lm<UE.length;lm++)Gie[UE.charCodeAt(lm)]=lm;var PE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var cm=0;cm<PE.length;cm++)Yf[PE.charCodeAt(cm)]=cm;var Wie=function(e){var t=e.length*.75,r=e.length,n,a=0,s,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),A=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=Yf[e.charCodeAt(n)],o=Yf[e.charCodeAt(n+1)],l=Yf[e.charCodeAt(n+2)],c=Yf[e.charCodeAt(n+3)],A[a++]=s<<2|o>>4,A[a++]=(o&15)<<4|l>>2,A[a++]=(l&3)<<6|c&63;return u},zie=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},Xie=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},Iu=5,$_=11,fy=2,Yie=$_-Iu,zI=65536>>Iu,Jie=1<<Iu,hy=Jie-1,Zie=1024>>Iu,eoe=zI+Zie,toe=eoe,roe=32,noe=toe+roe,aoe=65536>>$_,soe=1<<Yie,ioe=soe-1,DE=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},ooe=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},loe=function(e,t){var r=Wie(e),n=Array.isArray(r)?Xie(r):new Uint32Array(r),a=Array.isArray(r)?zie(r):new Uint16Array(r),s=24,o=DE(a,s/2,n[4]/2),l=n[5]===2?DE(a,(s+n[4])/2):ooe(n,Math.ceil((s+n[4])/4));return new coe(n[0],n[1],n[2],n[3],o,l)},coe=function(){function e(t,r,n,a,s,o){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Iu],r=(r<<fy)+(t&hy),this.data[r];if(t<=65535)return r=this.index[zI+(t-55296>>Iu)],r=(r<<fy)+(t&hy),this.data[r];if(t<this.highStart)return r=noe-aoe+(t>>$_),r=this.index[r],r+=t>>Iu&ioe,r=this.index[r],r=(r<<fy)+(t&hy),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),RE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",uoe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var um=0;um<RE.length;um++)uoe[RE.charCodeAt(um)]=um;var Aoe="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",QE=50,doe=1,XI=2,YI=3,foe=4,hoe=5,ME=7,JI=8,HE=9,mc=10,N2=11,qE=12,B2=13,poe=14,Jf=15,C2=16,Am=17,Rf=18,moe=19,KE=20,E2=21,Qf=22,py=23,EA=24,Gs=25,Zf=26,eh=27,SA=28,goe=29,vu=30,xoe=31,dm=32,fm=33,S2=34,k2=35,j2=36,f0=37,F2=38,zm=39,Xm=40,my=41,ZI=42,voe=43,yoe=[9001,65288],e8="!",hr="",hm="",T2=loe(Aoe),ul=[vu,j2],I2=[doe,XI,YI,hoe],t8=[mc,JI],$E=[eh,Zf],woe=I2.concat(t8),VE=[F2,zm,Xm,S2,k2],boe=[Jf,B2],_oe=function(e,t){t===void 0&&(t="strict");var r=[],n=[],a=[];return e.forEach(function(s,o){var l=T2.get(s);if(l>QE?(a.push(!0),l-=QE):a.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(o),r.push(C2);if(l===foe||l===N2){if(o===0)return n.push(o),r.push(vu);var c=r[o-1];return woe.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(vu))}if(n.push(o),l===xoe)return r.push(t==="strict"?E2:f0);if(l===ZI||l===goe)return r.push(vu);if(l===voe)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(f0):r.push(vu);r.push(l)}),[n,r,a]},gy=function(e,t,r,n){var a=n[r];if(Array.isArray(e)?e.indexOf(a)!==-1:e===a)for(var s=r;s<=n.length;){s++;var o=n[s];if(o===t)return!0;if(o!==mc)break}if(a===mc)for(var s=r;s>0;){s--;var l=n[s];if(Array.isArray(e)?e.indexOf(l)!==-1:e===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===t)return!0;if(o!==mc)break}if(l!==mc)break}return!1},GE=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n===mc)r--;else return n}return 0},Noe=function(e,t,r,n,a){if(r[n]===0)return hr;var s=n-1;if(Array.isArray(a)&&a[s]===!0)return hr;var o=s-1,l=s+1,c=t[s],u=o>=0?t[o]:0,A=t[l];if(c===XI&&A===YI)return hr;if(I2.indexOf(c)!==-1)return e8;if(I2.indexOf(A)!==-1||t8.indexOf(A)!==-1)return hr;if(GE(s,t)===JI)return hm;if(T2.get(e[s])===N2||(c===dm||c===fm)&&T2.get(e[l])===N2||c===ME||A===ME||c===HE||[mc,B2,Jf].indexOf(c)===-1&&A===HE||[Am,Rf,moe,EA,SA].indexOf(A)!==-1||GE(s,t)===Qf||gy(py,Qf,s,t)||gy([Am,Rf],E2,s,t)||gy(qE,qE,s,t))return hr;if(c===mc)return hm;if(c===py||A===py)return hr;if(A===C2||c===C2)return hm;if([B2,Jf,E2].indexOf(A)!==-1||c===poe||u===j2&&boe.indexOf(c)!==-1||c===SA&&A===j2||A===KE||ul.indexOf(A)!==-1&&c===Gs||ul.indexOf(c)!==-1&&A===Gs||c===eh&&[f0,dm,fm].indexOf(A)!==-1||[f0,dm,fm].indexOf(c)!==-1&&A===Zf||ul.indexOf(c)!==-1&&$E.indexOf(A)!==-1||$E.indexOf(c)!==-1&&ul.indexOf(A)!==-1||[eh,Zf].indexOf(c)!==-1&&(A===Gs||[Qf,Jf].indexOf(A)!==-1&&t[l+1]===Gs)||[Qf,Jf].indexOf(c)!==-1&&A===Gs||c===Gs&&[Gs,SA,EA].indexOf(A)!==-1)return hr;if([Gs,SA,EA,Am,Rf].indexOf(A)!==-1)for(var h=s;h>=0;){var f=t[h];if(f===Gs)return hr;if([SA,EA].indexOf(f)!==-1)h--;else break}if([eh,Zf].indexOf(A)!==-1)for(var h=[Am,Rf].indexOf(c)!==-1?o:s;h>=0;){var f=t[h];if(f===Gs)return hr;if([SA,EA].indexOf(f)!==-1)h--;else break}if(F2===c&&[F2,zm,S2,k2].indexOf(A)!==-1||[zm,S2].indexOf(c)!==-1&&[zm,Xm].indexOf(A)!==-1||[Xm,k2].indexOf(c)!==-1&&A===Xm||VE.indexOf(c)!==-1&&[KE,Zf].indexOf(A)!==-1||VE.indexOf(A)!==-1&&c===eh||ul.indexOf(c)!==-1&&ul.indexOf(A)!==-1||c===EA&&ul.indexOf(A)!==-1||ul.concat(Gs).indexOf(c)!==-1&&A===Qf&&yoe.indexOf(e[l])===-1||ul.concat(Gs).indexOf(A)!==-1&&c===Rf)return hr;if(c===my&&A===my){for(var d=r[s],v=1;d>0&&(d--,t[d]===my);)v++;if(v%2!==0)return hr}return c===dm&&A===fm?hr:hm},Boe=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=_oe(e,t.lineBreak),n=r[0],a=r[1],s=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(a=a.map(function(l){return[Gs,vu,ZI].indexOf(l)!==-1?f0:l}));var o=t.wordBreak==="keep-all"?s.map(function(l,c){return l&&e[c]>=19968&&e[c]<=40959}):void 0;return[n,a,o]},Coe=function(){function e(t,r,n,a){this.codePoints=t,this.required=r===e8,this.start=n,this.end=a}return e.prototype.slice=function(){return Fn.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),Eoe=function(e,t){var r=Wx(e),n=Boe(r,t),a=n[0],s=n[1],o=n[2],l=r.length,c=0,u=0;return{next:function(){if(u>=l)return{done:!0,value:null};for(var A=hr;u<l&&(A=Noe(r,s,a,++u,o))===hr;);if(A!==hr||u===l){var h=new Coe(r,A,c,u);return c=u,{value:h,done:!1}}return{done:!0,value:null}}}},Soe=1,koe=2,I0=4,WE=8,tx=10,zE=47,Bh=92,joe=9,Foe=32,pm=34,Mf=61,Toe=35,Ioe=36,Loe=37,mm=39,gm=40,Hf=41,Ooe=95,Es=45,Uoe=33,Poe=60,Doe=62,Roe=64,Qoe=91,Moe=93,Hoe=61,qoe=123,xm=63,Koe=125,XE=124,$oe=126,Voe=128,YE=65533,xy=42,Bu=43,Goe=44,Woe=58,zoe=59,h0=46,Xoe=0,Yoe=8,Joe=11,Zoe=14,ele=31,tle=127,Co=-1,r8=48,n8=97,a8=101,rle=102,nle=117,ale=122,s8=65,i8=69,o8=70,sle=85,ile=90,Ya=function(e){return e>=r8&&e<=57},ole=function(e){return e>=55296&&e<=57343},kA=function(e){return Ya(e)||e>=s8&&e<=o8||e>=n8&&e<=rle},lle=function(e){return e>=n8&&e<=ale},cle=function(e){return e>=s8&&e<=ile},ule=function(e){return lle(e)||cle(e)},Ale=function(e){return e>=Voe},vm=function(e){return e===tx||e===joe||e===Foe},rx=function(e){return ule(e)||Ale(e)||e===Ooe},JE=function(e){return rx(e)||Ya(e)||e===Es},dle=function(e){return e>=Xoe&&e<=Yoe||e===Joe||e>=Zoe&&e<=ele||e===tle},oc=function(e,t){return e!==Bh?!1:t!==tx},ym=function(e,t,r){return e===Es?rx(t)||oc(t,r):rx(e)?!0:!!(e===Bh&&oc(e,t))},vy=function(e,t,r){return e===Bu||e===Es?Ya(t)?!0:t===h0&&Ya(r):Ya(e===h0?t:e)},fle=function(e){var t=0,r=1;(e[t]===Bu||e[t]===Es)&&(e[t]===Es&&(r=-1),t++);for(var n=[];Ya(e[t]);)n.push(e[t++]);var a=n.length?parseInt(Fn.apply(void 0,n),10):0;e[t]===h0&&t++;for(var s=[];Ya(e[t]);)s.push(e[t++]);var o=s.length,l=o?parseInt(Fn.apply(void 0,s),10):0;(e[t]===i8||e[t]===a8)&&t++;var c=1;(e[t]===Bu||e[t]===Es)&&(e[t]===Es&&(c=-1),t++);for(var u=[];Ya(e[t]);)u.push(e[t++]);var A=u.length?parseInt(Fn.apply(void 0,u),10):0;return r*(a+l*Math.pow(10,-o))*Math.pow(10,c*A)},hle={type:2},ple={type:3},mle={type:4},gle={type:13},xle={type:8},vle={type:21},yle={type:9},wle={type:10},ble={type:11},_le={type:12},Nle={type:14},wm={type:23},Ble={type:1},Cle={type:25},Ele={type:24},Sle={type:26},kle={type:27},jle={type:28},Fle={type:29},Tle={type:31},L2={type:32},l8=function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(Wx(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==L2;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case pm:return this.consumeStringToken(pm);case Toe:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),a=this.peekCodePoint(2);if(JE(r)||oc(n,a)){var s=ym(r,n,a)?koe:Soe,o=this.consumeName();return{type:5,value:o,flags:s}}break;case Ioe:if(this.peekCodePoint(0)===Mf)return this.consumeCodePoint(),gle;break;case mm:return this.consumeStringToken(mm);case gm:return hle;case Hf:return ple;case xy:if(this.peekCodePoint(0)===Mf)return this.consumeCodePoint(),Nle;break;case Bu:if(vy(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case Goe:return mle;case Es:var l=t,c=this.peekCodePoint(0),u=this.peekCodePoint(1);if(vy(l,c,u))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(ym(l,c,u))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(c===Es&&u===Doe)return this.consumeCodePoint(),this.consumeCodePoint(),Ele;break;case h0:if(vy(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case zE:if(this.peekCodePoint(0)===xy)for(this.consumeCodePoint();;){var A=this.consumeCodePoint();if(A===xy&&(A=this.consumeCodePoint(),A===zE))return this.consumeToken();if(A===Co)return this.consumeToken()}break;case Woe:return Sle;case zoe:return kle;case Poe:if(this.peekCodePoint(0)===Uoe&&this.peekCodePoint(1)===Es&&this.peekCodePoint(2)===Es)return this.consumeCodePoint(),this.consumeCodePoint(),Cle;break;case Roe:var h=this.peekCodePoint(0),f=this.peekCodePoint(1),d=this.peekCodePoint(2);if(ym(h,f,d)){var o=this.consumeName();return{type:7,value:o}}break;case Qoe:return jle;case Bh:if(oc(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case Moe:return Fle;case Hoe:if(this.peekCodePoint(0)===Mf)return this.consumeCodePoint(),xle;break;case qoe:return ble;case Koe:return _le;case nle:case sle:var v=this.peekCodePoint(0),g=this.peekCodePoint(1);return v===Bu&&(kA(g)||g===xm)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case XE:if(this.peekCodePoint(0)===Mf)return this.consumeCodePoint(),yle;if(this.peekCodePoint(0)===XE)return this.consumeCodePoint(),vle;break;case $oe:if(this.peekCodePoint(0)===Mf)return this.consumeCodePoint(),wle;break;case Co:return L2}return vm(t)?(this.consumeWhiteSpace(),Tle):Ya(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):rx(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Fn(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();kA(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var n=!1;r===xm&&t.length<6;)t.push(r),r=this.consumeCodePoint(),n=!0;if(n){var a=parseInt(Fn.apply(void 0,t.map(function(c){return c===xm?r8:c})),16),s=parseInt(Fn.apply(void 0,t.map(function(c){return c===xm?o8:c})),16);return{type:30,start:a,end:s}}var o=parseInt(Fn.apply(void 0,t),16);if(this.peekCodePoint(0)===Es&&kA(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];kA(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var s=parseInt(Fn.apply(void 0,l),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===gm?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===gm?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Co)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===mm||r===pm){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Co||this.peekCodePoint(0)===Hf)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),wm)}for(;;){var a=this.consumeCodePoint();if(a===Co||a===Hf)return{type:22,value:Fn.apply(void 0,t)};if(vm(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Co||this.peekCodePoint(0)===Hf?(this.consumeCodePoint(),{type:22,value:Fn.apply(void 0,t)}):(this.consumeBadUrlRemnants(),wm);if(a===pm||a===mm||a===gm||dle(a))return this.consumeBadUrlRemnants(),wm;if(a===Bh)if(oc(a,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),wm;else t.push(a)}},e.prototype.consumeWhiteSpace=function(){for(;vm(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Hf||t===Co)return;oc(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,n="";t>0;){var a=Math.min(r,t);n+=Fn.apply(void 0,this._value.splice(0,a)),t-=a}return this._value.shift(),n},e.prototype.consumeStringToken=function(t){var r="",n=0;do{var a=this._value[n];if(a===Co||a===void 0||a===t)return r+=this.consumeStringSlice(n),{type:0,value:r};if(a===tx)return this._value.splice(0,n),Ble;if(a===Bh){var s=this._value[n+1];s!==Co&&s!==void 0&&(s===tx?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):oc(a,s)&&(r+=this.consumeStringSlice(n),r+=Fn(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=I0,n=this.peekCodePoint(0);for((n===Bu||n===Es)&&t.push(this.consumeCodePoint());Ya(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(n===h0&&Ya(a))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=WE;Ya(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),a=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===i8||n===a8)&&((a===Bu||a===Es)&&Ya(s)||Ya(a)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=WE;Ya(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[fle(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],n=t[1],a=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(ym(a,s,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return a===Loe?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(kA(t)){for(var r=Fn(t);kA(this.peekCodePoint(0))&&r.length<6;)r+=Fn(this.consumeCodePoint());vm(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||ole(n)||n>1114111?YE:n}return t===Co?YE:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(JE(r))t+=Fn(r);else if(oc(r,this.peekCodePoint(0)))t+=Fn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e}(),c8=function(){function e(t){this._tokens=t}return e.create=function(t){var r=new l8;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||Lle(n,t))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?L2:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e}(),L0=function(e){return e.type===15},Wd=function(e){return e.type===17},Ur=function(e){return e.type===20},Ile=function(e){return e.type===0},O2=function(e,t){return Ur(e)&&e.value===t},u8=function(e){return e.type!==31},jd=function(e){return e.type!==31&&e.type!==4},$o=function(e){var t=[],r=[];return e.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&t.push(r),t},Lle=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},Pc=function(e){return e.type===17||e.type===15},Vn=function(e){return e.type===16||Pc(e)},A8=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Oa={type:17,number:0,flags:I0},V_={type:16,number:50,flags:I0},gc={type:16,number:100,flags:I0},th=function(e,t,r){var n=e[0],a=e[1];return[Vr(n,t),Vr(typeof a<"u"?a:n,r)]},Vr=function(e,t){if(e.type===16)return e.number/100*t;if(L0(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},d8="deg",f8="grad",h8="rad",p8="turn",zx={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case d8:return Math.PI*t.number/180;case f8:return Math.PI/200*t.number;case h8:return t.number;case p8:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},m8=function(e){return e.type===15&&(e.unit===d8||e.unit===f8||e.unit===h8||e.unit===p8)},g8=function(e){var t=e.filter(Ur).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Oa,Oa];case"to top":case"bottom":return Ci(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Oa,gc];case"to right":case"left":return Ci(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[gc,gc];case"to bottom":case"top":return Ci(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[gc,Oa];case"to left":case"right":return Ci(270)}return 0},Ci=function(e){return Math.PI*e/180},Sc={name:"color",parse:function(e,t){if(t.type===18){var r=Ole[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),a=t.value.substring(1,2),s=t.value.substring(2,3);return xc(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),a=t.value.substring(1,2),s=t.value.substring(2,3),o=t.value.substring(3,4);return xc(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),a=t.value.substring(2,4),s=t.value.substring(4,6);return xc(parseInt(n,16),parseInt(a,16),parseInt(s,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),a=t.value.substring(2,4),s=t.value.substring(4,6),o=t.value.substring(6,8);return xc(parseInt(n,16),parseInt(a,16),parseInt(s,16),parseInt(o,16)/255)}}if(t.type===20){var l=Nl[t.value.toUpperCase()];if(typeof l<"u")return l}return Nl.TRANSPARENT}},kc=function(e){return(255&e)===0},fa=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,a=255&e>>24;return t<255?"rgba("+a+","+n+","+r+","+t/255+")":"rgb("+a+","+n+","+r+")"},xc=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(n*255)<<0)>>>0},ZE=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},eS=function(e,t){var r=t.filter(jd);if(r.length===3){var n=r.map(ZE),a=n[0],s=n[1],o=n[2];return xc(a,s,o,1)}if(r.length===4){var l=r.map(ZE),a=l[0],s=l[1],o=l[2],c=l[3];return xc(a,s,o,c)}return 0};function yy(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var tS=function(e,t){var r=t.filter(jd),n=r[0],a=r[1],s=r[2],o=r[3],l=(n.type===17?Ci(n.number):zx.parse(e,n))/(Math.PI*2),c=Vn(a)?a.number/100:0,u=Vn(s)?s.number/100:0,A=typeof o<"u"&&Vn(o)?Vr(o,1):1;if(c===0)return xc(u*255,u*255,u*255,1);var h=u<=.5?u*(c+1):u+c-u*c,f=u*2-h,d=yy(f,h,l+1/3),v=yy(f,h,l),g=yy(f,h,l-1/3);return xc(d*255,v*255,g*255,A)},Ole={hsl:tS,hsla:tS,rgb:eS,rgba:eS},Ch=function(e,t){return Sc.parse(e,c8.create(t).parseComponentValue())},Nl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Ule={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Ur(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Ple={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Xx=function(e,t){var r=Sc.parse(e,t[0]),n=t[1];return n&&Vn(n)?{color:r,stop:n}:{color:r,stop:null}},rS=function(e,t){var r=e[0],n=e[e.length-1];r.stop===null&&(r.stop=Oa),n.stop===null&&(n.stop=gc);for(var a=[],s=0,o=0;o<e.length;o++){var l=e[o].stop;if(l!==null){var c=Vr(l,t);c>s?a.push(c):a.push(s),s=c}else a.push(null)}for(var u=null,o=0;o<a.length;o++){var A=a[o];if(A===null)u===null&&(u=o);else if(u!==null){for(var h=o-u,f=a[u-1],d=(A-f)/(h+1),v=1;v<=h;v++)a[u+v-1]=d*v;u=null}}return e.map(function(g,y){var p=g.color;return{color:p,stop:Math.max(Math.min(1,a[y]/t),0)}})},Dle=function(e,t,r){var n=t/2,a=r/2,s=Vr(e[0],t)-n,o=a-Vr(e[1],r);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},Rle=function(e,t,r){var n=typeof e=="number"?e:Dle(e,t,r),a=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),s=t/2,o=r/2,l=a/2,c=Math.sin(n-Math.PI/2)*l,u=Math.cos(n-Math.PI/2)*l;return[a,s-u,s+u,o-c,o+c]},Wi=function(e,t){return Math.sqrt(e*e+t*t)},nS=function(e,t,r,n,a){var s=[[0,0],[0,t],[e,0],[e,t]];return s.reduce(function(o,l){var c=l[0],u=l[1],A=Wi(r-c,n-u);return(a?A<o.optimumDistance:A>o.optimumDistance)?{optimumCorner:l,optimumDistance:A}:o},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},Qle=function(e,t,r,n,a){var s=0,o=0;switch(e.size){case 0:e.shape===0?s=o=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-a)):e.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-n)),o=Math.min(Math.abs(r),Math.abs(r-a)));break;case 2:if(e.shape===0)s=o=Math.min(Wi(t,r),Wi(t,r-a),Wi(t-n,r),Wi(t-n,r-a));else if(e.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-a))/Math.min(Math.abs(t),Math.abs(t-n)),c=nS(n,a,t,r,!0),u=c[0],A=c[1];s=Wi(u-t,(A-r)/l),o=l*s}break;case 1:e.shape===0?s=o=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-a)):e.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-n)),o=Math.max(Math.abs(r),Math.abs(r-a)));break;case 3:if(e.shape===0)s=o=Math.max(Wi(t,r),Wi(t,r-a),Wi(t-n,r),Wi(t-n,r-a));else if(e.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-a))/Math.max(Math.abs(t),Math.abs(t-n)),h=nS(n,a,t,r,!1),u=h[0],A=h[1];s=Wi(u-t,(A-r)/l),o=l*s}break}return Array.isArray(e.size)&&(s=Vr(e.size[0],n),o=e.size.length===2?Vr(e.size[1],a):s),[s,o]},Mle=function(e,t){var r=Ci(180),n=[];return $o(t).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&o.value==="to"){r=g8(a);return}else if(m8(o)){r=zx.parse(e,o);return}}var l=Xx(e,a);n.push(l)}),{angle:r,stops:n,type:1}},bm=function(e,t){var r=Ci(180),n=[];return $o(t).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=g8(a);return}else if(m8(o)){r=(zx.parse(e,o)+Ci(270))%Ci(360);return}}var l=Xx(e,a);n.push(l)}),{angle:r,stops:n,type:1}},Hle=function(e,t){var r=Ci(180),n=[],a=1,s=0,o=3,l=[];return $o(t).forEach(function(c,u){var A=c[0];if(u===0){if(Ur(A)&&A.value==="linear"){a=1;return}else if(Ur(A)&&A.value==="radial"){a=2;return}}if(A.type===18){if(A.name==="from"){var h=Sc.parse(e,A.values[0]);n.push({stop:Oa,color:h})}else if(A.name==="to"){var h=Sc.parse(e,A.values[0]);n.push({stop:gc,color:h})}else if(A.name==="color-stop"){var f=A.values.filter(jd);if(f.length===2){var h=Sc.parse(e,f[1]),d=f[0];Wd(d)&&n.push({stop:{type:16,number:d.number*100,flags:d.flags},color:h})}}}}),a===1?{angle:(r+Ci(180))%Ci(360),stops:n,type:a}:{size:o,shape:s,stops:n,position:l,type:a}},x8="closest-side",v8="farthest-side",y8="closest-corner",w8="farthest-corner",b8="circle",_8="ellipse",N8="cover",B8="contain",qle=function(e,t){var r=0,n=3,a=[],s=[];return $o(t).forEach(function(o,l){var c=!0;if(l===0){var u=!1;c=o.reduce(function(h,f){if(u)if(Ur(f))switch(f.value){case"center":return s.push(V_),h;case"top":case"left":return s.push(Oa),h;case"right":case"bottom":return s.push(gc),h}else(Vn(f)||Pc(f))&&s.push(f);else if(Ur(f))switch(f.value){case b8:return r=0,!1;case _8:return r=1,!1;case"at":return u=!0,!1;case x8:return n=0,!1;case N8:case v8:return n=1,!1;case B8:case y8:return n=2,!1;case w8:return n=3,!1}else if(Pc(f)||Vn(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return h},c)}if(c){var A=Xx(e,o);a.push(A)}}),{size:n,shape:r,stops:a,position:s,type:2}},_m=function(e,t){var r=0,n=3,a=[],s=[];return $o(t).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(A,h){if(Ur(h))switch(h.value){case"center":return s.push(V_),!1;case"top":case"left":return s.push(Oa),!1;case"right":case"bottom":return s.push(gc),!1}else if(Vn(h)||Pc(h))return s.push(h),!1;return A},c):l===1&&(c=o.reduce(function(A,h){if(Ur(h))switch(h.value){case b8:return r=0,!1;case _8:return r=1,!1;case B8:case x8:return n=0,!1;case v8:return n=1,!1;case y8:return n=2,!1;case N8:case w8:return n=3,!1}else if(Pc(h)||Vn(h))return Array.isArray(n)||(n=[]),n.push(h),!1;return A},c)),c){var u=Xx(e,o);a.push(u)}}),{size:n,shape:r,stops:a,position:s,type:2}},Kle=function(e){return e.type===1},$le=function(e){return e.type===2},G_={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var n=C8[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function Vle(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!C8[e.name])}var C8={"linear-gradient":Mle,"-moz-linear-gradient":bm,"-ms-linear-gradient":bm,"-o-linear-gradient":bm,"-webkit-linear-gradient":bm,"radial-gradient":qle,"-moz-radial-gradient":_m,"-ms-radial-gradient":_m,"-o-radial-gradient":_m,"-webkit-radial-gradient":_m,"-webkit-gradient":Hle},Gle={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(n){return jd(n)&&Vle(n)}).map(function(n){return G_.parse(e,n)})}},Wle={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Ur(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},zle={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return $o(t).map(function(r){return r.filter(Vn)}).map(A8)}},Xle={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return $o(t).map(function(r){return r.filter(Ur).map(function(n){return n.value}).join(" ")}).map(Yle)}},Yle=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},xd;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(xd||(xd={}));var Jle={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return $o(t).map(function(r){return r.filter(Zle)})}},Zle=function(e){return Ur(e)||Vn(e)},Yx=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},ece=Yx("top"),tce=Yx("right"),rce=Yx("bottom"),nce=Yx("left"),Jx=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return A8(r.filter(Vn))}}},ace=Jx("top-left"),sce=Jx("top-right"),ice=Jx("bottom-right"),oce=Jx("bottom-left"),Zx=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},lce=Zx("top"),cce=Zx("right"),uce=Zx("bottom"),Ace=Zx("left"),e1=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return L0(r)?r.number:0}}},dce=e1("top"),fce=e1("right"),hce=e1("bottom"),pce=e1("left"),mce={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},gce={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},xce={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Ur).reduce(function(r,n){return r|vce(n.value)},0)}},vce=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},yce={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},wce={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},nx;(function(e){e.NORMAL="normal",e.STRICT="strict"})(nx||(nx={}));var bce={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return nx.STRICT;case"normal":default:return nx.NORMAL}}},_ce={name:"line-height",initialValue:"normal",prefix:!1,type:4},aS=function(e,t){return Ur(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:Vn(e)?Vr(e,t):t},Nce={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:G_.parse(e,t)}},Bce={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},U2={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},t1=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},Cce=t1("top"),Ece=t1("right"),Sce=t1("bottom"),kce=t1("left"),jce={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Ur).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Fce={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},r1=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Tce=r1("top"),Ice=r1("right"),Lce=r1("bottom"),Oce=r1("left"),Uce={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Pce={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Dce={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&O2(t[0],"none")?[]:$o(t).map(function(r){for(var n={color:Nl.TRANSPARENT,offsetX:Oa,offsetY:Oa,blur:Oa},a=0,s=0;s<r.length;s++){var o=r[s];Pc(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:n.blur=o,a++):n.color=Sc.parse(e,o)}return n})}},Rce={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Qce={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=qce[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},Mce=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},Hce=function(e){var t=e.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=t[0],n=t[1];t[2],t[3];var a=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],l=t[13];return t[14],t[15],t.length===16?[r,n,a,s,o,l]:null},qce={matrix:Mce,matrix3d:Hce},sS={type:16,number:50,flags:I0},Kce=[sS,sS],$ce={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(Vn);return r.length!==2?Kce:[r[0],r[1]]}},Vce={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Eh;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(Eh||(Eh={}));var Gce={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return Eh.BREAK_ALL;case"keep-all":return Eh.KEEP_ALL;case"normal":default:return Eh.NORMAL}}},Wce={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(Wd(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},E8={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},zce={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return Wd(t)?t.number:1}},Xce={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Yce={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Ur).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},Jce={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach(function(a){switch(a.type){case 20:case 0:r.push(a.value);break;case 17:r.push(a.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},Zce={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},eue={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(Wd(t))return t.number;if(Ur(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},tue={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Ur).map(function(r){return r.value})}},rue={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},sa=function(e,t){return(e&t)!==0},nue={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},aue={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var n=[],a=t.filter(u8),s=0;s<a.length;s++){var o=a[s],l=a[s+1];if(o.type===20){var c=l&&Wd(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},sue={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],n=t.filter(u8),a=0;a<n.length;a++){var s=n[a],o=n[a+1];if(Ur(s)&&s.value!=="none"){var l=o&&Wd(o)?o.number:0;r.push({counter:s.value,reset:l})}}return r}},iue={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(L0).map(function(r){return E8.parse(e,r)})}},oue={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var n=[],a=t.filter(Ile);if(a.length%2!==0)return null;for(var s=0;s<a.length;s+=2){var o=a[s].value,l=a[s+1].value;n.push({open:o,close:l})}return n}},iS=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},lue={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&O2(t[0],"none")?[]:$o(t).map(function(r){for(var n={color:255,offsetX:Oa,offsetY:Oa,blur:Oa,spread:Oa,inset:!1},a=0,s=0;s<r.length;s++){var o=r[s];O2(o,"inset")?n.inset=!0:Pc(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:a===2?n.blur=o:n.spread=o,a++):n.color=Sc.parse(e,o)}return n})}},cue={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(Ur).forEach(function(a){switch(a.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(a){n.indexOf(a)===-1&&n.push(a)}),n}},uue={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Aue={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return L0(t)?t.number:0}},due=function(){function e(t,r){var n,a;this.animationDuration=Bt(t,iue,r.animationDuration),this.backgroundClip=Bt(t,Ule,r.backgroundClip),this.backgroundColor=Bt(t,Ple,r.backgroundColor),this.backgroundImage=Bt(t,Gle,r.backgroundImage),this.backgroundOrigin=Bt(t,Wle,r.backgroundOrigin),this.backgroundPosition=Bt(t,zle,r.backgroundPosition),this.backgroundRepeat=Bt(t,Xle,r.backgroundRepeat),this.backgroundSize=Bt(t,Jle,r.backgroundSize),this.borderTopColor=Bt(t,ece,r.borderTopColor),this.borderRightColor=Bt(t,tce,r.borderRightColor),this.borderBottomColor=Bt(t,rce,r.borderBottomColor),this.borderLeftColor=Bt(t,nce,r.borderLeftColor),this.borderTopLeftRadius=Bt(t,ace,r.borderTopLeftRadius),this.borderTopRightRadius=Bt(t,sce,r.borderTopRightRadius),this.borderBottomRightRadius=Bt(t,ice,r.borderBottomRightRadius),this.borderBottomLeftRadius=Bt(t,oce,r.borderBottomLeftRadius),this.borderTopStyle=Bt(t,lce,r.borderTopStyle),this.borderRightStyle=Bt(t,cce,r.borderRightStyle),this.borderBottomStyle=Bt(t,uce,r.borderBottomStyle),this.borderLeftStyle=Bt(t,Ace,r.borderLeftStyle),this.borderTopWidth=Bt(t,dce,r.borderTopWidth),this.borderRightWidth=Bt(t,fce,r.borderRightWidth),this.borderBottomWidth=Bt(t,hce,r.borderBottomWidth),this.borderLeftWidth=Bt(t,pce,r.borderLeftWidth),this.boxShadow=Bt(t,lue,r.boxShadow),this.color=Bt(t,mce,r.color),this.direction=Bt(t,gce,r.direction),this.display=Bt(t,xce,r.display),this.float=Bt(t,yce,r.cssFloat),this.fontFamily=Bt(t,Jce,r.fontFamily),this.fontSize=Bt(t,Zce,r.fontSize),this.fontStyle=Bt(t,rue,r.fontStyle),this.fontVariant=Bt(t,tue,r.fontVariant),this.fontWeight=Bt(t,eue,r.fontWeight),this.letterSpacing=Bt(t,wce,r.letterSpacing),this.lineBreak=Bt(t,bce,r.lineBreak),this.lineHeight=Bt(t,_ce,r.lineHeight),this.listStyleImage=Bt(t,Nce,r.listStyleImage),this.listStylePosition=Bt(t,Bce,r.listStylePosition),this.listStyleType=Bt(t,U2,r.listStyleType),this.marginTop=Bt(t,Cce,r.marginTop),this.marginRight=Bt(t,Ece,r.marginRight),this.marginBottom=Bt(t,Sce,r.marginBottom),this.marginLeft=Bt(t,kce,r.marginLeft),this.opacity=Bt(t,zce,r.opacity);var s=Bt(t,jce,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=Bt(t,Fce,r.overflowWrap),this.paddingTop=Bt(t,Tce,r.paddingTop),this.paddingRight=Bt(t,Ice,r.paddingRight),this.paddingBottom=Bt(t,Lce,r.paddingBottom),this.paddingLeft=Bt(t,Oce,r.paddingLeft),this.paintOrder=Bt(t,cue,r.paintOrder),this.position=Bt(t,Pce,r.position),this.textAlign=Bt(t,Uce,r.textAlign),this.textDecorationColor=Bt(t,Xce,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=Bt(t,Yce,(a=r.textDecorationLine)!==null&&a!==void 0?a:r.textDecoration),this.textShadow=Bt(t,Dce,r.textShadow),this.textTransform=Bt(t,Rce,r.textTransform),this.transform=Bt(t,Qce,r.transform),this.transformOrigin=Bt(t,$ce,r.transformOrigin),this.visibility=Bt(t,Vce,r.visibility),this.webkitTextStrokeColor=Bt(t,uue,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=Bt(t,Aue,r.webkitTextStrokeWidth),this.wordBreak=Bt(t,Gce,r.wordBreak),this.zIndex=Bt(t,Wce,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return kc(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return sa(this.display,4)||sa(this.display,33554432)||sa(this.display,268435456)||sa(this.display,536870912)||sa(this.display,67108864)||sa(this.display,134217728)},e}(),fue=function(){function e(t,r){this.content=Bt(t,nue,r.content),this.quotes=Bt(t,oue,r.quotes)}return e}(),oS=function(){function e(t,r){this.counterIncrement=Bt(t,aue,r.counterIncrement),this.counterReset=Bt(t,sue,r.counterReset)}return e}(),Bt=function(e,t,r){var n=new l8,a=r!==null&&typeof r<"u"?r.toString():t.initialValue;n.write(a);var s=new c8(n.read());switch(t.type){case 2:var o=s.parseComponentValue();return t.parse(e,Ur(o)?o.value:t.initialValue);case 0:return t.parse(e,s.parseComponentValue());case 1:return t.parse(e,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return zx.parse(e,s.parseComponentValue());case"color":return Sc.parse(e,s.parseComponentValue());case"image":return G_.parse(e,s.parseComponentValue());case"length":var l=s.parseComponentValue();return Pc(l)?l:Oa;case"length-percentage":var c=s.parseComponentValue();return Vn(c)?c:Oa;case"time":return E8.parse(e,s.parseComponentValue())}break}},hue="data-html2canvas-debug",pue=function(e){var t=e.getAttribute(hue);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},P2=function(e,t){var r=pue(e);return r===1||t===r},Vo=function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,P2(r,3))debugger;this.styles=new due(t,window.getComputedStyle(r,null)),Q2(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Gx(this.context,r),P2(r,4)&&(this.flags|=16)}return e}(),mue="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",lS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Nm=0;Nm<lS.length;Nm++)rh[lS.charCodeAt(Nm)]=Nm;var gue=function(e){var t=e.length*.75,r=e.length,n,a=0,s,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),A=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=rh[e.charCodeAt(n)],o=rh[e.charCodeAt(n+1)],l=rh[e.charCodeAt(n+2)],c=rh[e.charCodeAt(n+3)],A[a++]=s<<2|o>>4,A[a++]=(o&15)<<4|l>>2,A[a++]=(l&3)<<6|c&63;return u},xue=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},vue=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},Lu=5,W_=11,wy=2,yue=W_-Lu,S8=65536>>Lu,wue=1<<Lu,by=wue-1,bue=1024>>Lu,_ue=S8+bue,Nue=_ue,Bue=32,Cue=Nue+Bue,Eue=65536>>W_,Sue=1<<yue,kue=Sue-1,cS=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},jue=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},Fue=function(e,t){var r=gue(e),n=Array.isArray(r)?vue(r):new Uint32Array(r),a=Array.isArray(r)?xue(r):new Uint16Array(r),s=24,o=cS(a,s/2,n[4]/2),l=n[5]===2?cS(a,(s+n[4])/2):jue(n,Math.ceil((s+n[4])/4));return new Tue(n[0],n[1],n[2],n[3],o,l)},Tue=function(){function e(t,r,n,a,s,o){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Lu],r=(r<<wy)+(t&by),this.data[r];if(t<=65535)return r=this.index[S8+(t-55296>>Lu)],r=(r<<wy)+(t&by),this.data[r];if(t<this.highStart)return r=Cue-Eue+(t>>W_),r=this.index[r],r+=t>>Lu&kue,r=this.index[r],r=(r<<wy)+(t&by),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),uS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Iue=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Bm=0;Bm<uS.length;Bm++)Iue[uS.charCodeAt(Bm)]=Bm;var Lue=1,_y=2,Ny=3,AS=4,dS=5,Oue=7,fS=8,By=9,Cy=10,hS=11,pS=12,mS=13,gS=14,Ey=15,Uue=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=e.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((a&1023)<<10)+(s&1023)+65536):(t.push(a),r--)}else t.push(a)}return t},Pue=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=e[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},Due=Fue(mue),yi="",Sy="",Rue=function(e){return Due.get(e)},Que=function(e,t,r){var n=r-2,a=t[n],s=t[r-1],o=t[r];if(s===_y&&o===Ny)return yi;if(s===_y||s===Ny||s===AS||o===_y||o===Ny||o===AS)return Sy;if(s===fS&&[fS,By,hS,pS].indexOf(o)!==-1||(s===hS||s===By)&&(o===By||o===Cy)||(s===pS||s===Cy)&&o===Cy||o===mS||o===dS||o===Oue||s===Lue)return yi;if(s===mS&&o===gS){for(;a===dS;)a=t[--n];if(a===gS)return yi}if(s===Ey&&o===Ey){for(var l=0;a===Ey;)l++,a=t[--n];if(l%2===0)return yi}return Sy},Mue=function(e){var t=Uue(e),r=t.length,n=0,a=0,s=t.map(Rue);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=yi;n<r&&(o=Que(t,s,++n))===yi;);if(o!==yi||n===r){var l=Pue.apply(null,t.slice(a,n));return a=n,{value:l,done:!1}}return{done:!0,value:null}}}},Hue=function(e){for(var t=Mue(e),r=[],n;!(n=t.next()).done;)n.value&&r.push(n.value.slice());return r},que=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var a=r.getBoundingClientRect(),s=Math.round(a.height);if(e.body.removeChild(n),s===t)return!0}}return!1},Kue=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,a=Wx(n.data).map(function(c){return Fn(c)}),s=0,o={},l=a.every(function(c,u){r.setStart(n,s),r.setEnd(n,s+c.length);var A=r.getBoundingClientRect();s+=c.length;var h=A.x>o.x||A.y>o.y;return o=A,u===0?!0:h});return e.body.removeChild(t),l},$ue=function(){return typeof new Image().crossOrigin<"u"},Vue=function(){return typeof new XMLHttpRequest().responseType=="string"},Gue=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},xS=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},Wue=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var a=new Image,s=t.toDataURL();a.src=s;var o=D2(r,r,0,0,a);return n.fillStyle="red",n.fillRect(0,0,r,r),vS(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var u=e.createElement("div");return u.style.backgroundImage="url("+s+")",u.style.height=r+"px",xS(c)?vS(D2(r,r,0,0,u)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),xS(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},D2=function(e,t,r,n,a){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(a),o},vS=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},Ta={get SUPPORT_RANGE_BOUNDS(){var e=que(document);return Object.defineProperty(Ta,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=Ta.SUPPORT_RANGE_BOUNDS&&Kue(document);return Object.defineProperty(Ta,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=Gue(document);return Object.defineProperty(Ta,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?Wue(document):Promise.resolve(!1);return Object.defineProperty(Ta,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=$ue();return Object.defineProperty(Ta,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=Vue();return Object.defineProperty(Ta,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ta,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Ta,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Sh=function(){function e(t,r){this.text=t,this.bounds=r}return e}(),zue=function(e,t,r,n){var a=Jue(t,r),s=[],o=0;return a.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Ta.SUPPORT_RANGE_BOUNDS){var c=yS(n,o,l.length).getClientRects();if(c.length>1){var u=z_(l),A=0;u.forEach(function(f){s.push(new Sh(f,Fl.fromDOMRectList(e,yS(n,A+o,f.length).getClientRects()))),A+=f.length})}else s.push(new Sh(l,Fl.fromDOMRectList(e,c)))}else{var h=n.splitText(l.length);s.push(new Sh(l,Xue(e,n))),n=h}else Ta.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),s},Xue=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var a=t.parentNode;if(a){a.replaceChild(n,t);var s=Gx(e,n);return n.firstChild&&a.replaceChild(n.firstChild,n),s}}return Fl.EMPTY},yS=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var a=n.createRange();return a.setStart(e,t),a.setEnd(e,t+r),a},z_=function(e){if(Ta.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return Hue(e)},Yue=function(e,t){if(Ta.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(n){return n.segment})}return eAe(e,t)},Jue=function(e,t){return t.letterSpacing!==0?z_(e):Yue(e,t)},Zue=[32,160,4961,65792,65793,4153,4241],eAe=function(e,t){for(var r=Eoe(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],a,s=function(){if(a.value){var o=a.value.slice(),l=Wx(o),c="";l.forEach(function(u){Zue.indexOf(u)===-1?c+=Fn(u):(c.length&&n.push(c),n.push(Fn(u)),c="")}),c.length&&n.push(c)}};!(a=r.next()).done;)s();return n},tAe=function(){function e(t,r,n){this.text=rAe(r.data,n.textTransform),this.textBounds=zue(t,this.text,n,r)}return e}(),rAe=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(nAe,aAe);case 2:return e.toUpperCase();default:return e}},nAe=/(^|\s|:|-|\(|\))([a-z])/g,aAe=function(e,t,r){return e.length>0?t+r.toUpperCase():e},k8=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.src=n.currentSrc||n.src,a.intrinsicWidth=n.naturalWidth,a.intrinsicHeight=n.naturalHeight,a.context.cache.addImage(a.src),a}return t}(Vo),j8=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.canvas=n,a.intrinsicWidth=n.width,a.intrinsicHeight=n.height,a}return t}(Vo),F8=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this,s=new XMLSerializer,o=Gx(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),a.intrinsicWidth=n.width.baseVal.value,a.intrinsicHeight=n.height.baseVal.value,a.context.cache.addImage(a.svg),a}return t}(Vo),T8=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.value=n.value,a}return t}(Vo),R2=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.start=n.start,a.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,a}return t}(Vo),sAe=[{type:15,flags:0,unit:"px",number:3}],iAe=[{type:16,flags:0,number:50}],oAe=function(e){return e.width>e.height?new Fl(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new Fl(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},lAe=function(e){var t=e.type===cAe?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},ax="checkbox",sx="radio",cAe="password",wS=707406591,X_=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this;switch(a.type=n.type.toLowerCase(),a.checked=n.checked,a.value=lAe(n),(a.type===ax||a.type===sx)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=oAe(a.bounds)),a.type){case ax:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=sAe;break;case sx:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=iAe;break}return a}return t}(Vo),I8=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return a.value=s&&s.text||"",a}return t}(Vo),L8=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.value=n.value,a}return t}(Vo),O8=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this;a.src=n.src,a.width=parseInt(n.width,10)||0,a.height=parseInt(n.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){a.tree=P8(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?Ch(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):Nl.TRANSPARENT,o=n.contentWindow.document.body?Ch(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):Nl.TRANSPARENT;a.backgroundColor=kc(s)?kc(o)?a.styles.backgroundColor:o:s}}catch{}return a}return t}(Vo),uAe=["OL","UL","MENU"],Ym=function(e,t,r,n){for(var a=t.firstChild,s=void 0;a;a=s)if(s=a.nextSibling,D8(a)&&a.data.trim().length>0)r.textNodes.push(new tAe(e,a,r.styles));else if(ed(a))if(H8(a)&&a.assignedNodes)a.assignedNodes().forEach(function(l){return Ym(e,l,r,n)});else{var o=U8(e,a);o.styles.isVisible()&&(AAe(a,o,n)?o.flags|=4:dAe(o.styles)&&(o.flags|=2),uAe.indexOf(a.tagName)!==-1&&(o.flags|=8),r.elements.push(o),a.slot,a.shadowRoot?Ym(e,a.shadowRoot,o,n):!ix(a)&&!R8(a)&&!ox(a)&&Ym(e,a,o,n))}},U8=function(e,t){return M2(t)?new k8(e,t):Q8(t)?new j8(e,t):R8(t)?new F8(e,t):fAe(t)?new T8(e,t):hAe(t)?new R2(e,t):pAe(t)?new X_(e,t):ox(t)?new I8(e,t):ix(t)?new L8(e,t):M8(t)?new O8(e,t):new Vo(e,t)},P8=function(e,t){var r=U8(e,t);return r.flags|=4,Ym(e,t,r,r),r},AAe=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||Y_(e)&&r.styles.isTransparent()},dAe=function(e){return e.isPositioned()||e.isFloating()},D8=function(e){return e.nodeType===Node.TEXT_NODE},ed=function(e){return e.nodeType===Node.ELEMENT_NODE},Q2=function(e){return ed(e)&&typeof e.style<"u"&&!Jm(e)},Jm=function(e){return typeof e.className=="object"},fAe=function(e){return e.tagName==="LI"},hAe=function(e){return e.tagName==="OL"},pAe=function(e){return e.tagName==="INPUT"},mAe=function(e){return e.tagName==="HTML"},R8=function(e){return e.tagName==="svg"},Y_=function(e){return e.tagName==="BODY"},Q8=function(e){return e.tagName==="CANVAS"},bS=function(e){return e.tagName==="VIDEO"},M2=function(e){return e.tagName==="IMG"},M8=function(e){return e.tagName==="IFRAME"},_S=function(e){return e.tagName==="STYLE"},gAe=function(e){return e.tagName==="SCRIPT"},ix=function(e){return e.tagName==="TEXTAREA"},ox=function(e){return e.tagName==="SELECT"},H8=function(e){return e.tagName==="SLOT"},NS=function(e){return e.tagName.indexOf("-")>0},xAe=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(n){return r.counters[n].pop()})},e.prototype.parse=function(t){var r=this,n=t.counterIncrement,a=t.counterReset,s=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(s=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return s&&a.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},e}(),BS={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},CS={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},vAe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},yAe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},jA=function(e,t,r,n,a,s){return e<t||e>r?p0(e,a,s.length>0):n.integers.reduce(function(o,l,c){for(;e>=l;)e-=l,o+=n.values[c];return o},"")+s},q8=function(e,t,r,n){var a="";do r||e--,a=n(e)+a,e/=t;while(e*t>=t);return a},kn=function(e,t,r,n,a){var s=r-t+1;return(e<0?"-":"")+(q8(Math.abs(e),s,n,function(o){return Fn(Math.floor(o%s)+t)})+a)},lu=function(e,t,r){r===void 0&&(r=". ");var n=t.length;return q8(Math.abs(e),n,!1,function(a){return t[Math.floor(a%n)]})+r},DA=1,nc=2,ac=4,nh=8,Al=function(e,t,r,n,a,s){if(e<-9999||e>9999)return p0(e,4,a.length>0);var o=Math.abs(e),l=a;if(o===0)return t[0]+l;for(var c=0;o>0&&c<=4;c++){var u=o%10;u===0&&sa(s,DA)&&l!==""?l=t[u]+l:u>1||u===1&&c===0||u===1&&c===1&&sa(s,nc)||u===1&&c===1&&sa(s,ac)&&e>100||u===1&&c>1&&sa(s,nh)?l=t[u]+(c>0?r[c-1]:"")+l:u===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(e<0?n:"")+l},ES="",SS="",kS="",ky="",p0=function(e,t,r){var n=r?". ":"",a=r?"":"",s=r?", ":"",o=r?" ":"";switch(t){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=kn(e,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return lu(e,"",a);case 6:return jA(e,1,3999,BS,3,n).toLowerCase();case 7:return jA(e,1,3999,BS,3,n);case 8:return kn(e,945,969,!1,n);case 9:return kn(e,97,122,!1,n);case 10:return kn(e,65,90,!1,n);case 11:return kn(e,1632,1641,!0,n);case 12:case 49:return jA(e,1,9999,CS,3,n);case 35:return jA(e,1,9999,CS,3,n).toLowerCase();case 13:return kn(e,2534,2543,!0,n);case 14:case 30:return kn(e,6112,6121,!0,n);case 15:return lu(e,"",a);case 16:return lu(e,"",a);case 17:case 48:return Al(e,"",ES,"",a,nc|ac|nh);case 47:return Al(e,"",SS,"",a,DA|nc|ac|nh);case 42:return Al(e,"",ES,"",a,nc|ac|nh);case 41:return Al(e,"",SS,"",a,DA|nc|ac|nh);case 26:return Al(e,"","",kS,a,0);case 25:return Al(e,"","",kS,a,DA|nc|ac);case 31:return Al(e,"","",ky,s,DA|nc|ac);case 33:return Al(e,"","",ky,s,0);case 32:return Al(e,"","",ky,s,DA|nc|ac);case 18:return kn(e,2406,2415,!0,n);case 20:return jA(e,1,19999,yAe,3,n);case 21:return kn(e,2790,2799,!0,n);case 22:return kn(e,2662,2671,!0,n);case 22:return jA(e,1,10999,vAe,3,n);case 23:return lu(e,"");case 24:return lu(e,"");case 27:return kn(e,3302,3311,!0,n);case 28:return lu(e,"",a);case 29:return lu(e,"",a);case 34:return kn(e,3792,3801,!0,n);case 37:return kn(e,6160,6169,!0,n);case 38:return kn(e,4160,4169,!0,n);case 39:return kn(e,2918,2927,!0,n);case 40:return kn(e,1776,1785,!0,n);case 43:return kn(e,3046,3055,!0,n);case 44:return kn(e,3174,3183,!0,n);case 45:return kn(e,3664,3673,!0,n);case 46:return kn(e,3872,3881,!0,n);case 3:default:return kn(e,48,57,!0,n)}},K8="data-html2canvas-ignore",jS=function(){function e(t,r,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new xAe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var n=this,a=wAe(t,r);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,l=a.contentWindow,c=l.document,u=NAe(a).then(function(){return ds(n,void 0,void 0,function(){var A,h;return Wa(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(SAe),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),A=this.options.onclone,h=this.clonedReferenceElement,typeof h>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:f.sent(),f.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,_Ae(c)]:[3,4];case 3:f.sent(),f.label=4;case 4:return typeof A=="function"?[2,Promise.resolve().then(function(){return A(c,h)}).then(function(){return a})]:[2,a]}})})});return c.open(),c.write(CAe(document.doctype)+"<html></html>"),EAe(this.referenceElement.ownerDocument,s,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),u},e.prototype.createElementClone=function(t){if(P2(t,2))debugger;if(Q8(t))return this.createCanvasClone(t);if(bS(t))return this.createVideoClone(t);if(_S(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return M2(r)&&(M2(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),NS(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return jy(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),a=t.cloneNode(!1);return a.textContent=n,a}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var a=t.cloneNode(!1);try{a.width=t.width,a.height=t.height;var s=t.getContext("2d"),o=a.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var l=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return a},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var a=t.ownerDocument.createElement("canvas");return a.width=t.offsetWidth,a.height=t.offsetHeight,a},e.prototype.appendChildNode=function(t,r,n){(!ed(r)||!gAe(r)&&!r.hasAttribute(K8)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!ed(r)||!_S(r))&&t.appendChild(this.cloneNode(r,n))},e.prototype.cloneChildNodes=function(t,r,n){for(var a=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if(ed(s)&&H8(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(l){return a.appendChildNode(r,l,n)})}else this.appendChildNode(r,s,n)},e.prototype.cloneNode=function(t,r){if(D8(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&ed(t)&&(Q2(t)||Jm(t))){var a=this.createElementClone(t);a.style.transitionProperty="none";var s=n.getComputedStyle(t),o=n.getComputedStyle(t,":before"),l=n.getComputedStyle(t,":after");this.referenceElement===t&&Q2(a)&&(this.clonedReferenceElement=a),Y_(a)&&FAe(a);var c=this.counters.parse(new oS(this.context,s)),u=this.resolvePseudoContent(t,a,o,kh.BEFORE);NS(t)&&(r=!0),bS(t)||this.cloneChildNodes(t,a,r),u&&a.insertBefore(u,a.firstChild);var A=this.resolvePseudoContent(t,a,l,kh.AFTER);return A&&a.appendChild(A),this.counters.pop(c),(s&&(this.options.copyStyles||Jm(t))&&!M8(t)||r)&&jy(s,a),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([a,t.scrollLeft,t.scrollTop]),(ix(t)||ox(t))&&(ix(a)||ox(a))&&(a.value=t.value),a}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,n,a){var s=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new oS(this.context,n));var c=new fue(this.context,n),u=l.createElement("html2canvaspseudoelement");jy(n,u),c.content.forEach(function(h){if(h.type===0)u.appendChild(l.createTextNode(h.value));else if(h.type===22){var f=l.createElement("img");f.src=h.value,f.style.opacity="1",u.appendChild(f)}else if(h.type===18){if(h.name==="attr"){var d=h.values.filter(Ur);d.length&&u.appendChild(l.createTextNode(t.getAttribute(d[0].value)||""))}else if(h.name==="counter"){var v=h.values.filter(jd),g=v[0],y=v[1];if(g&&Ur(g)){var p=s.counters.getCounterValue(g.value),m=y&&Ur(y)?U2.parse(s.context,y.value):3;u.appendChild(l.createTextNode(p0(p,m,!1)))}}else if(h.name==="counters"){var w=h.values.filter(jd),g=w[0],x=w[1],y=w[2];if(g&&Ur(g)){var b=s.counters.getCounterValues(g.value),B=y&&Ur(y)?U2.parse(s.context,y.value):3,_=x&&x.type===0?x.value:"",k=b.map(function(S){return p0(S,B,!1)}).join(_);u.appendChild(l.createTextNode(k))}}}else if(h.type===20)switch(h.value){case"open-quote":u.appendChild(l.createTextNode(iS(c.quotes,s.quoteDepth++,!0)));break;case"close-quote":u.appendChild(l.createTextNode(iS(c.quotes,--s.quoteDepth,!1)));break;default:u.appendChild(l.createTextNode(h.value))}}),u.className=H2+" "+q2;var A=a===kh.BEFORE?" "+H2:" "+q2;return Jm(r)?r.className.baseValue+=A:r.className+=A,u}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e}(),kh;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(kh||(kh={}));var wAe=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(K8,"true"),e.body.appendChild(r),r},bAe=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},_Ae=function(e){return Promise.all([].slice.call(e.images,0).map(bAe))},NAe=function(e){return new Promise(function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var a=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var s=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(s),t(e))},50)}})},BAe=["all","d","content"],jy=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);BAe.indexOf(n)===-1&&t.style.setProperty(n,e.getPropertyValue(n))}return t},CAe=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},EAe=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},SAe=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},kAe=":before",jAe=":after",H2="___html2canvas___pseudoelement_before",q2="___html2canvas___pseudoelement_after",FS=`{
    content: "" !important;
    display: none !important;
}`,FAe=function(e){TAe(e,"."+H2+kAe+FS+`
         .`+q2+jAe+FS)},TAe=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},$8=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),IAe=function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(Ty(t)||PAe(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return ds(this,void 0,void 0,function(){var r,n,a,s,o=this;return Wa(this,function(l){switch(l.label){case 0:return r=$8.isSameOrigin(t),n=!Fy(t)&&this._options.useCORS===!0&&Ta.SUPPORT_CORS_IMAGES&&!r,a=!Fy(t)&&!r&&!Ty(t)&&typeof this._options.proxy=="string"&&Ta.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!Fy(t)&&!Ty(t)&&!a&&!n?[2]:(s=t,a?[4,this.proxy(s)]:[3,2]);case 1:s=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(c,u){var A=new Image;A.onload=function(){return c(A)},A.onerror=u,(DAe(s)||n)&&(A.crossOrigin="anonymous"),A.src=s,A.complete===!0&&setTimeout(function(){return c(A)},500),o._options.imageTimeout>0&&setTimeout(function(){return u("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var a=t.substring(0,256);return new Promise(function(s,o){var l=Ta.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")s(c.response);else{var h=new FileReader;h.addEventListener("load",function(){return s(h.result)},!1),h.addEventListener("error",function(f){return o(f)},!1),h.readAsDataURL(c.response)}else o("Failed to proxy resource "+a+" with status code "+c.status)},c.onerror=o;var u=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+u+"url="+encodeURIComponent(t)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var A=r._options.imageTimeout;c.timeout=A,c.ontimeout=function(){return o("Timed out ("+A+"ms) proxying "+a)}}c.send()})},e}(),LAe=/^data:image\/svg\+xml/i,OAe=/^data:image\/.*;base64,/i,UAe=/^data:image\/.*/i,PAe=function(e){return Ta.SUPPORT_SVG_DRAWING||!RAe(e)},Fy=function(e){return UAe.test(e)},DAe=function(e){return OAe.test(e)},Ty=function(e){return e.substr(0,4)==="blob"},RAe=function(e){return e.substr(-3).toLowerCase()==="svg"||LAe.test(e)},wt=function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),FA=function(e,t,r){return new wt(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},Cm=function(){function e(t,r,n,a){this.type=1,this.start=t,this.startControl=r,this.endControl=n,this.end=a}return e.prototype.subdivide=function(t,r){var n=FA(this.start,this.startControl,t),a=FA(this.startControl,this.endControl,t),s=FA(this.endControl,this.end,t),o=FA(n,a,t),l=FA(a,s,t),c=FA(o,l,t);return r?new e(this.start,n,o,c):new e(c,l,s,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),Ni=function(e){return e.type===1},QAe=function(){function e(t){var r=t.styles,n=t.bounds,a=th(r.borderTopLeftRadius,n.width,n.height),s=a[0],o=a[1],l=th(r.borderTopRightRadius,n.width,n.height),c=l[0],u=l[1],A=th(r.borderBottomRightRadius,n.width,n.height),h=A[0],f=A[1],d=th(r.borderBottomLeftRadius,n.width,n.height),v=d[0],g=d[1],y=[];y.push((s+c)/n.width),y.push((v+h)/n.width),y.push((o+g)/n.height),y.push((u+f)/n.height);var p=Math.max.apply(Math,y);p>1&&(s/=p,o/=p,c/=p,u/=p,h/=p,f/=p,v/=p,g/=p);var m=n.width-c,w=n.height-f,x=n.width-h,b=n.height-g,B=r.borderTopWidth,_=r.borderRightWidth,k=r.borderBottomWidth,E=r.borderLeftWidth,T=Vr(r.paddingTop,t.bounds.width),S=Vr(r.paddingRight,t.bounds.width),j=Vr(r.paddingBottom,t.bounds.width),I=Vr(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?an(n.left+E/3,n.top+B/3,s-E/3,o-B/3,Er.TOP_LEFT):new wt(n.left+E/3,n.top+B/3),this.topRightBorderDoubleOuterBox=s>0||o>0?an(n.left+m,n.top+B/3,c-_/3,u-B/3,Er.TOP_RIGHT):new wt(n.left+n.width-_/3,n.top+B/3),this.bottomRightBorderDoubleOuterBox=h>0||f>0?an(n.left+x,n.top+w,h-_/3,f-k/3,Er.BOTTOM_RIGHT):new wt(n.left+n.width-_/3,n.top+n.height-k/3),this.bottomLeftBorderDoubleOuterBox=v>0||g>0?an(n.left+E/3,n.top+b,v-E/3,g-k/3,Er.BOTTOM_LEFT):new wt(n.left+E/3,n.top+n.height-k/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?an(n.left+E*2/3,n.top+B*2/3,s-E*2/3,o-B*2/3,Er.TOP_LEFT):new wt(n.left+E*2/3,n.top+B*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?an(n.left+m,n.top+B*2/3,c-_*2/3,u-B*2/3,Er.TOP_RIGHT):new wt(n.left+n.width-_*2/3,n.top+B*2/3),this.bottomRightBorderDoubleInnerBox=h>0||f>0?an(n.left+x,n.top+w,h-_*2/3,f-k*2/3,Er.BOTTOM_RIGHT):new wt(n.left+n.width-_*2/3,n.top+n.height-k*2/3),this.bottomLeftBorderDoubleInnerBox=v>0||g>0?an(n.left+E*2/3,n.top+b,v-E*2/3,g-k*2/3,Er.BOTTOM_LEFT):new wt(n.left+E*2/3,n.top+n.height-k*2/3),this.topLeftBorderStroke=s>0||o>0?an(n.left+E/2,n.top+B/2,s-E/2,o-B/2,Er.TOP_LEFT):new wt(n.left+E/2,n.top+B/2),this.topRightBorderStroke=s>0||o>0?an(n.left+m,n.top+B/2,c-_/2,u-B/2,Er.TOP_RIGHT):new wt(n.left+n.width-_/2,n.top+B/2),this.bottomRightBorderStroke=h>0||f>0?an(n.left+x,n.top+w,h-_/2,f-k/2,Er.BOTTOM_RIGHT):new wt(n.left+n.width-_/2,n.top+n.height-k/2),this.bottomLeftBorderStroke=v>0||g>0?an(n.left+E/2,n.top+b,v-E/2,g-k/2,Er.BOTTOM_LEFT):new wt(n.left+E/2,n.top+n.height-k/2),this.topLeftBorderBox=s>0||o>0?an(n.left,n.top,s,o,Er.TOP_LEFT):new wt(n.left,n.top),this.topRightBorderBox=c>0||u>0?an(n.left+m,n.top,c,u,Er.TOP_RIGHT):new wt(n.left+n.width,n.top),this.bottomRightBorderBox=h>0||f>0?an(n.left+x,n.top+w,h,f,Er.BOTTOM_RIGHT):new wt(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=v>0||g>0?an(n.left,n.top+b,v,g,Er.BOTTOM_LEFT):new wt(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||o>0?an(n.left+E,n.top+B,Math.max(0,s-E),Math.max(0,o-B),Er.TOP_LEFT):new wt(n.left+E,n.top+B),this.topRightPaddingBox=c>0||u>0?an(n.left+Math.min(m,n.width-_),n.top+B,m>n.width+_?0:Math.max(0,c-_),Math.max(0,u-B),Er.TOP_RIGHT):new wt(n.left+n.width-_,n.top+B),this.bottomRightPaddingBox=h>0||f>0?an(n.left+Math.min(x,n.width-E),n.top+Math.min(w,n.height-k),Math.max(0,h-_),Math.max(0,f-k),Er.BOTTOM_RIGHT):new wt(n.left+n.width-_,n.top+n.height-k),this.bottomLeftPaddingBox=v>0||g>0?an(n.left+E,n.top+Math.min(b,n.height-k),Math.max(0,v-E),Math.max(0,g-k),Er.BOTTOM_LEFT):new wt(n.left+E,n.top+n.height-k),this.topLeftContentBox=s>0||o>0?an(n.left+E+I,n.top+B+T,Math.max(0,s-(E+I)),Math.max(0,o-(B+T)),Er.TOP_LEFT):new wt(n.left+E+I,n.top+B+T),this.topRightContentBox=c>0||u>0?an(n.left+Math.min(m,n.width+E+I),n.top+B+T,m>n.width+E+I?0:c-E+I,u-(B+T),Er.TOP_RIGHT):new wt(n.left+n.width-(_+S),n.top+B+T),this.bottomRightContentBox=h>0||f>0?an(n.left+Math.min(x,n.width-(E+I)),n.top+Math.min(w,n.height+B+T),Math.max(0,h-(_+S)),f-(k+j),Er.BOTTOM_RIGHT):new wt(n.left+n.width-(_+S),n.top+n.height-(k+j)),this.bottomLeftContentBox=v>0||g>0?an(n.left+E+I,n.top+b,Math.max(0,v-(E+I)),g-(k+j),Er.BOTTOM_LEFT):new wt(n.left+E+I,n.top+n.height-(k+j))}return e}(),Er;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Er||(Er={}));var an=function(e,t,r,n,a){var s=4*((Math.sqrt(2)-1)/3),o=r*s,l=n*s,c=e+r,u=t+n;switch(a){case Er.TOP_LEFT:return new Cm(new wt(e,u),new wt(e,u-l),new wt(c-o,t),new wt(c,t));case Er.TOP_RIGHT:return new Cm(new wt(e,t),new wt(e+o,t),new wt(c,u-l),new wt(c,u));case Er.BOTTOM_RIGHT:return new Cm(new wt(c,t),new wt(c,t+l),new wt(e+o,u),new wt(e,u));case Er.BOTTOM_LEFT:default:return new Cm(new wt(c,u),new wt(c-o,u),new wt(e,t+l),new wt(e,t))}},lx=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},MAe=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},cx=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},HAe=function(){function e(t,r,n){this.offsetX=t,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return e}(),Em=function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e}(),qAe=function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e}(),KAe=function(e){return e.type===0},V8=function(e){return e.type===1},$Ae=function(e){return e.type===2},TS=function(e,t){return e.length===t.length?e.some(function(r,n){return r===t[n]}):!1},VAe=function(e,t,r,n,a){return e.map(function(s,o){switch(o){case 0:return s.add(t,r);case 1:return s.add(t+n,r);case 2:return s.add(t+n,r+a);case 3:return s.add(t,r+a)}return s})},G8=function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),W8=function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new QAe(this.container),this.container.styles.opacity<1&&this.effects.push(new qAe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new HAe(n,a,s))}if(this.container.styles.overflowX!==0){var o=lx(this.curves),l=cx(this.curves);TS(o,l)?this.effects.push(new Em(o,6)):(this.effects.push(new Em(o,2)),this.effects.push(new Em(l,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,a=this.effects.slice(0);n;){var s=n.effects.filter(function(c){return!V8(c)});if(r||n.container.styles.position!==0||!n.parent){if(a.unshift.apply(a,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=lx(n.curves),l=cx(n.curves);TS(o,l)||a.unshift(new Em(l,6))}}else a.unshift.apply(a,s);n=n.parent}return a.filter(function(c){return sa(c.target,t)})},e}(),K2=function(e,t,r,n){e.container.elements.forEach(function(a){var s=sa(a.flags,4),o=sa(a.flags,2),l=new W8(a,e);sa(a.styles.display,2048)&&n.push(l);var c=sa(a.flags,8)?[]:n;if(s||o){var u=s||a.styles.isPositioned()?r:t,A=new G8(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var h=a.styles.zIndex.order;if(h<0){var f=0;u.negativeZIndex.some(function(v,g){return h>v.element.container.styles.zIndex.order?(f=g,!1):f>0}),u.negativeZIndex.splice(f,0,A)}else if(h>0){var d=0;u.positiveZIndex.some(function(v,g){return h>=v.element.container.styles.zIndex.order?(d=g+1,!1):d>0}),u.positiveZIndex.splice(d,0,A)}else u.zeroOrAutoZIndexOrTransformedOrOpacity.push(A)}else a.styles.isFloating()?u.nonPositionedFloats.push(A):u.nonPositionedInlineLevel.push(A);K2(l,A,s?A:r,c)}else a.styles.isInlineLevel()?t.inlineLevel.push(l):t.nonInlineLevel.push(l),K2(l,t,r,c);sa(a.flags,8)&&z8(a,c)})},z8=function(e,t){for(var r=e instanceof R2?e.start:1,n=e instanceof R2?e.reversed:!1,a=0;a<t.length;a++){var s=t[a];s.container instanceof T8&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=p0(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},GAe=function(e){var t=new W8(e,null),r=new G8(t),n=[];return K2(t,r,r,n),z8(t.container,n),r},IS=function(e,t){switch(t){case 0:return Ei(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Ei(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Ei(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return Ei(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},WAe=function(e,t){switch(t){case 0:return Ei(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Ei(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Ei(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return Ei(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},zAe=function(e,t){switch(t){case 0:return Ei(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Ei(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Ei(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return Ei(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},XAe=function(e,t){switch(t){case 0:return Sm(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return Sm(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return Sm(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return Sm(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},Sm=function(e,t){var r=[];return Ni(e)?r.push(e.subdivide(.5,!1)):r.push(e),Ni(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Ei=function(e,t,r,n){var a=[];return Ni(e)?a.push(e.subdivide(.5,!1)):a.push(e),Ni(r)?a.push(r.subdivide(.5,!0)):a.push(r),Ni(n)?a.push(n.subdivide(.5,!0).reverse()):a.push(n),Ni(t)?a.push(t.subdivide(.5,!1).reverse()):a.push(t),a},X8=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},ux=function(e){var t=e.styles,r=e.bounds,n=Vr(t.paddingLeft,r.width),a=Vr(t.paddingRight,r.width),s=Vr(t.paddingTop,r.width),o=Vr(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+a),-(t.borderTopWidth+t.borderBottomWidth+s+o))},YAe=function(e,t){return e===0?t.bounds:e===2?ux(t):X8(t)},JAe=function(e,t){return e===0?t.bounds:e===2?ux(t):X8(t)},Iy=function(e,t,r){var n=YAe(RA(e.styles.backgroundOrigin,t),e),a=JAe(RA(e.styles.backgroundClip,t),e),s=ZAe(RA(e.styles.backgroundSize,t),r,n),o=s[0],l=s[1],c=th(RA(e.styles.backgroundPosition,t),n.width-o,n.height-l),u=ede(RA(e.styles.backgroundRepeat,t),c,s,n,a),A=Math.round(n.left+c[0]),h=Math.round(n.top+c[1]);return[u,A,h,o,l]},TA=function(e){return Ur(e)&&e.value===xd.AUTO},km=function(e){return typeof e=="number"},ZAe=function(e,t,r){var n=t[0],a=t[1],s=t[2],o=e[0],l=e[1];if(!o)return[0,0];if(Vn(o)&&l&&Vn(l))return[Vr(o,r.width),Vr(l,r.height)];var c=km(s);if(Ur(o)&&(o.value===xd.CONTAIN||o.value===xd.COVER)){if(km(s)){var u=r.width/r.height;return u<s!=(o.value===xd.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var A=km(n),h=km(a),f=A||h;if(TA(o)&&(!l||TA(l))){if(A&&h)return[n,a];if(!c&&!f)return[r.width,r.height];if(f&&c){var d=A?n:a*s,v=h?a:n/s;return[d,v]}var g=A?n:r.width,y=h?a:r.height;return[g,y]}if(c){var p=0,m=0;return Vn(o)?p=Vr(o,r.width):Vn(l)&&(m=Vr(l,r.height)),TA(o)?p=m*s:(!l||TA(l))&&(m=p/s),[p,m]}var w=null,x=null;if(Vn(o)?w=Vr(o,r.width):l&&Vn(l)&&(x=Vr(l,r.height)),w!==null&&(!l||TA(l))&&(x=A&&h?w/n*a:r.height),x!==null&&TA(o)&&(w=A&&h?x/a*n:r.width),w!==null&&x!==null)return[w,x];throw new Error("Unable to calculate background-size for element")},RA=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},ede=function(e,t,r,n,a){var s=t[0],o=t[1],l=r[0],c=r[1];switch(e){case 2:return[new wt(Math.round(n.left),Math.round(n.top+o)),new wt(Math.round(n.left+n.width),Math.round(n.top+o)),new wt(Math.round(n.left+n.width),Math.round(c+n.top+o)),new wt(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new wt(Math.round(n.left+s),Math.round(n.top)),new wt(Math.round(n.left+s+l),Math.round(n.top)),new wt(Math.round(n.left+s+l),Math.round(n.height+n.top)),new wt(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new wt(Math.round(n.left+s),Math.round(n.top+o)),new wt(Math.round(n.left+s+l),Math.round(n.top+o)),new wt(Math.round(n.left+s+l),Math.round(n.top+o+c)),new wt(Math.round(n.left+s),Math.round(n.top+o+c))];default:return[new wt(Math.round(a.left),Math.round(a.top)),new wt(Math.round(a.left+a.width),Math.round(a.top)),new wt(Math.round(a.left+a.width),Math.round(a.height+a.top)),new wt(Math.round(a.left),Math.round(a.height+a.top))]}},tde="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",LS="Hidden Text",rde=function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var n=this._document.createElement("div"),a=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),a.src=tde,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(LS)),n.appendChild(s),n.appendChild(a);var l=a.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(LS)),n.style.lineHeight="normal",a.style.verticalAlign="super";var c=a.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},e.prototype.getMetrics=function(t,r){var n=t+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,r)),this._data[n]},e}(),Y8=function(){function e(t,r){this.context=t,this.options=r}return e}(),nde=1e4,ade=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a._activeEffects=[],a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),n.canvas||(a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px"),a.fontMetrics=new rde(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),a}return t.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(a){return n.applyEffect(a)})},t.prototype.applyEffect=function(r){this.ctx.save(),$Ae(r)&&(this.ctx.globalAlpha=r.opacity),KAe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),V8(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return ds(this,void 0,void 0,function(){var n;return Wa(this,function(a){switch(a.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return ds(this,void 0,void 0,function(){return Wa(this,function(n){switch(n.label){case 0:if(sa(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,n,a){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+a);else{var o=z_(r.text);o.reduce(function(l,c){return s.ctx.fillText(c,l,r.bounds.top+a),l+s.ctx.measureText(c).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),a=cde(r.fontFamily).join(", "),s=L0(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,a].join(" "),a,s]},t.prototype.renderTextNode=function(r,n){return ds(this,void 0,void 0,function(){var a,s,o,l,c,u,A,h,f=this;return Wa(this,function(d){return a=this.createFontStyle(n),s=a[0],o=a[1],l=a[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),u=c.baseline,A=c.middle,h=n.paintOrder,r.textBounds.forEach(function(v){h.forEach(function(g){switch(g){case 0:f.ctx.fillStyle=fa(n.color),f.renderTextWithLetterSpacing(v,n.letterSpacing,u);var y=n.textShadow;y.length&&v.text.trim().length&&(y.slice(0).reverse().forEach(function(p){f.ctx.shadowColor=fa(p.color),f.ctx.shadowOffsetX=p.offsetX.number*f.options.scale,f.ctx.shadowOffsetY=p.offsetY.number*f.options.scale,f.ctx.shadowBlur=p.blur.number,f.renderTextWithLetterSpacing(v,n.letterSpacing,u)}),f.ctx.shadowColor="",f.ctx.shadowOffsetX=0,f.ctx.shadowOffsetY=0,f.ctx.shadowBlur=0),n.textDecorationLine.length&&(f.ctx.fillStyle=fa(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(p){switch(p){case 1:f.ctx.fillRect(v.bounds.left,Math.round(v.bounds.top+u),v.bounds.width,1);break;case 2:f.ctx.fillRect(v.bounds.left,Math.round(v.bounds.top),v.bounds.width,1);break;case 3:f.ctx.fillRect(v.bounds.left,Math.ceil(v.bounds.top+A),v.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&v.text.trim().length&&(f.ctx.strokeStyle=fa(n.webkitTextStrokeColor),f.ctx.lineWidth=n.webkitTextStrokeWidth,f.ctx.lineJoin=window.chrome?"miter":"round",f.ctx.strokeText(v.text,v.bounds.left,v.bounds.top+u)),f.ctx.strokeStyle="",f.ctx.lineWidth=0,f.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,n,a){if(a&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=ux(r),o=cx(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return ds(this,void 0,void 0,function(){var n,a,s,o,l,c,m,m,u,A,h,f,x,d,v,b,g,y,p,m,w,x,b;return Wa(this,function(B){switch(B.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,a=r.curves,s=n.styles,o=0,l=n.textNodes,B.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,s)]):[3,4];case 2:B.sent(),B.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof k8))return[3,8];B.label=5;case 5:return B.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return m=B.sent(),this.renderReplacedElement(n,a,m),[3,8];case 7:return B.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof j8&&this.renderReplacedElement(n,a,n.canvas),!(n instanceof F8))return[3,12];B.label=9;case 9:return B.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return m=B.sent(),this.renderReplacedElement(n,a,m),[3,12];case 11:return B.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof O8&&n.tree?(u=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,u.render(n.tree)]):[3,14];case 13:A=B.sent(),n.width&&n.height&&this.ctx.drawImage(A,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),B.label=14;case 14:if(n instanceof X_&&(h=Math.min(n.bounds.width,n.bounds.height),n.type===ax?n.checked&&(this.ctx.save(),this.path([new wt(n.bounds.left+h*.39363,n.bounds.top+h*.79),new wt(n.bounds.left+h*.16,n.bounds.top+h*.5549),new wt(n.bounds.left+h*.27347,n.bounds.top+h*.44071),new wt(n.bounds.left+h*.39694,n.bounds.top+h*.5649),new wt(n.bounds.left+h*.72983,n.bounds.top+h*.23),new wt(n.bounds.left+h*.84,n.bounds.top+h*.34085),new wt(n.bounds.left+h*.39363,n.bounds.top+h*.79)]),this.ctx.fillStyle=fa(wS),this.ctx.fill(),this.ctx.restore()):n.type===sx&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+h/2,n.bounds.top+h/2,h/4,0,Math.PI*2,!0),this.ctx.fillStyle=fa(wS),this.ctx.fill(),this.ctx.restore())),sde(n)&&n.value.length){switch(f=this.createFontStyle(s),x=f[0],d=f[1],v=this.fontMetrics.getMetrics(x,d).baseline,this.ctx.font=x,this.ctx.fillStyle=fa(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=ode(n.styles.textAlign),b=ux(n),g=0,n.styles.textAlign){case 1:g+=b.width/2;break;case 2:g+=b.width;break}y=b.add(g,0,0,-b.height/2+1),this.ctx.save(),this.path([new wt(b.left,b.top),new wt(b.left+b.width,b.top),new wt(b.left+b.width,b.top+b.height),new wt(b.left,b.top+b.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Sh(n.value,y),s.letterSpacing,v),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!sa(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(p=n.styles.listStyleImage,p.type!==0)return[3,18];m=void 0,w=p.url,B.label=15;case 15:return B.trys.push([15,17,,18]),[4,this.context.cache.match(w)];case 16:return m=B.sent(),this.ctx.drawImage(m,n.bounds.left-(m.width+10),n.bounds.top),[3,18];case 17:return B.sent(),this.context.logger.error("Error loading list-style-image "+w),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(x=this.createFontStyle(s)[0],this.ctx.font=x,this.ctx.fillStyle=fa(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",b=new Fl(n.bounds.left,n.bounds.top+Vr(n.styles.paddingTop,n.bounds.width),n.bounds.width,aS(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Sh(r.listValue,b),s.letterSpacing,aS(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),B.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return ds(this,void 0,void 0,function(){var n,a,p,s,o,p,l,c,p,u,A,p,h,f,p,d,v,p,g,y,p;return Wa(this,function(m){switch(m.label){case 0:if(sa(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:m.sent(),n=0,a=r.negativeZIndex,m.label=2;case 2:return n<a.length?(p=a[n],[4,this.renderStack(p)]):[3,5];case 3:m.sent(),m.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:m.sent(),s=0,o=r.nonInlineLevel,m.label=7;case 7:return s<o.length?(p=o[s],[4,this.renderNode(p)]):[3,10];case 8:m.sent(),m.label=9;case 9:return s++,[3,7];case 10:l=0,c=r.nonPositionedFloats,m.label=11;case 11:return l<c.length?(p=c[l],[4,this.renderStack(p)]):[3,14];case 12:m.sent(),m.label=13;case 13:return l++,[3,11];case 14:u=0,A=r.nonPositionedInlineLevel,m.label=15;case 15:return u<A.length?(p=A[u],[4,this.renderStack(p)]):[3,18];case 16:m.sent(),m.label=17;case 17:return u++,[3,15];case 18:h=0,f=r.inlineLevel,m.label=19;case 19:return h<f.length?(p=f[h],[4,this.renderNode(p)]):[3,22];case 20:m.sent(),m.label=21;case 21:return h++,[3,19];case 22:d=0,v=r.zeroOrAutoZIndexOrTransformedOrOpacity,m.label=23;case 23:return d<v.length?(p=v[d],[4,this.renderStack(p)]):[3,26];case 24:m.sent(),m.label=25;case 25:return d++,[3,23];case 26:g=0,y=r.positiveZIndex,m.label=27;case 27:return g<y.length?(p=y[g],[4,this.renderStack(p)]):[3,30];case 28:m.sent(),m.label=29;case 29:return g++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var n=this;r.forEach(function(a,s){var o=Ni(a)?a.start:a;s===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),Ni(a)&&n.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},t.prototype.renderRepeat=function(r,n,a,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},t.prototype.resizeImage=function(r,n,a){var s;if(r.width===n&&r.height===a)return r;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,a);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,a),l},t.prototype.renderBackgroundImage=function(r){return ds(this,void 0,void 0,function(){var n,a,s,o,l,c;return Wa(this,function(u){switch(u.label){case 0:n=r.styles.backgroundImage.length-1,a=function(A){var h,f,d,T,V,X,I,U,k,v,T,V,X,I,U,g,y,p,m,w,x,b,B,_,k,E,T,S,j,I,U,q,V,X,W,M,G,H,C,L,O,D;return Wa(this,function(P){switch(P.label){case 0:if(A.type!==0)return[3,5];h=void 0,f=A.url,P.label=1;case 1:return P.trys.push([1,3,,4]),[4,s.context.cache.match(f)];case 2:return h=P.sent(),[3,4];case 3:return P.sent(),s.context.logger.error("Error loading background-image "+f),[3,4];case 4:return h&&(d=Iy(r,n,[h.width,h.height,h.width/h.height]),T=d[0],V=d[1],X=d[2],I=d[3],U=d[4],k=s.ctx.createPattern(s.resizeImage(h,I,U),"repeat"),s.renderRepeat(T,k,V,X)),[3,6];case 5:Kle(A)?(v=Iy(r,n,[null,null,null]),T=v[0],V=v[1],X=v[2],I=v[3],U=v[4],g=Rle(A.angle,I,U),y=g[0],p=g[1],m=g[2],w=g[3],x=g[4],b=document.createElement("canvas"),b.width=I,b.height=U,B=b.getContext("2d"),_=B.createLinearGradient(p,w,m,x),rS(A.stops,y).forEach(function(Q){return _.addColorStop(Q.stop,fa(Q.color))}),B.fillStyle=_,B.fillRect(0,0,I,U),I>0&&U>0&&(k=s.ctx.createPattern(b,"repeat"),s.renderRepeat(T,k,V,X))):$le(A)&&(E=Iy(r,n,[null,null,null]),T=E[0],S=E[1],j=E[2],I=E[3],U=E[4],q=A.position.length===0?[V_]:A.position,V=Vr(q[0],I),X=Vr(q[q.length-1],U),W=Qle(A,V,X,I,U),M=W[0],G=W[1],M>0&&G>0&&(H=s.ctx.createRadialGradient(S+V,j+X,0,S+V,j+X,M),rS(A.stops,M*2).forEach(function(Q){return H.addColorStop(Q.stop,fa(Q.color))}),s.path(T),s.ctx.fillStyle=H,M!==G?(C=r.bounds.left+.5*r.bounds.width,L=r.bounds.top+.5*r.bounds.height,O=G/M,D=1/O,s.ctx.save(),s.ctx.translate(C,L),s.ctx.transform(1,0,0,O,0,0),s.ctx.translate(-C,-L),s.ctx.fillRect(S,D*(j-L)+L,I,U*D),s.ctx.restore()):s.ctx.fill())),P.label=6;case 6:return n--,[2]}})},s=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),u.label=1;case 1:return o<l.length?(c=l[o],[5,a(c)]):[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,n,a){return ds(this,void 0,void 0,function(){return Wa(this,function(s){return this.path(IS(a,n)),this.ctx.fillStyle=fa(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,n,a,s){return ds(this,void 0,void 0,function(){var o,l;return Wa(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,a,s)]:[3,2];case 1:return c.sent(),[2];case 2:return o=WAe(s,a),this.path(o),this.ctx.fillStyle=fa(r),this.ctx.fill(),l=zAe(s,a),this.path(l),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return ds(this,void 0,void 0,function(){var n,a,s,o,l,c,u,A,h=this;return Wa(this,function(f){switch(f.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,a=!kc(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=ide(RA(n.backgroundClip,0),r.curves),a||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),kc(n.backgroundColor)||(this.ctx.fillStyle=fa(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:f.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(d){h.ctx.save();var v=lx(r.curves),g=d.inset?0:nde,y=VAe(v,-g+(d.inset?1:-1)*d.spread.number,(d.inset?1:-1)*d.spread.number,d.spread.number*(d.inset?-2:2),d.spread.number*(d.inset?-2:2));d.inset?(h.path(v),h.ctx.clip(),h.mask(y)):(h.mask(v),h.ctx.clip(),h.path(y)),h.ctx.shadowOffsetX=d.offsetX.number+g,h.ctx.shadowOffsetY=d.offsetY.number,h.ctx.shadowColor=fa(d.color),h.ctx.shadowBlur=d.blur.number,h.ctx.fillStyle=d.inset?fa(d.color):"rgba(0,0,0,1)",h.ctx.fill(),h.ctx.restore()}),f.label=2;case 2:l=0,c=0,u=s,f.label=3;case 3:return c<u.length?(A=u[c],A.style!==0&&!kc(A.color)&&A.width>0?A.style!==2?[3,5]:[4,this.renderDashedDottedBorder(A.color,A.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return f.sent(),[3,11];case 5:return A.style!==3?[3,7]:[4,this.renderDashedDottedBorder(A.color,A.width,l,r.curves,3)];case 6:return f.sent(),[3,11];case 7:return A.style!==4?[3,9]:[4,this.renderDoubleBorder(A.color,A.width,l,r.curves)];case 8:return f.sent(),[3,11];case 9:return[4,this.renderSolidBorder(A.color,l,r.curves)];case 10:f.sent(),f.label=11;case 11:l++,f.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,n,a,s,o){return ds(this,void 0,void 0,function(){var l,c,u,A,h,f,d,v,g,y,p,m,w,x,b,B,b,B;return Wa(this,function(_){return this.ctx.save(),l=XAe(s,a),c=IS(s,a),o===2&&(this.path(c),this.ctx.clip()),Ni(c[0])?(u=c[0].start.x,A=c[0].start.y):(u=c[0].x,A=c[0].y),Ni(c[1])?(h=c[1].end.x,f=c[1].end.y):(h=c[1].x,f=c[1].y),a===0||a===2?d=Math.abs(u-h):d=Math.abs(A-f),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),v=n<3?n*3:n*2,g=n<3?n*2:n,o===3&&(v=n,g=n),y=!0,d<=v*2?y=!1:d<=v*2+g?(p=d/(2*v+g),v*=p,g*=p):(m=Math.floor((d+g)/(v+g)),w=(d-m*v)/(m-1),x=(d-(m+1)*v)/m,g=x<=0||Math.abs(g-w)<Math.abs(g-x)?w:x),y&&(o===3?this.ctx.setLineDash([0,v+g]):this.ctx.setLineDash([v,g])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=fa(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(Ni(c[0])&&(b=c[3],B=c[0],this.ctx.beginPath(),this.formatPath([new wt(b.end.x,b.end.y),new wt(B.start.x,B.start.y)]),this.ctx.stroke()),Ni(c[1])&&(b=c[1],B=c[2],this.ctx.beginPath(),this.formatPath([new wt(b.end.x,b.end.y),new wt(B.start.x,B.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return ds(this,void 0,void 0,function(){var n;return Wa(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=fa(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=GAe(r),[4,this.renderStack(n)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(Y8),sde=function(e){return e instanceof L8||e instanceof I8?!0:e instanceof X_&&e.type!==sx&&e.type!==ax},ide=function(e,t){switch(e){case 0:return lx(t);case 2:return MAe(t);case 1:default:return cx(t)}},ode=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},lde=["-apple-system","system-ui"],cde=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return lde.indexOf(t)===-1}):e},ude=function(e){mo(t,e);function t(r,n){var a=e.call(this,r,n)||this;return a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=n,a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),a}return t.prototype.render=function(r){return ds(this,void 0,void 0,function(){var n,a;return Wa(this,function(s){switch(s.label){case 0:return n=D2(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,Ade(n)];case 1:return a=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=fa(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(Y8),Ade=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},dde=function(){function e(t){var r=t.id,n=t.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,om([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,om([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,om([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,om([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e}(),fde=function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new dde({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new IAe(this,t)}return e.instanceCount=1,e}(),n1=function(e,t){return t===void 0&&(t={}),hde(e,t)};typeof window<"u"&&$8.setContext(window);var hde=function(e,t){return ds(void 0,void 0,void 0,function(){var r,n,a,s,o,l,c,u,A,h,f,d,v,g,y,p,m,w,x,b,_,B,_,k,E,T,S,j,I,U,q,V,X,W,M,G,H,C,L,O;return Wa(this,function(D){switch(D.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return a={allowTaint:(k=t.allowTaint)!==null&&k!==void 0?k:!1,imageTimeout:(E=t.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:t.proxy,useCORS:(T=t.useCORS)!==null&&T!==void 0?T:!1},s=_2({logging:(S=t.logging)!==null&&S!==void 0?S:!0,cache:t.cache},a),o={windowWidth:(j=t.windowWidth)!==null&&j!==void 0?j:n.innerWidth,windowHeight:(I=t.windowHeight)!==null&&I!==void 0?I:n.innerHeight,scrollX:(U=t.scrollX)!==null&&U!==void 0?U:n.pageXOffset,scrollY:(q=t.scrollY)!==null&&q!==void 0?q:n.pageYOffset},l=new Fl(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new fde(s,l),u=(V=t.foreignObjectRendering)!==null&&V!==void 0?V:!1,A={allowTaint:(X=t.allowTaint)!==null&&X!==void 0?X:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:u,copyStyles:u},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),h=new jS(c,e,A),f=h.clonedReferenceElement,f?[4,h.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return d=D.sent(),v=Y_(f)||mAe(f)?Vie(f.ownerDocument):Gx(c,f),g=v.width,y=v.height,p=v.left,m=v.top,w=pde(c,f,t.backgroundColor),x={canvas:t.canvas,backgroundColor:w,scale:(M=(W=t.scale)!==null&&W!==void 0?W:n.devicePixelRatio)!==null&&M!==void 0?M:1,x:((G=t.x)!==null&&G!==void 0?G:0)+p,y:((H=t.y)!==null&&H!==void 0?H:0)+m,width:(C=t.width)!==null&&C!==void 0?C:Math.ceil(g),height:(L=t.height)!==null&&L!==void 0?L:Math.ceil(y)},u?(c.logger.debug("Document cloned, using foreign object rendering"),_=new ude(c,x),[4,_.render(f)]):[3,3];case 2:return b=D.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+p+","+m+" with size "+g+"x"+y+" using computed rendering"),c.logger.debug("Starting DOM parsing"),B=P8(c,f),w===B.styles.backgroundColor&&(B.styles.backgroundColor=Nl.TRANSPARENT),c.logger.debug("Starting renderer for element at "+x.x+","+x.y+" with size "+x.width+"x"+x.height),_=new ade(c,x),[4,_.render(B)];case 4:b=D.sent(),D.label=5;case 5:return(!((O=t.removeContainer)!==null&&O!==void 0)||O)&&(jS.destroy(d)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,b]}})})},pde=function(e,t,r){var n=t.ownerDocument,a=n.documentElement?Ch(e,getComputedStyle(n.documentElement).backgroundColor):Nl.TRANSPARENT,s=n.body?Ch(e,getComputedStyle(n.body).backgroundColor):Nl.TRANSPARENT,o=typeof r=="string"?Ch(e,r):r===null?Nl.TRANSPARENT:4294967295;return t===n.documentElement?kc(a)?kc(s)?o:s:a:o};const mde=Object.freeze(Object.defineProperty({__proto__:null,default:n1},Symbol.toStringTag,{value:"Module"}));function gde({challan:e,items:t,onClose:r}){var A,h,f,d,v,g,y;const n=Z.useRef(null),a=()=>{window.print()},s=async()=>{if(n.current)try{const p=await n1(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:T=>{const S=T.getElementById("challan-print-content");S&&(S.style.width="210mm")}}),m=p.toDataURL("image/png",1),w=new Ot("p","mm","a4"),x=w.internal.pageSize.getWidth(),b=w.internal.pageSize.getHeight(),B=p.width,_=p.height,k=x/B,E=_*k;if(E>b){let T=0,S=E;for(;S>0;)w.addImage(m,"PNG",0,T,x,E),S-=b,T-=b,S>0&&w.addPage()}else w.addImage(m,"PNG",0,0,x,E);w.save(`Delivery-Challan-${e.challan_number}.pdf`)}catch(p){console.error("Error generating PDF:",p),alert("Failed to generate PDF. Please try again.")}},o=p=>{const m=new Date(p),w=m.getDate(),x=m.getMonth()+1,b=m.getFullYear();return`${w.toString().padStart(2,"0")}-${x.toString().padStart(2,"0")}-${b}`},l=p=>{const m=new Date(p),x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][m.getMonth()],b=m.getFullYear();return`${x} ${b}`},c=t.reduce((p,m)=>p+m.quantity,0),u=((h=(A=t[0])==null?void 0:A.products)==null?void 0:h.unit)||"kg";return i.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[i.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:i.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[i.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4 print:hidden",children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Surat Jalan ",e.challan_number]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:a,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[i.jsx(Wb,{className:"h-4 w-4"}),"Cetak"]}),i.jsxs("button",{onClick:s,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[i.jsx(Qo,{className:"h-4 w-4"}),"PDF"]}),i.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:i.jsx(An,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{id:"challan-print-content",ref:n,className:"p-8",children:[i.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[i.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:i.jsxs("g",{children:[i.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),i.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),i.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),i.jsx("div",{className:"text-right",children:i.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:"SURAT JALAN"})})]}),i.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No izin PBF"}),i.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),i.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),i.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[i.jsx("div",{className:"mb-1",children:i.jsx("span",{className:"font-bold",children:"Company Name:"})}),i.jsx("div",{className:"ml-4 mb-2",children:i.jsx("p",{className:"font-semibold",children:((f=e.customers)==null?void 0:f.company_name)||""})}),i.jsx("div",{className:"mb-1",children:i.jsx("span",{className:"font-bold",children:"Address:"})}),i.jsxs("div",{className:"ml-4 mb-2",children:[i.jsx("p",{children:e.delivery_address||""}),i.jsx("p",{children:((d=e.customers)==null?void 0:d.city)||""})]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Phone:"}),i.jsx("span",{className:"ml-2",children:((v=e.customers)==null?void 0:v.phone)||"-"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"No.Izin PBF:"}),i.jsx("span",{className:"ml-2",children:((g=e.customers)==null?void 0:g.pbf_license)||"-"})]})]}),i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right w-64",children:[i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Challan No: "}),i.jsx("span",{children:e.challan_number})]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Challan Date: "}),i.jsx("span",{children:o(e.challan_date)})]}),e.vehicle_number&&i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Vehicle No: "}),i.jsx("span",{children:e.vehicle_number})]})]})]})}),i.jsx("div",{className:"mb-3 border-2 border-black print:mb-2",children:i.jsxs("table",{className:"w-full border-collapse text-xs print:text-[10px]",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b-2 border-black",children:[i.jsx("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"5%"},children:"No"}),i.jsxs("th",{className:"border-r border-black p-2 text-left font-bold print:p-1",style:{width:"30%"},children:["Nama Produk",i.jsx("br",{}),"Product Name"]}),i.jsxs("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"12%"},children:["No Batch",i.jsx("br",{}),"Batch No"]}),i.jsx("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"12%"},children:"Exp. Date"}),i.jsxs("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"18%"},children:["Kemasan",i.jsx("br",{}),"Packaging"]}),i.jsxs("th",{className:"border-r border-black p-2 text-center font-bold print:p-1",style:{width:"8%"},children:["Jumlah",i.jsx("br",{}),"Packs"]}),i.jsxs("th",{className:"p-2 text-center font-bold print:p-1",style:{width:"15%"},children:["Kuantitas",i.jsx("br",{}),"Quantity"]})]})}),i.jsxs("tbody",{children:[t.map((p,m)=>{var w,x,b,B,_;return i.jsxs("tr",{className:"border-b border-black",children:[i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:m+1}),i.jsx("td",{className:"border-r border-black p-2 print:p-1",children:(w=p.products)==null?void 0:w.product_name}),i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:(x=p.batches)==null?void 0:x.batch_number}),i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:(b=p.batches)!=null&&b.expiry_date?l(p.batches.expiry_date):"-"}),i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:p.pack_type&&p.pack_size&&p.number_of_packs?`${p.pack_size} ${((B=p.products)==null?void 0:B.unit)||"kg"}/${p.pack_type}`:p.pack_type&&p.pack_size?`${p.pack_size} ${p.pack_type}`:"-"}),i.jsx("td",{className:"border-r border-black p-2 text-center print:p-1",children:p.number_of_packs||"-"}),i.jsxs("td",{className:"p-2 text-center print:p-1",children:[p.quantity.toLocaleString()," ",((_=p.products)==null?void 0:_.unit)||u]})]},p.id)}),i.jsxs("tr",{className:"border-t-2 border-black bg-gray-50 font-bold",children:[i.jsx("td",{colSpan:6,className:"border-r border-black p-2 text-right print:p-1",children:"Total Kuantitas / Total Quantity:"}),i.jsxs("td",{className:"p-2 text-center print:p-1",children:[c.toLocaleString()," ",u]})]})]})]})}),i.jsxs("div",{className:"mb-3 p-2 print:mb-2 print:p-1.5",children:[i.jsx("p",{className:"text-xs font-semibold print:text-[10px]",children:"Catatan / Notes:"}),e.notes?i.jsx("p",{className:"text-xs print:text-[10px] mt-1",children:e.notes}):i.jsx("p",{className:"text-xs print:text-[10px] mt-1",children:"Produk dikirim dalam kondisi sesuai persyaratan penyimpanan / Goods are delivered under controlled storage conditions."})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-3 print:gap-2",children:[i.jsxs("div",{className:"border-2 border-black p-2 text-center print:p-1.5",children:[i.jsxs("div",{className:"mb-2 text-xs font-semibold print:mb-1 print:text-[10px]",children:["Disiapkan Oleh",i.jsx("br",{}),"Prepared By"]}),i.jsx("div",{className:"mb-10 print:mb-8",children:i.jsx("div",{className:"h-12 print:h-10"})}),i.jsxs("div",{className:"border-t-2 border-black pt-2 print:pt-1",children:[i.jsx("p",{className:"text-xs print:text-[10px]",children:"Tanda Tangan & Tanggal"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Signature & Date"}),i.jsx("p",{className:"text-[10px] font-semibold mt-1 print:text-[8px] print:mt-0.5",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),i.jsxs("div",{className:"border-2 border-black p-2 text-center print:p-1.5",children:[i.jsxs("div",{className:"mb-2 text-xs font-semibold print:mb-1 print:text-[10px]",children:["Dikirim Oleh",i.jsx("br",{}),"Delivered By"]}),i.jsx("div",{className:"mb-10 print:mb-8",children:i.jsx("div",{className:"h-12 print:h-10"})}),i.jsxs("div",{className:"border-t-2 border-black pt-2 print:pt-1",children:[i.jsx("p",{className:"text-xs print:text-[10px]",children:"Tanda Tangan & Tanggal"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Signature & Date"}),i.jsx("p",{className:"text-[10px] font-semibold mt-1 print:text-[8px] print:mt-0.5",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),i.jsxs("div",{className:"border-2 border-black p-2 text-center print:p-1.5",children:[i.jsxs("div",{className:"mb-2 text-xs font-semibold print:mb-1 print:text-[10px]",children:["Farmasi",i.jsx("br",{}),"Pharmacist"]}),i.jsx("div",{className:"mb-10 print:mb-8",children:i.jsx("div",{className:"h-12 print:h-10"})}),i.jsxs("div",{className:"border-t-2 border-black pt-2 print:pt-1",children:[i.jsx("p",{className:"text-xs print:text-[10px]",children:"Tanda Tangan & Tanggal"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Signature & Date"}),i.jsx("p",{className:"text-[10px] font-semibold mt-1 print:text-[8px] print:mt-0.5",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),i.jsxs("div",{className:"border-2 border-black p-2 text-center print:p-1.5",children:[i.jsxs("div",{className:"mb-2 text-xs font-semibold print:mb-1 print:text-[10px]",children:["Diterima Oleh",i.jsx("br",{}),"Received By"]}),i.jsx("div",{className:"mb-10 print:mb-8",children:i.jsx("div",{className:"h-12 print:h-10"})}),i.jsxs("div",{className:"border-t-2 border-black pt-2 print:pt-1",children:[i.jsx("p",{className:"text-xs print:text-[10px]",children:"Tanda Tangan & Tanggal"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Signature & Date"}),i.jsx("p",{className:"text-[10px] font-semibold mt-1 print:text-[8px] print:mt-0.5",children:((y=e.customers)==null?void 0:y.company_name)||""})]})]})]})]})]})}),i.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #challan-print-content,
          #challan-print-content * {
            visibility: visible;
          }

          #challan-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #challan-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}const xde=e=>e?new Date(e)<new Date:!1;function vde(){const{profile:e}=Dr(),{setCurrentPage:t,setNavigationData:r}=Mo(),[n,a]=Z.useState([]),[s,o]=Z.useState([]),[l,c]=Z.useState([]),[u,A]=Z.useState([]),[h,f]=Z.useState(!0),[d,v]=Z.useState(!1),[g,y]=Z.useState(!1),[p,m]=Z.useState(null),[w,x]=Z.useState([]),[b,B]=Z.useState(null),[_,k]=Z.useState(null),[E,T]=Z.useState([]),[S,j]=Z.useState(!1),[I,U]=Z.useState(""),[q,V]=Z.useState(null),[X,W]=Z.useState({challan_number:"",customer_id:"",sales_order_id:"",challan_date:new Date().toISOString().split("T")[0],delivery_address:"",vehicle_number:"",driver_name:"",notes:""}),[M,G]=Z.useState([]),[H,C]=Z.useState([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}]);Z.useEffect(()=>{D(),Q(),J(),te(),O()},[]);const L=async fe=>{try{let Ee=de.from("sales_orders").select(`
          id,
          so_number,
          customer_id,
          status,
          customers(company_name)
        `).in("status",["approved","stock_reserved","shortage","pending_delivery"]).eq("is_archived",!1).order("so_date",{ascending:!1});fe&&(Ee=Ee.eq("customer_id",fe));const{data:qe,error:Qe}=await Ee;if(Qe)throw Qe;G(qe||[])}catch(Ee){console.error("Error loading sales orders:",Ee)}},O=async()=>{try{const{data:fe,error:Ee}=await de.from("app_settings").select("*").limit(1).maybeSingle();if(Ee)throw Ee;B(fe)}catch(fe){console.error("Error loading company settings:",fe)}},D=async()=>{try{const{data:fe,error:Ee}=await de.from("delivery_challans").select("*, customers(company_name, address, city, phone, pbf_license)").order("challan_date",{ascending:!1});if(Ee)throw Ee;a(fe||[])}catch(fe){console.error("Error loading challans:",fe)}finally{f(!1)}},P=async()=>{try{const{data:fe}=await de.from("app_settings").select("financial_year_start").limit(1).maybeSingle();let Ee=new Date().getFullYear().toString().slice(-2);fe!=null&&fe.financial_year_start&&(Ee=new Date(fe.financial_year_start).getFullYear().toString().slice(-2));const qe="DO",{data:Qe}=await de.from("delivery_challans").select("challan_number").or(`challan_number.like.DO-${Ee}%,challan_number.like.DC-${Ee}%`);let Ye=1;if(Qe&&Qe.length>0){const xt=Qe.map(it=>{const ut=it.challan_number.match(/(\d+)$/);return ut?parseInt(ut[1],10):0}).filter(it=>!isNaN(it));xt.length>0&&(Ye=Math.max(...xt)+1)}const Nt=String(Ye).padStart(4,"0");return`${qe}-${Ee}-${Nt}`}catch(fe){return console.error("Error generating challan number:",fe),"DO-25-0001"}},Q=async()=>{try{const{data:fe,error:Ee}=await de.from("customers").select("id, company_name, address, city").eq("is_active",!0).order("company_name");if(Ee)throw Ee;o(fe||[])}catch(fe){console.error("Error loading customers:",fe)}},J=async()=>{try{const{data:fe,error:Ee}=await de.from("products").select("id, product_name, product_code, unit").eq("is_active",!0).order("product_name");if(Ee)throw Ee;c(fe||[])}catch(fe){console.error("Error loading products:",fe)}},te=async()=>{try{const{data:fe,error:Ee}=await de.from("batches").select("id, batch_number, product_id, current_stock, expiry_date, packaging_details, import_date").eq("is_active",!0).gt("current_stock",0).order("import_date",{ascending:!0});if(Ee)throw Ee;A(fe||[])}catch(fe){console.error("Error loading batches:",fe)}},z=async fe=>{try{const{data:Ee,error:qe}=await de.from("delivery_challan_items").select("*, products(product_name, product_code, unit), batches(batch_number, expiry_date, packaging_details, current_stock)").eq("challan_id",fe);if(qe)throw qe;return Ee||[]}catch(Ee){return console.error("Error loading challan items:",Ee),[]}},ye=fe=>u.filter(qe=>qe.product_id===fe&&!xde(qe.expiry_date)).sort((qe,Qe)=>{const Ye=new Date(qe.import_date).getTime(),Nt=new Date(Qe.import_date).getTime();return Ye-Nt})[0]||null,re=fe=>{const Ee=s.find(qe=>qe.id===fe);Ee&&(W({...X,customer_id:fe,sales_order_id:"",delivery_address:`${Ee.address}, ${Ee.city}`}),L(fe))},ke=async fe=>{if(W({...X,sales_order_id:fe}),fe){const Ee=M.find(qe=>qe.id===fe);if(Ee){W(qe=>({...qe,customer_id:Ee.customer_id}));try{const{data:qe,error:Qe}=await de.from("sales_order_items").select(`
              id,
              product_id,
              quantity,
              products(product_name)
            `).eq("sales_order_id",fe);if(Qe)throw Qe;if(qe&&qe.length>0){const Ye=qe.map(Nt=>{const xt=u.filter(Et=>Et.product_id===Nt.product_id&&Et.current_stock>0),it=xt.length>0?xt[0]:null;if(!it)return{product_id:Nt.product_id,batch_id:"",quantity:Nt.quantity,pack_size:null,pack_type:null,number_of_packs:null};let ut=null,Mt=null,ht=null;if(it.packaging_details){const Et=it.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/i);Et&&(ht=parseInt(Et[1],10),Mt=Et[2].toLowerCase(),ut=parseFloat(Et[3]))}return{product_id:Nt.product_id,batch_id:it.id,quantity:Nt.quantity,pack_size:ut,pack_type:Mt,number_of_packs:ht||1}});C(Ye)}}catch(qe){console.error("Error loading SO items:",qe),alert("Failed to load Sales Order items. Please try again.")}}}else C([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},be=(fe,Ee)=>{const qe=u.find(Qe=>Qe.id===Ee);if(qe){const Qe=[...H];let Ye=null,Nt=null,xt=null;if(qe.packaging_details){const it=qe.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/i);it&&(xt=parseInt(it[1],10),Nt=it[2].toLowerCase(),Ye=parseFloat(it[3]))}Qe[fe]={...Qe[fe],batch_id:Ee,pack_size:Ye,pack_type:Nt,number_of_packs:xt||1,quantity:Ye&&xt?Ye*xt:0},C(Qe)}},ae=(fe,Ee)=>{const qe=[...H],Qe=qe[fe];Qe.pack_size&&(qe[fe]={...Qe,number_of_packs:Ee,quantity:Qe.pack_size*Ee},C(qe))},Ie=()=>{C([...H,{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},De=fe=>{H.length>1&&C(H.filter((Ee,qe)=>qe!==fe))},pe=async fe=>{k(fe),W({challan_number:fe.challan_number,customer_id:fe.customer_id,challan_date:fe.challan_date,delivery_address:fe.delivery_address,vehicle_number:fe.vehicle_number||"",driver_name:fe.driver_name||"",notes:fe.notes||""});const Ee=await z(fe.id);T(Ee),Ee.length>0&&C(Ee.map(qe=>({product_id:qe.product_id,batch_id:qe.batch_id,quantity:qe.quantity,pack_size:qe.pack_size,pack_type:qe.pack_type,number_of_packs:qe.number_of_packs}))),v(!0)},we=async fe=>{if(fe.preventDefault(),H.filter(Qe=>!Qe.product_id||!Qe.batch_id||Qe.quantity<=0).length>0){alert("Please select product, batch, and enter quantity for all items before saving.");return}if(H.filter(Qe=>Qe.batch_id==="").length>0){alert("Some items do not have a batch selected. Please select a batch for all items.");return}try{const{data:{user:Qe}}=await de.auth.getUser();if(!Qe)throw new Error("Not authenticated");const Ye={challan_number:X.challan_number,customer_id:X.customer_id,sales_order_id:X.sales_order_id||null,challan_date:X.challan_date,delivery_address:X.delivery_address,vehicle_number:X.vehicle_number||null,driver_name:X.driver_name||null,notes:X.notes||null,approval_status:"pending_approval",created_by:Qe.id};let Nt;if(_){const ut=[];for(const mt of E)ut.push({batch_id:mt.batch_id,adjustment:mt.quantity});for(const mt of H){const _t=ut.find(Ht=>Ht.batch_id===mt.batch_id);_t?_t.adjustment-=mt.quantity:ut.push({batch_id:mt.batch_id,adjustment:-mt.quantity})}for(const mt of ut)if(mt.adjustment!==0){const{error:_t}=await de.rpc("update_batch_stock",{p_batch_id:mt.batch_id,p_adjustment:mt.adjustment});if(_t){const{data:Ht}=await de.from("batches").select("current_stock").eq("id",mt.batch_id).single();if(Ht){const bt=Ht.current_stock+mt.adjustment;await de.from("batches").update({current_stock:bt}).eq("id",mt.batch_id)}}}const{data:Mt,error:ht}=await de.from("delivery_challans").update(Ye).eq("id",_.id).select().single();if(ht)throw ht;const{error:Et}=await de.from("delivery_challan_items").delete().eq("challan_id",_.id);if(Et)throw Et;Nt=Mt.id}else{const{data:ut,error:Mt}=await de.from("delivery_challans").insert([Ye]).select().single();if(Mt)throw Mt;Nt=ut.id;for(const ht of H)if(X.sales_order_id){const{error:Et}=await de.rpc("fn_deduct_stock_and_release_reservation",{p_so_id:X.sales_order_id,p_batch_id:ht.batch_id,p_product_id:ht.product_id,p_quantity:ht.quantity,p_user_id:Qe.id});Et&&console.error("Error releasing reservation:",Et)}if(X.sales_order_id){const{data:ht}=await de.from("sales_order_items").select("id, product_id, quantity, delivered_quantity").eq("sales_order_id",X.sales_order_id);if(ht){let Et=!0;for(const _t of ht){const Ht=H.find(Ct=>Ct.product_id===_t.product_id),bt=(_t.delivered_quantity||0)+((Ht==null?void 0:Ht.quantity)||0);await de.from("sales_order_items").update({delivered_quantity:bt}).eq("id",_t.id),bt<_t.quantity&&(Et=!1)}const mt=Et?"delivered":"partially_delivered";await de.from("sales_orders").update({status:mt,is_archived:Et,archived_at:Et?new Date().toISOString():null,archived_by:Et?Qe.id:null,archive_reason:Et?"Delivery Challan created and all items delivered":null}).eq("id",X.sales_order_id)}}}const xt=H.map(ut=>({challan_id:Nt,product_id:ut.product_id,batch_id:ut.batch_id,quantity:ut.quantity,pack_size:ut.pack_size,pack_type:ut.pack_type,number_of_packs:ut.number_of_packs})),{error:it}=await de.from("delivery_challan_items").insert(xt);if(it)throw it;v(!1),Se(),D(),te(),alert(`Delivery Challan ${_?"updated":"created"} successfully!`)}catch(Qe){console.error("Error saving challan:",Qe);const Ye=(Qe==null?void 0:Qe.message)||"Unknown error occurred";Ye.includes("batch_id")?alert("Error: Invalid batch selection. Please ensure all items have a valid batch selected."):Ye.includes("foreign key")?alert("Error: Invalid product or batch selection. Please check your selections."):alert(`Failed to save challan: ${Ye}`)}},Te=async fe=>{if(confirm("Are you sure you want to delete this delivery challan? This will revert the linked Sales Order status."))try{const{data:Ee}=await de.from("delivery_challans").select("sales_order_id, id").eq("id",fe).single(),{error:qe}=await de.from("delivery_challans").delete().eq("id",fe);if(qe)throw qe;Ee!=null&&Ee.sales_order_id&&await de.from("sales_orders").update({status:"pending_delivery",is_archived:!1,archived_at:null,archived_by:null,archive_reason:null}).eq("id",Ee.sales_order_id),D(),alert("Delivery Challan deleted successfully. Sales Order status has been reverted.")}catch(Ee){console.error("Error deleting challan:",Ee),alert("Failed to delete challan. Please try again.")}},he=async fe=>{if(confirm("Approve this Delivery Challan? It will be available for invoice creation."))try{const{data:{user:Ee}}=await de.auth.getUser();if(!Ee)throw new Error("Not authenticated");const{error:qe}=await de.from("delivery_challans").update({approval_status:"approved",approved_by:Ee.id,approved_at:new Date().toISOString()}).eq("id",fe);if(qe)throw qe;alert("Delivery Challan approved successfully!"),D()}catch(Ee){console.error("Error approving challan:",Ee.message),alert("Failed to approve challan")}},ce=async()=>{if(!q||!I.trim()){alert("Please enter a rejection reason");return}try{const{data:{user:fe}}=await de.auth.getUser();if(!fe)throw new Error("Not authenticated");const{error:Ee}=await de.from("delivery_challans").update({approval_status:"rejected",rejected_by:fe.id,rejected_at:new Date().toISOString(),rejection_reason:I}).eq("id",q);if(Ee)throw Ee;alert("Delivery Challan rejected"),j(!1),U(""),V(null),D()}catch(fe){console.error("Error rejecting challan:",fe.message),alert("Failed to reject challan")}},Se=()=>{k(null),T([]),W({challan_number:"",customer_id:"",sales_order_id:"",challan_date:new Date().toISOString().split("T")[0],delivery_address:"",vehicle_number:"",driver_name:"",notes:""}),C([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},Pe=[{key:"challan_number",label:"DO Number"},{key:"customer",label:"Customer",render:fe=>{var Ee;return i.jsx("div",{className:"font-medium",children:(Ee=fe.customers)==null?void 0:Ee.company_name})}},{key:"challan_date",label:"Date",render:fe=>new Date(fe.challan_date).toLocaleDateString()},{key:"approval_status",label:"Status / Approval",render:fe=>{const Ee={pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},qe={pending_approval:"Pending Approval",approved:"Approved",rejected:"Rejected"};return i.jsxs("div",{className:"flex items-center justify-center gap-2",children:[i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ee[fe.approval_status]}`,children:qe[fe.approval_status]}),fe.approval_status==="pending_approval"&&(e==null?void 0:e.role)==="admin"&&i.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[i.jsx("button",{onClick:Qe=>{Qe.stopPropagation(),he(fe.id)},className:"p-2 bg-green-100 hover:bg-green-200 rounded-lg transition-colors",title:"Approve Delivery Challan",children:i.jsx(ua,{className:"w-6 h-6 text-green-600"})}),i.jsx("button",{onClick:Qe=>{Qe.stopPropagation(),V(fe.id),j(!0)},className:"p-2 bg-red-100 hover:bg-red-200 rounded-lg transition-colors",title:"Reject Delivery Challan",children:i.jsx(Pa,{className:"w-6 h-6 text-red-600"})})]}),fe.approval_status==="approved"&&i.jsx(ua,{className:"w-5 h-5 text-green-600 ml-2",title:"Approved"}),fe.approval_status==="rejected"&&i.jsx(Pa,{className:"w-5 h-5 text-red-600 ml-2",title:"Rejected"})]})}}],Le=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="accounts"||(e==null?void 0:e.role)==="sales"||(e==null?void 0:e.role)==="warehouse",Xe={total:n.length};return i.jsx(ca,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Delivery Challan (Surat Jalan)"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage delivery orders and dispatch records"})]}),Le&&i.jsxs("button",{onClick:async()=>{Se();const fe=await P();W(Ee=>({...Ee,challan_number:fe})),v(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Create Delivery Challan"]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Delivery Challans"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Xe.total})]}),i.jsx(Ls,{columns:Pe,data:n,loading:h,actions:fe=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:async()=>{const Ee=await z(fe.id);m(fe),x(Ee),y(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Challan",children:i.jsx(b0,{className:"w-4 h-4"})}),Le&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:async()=>{const Ee=await z(fe.id);r({sourceType:"delivery_challan",customerId:fe.customer_id,challanNumber:fe.challan_number,challanId:fe.id,items:Ee}),t("sales")},className:"p-1 text-purple-600 hover:bg-purple-50 rounded",title:"Create Invoice from DO",children:i.jsx(pr,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>pe(fe),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit Challan",children:i.jsx(uo,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>Te(fe.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Challan",children:i.jsx(wa,{className:"w-4 h-4"})})]})]})}),i.jsx(ir,{isOpen:d,onClose:()=>{v(!1),Se()},title:_?`Edit DC - ${X.challan_number}`:`Create DC - ${X.challan_number}`,size:"xl",children:i.jsxs("form",{onSubmit:we,className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),i.jsxs("select",{value:X.customer_id,onChange:fe=>re(fe.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!X.sales_order_id,children:[i.jsx("option",{value:"",children:"Select Customer"}),s.map(fe=>i.jsx("option",{value:fe.id,children:fe.company_name},fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Linked Sales Order"}),i.jsxs("select",{value:X.sales_order_id,onChange:fe=>ke(fe.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",disabled:!X.customer_id,children:[i.jsx("option",{value:"",children:"No Sales Order / Manual Entry"}),M.map(fe=>i.jsxs("option",{value:fe.id,children:[fe.so_number," (",fe.status,")"]},fe.id))]}),X.customer_id&&M.length===0&&i.jsx("p",{className:"text-xs text-orange-600 mt-1",children:" No active sales orders for this customer"}),!X.customer_id&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select a customer first"})]})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vehicle Number"}),i.jsx("input",{type:"text",value:X.vehicle_number,onChange:fe=>W({...X,vehicle_number:fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"B 1234 XYZ"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Driver Name"}),i.jsx("input",{type:"text",value:X.driver_name,onChange:fe=>W({...X,driver_name:fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Driver name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),i.jsx("input",{type:"date",value:X.challan_date,onChange:fe=>W({...X,challan_date:fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Address *"}),i.jsx("textarea",{value:X.delivery_address,onChange:fe=>W({...X,delivery_address:fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:X.notes,onChange:fe=>W({...X,notes:fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Additional notes..."})]})]}),i.jsxs("div",{className:"border-t pt-3 mt-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Items to Dispatch"}),i.jsx("button",{type:"button",onClick:Ie,className:"text-sm px-3 py-1 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg font-medium transition-colors",children:"+ Add Item"})]}),i.jsx("div",{className:"space-y-2",children:H.map((fe,Ee)=>{const qe=u.filter(Ye=>Ye.product_id===fe.product_id),Qe=u.find(Ye=>Ye.id===fe.batch_id);return i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product *"}),i.jsxs("select",{value:fe.product_id,onChange:Ye=>{const Nt=[...H];Nt[Ee]={...Nt[Ee],product_id:Ye.target.value,batch_id:""},C(Nt)},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),l.map(Ye=>i.jsx("option",{value:Ye.id,children:Ye.product_name},Ye.id))]})]}),fe.product_id&&i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Batch *"}),qe.length>0&&i.jsx("button",{type:"button",onClick:()=>{const Ye=ye(fe.product_id);Ye&&be(Ee,Ye.id)},className:"text-xs text-blue-600 hover:text-blue-700 font-medium",title:"Select oldest batch (FIFO)",children:"Use FIFO"})]}),qe.length>0?i.jsxs("select",{value:fe.batch_id,onChange:Ye=>be(Ee,Ye.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Batch"}),qe.map((Ye,Nt)=>{const xt=Nt===0?"  FIFO":"",it=Ye.current_stock-(Ye.reserved_stock||0);return i.jsxs("option",{value:Ye.id,children:[Ye.batch_number," (Total: ",Ye.current_stock,"kg, Available: ",it,"kg)",xt]},Ye.id)})]}):i.jsxs("div",{className:"w-full px-2 py-1.5 text-sm border border-red-300 rounded bg-red-50 text-red-700 flex items-center gap-2",children:[i.jsx("span",{children:""}),i.jsx("span",{children:"No batches available for this product"})]})]})]}),Qe&&i.jsxs("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded text-xs space-y-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Batch:"}),i.jsx("span",{className:"font-medium",children:Qe.batch_number})]}),Qe.expiry_date&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Expiry:"}),i.jsx("span",{className:"font-medium",children:new Date(Qe.expiry_date).toLocaleDateString()})]}),Qe.packaging_details&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Packaging:"}),i.jsx("span",{className:"font-medium",children:Qe.packaging_details})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Total Stock:"}),i.jsxs("span",{className:"font-medium",children:[Qe.current_stock," kg"]})]}),Qe.reserved_stock>0&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Reserved:"}),i.jsxs("span",{className:"font-medium text-orange-600",children:[Qe.reserved_stock," kg"]})]}),i.jsxs("div",{className:"flex justify-between border-t pt-1",children:[i.jsx("span",{className:"text-gray-600 font-semibold",children:"Available:"}),i.jsxs("span",{className:"font-bold text-green-600",children:[Qe.current_stock-(Qe.reserved_stock||0)," kg"]})]})]}),fe.pack_size&&i.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"No. of Packs *"}),i.jsx("input",{type:"number",value:fe.number_of_packs||"",onChange:Ye=>ae(Ee,Number(Ye.target.value)),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Pack Size"}),i.jsx("input",{type:"text",value:`${fe.pack_size} kg`,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",disabled:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Total Qty"}),i.jsx("input",{type:"text",value:`${fe.quantity} kg`,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",disabled:!0})]})]}),H.length>1&&i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",onClick:()=>De(Ee),className:"text-xs text-red-600 hover:text-red-700",children:"Remove Item"})})]},Ee)})})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t mt-3",children:[i.jsx("button",{type:"button",onClick:()=>{v(!1),Se()},className:"px-5 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-sm",children:_?"Update Challan":"Create Challan"})]})]})}),g&&p&&i.jsx(gde,{challan:p,items:w,onClose:()=>y(!1),companySettings:b}),S&&i.jsx(ir,{isOpen:S,onClose:()=>{j(!1),U(""),V(null)},title:"Reject Delivery Challan",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rejection Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{value:I,onChange:fe=>U(fe.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter reason for rejecting this delivery challan..."})]}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>{j(!1),U(""),V(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:ce,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",disabled:!I.trim(),children:"Reject Challan"})]})]})})]})})}function yde({invoice:e,items:t,onClose:r}){const n=Z.useRef(null),{t:a,language:s}=ba(),o=p=>p==null?"Rp 0":`${p.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,l=p=>{const m=new Date(p),w=s==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],x=m.getDate(),b=w[m.getMonth()],B=m.getFullYear();return`${x} ${b} ${B}`},c=p=>{const m=new Date(p),x=(s==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"])[m.getMonth()],b=m.getFullYear();return`${x} ${b}`},u=p=>s==="id"?A(p):h(p),A=p=>{if(p===0)return"Nol";const m=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],w=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],x=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],b=B=>{if(B===0)return"";if(B<10)return m[B];if(B>=10&&B<20)return w[B-10];if(B<100){const T=Math.floor(B/10),S=B%10;return x[T]+(S>0?" "+m[S]:"")}const _=Math.floor(B/100),k=B%100;return(_===1?"Seratus":m[_]+" Ratus")+(k>0?" "+b(k):"")};if(p<1e3)return b(p);if(p<1e6){const B=Math.floor(p/1e3),_=p%1e3;return(B===1?"Seribu":b(B)+" Ribu")+(_>0?" "+b(_):"")}if(p<1e9){const B=Math.floor(p/1e6),_=p%1e6,k=b(B)+" Juta",E=_>=1e3?(Math.floor(_/1e3)===1?"Seribu":b(Math.floor(_/1e3))+" Ribu")+(_%1e3>0?" "+b(_%1e3):""):_>0?b(_):"";return k+(E?" "+E:"")}return p.toString()},h=p=>{if(p===0)return"Zero";const m=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],w=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],x=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],b=B=>{if(B===0)return"";if(B<10)return m[B];if(B>=10&&B<20)return w[B-10];if(B<100){const E=Math.floor(B/10),T=B%10;return x[E]+(T>0?" "+m[T]:"")}const _=Math.floor(B/100),k=B%100;return m[_]+" Hundred"+(k>0?" "+b(k):"")};if(p<1e3)return b(p);if(p<1e6){const B=Math.floor(p/1e3),_=p%1e3;return b(B)+" Thousand"+(_>0?" "+b(_):"")}if(p<1e9){const B=Math.floor(p/1e6),_=p%1e6,k=_>=1e3?b(Math.floor(_/1e3))+" Thousand"+(_%1e3>0?" "+b(_%1e3):""):_>0?b(_):"";return b(B)+" Million"+(k?" "+k:"")}return p.toString()},f=()=>{window.print()},d=async()=>{if(n.current)try{const p=await n1(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:T=>{const S=T.getElementById("invoice-print-content");S&&(S.style.width="210mm")}}),m=p.toDataURL("image/png",1),w=new Ot("p","mm","a4"),x=w.internal.pageSize.getWidth(),b=w.internal.pageSize.getHeight(),B=p.width,_=p.height,k=x/B,E=_*k;if(E>b){let T=0,S=E;for(;S>0;)w.addImage(m,"PNG",0,T,x,E),S-=b,T-=b,S>0&&w.addPage()}else w.addImage(m,"PNG",0,0,x,E);w.save(`Invoice-${e.invoice_number}.pdf`)}catch(p){console.error("Error generating PDF:",p),alert("Failed to generate PDF. Please try again.")}},v=e.customers,g=e.payment_terms_days||30,y=()=>g===0?"Advance / Immediate":`${g} ${s==="id"?"Hari":"Days"}`;return i.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[i.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:i.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[i.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",style:{printColorAdjust:"exact",WebkitPrintColorAdjust:"exact"},children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[s==="id"?"Faktur":"Invoice"," ",e.invoice_number]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:f,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[i.jsx(Wb,{className:"h-4 w-4"}),s==="id"?"Cetak":"Print"]}),i.jsxs("button",{onClick:d,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[i.jsx(Qo,{className:"h-4 w-4"}),"PDF"]}),i.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:i.jsx(An,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{id:"invoice-print-content",ref:n,className:"p-8",children:[i.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[i.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:i.jsxs("g",{children:[i.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),i.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),i.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),i.jsx("div",{className:"text-right",children:i.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:"INVOICE"})})]}),i.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No izin PBF"}),i.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),i.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),i.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Company Name:"}),i.jsxs("span",{className:"font-semibold",children:[" ",(v==null?void 0:v.company_name)||""]})]}),i.jsxs("div",{className:"pt-1 flex",children:[i.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),i.jsxs("div",{children:[i.jsx("p",{children:(v==null?void 0:v.address)||""}),i.jsx("p",{children:(v==null?void 0:v.city)||""})]})]}),i.jsxs("div",{className:"flex pt-1",children:[i.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),i.jsx("span",{children:(v==null?void 0:v.phone)||""})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"NPWP:"}),i.jsx("span",{children:(v==null?void 0:v.npwp)||""})]})]}),i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"200px"},children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Invoice No:"}),i.jsx("span",{className:"ml-2",children:e.invoice_number})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Invoice Date:"}),i.jsx("span",{className:"ml-2",children:l(e.invoice_date)})]}),i.jsxs("div",{className:"pt-1",children:[i.jsx("span",{className:"font-bold",children:"Po No:"}),i.jsx("span",{className:"ml-2",children:e.po_number||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Payment Terms:"}),i.jsx("span",{className:"ml-2",children:y()})]})]})]})}),i.jsx("div",{children:i.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),i.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Batch No."}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Exp. Date"}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Total Qty"}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"UOM"}),i.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Unit Price (IDR)"}),i.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:"Sub Total (IDR)"})]})}),i.jsxs("tbody",{children:[t.map((p,m)=>{var _,k,E,T;const w=p.quantity||0,x=p.unit_price||0,b=w*x,B=(_=p.batches)!=null&&_.expiry_date?c(p.batches.expiry_date):"-";return i.jsxs("tr",{className:"border-b border-black",children:[i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:m+1}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((k=p.products)==null?void 0:k.product_name)||"Unknown Product"}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((E=p.batches)==null?void 0:E.batch_number)||"N/A"}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:B}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:w.toLocaleString()}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((T=p.products)==null?void 0:T.unit)||"Kg"}),i.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:o(x)}),i.jsx("td",{className:"p-1.5 text-right print:p-1",children:o(b)})]},p.id||m)}),t.length<2&&Array.from({length:2-t.length}).map((p,m)=>i.jsxs("tr",{className:"border-b border-black",children:[i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${m}`))]})]})}),i.jsxs("div",{className:"border-2 border-black border-t-0",children:[i.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[i.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[i.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:s==="id"?"Amount In words:":"Amount in words:"}),i.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:["IDR ",u(Math.round(e.total_amount))," RUPIAH"]})]}),i.jsxs("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:[i.jsxs("div",{className:"flex justify-between py-1 print:py-0.5",children:[i.jsx("span",{className:"font-bold",children:"Sub Total"}),i.jsx("span",{className:"font-bold",children:o(e.subtotal)})]}),i.jsxs("div",{className:"flex justify-between border-t border-black py-1 print:py-0.5",children:[i.jsx("span",{className:"font-bold",children:"VAT (PPN) 11%"}),i.jsx("span",{className:"font-bold",children:o(e.tax_amount)})]}),i.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[i.jsx("span",{className:"font-bold",children:"Grand Total"}),i.jsx("span",{className:"font-bold text-sm print:text-xs",children:o(e.total_amount)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-0 text-xs print:text-[10px]",children:[i.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[i.jsx("p",{className:"font-semibold mb-2 print:mb-1",children:"Bank Details:"}),i.jsxs("div",{className:"space-y-0.5 print:space-y-0",children:[i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Bank Name"}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{children:"BCA"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Branch"}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{children:"Sunter Mall, Jakarta"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account Name"}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{className:"whitespace-nowrap",children:"PT. Shubham Anzen Pharma Jaya"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account No."}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{children:"0930 2010 14 (IDR)"})]})]})]}),i.jsxs("div",{className:"p-3 print:p-2",children:[i.jsx("p",{className:"font-semibold mb-1",children:"Authorized Signatory:"}),i.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),i.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Pharmacist"})]})]})]}),i.jsx("div",{className:"border-2 border-black border-t-0 p-2.5 print:p-2",children:i.jsx("p",{className:"text-xs font-semibold text-center print:text-[10px]",children:s==="id"?`Pembayaran jatuh tempo dalam ${y()} sejak tanggal barang dikirim.`:`Payment is due within ${y()} from the date on which the goods are delivered.`})}),e.notes&&i.jsx("div",{className:"mt-3 border-2 border-black p-2 print:mt-2 print:p-1.5",children:i.jsxs("p",{className:"text-xs print:text-[10px]",children:[i.jsx("span",{className:"font-bold",children:"Notes: "}),i.jsx("span",{children:e.notes})]})})]})]})}),i.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #invoice-print-content,
          #invoice-print-content * {
            visibility: visible;
          }

          #invoice-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #invoice-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function wde(){const{t:e}=ba(),{profile:t}=Dr(),{navigationData:r,clearNavigationData:n}=Mo(),[a,s]=Z.useState([]),[o,l]=Z.useState([]),[c,u]=Z.useState([]),[A,h]=Z.useState([]),[f,d]=Z.useState([]),[v,g]=Z.useState(""),[y,p]=Z.useState(!0),[m,w]=Z.useState(!1),[x,b]=Z.useState(!1),[B,_]=Z.useState(null),[k,E]=Z.useState(null),[T,S]=Z.useState([]),[j,I]=Z.useState({invoice_number:"",customer_id:"",invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:"",po_number:"",notes:""}),[U,q]=Z.useState([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}]);Z.useEffect(()=>{V(),W(),M(),G()},[]),Z.useEffect(()=>{(r==null?void 0:r.sourceType)==="delivery_challan"&&(L(r),n())},[r]);const V=async()=>{try{const{data:he,error:ce}=await de.from("sales_invoices").select("*, customers(company_name, address, city, phone, npwp, pharmacy_license, gst_vat_type)").order("invoice_date",{ascending:!1});if(ce)throw ce;const Se=await Promise.all((he||[]).map(async Pe=>{const{data:Le}=await de.rpc("get_invoice_paid_amount",{p_invoice_id:Pe.id}),Xe=Le||0,fe=Pe.total_amount-Xe;return{...Pe,paid_amount:Xe,balance_amount:fe}}));s(Se)}catch(he){console.error("Error loading invoices:",he)}finally{p(!1)}},X=async()=>{try{const{data:he}=await de.from("app_settings").select("invoice_prefix, invoice_start_number").maybeSingle(),ce=(he==null?void 0:he.invoice_prefix)||"SAPJ",Se=(he==null?void 0:he.invoice_start_number)||1,{data:Pe}=await de.from("sales_invoices").select("invoice_number").like("invoice_number",`${ce}%`);let Le=Se;if(Pe&&Pe.length>0){const fe=Pe.map(Ee=>{const qe=Ee.invoice_number.match(/(\d+)$/);return qe?parseInt(qe[1],10):0}).filter(Ee=>!isNaN(Ee));fe.length>0&&(Le=Math.max(...fe)+1)}const Xe=String(Le).padStart(3,"0");return`${ce}-${Xe}`}catch(he){return console.error("Error generating invoice number:",he),"SAPJ-001"}},W=async()=>{try{const{data:he,error:ce}=await de.from("customers").select("id, company_name, gst_vat_type").eq("is_active",!0).order("company_name");if(ce)throw ce;l(he||[])}catch(he){console.error("Error loading customers:",he)}},M=async()=>{try{const{data:he,error:ce}=await de.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(ce)throw ce;u(he||[])}catch(he){console.error("Error loading products:",he)}},G=async()=>{try{const{data:he,error:ce}=await de.from("batches").select("id, batch_number, product_id, current_stock, import_price, duty_charges, freight_charges, other_charges, import_quantity, import_date, expiry_date").eq("is_active",!0).order("import_date",{ascending:!0});if(ce)throw ce;h(he||[])}catch(he){console.error("Error loading batches:",he)}},H=async he=>{try{const{data:ce,error:Se}=await de.from("delivery_challans").select("id, challan_number, challan_date, delivery_address, vehicle_number, notes").eq("customer_id",he).order("challan_date",{ascending:!1});if(Se)throw Se;const{data:Pe,error:Le}=await de.from("sales_invoices").select("linked_challan_ids").not("linked_challan_ids","is",null);if(Le)throw Le;const Xe=new Set;Pe==null||Pe.forEach(Ee=>{var qe;(qe=Ee.linked_challan_ids)==null||qe.forEach(Qe=>Xe.add(Qe))});const fe=(ce==null?void 0:ce.filter(Ee=>!Xe.has(Ee.id)))||[];d(fe)}catch(ce){console.error("Error loading pending challans:",ce),d([])}},C=async he=>{if(!he){g(""),q([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}]);return}g(he);try{const ce=f.find(Xe=>Xe.id===he);if(!ce){console.error("Selected challan not found in pending challans list"),alert("Error: Selected delivery challan not found. Please refresh and try again.");return}I(Xe=>({...Xe,delivery_challan_number:ce.challan_number}));const{data:Se,error:Pe}=await de.from("delivery_challan_items").select("product_id, batch_id, quantity, products(product_name, product_code), batches(batch_number, import_price, duty_charges, freight_charges, other_charges, import_quantity)").eq("challan_id",he);if(Pe)throw console.error("Database error loading challan items:",Pe),Pe;if(!Se||Se.length===0){console.warn("No items found for this delivery challan"),alert("This delivery challan has no items. Please add items manually.");return}const Le=[];for(const Xe of Se){if(!Xe.product_id){console.warn("Skipping item with missing product_id");continue}let fe=0;if(Xe.batch_id){const Ee=A.find(qe=>qe.id===Xe.batch_id);if(Ee){const qe=(Ee.import_price+Ee.duty_charges+Ee.freight_charges+Ee.other_charges)/Ee.import_quantity;fe=Math.round(qe*1.25)}else console.warn(`Batch ${Xe.batch_id} not found in loaded batches`)}Le.push({product_id:Xe.product_id,batch_id:Xe.batch_id,quantity:Xe.quantity,unit_price:fe,tax_rate:11,total:Xe.quantity*fe*1.11})}if(Le.length===0){alert("Could not load items from delivery challan. Please add items manually.");return}q(Le)}catch(ce){console.error("Error loading challan items:",ce),alert(`Failed to load delivery challan items: ${ce.message||"Unknown error"}. Please try again or add items manually.`)}},L=async he=>{const ce=await X();I({invoice_number:ce,customer_id:he.customerId,invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:he.challanNumber,po_number:"",notes:`Created from Delivery Challan: ${he.challanNumber}`}),he.customerId&&await H(he.customerId);const Se=he.items.map(Pe=>{const Le=A.find(Ee=>Ee.id===Pe.batch_id),fe=(Le?(Le.import_price+Le.duty_charges+Le.freight_charges+Le.other_charges)/Le.import_quantity:0)*1.25;return{product_id:Pe.product_id,batch_id:Pe.batch_id,quantity:Pe.quantity,unit_price:Math.round(fe),tax_rate:11,total:0}});q(Se.map(Pe=>({...Pe,total:D(Pe)}))),w(!0)},O=async he=>{try{const{data:ce,error:Se}=await de.from("sales_invoice_items").select("*, products(product_name, product_code, unit), batches(batch_number, expiry_date)").eq("invoice_id",he);if(Se)throw Se;return S(ce||[]),ce||[]}catch(ce){return console.error("Error loading invoice items:",ce),[]}},D=he=>{const ce=he.quantity*he.unit_price,Se=ce*(he.tax_rate/100);return ce+Se},P=he=>{if(!he)return 0;const ce=A.find(Pe=>Pe.id===he);return!ce||!ce.import_quantity?0:(ce.import_price+ce.duty_charges+ce.freight_charges+ce.other_charges)/ce.import_quantity},Q=(he,ce)=>ce===0?0:(he-ce)/he*100,J=(he,ce=25)=>{const Se=P(he);return Math.round(Se*(1+ce/100))},te=(he,ce)=>{const Se=D(ce),Pe=[...U];Pe[he]={...ce,total:Se},q(Pe)},z=()=>{q([...U,{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}])},ye=he=>{U.length>1&&q(U.filter((ce,Se)=>Se!==he))},re=()=>{const he=U.reduce((Pe,Le)=>Pe+Le.quantity*Le.unit_price,0),ce=U.reduce((Pe,Le)=>{const Xe=Le.quantity*Le.unit_price;return Pe+Xe*(Le.tax_rate/100)},0),Se=he+ce-j.discount;return{subtotal:he,taxAmount:ce,total:Se}},ke=async he=>{he.preventDefault();try{const{data:{user:ce}}=await de.auth.getUser();if(!ce)throw new Error("Not authenticated");const Se=re(),Pe=new Date(j.invoice_date);let Le=new Date(Pe),Xe=30;j.payment_terms==="advance"||j.payment_terms==="50-50"?Xe=0:(Xe=parseInt(j.payment_terms),isNaN(Xe)||Le.setDate(Le.getDate()+Xe));let fe;if(B){const{error:Qe}=await de.from("sales_invoice_items").delete().eq("invoice_id",B.id);if(Qe)throw Qe;const{data:Ye,error:Nt}=await de.from("sales_invoices").update({invoice_number:j.invoice_number,customer_id:j.customer_id,invoice_date:j.invoice_date,due_date:Le.toISOString().split("T")[0],discount_amount:j.discount,delivery_challan_number:j.delivery_challan_number||null,po_number:j.po_number||null,payment_terms_days:Xe,notes:j.notes||null,subtotal:Se.subtotal,tax_amount:Se.taxAmount,total_amount:Se.total,linked_challan_ids:v?[v]:null}).eq("id",B.id).select().single();if(Nt)throw Nt;fe=Ye}else{const{data:Qe,error:Ye}=await de.from("sales_invoices").insert([{invoice_number:j.invoice_number,customer_id:j.customer_id,invoice_date:j.invoice_date,due_date:Le.toISOString().split("T")[0],discount_amount:j.discount,delivery_challan_number:j.delivery_challan_number||null,po_number:j.po_number||null,payment_terms_days:Xe,notes:j.notes||null,subtotal:Se.subtotal,tax_amount:Se.taxAmount,total_amount:Se.total,payment_status:"pending",created_by:ce.id,linked_challan_ids:v?[v]:null}]).select().single();if(Ye)throw Ye;fe=Qe}const Ee=U.map(Qe=>({invoice_id:fe.id,product_id:Qe.product_id,batch_id:Qe.batch_id,quantity:Qe.quantity,unit_price:Qe.unit_price,tax_rate:Qe.tax_rate})),{error:qe}=await de.from("sales_invoice_items").insert(Ee);if(qe)throw qe;await V(),await G(),w(!1),De()}catch(ce){console.error("Error saving invoice:",ce),alert(`Failed to save invoice: ${ce.message||"Unknown error"}. Please check console for details.`)}},be=async he=>{E(he),await O(he.id),b(!0)},ae=async he=>{_(he),I({invoice_number:he.invoice_number,customer_id:he.customer_id,invoice_date:he.invoice_date,payment_terms:String(he.payment_terms_days||30),discount:he.discount_amount,delivery_challan_number:he.delivery_challan_number||"",po_number:he.po_number||"",notes:he.notes||""});const ce=await O(he.id);ce.length>0&&q(ce.map(Se=>({product_id:Se.product_id,batch_id:Se.batch_id,quantity:Se.quantity,unit_price:Se.unit_price,tax_rate:Se.tax_rate,total:Se.total}))),w(!0)},Ie=async he=>{if(confirm("Are you sure you want to delete this invoice?"))try{const{error:ce}=await de.from("sales_invoices").delete().eq("id",he);if(ce)throw ce;V()}catch(ce){console.error("Error deleting invoice:",ce),alert("Failed to delete invoice. Please try again.")}},De=()=>{_(null),g(""),d([]),I({invoice_number:"",customer_id:"",invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:"",po_number:"",notes:""}),q([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}])},pe=[{key:"invoice_number",label:"Invoice #"},{key:"customer",label:"Customer",render:he=>{var ce;return i.jsx("div",{className:"font-medium",children:(ce=he.customers)==null?void 0:ce.company_name})}},{key:"invoice_date",label:"Date",render:he=>new Date(he.invoice_date).toLocaleDateString()},{key:"total_amount",label:"Total Amount",render:he=>i.jsxs("span",{className:"font-medium",children:["Rp ",he.total_amount.toLocaleString("id-ID")]})},{key:"paid_amount",label:"Paid Amount",render:he=>i.jsxs("span",{className:"text-green-600 font-medium",children:["Rp ",(he.paid_amount||0).toLocaleString("id-ID")]})},{key:"balance_amount",label:"Balance",render:he=>i.jsxs("span",{className:`font-medium ${(he.balance_amount||0)===0?"text-gray-400":"text-orange-600"}`,children:["Rp ",(he.balance_amount||0).toLocaleString("id-ID")]})},{key:"payment_status",label:"Payment Status",render:he=>i.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${he.payment_status==="paid"?"bg-green-100 text-green-800":he.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:he.payment_status==="pending"?"Unpaid":he.payment_status==="partial"?"Partially Paid":"Paid"})}],we=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts"||(t==null?void 0:t.role)==="sales",Te={total:a.length,totalRevenue:a.reduce((he,ce)=>he+ce.total_amount,0),pending:a.filter(he=>he.payment_status==="pending").length,paid:a.filter(he=>he.payment_status==="paid").length};return i.jsx(ca,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sales Invoices"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage sales invoices and track payments"})]}),we&&i.jsxs("button",{onClick:async()=>{De();const he=await X();I(ce=>({...ce,invoice_number:he})),w(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Create Invoice"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Invoices"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Te.total})]}),i.jsxs("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-blue-600",children:"Total Revenue"}),i.jsxs("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:["Rp ",Te.totalRevenue.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-red-600",children:"Pending Payment"}),i.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:Te.pending})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg shadow p-6",children:[i.jsx("p",{className:"text-sm text-green-600",children:"Paid"}),i.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:Te.paid})]})]}),i.jsx(Ls,{columns:pe,data:a,loading:y,actions:we?he=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>be(he),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Invoice",children:i.jsx(b0,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>ae(he),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit Invoice",children:i.jsx(uo,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>Ie(he.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Invoice",children:i.jsx(wa,{className:"w-4 h-4"})})]}):void 0}),i.jsx(ir,{isOpen:m,onClose:()=>{w(!1),De()},title:B?"Edit Sales Invoice":"Create Sales Invoice",size:"xl",children:i.jsxs("form",{onSubmit:ke,className:"space-y-6",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Invoice Details"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number *"}),i.jsx("input",{type:"text",value:j.invoice_number,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed",required:!0,placeholder:"INV-001",readOnly:!0,disabled:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Date *"}),i.jsx("input",{type:"date",value:j.invoice_date,onChange:he=>I({...j,invoice_date:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{className:"border-r border-gray-200 pr-6",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Customer Information"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),i.jsxs("select",{value:j.customer_id,onChange:he=>{const ce=he.target.value;I({...j,customer_id:ce}),g(""),d([]),ce&&H(ce)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Customer"}),o.map(he=>i.jsx("option",{value:he.id,children:he.company_name},he.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Delivery Challan (Optional)"}),i.jsxs("select",{value:v,onChange:he=>C(he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",disabled:!j.customer_id,children:[i.jsx("option",{value:"",children:"No Delivery Challan / Manual Entry"}),f.map(he=>i.jsxs("option",{value:he.id,children:[he.challan_number," - ",new Date(he.challan_date).toLocaleDateString()]},he.id))]}),j.customer_id&&f.length===0&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No pending delivery challans for this customer"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:j.notes,onChange:he=>I({...j,notes:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Additional notes for invoice"})]})]})]}),i.jsxs("div",{className:"pl-6",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Payment Terms"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms *"}),i.jsxs("select",{value:j.payment_terms,onChange:he=>I({...j,payment_terms:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"0",children:"Immediate"}),i.jsx("option",{value:"15",children:"15 Days"}),i.jsx("option",{value:"30",children:"30 Days"}),i.jsx("option",{value:"45",children:"45 Days"}),i.jsx("option",{value:"60",children:"60 Days"}),i.jsx("option",{value:"advance",children:"Advance"}),i.jsx("option",{value:"50-50",children:"50% Adv & 50% on Delivery"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO Number"}),i.jsx("input",{type:"text",value:j.po_number,onChange:he=>I({...j,po_number:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Customer PO Number"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount (Rp)"}),i.jsx("input",{type:"number",value:j.discount===0?"":j.discount,onChange:he=>I({...j,discount:he.target.value===""?0:Number(he.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",placeholder:"0"})]})]})]})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Line Items"}),i.jsx("button",{type:"button",onClick:z,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"+ Add Item"})]}),i.jsx("div",{className:"space-y-3",children:U.map((he,ce)=>{var fe;const Se=A.filter(Ee=>Ee.product_id===he.product_id),Pe=P(he.batch_id),Le=Q(he.unit_price,Pe),Xe=J(he.batch_id);return i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[i.jsxs("div",{className:"col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product *"}),i.jsxs("select",{value:he.product_id,onChange:Ee=>te(ce,{...he,product_id:Ee.target.value,batch_id:null}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),c.map(Ee=>i.jsx("option",{value:Ee.id,children:Ee.product_name},Ee.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Batch"}),i.jsxs("select",{value:he.batch_id||"",onChange:Ee=>{const qe=Ee.target.value||null,Qe=J(qe);te(ce,{...he,batch_id:qe,unit_price:Qe})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",disabled:!he.product_id||v!=="",children:[i.jsx("option",{value:"",children:"Select Batch"}),Se.filter(Ee=>Ee.current_stock>0).map(Ee=>i.jsxs("option",{value:Ee.id,children:[Ee.batch_number," (",Ee.current_stock," stock)"]},Ee.id)),he.batch_id&&Se.find(Ee=>Ee.id===he.batch_id&&Ee.current_stock===0)&&i.jsxs("option",{value:he.batch_id,children:[(fe=Se.find(Ee=>Ee.id===he.batch_id))==null?void 0:fe.batch_number," (from challan)"]},he.batch_id)]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Quantity *"}),i.jsx("input",{type:"number",value:he.quantity===0?"":he.quantity,onChange:Ee=>te(ce,{...he,quantity:Ee.target.value===""?1:Number(Ee.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"1",placeholder:"1"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Unit Price *"}),i.jsx("input",{type:"number",value:he.unit_price===0?"":he.unit_price,onChange:Ee=>te(ce,{...he,unit_price:Ee.target.value===""?0:Number(Ee.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"0",placeholder:"0"})]}),i.jsxs("div",{className:"col-span-1",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Tax %"}),i.jsx("input",{type:"number",value:he.tax_rate===0?"":he.tax_rate,onChange:Ee=>te(ce,{...he,tax_rate:Ee.target.value===""?0:Number(Ee.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"0",placeholder:"11"})]}),i.jsxs("div",{className:"col-span-2 flex items-end gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Total"}),i.jsx("input",{type:"text",value:(he.total||0).toFixed(2),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",disabled:!0})]}),U.length>1&&i.jsx("button",{type:"button",onClick:()=>ye(ce),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Remove Item",children:i.jsx(wa,{className:"w-4 h-4"})})]})]}),he.batch_id&&Pe>0&&i.jsxs("div",{className:"flex items-center gap-4 text-xs p-2 bg-white rounded border border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Cost/Unit:"}),i.jsxs("span",{className:"font-semibold text-gray-900",children:["Rp ",Pe.toLocaleString("id-ID",{maximumFractionDigits:0})]})]}),i.jsx("div",{className:"h-4 w-px bg-gray-300"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Suggested Price (25%):"}),i.jsxs("span",{className:"font-semibold text-blue-600",children:["Rp ",Xe.toLocaleString("id-ID")]})]}),i.jsx("div",{className:"h-4 w-px bg-gray-300"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Current Margin:"}),i.jsxs("span",{className:`font-semibold ${Le>=20?"text-green-600":Le>=10?"text-yellow-600":"text-red-600"}`,children:[Le.toFixed(1),"%"]})]}),i.jsx("div",{className:"h-4 w-px bg-gray-300"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Profit/Unit:"}),i.jsxs("span",{className:`font-semibold ${he.unit_price>Pe?"text-green-600":"text-red-600"}`,children:["Rp ",(he.unit_price-Pe).toLocaleString("id-ID",{maximumFractionDigits:0})]})]})]})]},ce)})}),i.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{className:"font-medium",children:["Rp ",re().subtotal.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Tax:"}),i.jsxs("span",{className:"font-medium",children:["Rp ",re().taxAmount.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Discount:"}),i.jsxs("span",{className:"font-medium",children:["-Rp ",j.discount.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between text-base font-bold border-t pt-2",children:[i.jsx("span",{children:"Total:"}),i.jsxs("span",{className:"text-blue-600",children:["Rp ",re().total.toLocaleString("id-ID")]})]})]})})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{w(!1),De()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Create Invoice"})]})]})}),x&&k&&i.jsx(yde,{invoice:k,items:T,onClose:()=>{b(!1),E(null),S([])}})]})})}function bde({canManage:e}){const[t,r]=Z.useState([]),[n,a]=Z.useState(!0),[s,o]=Z.useState(!1),[l,c]=Z.useState(null),[u,A]=Z.useState({account_name:"",bank_name:"",account_number:"",account_type:"current",currency:"IDR",opening_balance:0});Z.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:y,error:p}=await de.from("bank_accounts").select("*").order("created_at",{ascending:!1});if(p)throw p;r(y||[])}catch(y){console.error("Error loading bank accounts:",y)}finally{a(!1)}},f=async y=>{y.preventDefault();try{const{data:{user:p}}=await de.auth.getUser();if(!p)throw new Error("Not authenticated");if(l){const{error:m}=await de.from("bank_accounts").update(u).eq("id",l.id);if(m)throw m}else{const{error:m}=await de.from("bank_accounts").insert([{...u,current_balance:u.opening_balance,created_by:p.id}]);if(m)throw m}o(!1),v(),h()}catch(p){console.error("Error saving bank account:",p),alert(`Failed to save bank account: ${p.message}`)}},d=y=>{c(y),A({account_name:y.account_name,bank_name:y.bank_name,account_number:y.account_number,account_type:y.account_type,currency:y.currency,opening_balance:y.opening_balance}),o(!0)},v=()=>{c(null),A({account_name:"",bank_name:"",account_number:"",account_type:"current",currency:"IDR",opening_balance:0})},g=[{key:"account_name",label:"Account Name"},{key:"bank_name",label:"Bank"},{key:"account_number",label:"Account #"},{key:"type",label:"Type",render:y=>i.jsx("span",{className:"capitalize",children:y.account_type})},{key:"balance",label:"Balance",render:y=>i.jsxs("span",{className:"font-semibold",children:["Rp ",y.current_balance.toLocaleString("id-ID")]})},{key:"status",label:"Status",render:y=>i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:y.is_active?"Active":"Inactive"})}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-semibold",children:"Bank Accounts"}),e&&i.jsxs("button",{onClick:()=>{v(),o(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Add Bank Account"]})]}),i.jsx(Ls,{columns:g,data:t,loading:n,actions:e?y=>i.jsx("button",{onClick:()=>d(y),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(uo,{className:"w-4 h-4"})}):void 0}),i.jsx(ir,{isOpen:s,onClose:()=>{o(!1),v()},title:l?"Edit Bank Account":"Add Bank Account",children:i.jsxs("form",{onSubmit:f,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name *"}),i.jsx("input",{type:"text",value:u.account_name,onChange:y=>A({...u,account_name:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name *"}),i.jsx("input",{type:"text",value:u.bank_name,onChange:y=>A({...u,bank_name:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number *"}),i.jsx("input",{type:"text",value:u.account_number,onChange:y=>A({...u,account_number:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Type *"}),i.jsxs("select",{value:u.account_type,onChange:y=>A({...u,account_type:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"savings",children:"Savings"}),i.jsx("option",{value:"current",children:"Current"}),i.jsx("option",{value:"credit_card",children:"Credit Card"}),i.jsx("option",{value:"other",children:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency *"}),i.jsxs("select",{value:u.currency,onChange:y=>A({...u,currency:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"IDR",children:"IDR (Indonesian Rupiah)"}),i.jsx("option",{value:"USD",children:"USD (US Dollar)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opening Balance *"}),i.jsx("input",{type:"number",value:u.opening_balance===0?"":u.opening_balance,onChange:y=>A({...u,opening_balance:y.target.value===""?0:Number(y.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,step:"0.01"})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{o(!1),v()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[l?"Update":"Add"," Account"]})]})]})})]})}function _de({canManage:e}){var j;const{setCurrentPage:t}=Mo(),[r,n]=Z.useState("invoices"),[a,s]=Z.useState([]),[o,l]=Z.useState([]),[c,u]=Z.useState([]),[A,h]=Z.useState(!0),[f,d]=Z.useState(!1),[v,g]=Z.useState(null),[y,p]=Z.useState([]),[m,w]=Z.useState({}),[x,b]=Z.useState({payment_number:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""});Z.useEffect(()=>{B()},[r]);const B=async()=>{try{const[I,U,q]=await Promise.all([de.from("sales_invoices").select("*, customers(company_name)").in("payment_status",["pending","partial"]).order("due_date",{ascending:!0}),de.from("customer_payments").select("*, customers(company_name), sales_invoices(invoice_number), bank_accounts(account_name)").order("payment_date",{ascending:!1}).limit(50),de.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0).order("account_name")]);if(I.error)throw I.error;if(U.error)throw U.error;if(q.error)throw q.error;const V=await Promise.all((I.data||[]).map(async X=>{const{data:W}=await de.rpc("get_invoice_paid_amount",{p_invoice_id:X.id});return{...X,paid_amount:W||0}}));s(V),l(U.data||[]),u(q.data||[])}catch(I){console.error("Error loading data:",I)}finally{h(!1)}},_=async I=>{g(I);const U=I.total_amount-(I.paid_amount||0);b({...x,payment_number:`PAY-${Date.now()}`,amount:U});try{const{data:q,error:V}=await de.from("sales_invoices").select("*").eq("customer_id",I.customer_id).in("payment_status",["pending","partial"]).order("invoice_date",{ascending:!0});if(V)throw V;const X=await Promise.all((q||[]).map(async W=>{const{data:M}=await de.rpc("get_invoice_paid_amount",{p_invoice_id:W.id});return{...W,paid_amount:M||0}}));p(X),w({[I.id]:U})}catch(q){console.error("Error loading customer invoices:",q)}d(!0)},k=async I=>{if(I.preventDefault(),!v)return;const U=Object.values(m).reduce((q,V)=>q+V,0);if(U>x.amount){alert("Total allocated amount cannot exceed payment amount");return}if(U===0){alert("Please allocate the payment to at least one invoice");return}try{const{data:{user:q}}=await de.auth.getUser();if(!q)throw new Error("Not authenticated");const{data:V,error:X}=await de.from("customer_payments").insert([{payment_number:x.payment_number,customer_id:v.customer_id,invoice_id:null,payment_date:x.payment_date,amount:x.amount,payment_method:x.payment_method,bank_account_id:x.bank_account_id||null,reference_number:x.reference_number||null,notes:x.notes||null,created_by:q.id}]).select().single();if(X)throw X;const W=Object.entries(m).filter(([G,H])=>H>0).map(([G,H])=>({invoice_id:G,payment_id:V.id,allocated_amount:H,created_by:q.id})),{error:M}=await de.from("invoice_payment_allocations").insert(W);if(M)throw M;d(!1),g(null),p([]),w({}),E(),B(),alert("Payment recorded and allocated successfully!")}catch(q){console.error("Error recording payment:",q),alert(`Failed to record payment: ${q.message}`)}},E=()=>{b({payment_number:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""})},T=[{key:"invoice_number",label:"Invoice #",render:I=>i.jsx("button",{onClick:()=>t("sales"),className:"text-blue-600 hover:underline font-medium",children:I.invoice_number})},{key:"customer",label:"Customer",render:I=>{var U;return((U=I.customers)==null?void 0:U.company_name)||"N/A"}},{key:"invoice_date",label:"Date",render:I=>new Date(I.invoice_date).toLocaleDateString()},{key:"due_date",label:"Due Date",render:I=>{const U=new Date(I.due_date),V=U<new Date&&I.payment_status!=="paid";return i.jsx("span",{className:V?"text-red-600 font-semibold":"",children:U.toLocaleDateString()})}},{key:"total_amount",label:"Amount",render:I=>`Rp ${I.total_amount.toLocaleString("id-ID")}`},{key:"paid",label:"Paid",render:I=>i.jsxs("span",{className:"text-green-600",children:["Rp ",(I.paid_amount||0).toLocaleString("id-ID")]})},{key:"balance",label:"Balance",render:I=>i.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",(I.total_amount-(I.paid_amount||0)).toLocaleString("id-ID")]})},{key:"status",label:"Status",render:I=>i.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${I.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:I.payment_status})}],S=[{key:"payment_number",label:"Payment #",render:I=>I.payment_number},{key:"payment_date",label:"Date",render:I=>new Date(I.payment_date).toLocaleDateString()},{key:"customer",label:"Customer",render:I=>{var U;return((U=I.customers)==null?void 0:U.company_name)||"N/A"}},{key:"invoice",label:"Invoice",render:I=>{var U;return((U=I.sales_invoices)==null?void 0:U.invoice_number)||"N/A"}},{key:"amount",label:"Amount",render:I=>i.jsxs("span",{className:"font-semibold text-green-600",children:["Rp ",I.amount.toLocaleString("id-ID")]})},{key:"method",label:"Method",render:I=>i.jsx("span",{className:"capitalize",children:I.payment_method.replace("_"," ")})},{key:"bank",label:"Bank Account",render:I=>{var U;return((U=I.bank_accounts)==null?void 0:U.account_name)||"Cash"}}];return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex justify-between items-center",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>n("invoices"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="invoices"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Outstanding Invoices (",a.length,")"]}),i.jsx("button",{onClick:()=>n("payments"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="payments"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Payment History"})]})}),r==="invoices"?i.jsx(i.Fragment,{children:a.length===0&&!A?i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(Ao,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"text-lg font-medium",children:"All Caught Up!"}),i.jsx("p",{className:"text-sm mt-2",children:"No outstanding invoices"})]}):i.jsx(Ls,{columns:T,data:a,loading:A,actions:e?I=>i.jsx("button",{onClick:()=>_(I),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition",children:"Record Payment"}):void 0})}):i.jsx(Ls,{columns:S,data:o,loading:A}),i.jsx(ir,{isOpen:f,onClose:()=>{d(!1),g(null),p([]),w({}),E()},title:"Record Customer Payment",maxWidth:"max-w-4xl",children:i.jsxs("form",{onSubmit:k,className:"space-y-4",children:[v&&i.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-medium text-lg mb-2",children:(j=v.customers)==null?void 0:j.company_name}),i.jsx("div",{className:"text-gray-600",children:"Recording payment for customer invoices"})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Number *"}),i.jsx("input",{type:"text",value:x.payment_number,onChange:I=>b({...x,payment_number:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),i.jsx("input",{type:"date",value:x.payment_date,onChange:I=>b({...x,payment_date:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),i.jsx("input",{type:"number",value:x.amount===0?"":x.amount,onChange:I=>b({...x,amount:I.target.value===""?0:Number(I.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),i.jsxs("select",{value:x.payment_method,onChange:I=>b({...x,payment_method:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),i.jsx("option",{value:"cheque",children:"Cheque"}),i.jsx("option",{value:"credit_card",children:"Credit Card"}),i.jsx("option",{value:"other",children:"Other"})]})]}),x.payment_method!=="cash"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),i.jsxs("select",{value:x.bank_account_id,onChange:I=>b({...x,bank_account_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select Bank Account"}),c.map(I=>i.jsxs("option",{value:I.id,children:[I.account_name," - ",I.bank_name]},I.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),i.jsx("input",{type:"text",value:x.reference_number,onChange:I=>b({...x,reference_number:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Bank reference or cheque number"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:x.notes,onChange:I=>b({...x,notes:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2})]})]}),y.length>0&&i.jsxs("div",{className:"border rounded-lg p-4 space-y-3 max-h-96 overflow-y-auto",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:"Allocate Payment to Invoices"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Select invoices and enter amount to allocate to each"}),y.map(I=>{const U=I.total_amount-(I.paid_amount||0),q=m[I.id]!==void 0,V=m[I.id]||0;return i.jsx("div",{className:"border rounded p-3 space-y-2",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[i.jsx("input",{type:"checkbox",checked:q,onChange:X=>{if(X.target.checked)w(W=>({...W,[I.id]:Math.min(U,x.amount-Object.values(m).reduce((M,G)=>M+G,0))}));else{const W={...m};delete W[I.id],w(W)}},className:"mt-1"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium text-sm",children:I.invoice_number}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Date: ",new Date(I.invoice_date).toLocaleDateString()]}),i.jsxs("div",{className:"text-xs mt-1",children:["Total: Rp ",I.total_amount.toLocaleString("id-ID")]}),i.jsxs("div",{className:"text-xs text-orange-600 font-medium",children:["Balance: Rp ",U.toLocaleString("id-ID")]})]})]}),q&&i.jsx("div",{className:"ml-3 w-32",children:i.jsx("input",{type:"number",value:V||"",onChange:X=>{const W=parseFloat(X.target.value)||0;if(W>U){alert("Cannot allocate more than balance");return}w(M=>({...M,[I.id]:W}))},className:"w-full px-2 py-1 border rounded text-sm",placeholder:"Amount",min:"0",max:U,step:"0.01"})})]})},I.id)}),i.jsxs("div",{className:"border-t pt-3 space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"font-medium",children:"Payment Amount:"}),i.jsxs("span",{className:"font-bold",children:["Rp ",x.amount.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Allocated:"}),i.jsxs("span",{className:Object.values(m).reduce((I,U)=>I+U,0)>x.amount?"text-red-600 font-bold":"text-green-600",children:["Rp ",Object.values(m).reduce((I,U)=>I+U,0).toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Unallocated:"}),i.jsxs("span",{className:"text-gray-600",children:["Rp ",(x.amount-Object.values(m).reduce((I,U)=>I+U,0)).toLocaleString("id-ID")]})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{d(!1),g(null),p([]),w({}),E()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",disabled:Object.values(m).reduce((I,U)=>I+U,0)===0,children:"Record Payment"})]})]})})]})}function Nde({canManage:e}){const{profile:t}=Dr(),[r,n]=Z.useState("bills"),[a,s]=Z.useState([]),[o,l]=Z.useState([]),[c,u]=Z.useState([]),[A,h]=Z.useState(!0),[f,d]=Z.useState(!1),[v,g]=Z.useState(!1),[y,p]=Z.useState(null),[m,w]=Z.useState(null),[x,b]=Z.useState({bill_number:"",vendor_name:"",vendor_id:"",bill_date:new Date().toISOString().split("T")[0],due_date:"",amount:0,tax_amount:0,category:"expense",description:""}),[B,_]=Z.useState({bill_id:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""});Z.useEffect(()=>{k()},[]);const k=async()=>{h(!0),await Promise.all([E(),T(),S()]),h(!1)},E=async()=>{try{const{data:z,error:ye}=await de.from("vendor_bills").select("*").order("bill_date",{ascending:!1});if(ye)throw ye;s(z||[])}catch(z){console.error("Error loading bills:",z)}},T=async()=>{try{const{data:z,error:ye}=await de.from("vendor_payments").select(`
          *,
          vendor_bills (
            bill_number,
            vendor_name
          ),
          bank_accounts (
            account_name,
            bank_name
          )
        `).order("payment_date",{ascending:!1});if(ye)throw ye;l(z||[])}catch(z){console.error("Error loading payments:",z)}},S=async()=>{try{const{data:z,error:ye}=await de.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0).order("account_name");if(ye)throw ye;u(z||[])}catch(z){console.error("Error loading bank accounts:",z)}},j=async()=>{const z="BILL",ye=new Date().getFullYear(),{data:re}=await de.from("vendor_bills").select("bill_number").like("bill_number",`${z}-${ye}%`).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(re!=null&&re.bill_number){const ke=parseInt(re.bill_number.split("-")[2]);return`${z}-${ye}-${String(ke+1).padStart(5,"0")}`}return`${z}-${ye}-00001`},I=async()=>{const z="VPAY",ye=new Date().getFullYear(),{data:re}=await de.from("vendor_payments").select("payment_number").like("payment_number",`${z}-${ye}%`).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(re!=null&&re.payment_number){const ke=parseInt(re.payment_number.split("-")[2]);return`${z}-${ye}-${String(ke+1).padStart(5,"0")}`}return`${z}-${ye}-00001`},U=async z=>{z.preventDefault();try{const{data:{user:ye}}=await de.auth.getUser();if(!ye)throw new Error("Not authenticated");const re=x.amount+x.tax_amount;if(y){const{error:ke}=await de.from("vendor_bills").update({vendor_name:x.vendor_name,vendor_id:x.vendor_id||null,bill_date:x.bill_date,due_date:x.due_date||null,amount:x.amount,tax_amount:x.tax_amount,total_amount:re,category:x.category,description:x.description||null}).eq("id",y.id);if(ke)throw ke}else{const ke=await j(),{error:be}=await de.from("vendor_bills").insert([{bill_number:ke,vendor_name:x.vendor_name,vendor_id:x.vendor_id||null,bill_date:x.bill_date,due_date:x.due_date||null,amount:x.amount,tax_amount:x.tax_amount,total_amount:re,category:x.category,description:x.description||null,created_by:ye.id}]);if(be)throw be}d(!1),G(),E()}catch(ye){console.error("Error saving bill:",ye),alert("Failed to save bill. Please try again.")}},q=async z=>{z.preventDefault();try{const{data:{user:ye}}=await de.auth.getUser();if(!ye)throw new Error("Not authenticated");if(m){const{error:re}=await de.from("vendor_payments").update({payment_date:B.payment_date,amount:B.amount,payment_method:B.payment_method,bank_account_id:B.bank_account_id||null,reference_number:B.reference_number||null,notes:B.notes||null}).eq("id",m.id);if(re)throw re}else{const re=await I(),{error:ke}=await de.from("vendor_payments").insert([{payment_number:re,bill_id:B.bill_id,payment_date:B.payment_date,amount:B.amount,payment_method:B.payment_method,bank_account_id:B.bank_account_id||null,reference_number:B.reference_number||null,notes:B.notes||null,created_by:ye.id}]);if(ke)throw ke}g(!1),H(),T(),E()}catch(ye){console.error("Error saving payment:",ye),alert("Failed to save payment. Please try again.")}},V=z=>{p(z),b({bill_number:z.bill_number,vendor_name:z.vendor_name,vendor_id:z.vendor_id||"",bill_date:z.bill_date,due_date:z.due_date||"",amount:z.amount,tax_amount:z.tax_amount,category:z.category,description:z.description||""}),d(!0)},X=z=>{w(z),_({bill_id:z.bill_id,payment_date:z.payment_date,amount:z.amount,payment_method:z.payment_method,bank_account_id:z.bank_account_id||"",reference_number:z.reference_number||"",notes:z.notes||""}),g(!0)},W=async z=>{if(confirm("Are you sure you want to delete this bill?"))try{const{error:ye}=await de.from("vendor_bills").delete().eq("id",z);if(ye)throw ye;E()}catch(ye){console.error("Error deleting bill:",ye),alert("Failed to delete bill. Please try again.")}},M=async z=>{if(confirm("Are you sure you want to delete this payment?"))try{const{error:ye}=await de.from("vendor_payments").delete().eq("id",z);if(ye)throw ye;T(),E()}catch(ye){console.error("Error deleting payment:",ye),alert("Failed to delete payment. Please try again.")}},G=()=>{p(null),b({bill_number:"",vendor_name:"",vendor_id:"",bill_date:new Date().toISOString().split("T")[0],due_date:"",amount:0,tax_amount:0,category:"expense",description:""})},H=()=>{w(null),_({bill_id:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""})},C=z=>{switch(z){case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-yellow-100 text-yellow-800";case"pending":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},L=z=>z?{inventory:"Inventory",expense:"Expense",asset:"Asset",other:"Other"}[z]||z:"N/A",O=z=>({cash:"Cash",bank_transfer:"Bank Transfer",cheque:"Cheque",credit_card:"Credit Card",other:"Other"})[z]||z,D=a.filter(z=>z.payment_status!=="paid").reduce((z,ye)=>z+ye.total_amount,0),P=a.filter(z=>!z.due_date||z.payment_status==="paid"?!1:new Date(z.due_date)<new Date),Q=[{key:"bill_number",label:"Bill Number",render:z=>i.jsx("span",{className:"font-medium text-gray-900",children:z.bill_number})},{key:"vendor_name",label:"Vendor",render:z=>z.vendor_name},{key:"bill_date",label:"Bill Date",render:z=>new Date(z.bill_date).toLocaleDateString()},{key:"due_date",label:"Due Date",render:z=>{if(!z.due_date)return"N/A";const ye=new Date(z.due_date),re=ye<new Date&&z.payment_status!=="paid";return i.jsxs("span",{className:re?"text-red-600 font-medium":"",children:[ye.toLocaleDateString(),re&&i.jsx(ya,{className:"w-3 h-3 inline ml-1"})]})}},{key:"category",label:"Category",render:z=>L(z.category)},{key:"total_amount",label:"Total Amount",render:z=>i.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",z.total_amount.toLocaleString("id-ID")]})},{key:"payment_status",label:"Status",render:z=>i.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${C(z.payment_status)}`,children:z.payment_status.toUpperCase()})}],J=[{key:"payment_number",label:"Payment Number",render:z=>i.jsx("span",{className:"font-medium text-gray-900",children:z.payment_number})},{key:"bill",label:"Bill Number",render:z=>{var ye;return((ye=z.vendor_bills)==null?void 0:ye.bill_number)||"N/A"}},{key:"vendor",label:"Vendor",render:z=>{var ye;return((ye=z.vendor_bills)==null?void 0:ye.vendor_name)||"N/A"}},{key:"payment_date",label:"Payment Date",render:z=>new Date(z.payment_date).toLocaleDateString()},{key:"amount",label:"Amount",render:z=>i.jsxs("span",{className:"font-semibold text-green-600",children:["Rp ",z.amount.toLocaleString("id-ID")]})},{key:"payment_method",label:"Method",render:z=>O(z.payment_method)},{key:"bank_account",label:"Bank Account",render:z=>z.bank_accounts?`${z.bank_accounts.account_name} - ${z.bank_accounts.bank_name}`:"N/A"}],te=a.filter(z=>z.payment_status!=="paid");return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg shadow p-6 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-red-100",children:"Total Payable"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rp ",D.toLocaleString("id-ID")]})]}),i.jsx(Ro,{className:"w-8 h-8 text-red-200"})]})}),i.jsx("div",{className:"bg-orange-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-orange-600",children:"Overdue Bills"}),i.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:P.length})]}),i.jsx(ya,{className:"w-8 h-8 text-orange-400"})]})}),i.jsx("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-blue-600",children:"Total Bills"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:a.length})]}),i.jsx(pr,{className:"w-8 h-8 text-blue-400"})]})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>n("bills"),className:`px-4 py-2 rounded-lg transition ${r==="bills"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[i.jsx(pr,{className:"w-4 h-4 inline mr-2"}),"Bills"]}),i.jsxs("button",{onClick:()=>n("payments"),className:`px-4 py-2 rounded-lg transition ${r==="payments"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[i.jsx(Ro,{className:"w-4 h-4 inline mr-2"}),"Payments"]})]}),e&&i.jsxs("div",{className:"flex gap-2",children:[r==="bills"&&i.jsxs("button",{onClick:()=>{G(),d(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Add Bill"]}),r==="payments"&&i.jsxs("button",{onClick:()=>{H(),g(!0)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Record Payment"]})]})]}),r==="bills"?i.jsx(Ls,{columns:Q,data:a,loading:A,actions:e?z=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>V(z),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(uo,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>W(z.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:i.jsx(wa,{className:"w-4 h-4"})})]}):void 0}):i.jsx(Ls,{columns:J,data:o,loading:A,actions:e?z=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>X(z),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(uo,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>M(z.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:i.jsx(wa,{className:"w-4 h-4"})})]}):void 0}),i.jsx(ir,{isOpen:f,onClose:()=>{d(!1),G()},title:y?"Edit Vendor Bill":"Add Vendor Bill",children:i.jsxs("form",{onSubmit:U,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Name *"}),i.jsx("input",{type:"text",value:x.vendor_name,onChange:z=>b({...x,vendor_name:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor ID (Optional)"}),i.jsx("input",{type:"text",value:x.vendor_id,onChange:z=>b({...x,vendor_id:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),i.jsxs("select",{value:x.category||"",onChange:z=>b({...x,category:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"expense",children:"Expense"}),i.jsx("option",{value:"inventory",children:"Inventory"}),i.jsx("option",{value:"asset",children:"Asset"}),i.jsx("option",{value:"other",children:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Date *"}),i.jsx("input",{type:"date",value:x.bill_date,onChange:z=>b({...x,bill_date:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),i.jsx("input",{type:"date",value:x.due_date,onChange:z=>b({...x,due_date:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),i.jsx("input",{type:"number",value:x.amount===0?"":x.amount,onChange:z=>b({...x,amount:z.target.value===""?0:Number(z.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Amount (Rp)"}),i.jsx("input",{type:"number",value:x.tax_amount===0?"":x.tax_amount,onChange:z=>b({...x,tax_amount:z.target.value===""?0:Number(z.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),i.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["Rp ",(x.amount+x.tax_amount).toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:x.description,onChange:z=>b({...x,description:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{d(!1),G()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:y?"Update Bill":"Add Bill"})]})]})}),i.jsx(ir,{isOpen:v,onClose:()=>{g(!1),H()},title:m?"Edit Payment":"Record Payment",children:i.jsxs("form",{onSubmit:q,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill *"}),i.jsxs("select",{value:B.bill_id,onChange:z=>{const ye=z.target.value,re=te.find(ke=>ke.id===ye);_({...B,bill_id:ye,amount:re?re.total_amount:0})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!m,children:[i.jsx("option",{value:"",children:"Select a bill"}),te.map(z=>i.jsxs("option",{value:z.id,children:[z.bill_number," - ",z.vendor_name," (Rp ",z.total_amount.toLocaleString("id-ID"),")"]},z.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),i.jsx("input",{type:"date",value:B.payment_date,onChange:z=>_({...B,payment_date:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),i.jsx("input",{type:"number",value:B.amount===0?"":B.amount,onChange:z=>_({...B,amount:z.target.value===""?0:Number(z.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),i.jsxs("select",{value:B.payment_method,onChange:z=>_({...B,payment_method:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"cheque",children:"Cheque"}),i.jsx("option",{value:"credit_card",children:"Credit Card"}),i.jsx("option",{value:"other",children:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),i.jsxs("select",{value:B.bank_account_id,onChange:z=>_({...B,bank_account_id:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select bank account"}),c.map(z=>i.jsxs("option",{value:z.id,children:[z.account_name," - ",z.bank_name]},z.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),i.jsx("input",{type:"text",value:B.reference_number,onChange:z=>_({...B,reference_number:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Transaction/Check number"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:B.notes,onChange:z=>_({...B,notes:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{g(!1),H()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:m?"Update Payment":"Record Payment"})]})]})})]})}function Bde(){const[e,t]=Z.useState([]),[r,n]=Z.useState(!0),[a,s]=Z.useState(new Date().toISOString().split("T")[0]);Z.useEffect(()=>{o()},[a]);const o=async()=>{try{n(!0);const{data:A,error:h}=await de.from("sales_invoices").select("*, customers(company_name)").in("payment_status",["pending","partial"]);if(h)throw h;const f=await Promise.all((A||[]).map(async g=>{const{data:y}=await de.rpc("get_invoice_paid_amount",{p_invoice_id:g.id}),p=y||0,m=g.total_amount-p,w=new Date(g.due_date),x=new Date(a),b=Math.floor((x.getTime()-w.getTime())/(1e3*60*60*24));return{...g,balance:m,days_overdue:b}})),d=new Map;f.forEach(g=>{var m;const y=g.customer_id;d.has(y)||d.set(y,{customer_id:y,customer_name:((m=g.customers)==null?void 0:m.company_name)||"Unknown",total_outstanding:0,current:0,days_1_30:0,days_31_60:0,days_61_90:0,days_90_plus:0,invoice_count:0});const p=d.get(y);p.total_outstanding+=g.balance,p.invoice_count+=1,g.days_overdue<0?p.current+=g.balance:g.days_overdue<=30?p.days_1_30+=g.balance:g.days_overdue<=60?p.days_31_60+=g.balance:g.days_overdue<=90?p.days_61_90+=g.balance:p.days_90_plus+=g.balance});const v=Array.from(d.values()).sort((g,y)=>y.total_outstanding-g.total_outstanding);t(v)}catch(A){console.error("Error loading ageing data:",A),alert("Failed to load ageing report")}finally{n(!1)}},l=()=>{const A=["Customer","Total Outstanding","Current (Not Due)","1-30 Days","31-60 Days","61-90 Days","90+ Days","Invoice Count"],h=e.map(y=>[y.customer_name,y.total_outstanding,y.current,y.days_1_30,y.days_31_60,y.days_61_90,y.days_90_plus,y.invoice_count]),f=[A.join(","),...h.map(y=>y.join(","))].join(`
`),d=new Blob([f],{type:"text/csv"}),v=URL.createObjectURL(d),g=document.createElement("a");g.href=v,g.download=`ageing_report_${a}.csv`,g.click(),URL.revokeObjectURL(v)},c=e.reduce((A,h)=>({total_outstanding:A.total_outstanding+h.total_outstanding,current:A.current+h.current,days_1_30:A.days_1_30+h.days_1_30,days_31_60:A.days_31_60+h.days_31_60,days_61_90:A.days_61_90+h.days_61_90,days_90_plus:A.days_90_plus+h.days_90_plus,invoice_count:A.invoice_count+h.invoice_count}),{total_outstanding:0,current:0,days_1_30:0,days_31_60:0,days_61_90:0,days_90_plus:0,invoice_count:0}),u=c.days_1_30+c.days_31_60+c.days_61_90+c.days_90_plus;return i.jsx(ca,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Accounts Receivable Ageing Report"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Track overdue invoices by ageing buckets"})]}),i.jsxs("button",{onClick:l,disabled:e.length===0,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Y7,{className:"w-4 h-4"}),"Export CSV"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Outstanding"}),i.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:["Rp ",c.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[c.invoice_count," invoices"]})]}),i.jsx(Ao,{className:"w-10 h-10 text-gray-400"})]})}),i.jsxs("div",{className:"bg-green-50 rounded-lg shadow p-6 border border-green-200",children:[i.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Current (Not Due)"}),i.jsxs("p",{className:"text-2xl font-bold text-green-900 mt-1",children:["Rp ",c.current.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[c.total_outstanding>0?(c.current/c.total_outstanding*100).toFixed(1):0,"% of total"]})]}),i.jsxs("div",{className:"bg-orange-50 rounded-lg shadow p-6 border border-orange-200",children:[i.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Overdue"}),i.jsxs("p",{className:"text-2xl font-bold text-orange-900 mt-1",children:["Rp ",u.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:[c.total_outstanding>0?(u/c.total_outstanding*100).toFixed(1):0,"% of total"]})]}),i.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-6 border border-red-200",children:[i.jsx("p",{className:"text-sm text-red-700 font-medium",children:"90+ Days Critical"}),i.jsxs("p",{className:"text-2xl font-bold text-red-900 mt-1",children:["Rp ",c.days_90_plus.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Immediate action required"})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx(as,{className:"w-4 h-4 text-gray-500"}),i.jsx("span",{className:"font-medium text-gray-700",children:"As of Date:"})]}),i.jsx("input",{type:"date",value:a,onChange:A=>s(A.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),i.jsxs("span",{className:"text-sm text-gray-500",children:["Report generated as of ",new Date(a).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoices"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Outstanding"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-green-700 uppercase tracking-wider",children:"Current"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-yellow-700 uppercase tracking-wider",children:"1-30 Days"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-orange-700 uppercase tracking-wider",children:"31-60 Days"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-red-700 uppercase tracking-wider",children:"61-90 Days"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-red-900 uppercase tracking-wider",children:"90+ Days"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-3",children:"Loading ageing data..."})]})})}):e.length===0?i.jsx("tr",{children:i.jsxs("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:[i.jsx(Ao,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-lg font-medium",children:"No Outstanding Invoices"}),i.jsx("p",{className:"text-sm mt-2",children:"All invoices are fully paid!"})]})}):i.jsxs(i.Fragment,{children:[e.map(A=>i.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",children:A.customer_name})}),i.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-500",children:A.invoice_count}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm font-bold text-gray-900",children:["Rp ",A.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:A.current>0?i.jsxs("span",{className:"text-green-600 font-medium",children:["Rp ",A.current.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:A.days_1_30>0?i.jsxs("span",{className:"text-yellow-600 font-medium",children:["Rp ",A.days_1_30.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:A.days_31_60>0?i.jsxs("span",{className:"text-orange-600 font-medium",children:["Rp ",A.days_31_60.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:A.days_61_90>0?i.jsxs("span",{className:"text-red-600 font-medium",children:["Rp ",A.days_61_90.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})}),i.jsx("td",{className:"px-6 py-4 text-right text-sm",children:A.days_90_plus>0?i.jsxs("span",{className:"text-red-900 font-bold",children:["Rp ",A.days_90_plus.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):i.jsx("span",{className:"text-gray-300",children:"-"})})]},A.customer_id)),i.jsxs("tr",{className:"bg-gray-100 font-bold border-t-2 border-gray-300",children:[i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"TOTAL"}),i.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-900",children:c.invoice_count}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-gray-900",children:["Rp ",c.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-green-700",children:["Rp ",c.current.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-yellow-700",children:["Rp ",c.days_1_30.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-orange-700",children:["Rp ",c.days_31_60.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-red-700",children:["Rp ",c.days_61_90.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),i.jsxs("td",{className:"px-6 py-4 text-right text-sm text-red-900",children:["Rp ",c.days_90_plus.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]})})]})})})]})})}function Cde(){const{t:e}=ba(),{profile:t}=Dr(),[r,n]=Z.useState("expenses"),[a,s]=Z.useState([]),[o,l]=Z.useState([]),[c,u]=Z.useState(!0),[A,h]=Z.useState(!1),[f,d]=Z.useState(null),[v,g]=Z.useState("all"),[y,p]=Z.useState({start:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[m,w]=Z.useState({expense_category:"other",amount:0,expense_date:new Date().toISOString().split("T")[0],description:"",batch_id:"",document_urls:[]});Z.useEffect(()=>{x(),b()},[]);const x=async()=>{try{const{data:V,error:X}=await de.from("finance_expenses").select("*, batches(batch_number)").order("expense_date",{ascending:!1}).order("created_at",{ascending:!1});if(X)throw X;s(V||[])}catch(V){console.error("Error loading expenses:",V)}finally{u(!1)}},b=async()=>{try{const{data:V,error:X}=await de.from("batches").select("id, batch_number").eq("is_active",!0).order("import_date",{ascending:!1});if(X)throw X;l(V||[])}catch(V){console.error("Error loading batches:",V)}},B=async V=>{V.preventDefault();try{const{data:{user:X}}=await de.auth.getUser();if(!X)throw new Error("Not authenticated");if(f){const{error:W}=await de.from("finance_expenses").update({...m,batch_id:m.batch_id||null,description:m.description||null,document_urls:m.document_urls.length>0?m.document_urls:null}).eq("id",f.id);if(W)throw W}else{const{error:W}=await de.from("finance_expenses").insert([{...m,batch_id:m.batch_id||null,description:m.description||null,document_urls:m.document_urls.length>0?m.document_urls:null,created_by:X.id}]);if(W)throw W}h(!1),E(),x()}catch(X){console.error("Error saving expense:",X),alert("Failed to save expense. Please try again.")}},_=V=>{d(V),w({expense_category:V.expense_category,amount:V.amount,expense_date:V.expense_date,description:V.description||"",batch_id:V.batch_id||"",document_urls:V.document_urls||[]}),h(!0)},k=async V=>{if(confirm("Are you sure you want to delete this expense?"))try{const{error:X}=await de.from("finance_expenses").delete().eq("id",V);if(X)throw X;x()}catch(X){console.error("Error deleting expense:",X),alert("Failed to delete expense. Please try again.")}},E=()=>{d(null),w({expense_category:"other",amount:0,expense_date:new Date().toISOString().split("T")[0],description:"",batch_id:"",document_urls:[]})},T={duty:{label:"Duty",color:"bg-red-100 text-red-800"},freight:{label:"Freight",color:"bg-blue-100 text-blue-800"},warehouse_rent:{label:"Warehouse Rent",color:"bg-yellow-100 text-yellow-800"},utilities:{label:"Utilities",color:"bg-green-100 text-green-800"},salary:{label:"Salary",color:"bg-purple-100 text-purple-800"},other:{label:"Other",color:"bg-gray-100 text-gray-800"}},S=a.filter(V=>{const X=v==="all"||V.expense_category===v,W=new Date(V.expense_date),M=W>=new Date(y.start)&&W<=new Date(y.end);return X&&M}),j={totalExpenses:S.reduce((V,X)=>V+X.amount,0),duty:a.filter(V=>V.expense_category==="duty").reduce((V,X)=>V+X.amount,0),freight:a.filter(V=>V.expense_category==="freight").reduce((V,X)=>V+X.amount,0),operations:a.filter(V=>["warehouse_rent","utilities","salary"].includes(V.expense_category)).reduce((V,X)=>V+X.amount,0),other:a.filter(V=>V.expense_category==="other").reduce((V,X)=>V+X.amount,0)},I=[{key:"expense_date",label:"Date",render:V=>new Date(V.expense_date).toLocaleDateString()},{key:"expense_category",label:"Category",render:V=>i.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${T[V.expense_category].color}`,children:T[V.expense_category].label})},{key:"amount",label:"Amount",render:V=>i.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",V.amount.toLocaleString("id-ID")]})},{key:"batch",label:"Batch",render:V=>{var X;return((X=V.batches)==null?void 0:X.batch_number)||"N/A"}},{key:"description",label:"Description",render:V=>i.jsx("span",{className:"text-sm text-gray-600",children:V.description||"-"})}],U=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts",q=[{id:"expenses",label:"Expenses",icon:lR},{id:"banks",label:"Bank Accounts",icon:X7},{id:"receivables",label:"Receivables",icon:Ao},{id:"payables",label:"Payables",icon:qw},{id:"ageing",label:"Ageing Report",icon:Ro}];return i.jsx(ca,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Finance Management"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive financial tracking and reporting"})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:q.map(V=>{const X=V.icon,W=r===V.id;return i.jsxs("button",{onClick:()=>n(V.id),className:["flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm",W?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"].join(" "),children:[i.jsx(X,{className:"w-5 h-5"}),V.label]},V.id)})})}),i.jsxs("div",{className:"p-6",children:[r==="expenses"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:U&&i.jsxs("button",{onClick:()=>{E(),h(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition ml-auto",children:[i.jsx(Wn,{className:"w-5 h-5"}),"Add Expense"]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow p-3 md:p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("p",{className:"text-xs md:text-sm text-blue-100 truncate",children:"Total Expenses"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold mt-0.5",children:["Rp ",j.totalExpenses.toLocaleString("id-ID")]})]}),i.jsx(Ro,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-200 flex-shrink-0 ml-2"})]})}),i.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-3 md:p-4",children:[i.jsx("p",{className:"text-xs md:text-sm text-red-600 truncate",children:"Duty"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold text-red-600 mt-0.5",children:["Rp ",j.duty.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"bg-blue-50 rounded-lg shadow p-3 md:p-4",children:[i.jsx("p",{className:"text-xs md:text-sm text-blue-600 truncate",children:"Freight"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold text-blue-600 mt-0.5",children:["Rp ",j.freight.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"bg-yellow-50 rounded-lg shadow p-3 md:p-4",children:[i.jsx("p",{className:"text-xs md:text-sm text-yellow-600 truncate",children:"Operations"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold text-yellow-600 mt-0.5",children:["Rp ",j.operations.toLocaleString("id-ID")]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg shadow p-3 md:p-4",children:[i.jsx("p",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Other"}),i.jsxs("p",{className:"text-lg md:text-2xl font-bold text-gray-600 mt-0.5",children:["Rp ",j.other.toLocaleString("id-ID")]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:i.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"From:"}),i.jsx("input",{type:"date",value:y.start,onChange:V=>p({...y,start:V.target.value}),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"To:"}),i.jsx("input",{type:"date",value:y.end,onChange:V=>p({...y,end:V.target.value}),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"})]}),i.jsx("div",{className:"flex-1"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>g("all"),className:`px-3 py-1.5 rounded-lg text-sm transition ${v==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All"}),Object.entries(T).map(([V,X])=>i.jsx("button",{onClick:()=>g(V),className:`px-3 py-1.5 rounded-lg text-sm transition ${v===V?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:X.label},V))]})]})}),i.jsx(Ls,{columns:I,data:S,loading:c,actions:U?V=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>_(V),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:i.jsx(uo,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>k(V.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:i.jsx(wa,{className:"w-4 h-4"})})]}):void 0}),i.jsx(ir,{isOpen:A,onClose:()=>{h(!1),E()},title:f?"Edit Expense":"Add New Expense",children:i.jsxs("form",{onSubmit:B,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expense Category *"}),i.jsx("select",{value:m.expense_category,onChange:V=>w({...m,expense_category:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:Object.entries(T).map(([V,X])=>i.jsx("option",{value:V,children:X.label},V))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),i.jsx("input",{type:"number",value:m.amount===0?"":m.amount,onChange:V=>w({...m,amount:V.target.value===""?0:Number(V.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expense Date *"}),i.jsx("input",{type:"date",value:m.expense_date,onChange:V=>w({...m,expense_date:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Batch (Optional)"}),i.jsxs("select",{value:m.batch_id,onChange:V=>w({...m,batch_id:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"None"}),o.map(V=>i.jsx("option",{value:V.id,children:V.batch_number},V.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:m.description,onChange:V=>w({...m,description:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Additional details about this expense"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(ki,{className:"w-4 h-4 inline mr-1"}),"Attach Documents (Receipts, Photos, etc.)"]}),i.jsx(_F,{currentUrls:m.document_urls,onUploadComplete:V=>w({...m,document_urls:V}),folder:"expense-documents"})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{h(!1),E()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:f?"Update Expense":"Add Expense"})]})]})})]}),r==="banks"&&i.jsx(bde,{canManage:U}),r==="receivables"&&i.jsx(_de,{canManage:U}),r==="payables"&&i.jsx(Nde,{canManage:U}),r==="ageing"&&i.jsx(Bde,{})]})]})]})})}function Ede(){const[e,t]=Z.useState(null),[r,n]=Z.useState(!0),[a,s]=Z.useState(!1);Z.useEffect(()=>{o();const h=setInterval(()=>{o()},5e3);return()=>clearInterval(h)},[]);const o=async()=>{try{const{data:{user:h}}=await de.auth.getUser();if(!h)return;const{data:f,error:d}=await de.from("gmail_connections").select("*").eq("user_id",h.id).maybeSingle();if(d&&d.code!=="PGRST116")throw d;t(f)}catch(h){console.error("Error loading Gmail connection:",h)}finally{n(!1)}},l=()=>{{alert(`Gmail integration is not configured. Please add VITE_GOOGLE_CLIENT_ID to your .env file.

Steps:
1. Go to Google Cloud Console
2. Create OAuth 2.0 credentials
3. Add the Client ID to .env file
4. Restart the dev server

See GMAIL_SETUP.md for detailed instructions.`);return}},c=async()=>{if(confirm("Are you sure you want to disconnect your Gmail account? Email syncing will stop."))try{const{data:{user:h}}=await de.auth.getUser();if(!h)return;const{error:f}=await de.from("gmail_connections").update({is_connected:!1,sync_enabled:!1,access_token:null,refresh_token:null}).eq("user_id",h.id);if(f)throw f;alert("Gmail account disconnected successfully"),o()}catch(h){console.error("Error disconnecting Gmail:",h),alert("Failed to disconnect Gmail account")}},u=async()=>{if(e)try{const{error:h}=await de.from("gmail_connections").update({sync_enabled:!e.sync_enabled}).eq("id",e.id);if(h)throw h;o()}catch(h){console.error("Error toggling sync:",h),alert("Failed to update sync settings")}},A=async()=>{if(a)return;s(!0),console.log({title:"Email Sync Started",message:"Syncing emails in background. You can continue using the app."});try{const{data:{session:f}}=await de.auth.getSession();if(!f){alert("Please sign in to sync emails"),s(!1);return}const d="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/sync-gmail-emails",v=new AbortController,g=setTimeout(()=>v.abort(),12e4),y=await fetch(d,{method:"POST",headers:{Authorization:`Bearer ${f.access_token}`,"Content-Type":"application/json"},signal:v.signal});if(clearTimeout(g),!y.ok){const m=await y.text();throw new Error(`Server error (${y.status}): ${m}`)}const p=await y.json();if(p.success)alert(`Email sync completed!

 Total messages found: ${p.totalMessages}
 New emails processed: ${p.processedCount}
 New inquiries: ${p.newInquiriesCount}`),o();else throw new Error(p.error||"Sync failed")}catch(f){console.error("Error syncing emails:",f),f instanceof Error&&f.name==="AbortError"?alert("Sync is taking longer than expected. It will continue in the background. Check back in a few minutes."):alert(`Failed to sync emails: ${f instanceof Error?f.message:"Unknown error"}`)}finally{s(!1)}};return r?i.jsx("div",{className:"flex justify-center items-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(gF,{className:"w-5 h-5 text-blue-600"}),i.jsx("h3",{className:"text-lg font-semibold",children:"Gmail Integration"})]}),e!=null&&e.is_connected?i.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),i.jsx("span",{className:"text-sm font-medium text-green-700",children:"Connected"})]}):i.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg",children:[i.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),i.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Not Connected"})]})]}),e!=null&&e.is_connected?i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[i.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:i.jsx(ua,{className:"w-8 h-8 text-green-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Gmail Connected"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.email_address}),e.last_sync&&i.jsxs("p",{className:"text-xs text-gray-500",children:["Last synced: ",new Date(e.last_sync).toLocaleString()]}),e.access_token_expires_at&&i.jsxs("p",{className:"text-xs text-gray-500",children:["Token expires: ",new Date(e.access_token_expires_at).toLocaleString()]})]})]}),i.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition",children:[i.jsx(mF,{className:"w-4 h-4"}),"Disconnect"]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:"Sync Settings"}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Automatic Email Sync"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Fetch new emails every 10 minutes"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:e.sync_enabled,onChange:u,className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),i.jsx("div",{className:"pt-4 border-t",children:i.jsxs("button",{onClick:A,disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm font-medium disabled:opacity-50",children:[i.jsx(Ec,{className:`w-4 h-4 ${a?"animate-spin":""}`}),a?"Syncing...":"Sync Now"]})})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(ya,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"text-sm text-yellow-800",children:[i.jsx("p",{className:"font-medium mb-1",children:"Important Security Information"}),i.jsxs("ul",{className:"space-y-1 text-xs",children:[i.jsx("li",{children:" Your Gmail password is never stored or accessed by this app"}),i.jsx("li",{children:" Access tokens are encrypted in the database"}),i.jsx("li",{children:" You can revoke access anytime from Google Account settings"}),i.jsx("li",{children:" Only emails marked as inquiry-related are processed"})]})]})]})})]}):i.jsx("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:i.jsx(la,{className:"w-8 h-8 text-blue-600"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Connect Your Gmail Account"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Securely connect your Gmail account to automatically fetch pharmaceutical inquiry emails. Your password is never stored - we use Google's OAuth2 for maximum security."}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[i.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"What you'll get:"}),i.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[i.jsx("li",{children:" Automatic email fetching every 10 minutes"}),i.jsx("li",{children:" AI-powered inquiry extraction from emails"}),i.jsx("li",{children:" Send emails directly from CRM"}),i.jsx("li",{children:" Complete email activity tracking"})]})]}),i.jsxs("button",{onClick:l,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-medium",children:[i.jsx(la,{className:"w-5 h-5"}),"Connect Gmail Account"]}),i.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["By connecting, you authorize this app to read and send emails on your behalf. You can revoke access anytime from your ",i.jsx("a",{href:"https://myaccount.google.com/permissions",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Google Account settings"}),"."]})]})]})}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(ya,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"text-sm text-red-800",children:[i.jsx("p",{className:"font-medium mb-1",children:"Gmail Integration Not Configured"}),i.jsx("p",{children:"Gmail OAuth2 credentials are not set up. Please contact your administrator to configure the VITE_GOOGLE_CLIENT_ID environment variable. Refer to GMAIL_SETUP.md for setup instructions."})]})]})})]})}function Sde({users:e,onRefresh:t}){const[r,n]=Z.useState(!1),[a,s]=Z.useState(!1),[o,l]=Z.useState(null),[c,u]=Z.useState(!1),[A,h]=Z.useState({username:"",email:"",password:"",full_name:"",role:"sales"}),f=async m=>{m.preventDefault(),u(!0);try{const{data:w,error:x}=await de.auth.signUp({email:A.email,password:A.password,options:{data:{full_name:A.full_name,email_verified:!0}}});if(x)throw x;if(!w.user)throw new Error("Failed to create user");const{error:b}=await de.from("user_profiles").insert([{id:w.user.id,username:A.username.toLowerCase(),email:A.email,full_name:A.full_name,role:A.role,is_active:!0}]);if(b)throw b;alert(`User ${A.full_name} created successfully! Username: ${A.username}`),n(!1),h({username:"",email:"",password:"",full_name:"",role:"sales"}),t()}catch(w){console.error("Error creating user:",w),alert(w.message||"Failed to create user. Please try again.")}finally{u(!1)}},d=async m=>{if(m.preventDefault(),!!o){u(!0);try{const{error:w}=await de.from("user_profiles").update({username:A.username.toLowerCase(),full_name:A.full_name,role:A.role}).eq("id",o.id);if(w)throw w;alert(`User ${A.full_name} updated successfully!`),s(!1),l(null),h({username:"",email:"",password:"",full_name:"",role:"sales"}),t()}catch(w){console.error("Error updating user:",w),alert(w.message||"Failed to update user. Please try again.")}finally{u(!1)}}},v=m=>{l(m),h({username:m.username,email:m.email,password:"",full_name:m.full_name,role:m.role}),s(!0)},g=async(m,w)=>{if(confirm(`Are you sure you want to ${w?"deactivate":"activate"} this user?`))try{const{error:b}=await de.from("user_profiles").update({is_active:!w}).eq("id",m);if(b)throw b;alert(`User ${w?"deactivated":"activated"} successfully!`),t()}catch(b){console.error("Error updating user status:",b),alert("Failed to update user status.")}},y=async(m,w)=>{if(confirm(`Are you sure you want to permanently delete user "${w}"? This action cannot be undone.`))try{const{error:x}=await de.from("user_profiles").delete().eq("id",m);if(x)throw x;alert("User deleted successfully!"),t()}catch(x){console.error("Error deleting user:",x),alert("Failed to delete user. The user may have associated records.")}},p=m=>{switch(m){case"admin":return"bg-purple-100 text-purple-800 border-purple-300";case"sales":return"bg-blue-100 text-blue-800 border-blue-300";case"accounts":return"bg-green-100 text-green-800 border-green-300";case"warehouse":return"bg-orange-100 text-orange-800 border-orange-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(to,{className:"w-5 h-5"}),"User Management"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage system users, roles, and access permissions"})]}),i.jsxs("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2",children:[i.jsx(Kw,{className:"w-4 h-4"}),"Add New User"]})]}),i.jsx("div",{className:"space-y-3",children:e.length===0?i.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx(to,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-600",children:"No users found"}),i.jsx("button",{onClick:()=>n(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Add your first user"})]}):e.map(m=>i.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-md",children:i.jsx("span",{className:"text-white font-bold text-lg",children:m.full_name.charAt(0).toUpperCase()})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-900",children:m.full_name}),i.jsxs("p",{className:"text-sm text-gray-600 font-mono",children:["@",m.username]}),i.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mt-0.5",children:[i.jsx(la,{className:"w-3 h-3"}),m.email]}),i.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Created: ",new Date(m.created_at).toLocaleDateString()]})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("span",{className:`px-3 py-1 border rounded-full text-xs font-medium capitalize flex items-center gap-1.5 ${p(m.role)}`,children:[i.jsx(gv,{className:"w-3 h-3"}),m.role]}),i.jsx("button",{onClick:()=>v(m),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit user",children:i.jsx(jg,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>g(m.id,m.is_active),className:`px-4 py-1.5 rounded-lg text-sm font-medium transition flex items-center gap-1.5 ${m.is_active?"bg-green-100 text-green-800 hover:bg-green-200 border border-green-300":"bg-red-100 text-red-800 hover:bg-red-200 border border-red-300"}`,title:m.is_active?"Click to deactivate":"Click to activate",children:m.is_active?i.jsxs(i.Fragment,{children:[i.jsx(ua,{className:"w-3.5 h-3.5"}),"Active"]}):i.jsxs(i.Fragment,{children:[i.jsx(Pa,{className:"w-3.5 h-3.5"}),"Inactive"]})}),i.jsx("button",{onClick:()=>y(m.id,m.username),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete user",children:i.jsx(wa,{className:"w-4 h-4"})})]})]},m.id))}),i.jsx(ir,{isOpen:r,onClose:()=>{n(!1),h({username:"",email:"",password:"",full_name:"",role:"sales"})},title:"Add New User",children:i.jsxs("form",{onSubmit:f,className:"space-y-4",children:[i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:i.jsx("p",{className:"text-sm text-blue-800",children:"Create a new user account. The user will be able to log in with their username and password."})}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(to,{className:"w-4 h-4"}),"Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:A.full_name,onChange:m=>h({...A,full_name:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(to,{className:"w-4 h-4"}),"Username ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:A.username,onChange:m=>h({...A,username:m.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:"johndoe",pattern:"[a-z0-9]+",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lowercase letters and numbers only. This will be used to log in."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(la,{className:"w-4 h-4"}),"Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",value:A.email,onChange:m=>h({...A,email:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"user@company.com",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"For system notifications only. Login uses username."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(rR,{className:"w-4 h-4"}),"Password ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"password",value:A.password,onChange:m=>h({...A,password:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Minimum 6 characters",minLength:6,required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters. User can change this after logging in."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(gv,{className:"w-4 h-4"}),"Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:A.role,onChange:m=>h({...A,role:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"sales",children:"Sales - CRM, customers, and sales invoices"}),i.jsx("option",{value:"accounts",children:"Accounts - Finance and invoicing"}),i.jsx("option",{value:"warehouse",children:"Warehouse - Inventory management"}),i.jsx("option",{value:"admin",children:"Admin - Full system access"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Role determines which modules the user can access"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{n(!1),h({username:"",email:"",password:"",full_name:"",role:"sales"})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:c,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:c,children:c?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Kw,{className:"w-4 h-4"}),"Create User"]})})]})]})}),i.jsx(ir,{isOpen:a,onClose:()=>{s(!1),l(null),h({username:"",email:"",password:"",full_name:"",role:"sales"})},title:"Edit User",children:i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:i.jsx("p",{className:"text-sm text-amber-800",children:"Editing user profile. Email cannot be changed. To reset password, user must use password reset feature."})}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(to,{className:"w-4 h-4"}),"Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:A.full_name,onChange:m=>h({...A,full_name:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(to,{className:"w-4 h-4"}),"Username ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:A.username,onChange:m=>h({...A,username:m.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:"johndoe",pattern:"[a-z0-9]+",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lowercase letters and numbers only. This will be used to log in."})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(la,{className:"w-4 h-4"}),"Email Address"]}),i.jsx("input",{type:"email",value:A.email,className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed",disabled:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[i.jsx(gv,{className:"w-4 h-4"}),"Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:A.role,onChange:m=>h({...A,role:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"sales",children:"Sales - CRM, customers, and sales invoices"}),i.jsx("option",{value:"accounts",children:"Accounts - Finance and invoicing"}),i.jsx("option",{value:"warehouse",children:"Warehouse - Inventory management"}),i.jsx("option",{value:"admin",children:"Admin - Full system access"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Role determines which modules the user can access"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{s(!1),l(null),h({username:"",email:"",password:"",full_name:"",role:"sales"})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:c,children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:c,children:c?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(jg,{className:"w-4 h-4"}),"Save Changes"]})})]})]})})]})}function kde(){const[e,t]=Z.useState([]),[r,n]=Z.useState(!0),[a,s]=Z.useState(!1),[o,l]=Z.useState(null),[c,u]=Z.useState({template_name:"",subject:"",body:"",category:"custom",variables:[]}),A=[{value:"price_quote",label:"Price Quote"},{value:"coa_msds",label:"COA/MSDS"},{value:"follow_up",label:"Follow-up"},{value:"thank_you",label:"Thank You"},{value:"custom",label:"Custom"}],h=["{{contact_person}}","{{company_name}}","{{product_name}}","{{specification}}","{{quantity}}","{{supplier_name}}","{{supplier_country}}","{{inquiry_number}}","{{user_name}}"];Z.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:x,error:b}=await de.from("crm_email_templates").select("*").order("created_at",{ascending:!1});if(b)throw b;t(x||[])}catch(x){console.error("Error loading templates:",x)}finally{n(!1)}},d=async x=>{x.preventDefault();try{const{data:{user:b}}=await de.auth.getUser();if(!b)throw new Error("Not authenticated");if(o){const{error:B}=await de.from("crm_email_templates").update({template_name:c.template_name,subject:c.subject,body:c.body,category:c.category,variables:c.variables,updated_at:new Date().toISOString()}).eq("id",o.id);if(B)throw B;alert("Template updated successfully!")}else{const{error:B}=await de.from("crm_email_templates").insert([{...c,created_by:b.id,is_active:!0,use_count:0}]);if(B)throw B;alert("Template created successfully!")}w(),s(!1),f()}catch(b){console.error("Error saving template:",b),alert(b.message||"Failed to save template")}},v=x=>{l(x),u({template_name:x.template_name,subject:x.subject,body:x.body,category:x.category,variables:x.variables||[]}),s(!0)},g=async x=>{try{const{data:{user:b}}=await de.auth.getUser();if(!b)throw new Error("Not authenticated");const{error:B}=await de.from("crm_email_templates").insert([{template_name:`${x.template_name} (Copy)`,subject:x.subject,body:x.body,category:x.category,variables:x.variables,created_by:b.id,is_active:!0,use_count:0}]);if(B)throw B;alert("Template duplicated successfully!"),f()}catch(b){console.error("Error duplicating template:",b),alert("Failed to duplicate template")}},y=async(x,b)=>{if(confirm(`Are you sure you want to delete "${b}"?`))try{const{error:B}=await de.from("crm_email_templates").delete().eq("id",x);if(B)throw B;alert("Template deleted successfully!"),f()}catch(B){console.error("Error deleting template:",B),alert("Failed to delete template")}},p=async(x,b)=>{try{const{error:B}=await de.from("crm_email_templates").update({is_active:!b}).eq("id",x);if(B)throw B;f()}catch(B){console.error("Error updating template:",B),alert("Failed to update template status")}},m=x=>{u(b=>({...b,body:b.body+" "+x,variables:b.variables.includes(x)?b.variables:[...b.variables,x]}))},w=()=>{l(null),u({template_name:"",subject:"",body:"",category:"custom",variables:[]})};return r?i.jsx("div",{className:"flex justify-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(pr,{className:"w-5 h-5"}),"Email Templates"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage reusable email templates with variable placeholders"})]}),i.jsxs("button",{onClick:()=>{w(),s(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2",children:[i.jsx(Wn,{className:"w-4 h-4"}),"New Template"]})]}),i.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.length===0?i.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsx(pr,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),i.jsx("p",{className:"text-gray-600",children:"No templates found"}),i.jsx("button",{onClick:()=>s(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Create your first template"})]}):e.map(x=>{var b,B;return i.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:x.template_name}),i.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-700 rounded",children:((b=A.find(_=>_.value===x.category))==null?void 0:b.label)||x.category})]}),i.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[i.jsx("strong",{children:"Subject:"})," ",x.subject]}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[i.jsxs("span",{children:["Used ",x.use_count," times"]}),((B=x.variables)==null?void 0:B.length)>0&&i.jsxs("span",{children:["Variables: ",x.variables.length]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>p(x.id,x.is_active),className:`p-2 rounded-lg transition ${x.is_active?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-50"}`,title:x.is_active?"Active":"Inactive",children:x.is_active?i.jsx(ua,{className:"w-4 h-4"}):i.jsx(Pa,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>g(x),className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition",title:"Duplicate",children:i.jsx(z7,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>v(x),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit",children:i.jsx(jg,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>y(x.id,x.template_name),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete",children:i.jsx(wa,{className:"w-4 h-4"})})]})]})},x.id)})}),i.jsx(ir,{isOpen:a,onClose:()=>{s(!1),w()},title:o?"Edit Template":"Create New Template",children:i.jsxs("form",{onSubmit:d,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Name *"}),i.jsx("input",{type:"text",value:c.template_name,onChange:x=>u({...c,template_name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"e.g., Price Quote - English"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),i.jsx("select",{value:c.category,onChange:x=>u({...c,category:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:A.map(x=>i.jsx("option",{value:x.value,children:x.label},x.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Subject *"}),i.jsx("input",{type:"text",value:c.subject,onChange:x=>u({...c,subject:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"Use variables like {{product_name}}"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Body (HTML) *"}),i.jsx("div",{className:"mb-2 flex flex-wrap gap-1",children:h.map(x=>i.jsx("button",{type:"button",onClick:()=>m(x),className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:x},x))}),i.jsx("textarea",{value:c.body,onChange:x=>u({...c,body:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:15,placeholder:"Enter email template body..."})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[i.jsx("button",{type:"button",onClick:()=>{s(!1),w()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:o?"Update Template":"Create Template"})]})]})})]})}function jde(){const[e,t]=Z.useState(!1),[r,n]=Z.useState(!1),[a,s]=Z.useState([]),[o,l]=Z.useState(null),[c,u]=Z.useState(new Set),[A,h]=Z.useState(500),f=async()=>{t(!0);try{const{data:{user:p}}=await de.auth.getUser();if(!p){alert("Please log in to extract contacts.");return}const{data:m,error:w}=await de.from("gmail_connections").select("*").eq("user_id",p.id).eq("is_connected",!0).maybeSingle();if(w){console.error("Error fetching Gmail connection:",w),alert("Error checking Gmail connection. Please try again.");return}if(!m||!m.access_token){alert("Gmail is not connected. Please connect Gmail first in Settings  Gmail tab.");return}const b=await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/extract-gmail-contacts",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY","Content-Type":"application/json"},body:JSON.stringify({access_token:m.access_token,max_emails:A})});if(!b.ok)throw new Error("Failed to extract contacts");const B=await b.json();if(B.success)s(B.contacts),l({total_emails:B.total_emails,total_contacts:B.total_contacts}),u(new Set(B.contacts.map((_,k)=>k)));else throw new Error(B.error||"Failed to extract contacts")}catch(p){console.error("Error extracting contacts:",p),alert("Failed to extract contacts. Please try again.")}finally{t(!1)}},d=()=>{if(a.length===0){alert("No contacts to export");return}const p=a.filter((b,B)=>c.has(B)),m=hs.json_to_sheet(p.map(b=>({"Company Name":b.companyName,"Customer Name":b.customerName,"Email IDs":b.emailIds,Phone:b.phone,Mobile:b.mobile,Website:b.website,Address:b.address,Source:b.source}))),w=hs.book_new();hs.book_append_sheet(w,m,"Clients");const x=[{wch:30},{wch:25},{wch:40},{wch:18},{wch:18},{wch:30},{wch:40},{wch:12}];m["!cols"]=x,Wg(w,`Extracted_Contacts_${new Date().toISOString().split("T")[0]}.xlsx`)},v=async()=>{if(c.size===0){alert("Please select contacts to import");return}if(confirm(`Are you sure you want to import ${c.size} contact(s) to the Customers database?

This will create new customer records for selected contacts.`)){n(!0);try{const w=a.filter((B,_)=>c.has(_)).map(B=>{var _;return{company_name:B.companyName||"Unknown Company",contact_person:B.customerName||"",email:((_=B.emailIds.split(";")[0])==null?void 0:_.trim())||"",phone:B.phone||B.mobile||"",website:B.website||"",address:B.address||"",country:"Indonesia",city:"Jakarta Pusat",is_active:!0}}),{data:x,error:b}=await de.from("customers").upsert(w,{onConflict:"email",ignoreDuplicates:!1}).select();if(b)throw b;alert(`Successfully imported ${(x==null?void 0:x.length)||c.size} customer(s)!`),s([]),l(null),u(new Set)}catch(m){console.error("Error importing customers:",m),alert("Failed to import some customers. They may already exist in the database.")}finally{n(!1)}}},g=()=>{c.size===a.length?u(new Set):u(new Set(a.map((p,m)=>m)))},y=p=>{const m=new Set(c);m.has(p)?m.delete(p):m.add(p),u(m)};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Extract Data from Gmail"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Extract contact information from your Gmail inbox, sent emails, and CC/BCC recipients. The system will analyze email signatures, bodies, and headers to gather business contact details."})]}),i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Emails to Scan"}),i.jsx("input",{type:"number",value:A,onChange:p=>h(Math.max(100,Math.min(2e3,parseInt(p.target.value)||500))),min:"100",max:"2000",step:"100",className:"w-48 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Range: 100 - 2000 emails"})]}),i.jsx("div",{className:"flex-shrink-0 pt-6",children:i.jsx("button",{onClick:f,disabled:e,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e?i.jsxs(i.Fragment,{children:[i.jsx(Ec,{className:"h-5 w-5 animate-spin"}),"Extracting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(la,{className:"h-5 w-5"}),"Extract Contacts"]})})})]}),o&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(ua,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"Extraction completed successfully!"}),i.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["Scanned ",o.total_emails," emails and found ",o.total_contacts," unique contacts"]})]})]})})]}),a.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("h3",{className:"text-md font-semibold text-gray-900",children:["Extracted Contacts (",c.size," selected)"]}),i.jsx("button",{onClick:g,className:"text-sm text-blue-600 hover:text-blue-700",children:c.size===a.length?"Deselect All":"Select All"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:d,disabled:c.size===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Qo,{className:"h-4 w-4"}),"Export to Excel"]}),i.jsx("button",{onClick:v,disabled:r||c.size===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:r?i.jsxs(i.Fragment,{children:[i.jsx(Ec,{className:"h-4 w-4 animate-spin"}),"Importing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(zb,{className:"h-4 w-4"}),"Import to Customers"]})})]})]}),i.jsx("div",{className:"overflow-x-auto max-h-96 overflow-y-auto border border-gray-200 rounded-lg",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left",children:i.jsx("input",{type:"checkbox",checked:c.size===a.length,onChange:g,className:"rounded border-gray-300"})}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact Person"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email IDs"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phone"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mobile"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Website"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map((p,m)=>i.jsxs("tr",{className:`hover:bg-gray-50 ${c.has(m)?"bg-blue-50":""}`,children:[i.jsx("td",{className:"px-4 py-3",children:i.jsx("input",{type:"checkbox",checked:c.has(m),onChange:()=>y(m),className:"rounded border-gray-300"})}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:p.companyName||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:p.customerName||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 max-w-xs truncate",title:p.emailIds,children:p.emailIds||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:p.phone||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:p.mobile||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-blue-600 max-w-xs truncate",title:p.website,children:p.website||"-"})]},m))})]})})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(ya,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-yellow-900 font-medium",children:"Review before importing"}),i.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Please review the extracted contacts carefully. The system attempts to deduplicate and merge contacts from the same company, but you should verify the data before importing to your customer database."})]})]})})]})]})}function Fde(){const{t:e}=ba(),{profile:t}=Dr(),[r,n]=Z.useState("company"),[a,s]=Z.useState(!0),[o,l]=Z.useState(!1),[c,u]=Z.useState(null),[A,h]=Z.useState([]),[f,d]=Z.useState({company_name:"",company_address:"",company_phone:"",company_email:"",tax_rate:11,invoice_prefix:"SAPJ",invoice_start_number:1,email_host:"",email_port:587,email_username:"",low_stock_threshold:100,expiry_alert_days:30,default_language:"en",financial_year_start:"2024-01-01",financial_year_end:"2024-12-31",current_financial_year:"2024"});Z.useEffect(()=>{(t==null?void 0:t.role)==="admin"&&(v(),g())},[t]);const v=async()=>{try{const{data:p,error:m}=await de.from("app_settings").select("*").limit(1).maybeSingle();if(m)throw m;p&&(u(p),d({company_name:p.company_name||"",company_address:p.company_address||"",company_phone:p.company_phone||"",company_email:p.company_email||"",tax_rate:p.tax_rate||11,invoice_prefix:p.invoice_prefix||"SAPJ",invoice_start_number:p.invoice_start_number||1,email_host:p.email_host||"",email_port:p.email_port||587,email_username:p.email_username||"",low_stock_threshold:p.low_stock_threshold||100,expiry_alert_days:p.expiry_alert_days||30,default_language:p.default_language||"en",financial_year_start:p.financial_year_start||"2024-01-01",financial_year_end:p.financial_year_end||"2024-12-31",current_financial_year:p.current_financial_year||"2024"}))}catch(p){console.error("Error loading settings:",p)}finally{s(!1)}},g=async()=>{try{const{data:p,error:m}=await de.from("user_profiles").select("id, email, full_name, role, is_active, created_at, username").order("created_at",{ascending:!1});if(m)throw m;h(p||[])}catch(p){console.error("Error loading users:",p),h([])}},y=async p=>{p.preventDefault(),l(!0);try{if(c){const{error:m}=await de.from("app_settings").update({...f,email_host:f.email_host||null,email_username:f.email_username||null}).eq("id",c.id);if(m)throw m}else{const{error:m}=await de.from("app_settings").insert([{...f,email_host:f.email_host||null,email_username:f.email_username||null}]);if(m)throw m}alert("Settings saved successfully!"),v()}catch(m){console.error("Error saving settings:",m),alert("Failed to save settings. Please try again.")}finally{l(!1)}};return(t==null?void 0:t.role)!=="admin"?i.jsx(ca,{children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx("p",{className:"text-xl text-gray-600",children:"You do not have permission to access settings."}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Only administrators can view and modify system settings."})]})}):a?i.jsx(ca,{children:i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):i.jsx(ca,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Configure system settings and manage users"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("nav",{className:"flex -mb-px",children:[i.jsx("button",{onClick:()=>n("company"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="company"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Mw,{className:"w-4 h-4"}),"Company Profile"]})}),i.jsx("button",{onClick:()=>n("users"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="users"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Qu,{className:"w-4 h-4"}),"Users"]})}),i.jsx("button",{onClick:()=>n("financial"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="financial"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(as,{className:"w-4 h-4"}),"Financial Year"]})}),i.jsx("button",{onClick:()=>n("system"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="system"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(si,{className:"w-4 h-4"}),"System"]})}),i.jsx("button",{onClick:()=>n("gmail"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="gmail"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(la,{className:"w-4 h-4"}),"Gmail"]})}),i.jsx("button",{onClick:()=>n("templates"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="templates"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(pr,{className:"w-4 h-4"}),"Email Templates"]})}),i.jsx("button",{onClick:()=>n("extract"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="extract"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Qo,{className:"w-4 h-4"}),"Extract Data"]})})]})}),i.jsxs("div",{className:"p-6",children:[r==="gmail"&&i.jsx(Ede,{}),r==="templates"&&i.jsx(kde,{}),r==="extract"&&i.jsx(jde,{}),r==="company"&&i.jsxs("form",{onSubmit:y,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(Mw,{className:"w-5 h-5"}),"Company Information"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name *"}),i.jsx("input",{type:"text",value:f.company_name,onChange:p=>d({...f,company_name:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),i.jsx("textarea",{value:f.company_address,onChange:p=>d({...f,company_address:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),i.jsx("input",{type:"text",value:f.company_phone,onChange:p=>d({...f,company_phone:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:f.company_email,onChange:p=>d({...f,company_email:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(Ro,{className:"w-5 h-5"}),"Financial Settings"]}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Tax Rate (%)"}),i.jsx("input",{type:"number",value:f.tax_rate,onChange:p=>d({...f,tax_rate:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"0.1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Prefix"}),i.jsx("input",{type:"text",value:f.invoice_prefix,onChange:p=>d({...f,invoice_prefix:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Start Number"}),i.jsx("input",{type:"number",value:f.invoice_start_number,onChange:p=>d({...f,invoice_start_number:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1"})]})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[i.jsx(xv,{className:"w-5 h-5"}),o?"Saving...":"Save Settings"]})})]}),r==="users"&&i.jsx(Sde,{users:A,onRefresh:g}),r==="financial"&&i.jsxs("form",{onSubmit:y,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(as,{className:"w-5 h-5"}),"Financial Year Configuration"]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:i.jsx("p",{className:"text-sm text-blue-800",children:"Configure your company's financial year period. This will be used to filter reports and dashboard statistics. The system will automatically organize data based on the selected financial year."})}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Financial Year *"}),i.jsxs("select",{value:f.current_financial_year,onChange:p=>{const m=p.target.value;d({...f,current_financial_year:m,financial_year_start:`${m}-01-01`,financial_year_end:`${m}-12-31`})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"2023",children:"2023"}),i.jsx("option",{value:"2024",children:"2024"}),i.jsx("option",{value:"2025",children:"2025"}),i.jsx("option",{value:"2026",children:"2026"}),i.jsx("option",{value:"2027",children:"2027"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the active financial year"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),i.jsx("input",{type:"date",value:f.financial_year_start,onChange:p=>d({...f,financial_year_start:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Financial year start date"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),i.jsx("input",{type:"date",value:f.financial_year_end,onChange:p=>d({...f,financial_year_end:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Financial year end date"})]})]}),i.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:"Active Financial Year Period:"}),i.jsxs("p",{className:"text-lg font-bold text-green-900",children:[new Date(f.financial_year_start).toLocaleDateString()," - ",new Date(f.financial_year_end).toLocaleDateString()]})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[i.jsx(xv,{className:"w-5 h-5"}),o?"Saving...":"Save Financial Year"]})})]}),r==="system"&&i.jsxs("form",{onSubmit:y,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(si,{className:"w-5 h-5"}),"Inventory Alerts"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Low Stock Threshold"}),i.jsx("input",{type:"number",value:f.low_stock_threshold,onChange:p=>d({...f,low_stock_threshold:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when stock falls below this quantity"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Alert Days"}),i.jsx("input",{type:"number",value:f.expiry_alert_days,onChange:p=>d({...f,expiry_alert_days:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when products will expire within this many days"})]})]})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(la,{className:"w-5 h-5"}),"Email Configuration (Optional)"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Host"}),i.jsx("input",{type:"text",value:f.email_host,onChange:p=>d({...f,email_host:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"smtp.example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Port"}),i.jsx("input",{type:"number",value:f.email_port,onChange:p=>d({...f,email_port:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Username"}),i.jsx("input",{type:"text",value:f.email_username,onChange:p=>d({...f,email_username:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"user@example.com"})]})]})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Language Preference"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Language"}),i.jsxs("select",{value:f.default_language,onChange:p=>d({...f,default_language:p.target.value}),className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"en",children:"English"}),i.jsx("option",{value:"id",children:"Indonesian"})]})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[i.jsx(xv,{className:"w-5 h-5"}),o?"Saving...":"Save Settings"]})})]})]})]})]})})}const Ly=[{email:"admin@pharma.com",password:"admin123",fullName:"Admin User",role:"admin"},{email:"accounts@pharma.com",password:"accounts123",fullName:"Accounts Manager",role:"accounts"},{email:"sales@pharma.com",password:"sales123",fullName:"Sales Representative",role:"sales"},{email:"warehouse@pharma.com",password:"warehouse123",fullName:"Warehouse Staff",role:"warehouse"}];function Tde(){const[e,t]=Z.useState(!1),[r,n]=Z.useState([]),[a,s]=Z.useState(!0),o=async()=>{t(!0),n([]);const l=[];for(const c of Ly){try{const{data:u,error:A}=await de.auth.signUp({email:c.email,password:c.password});if(A){l.push({email:c.email,success:!1,message:`Auth error: ${A.message}`});continue}if(!u.user){l.push({email:c.email,success:!1,message:"No user data returned"});continue}const{error:h}=await de.from("user_profiles").insert({id:u.user.id,email:c.email,full_name:c.fullName,role:c.role,language:"en",is_active:!0});if(h){l.push({email:c.email,success:!1,message:`Profile error: ${h.message}`});continue}l.push({email:c.email,success:!0,message:`Created successfully (${c.role})`})}catch(u){l.push({email:c.email,success:!1,message:`Error: ${u.message}`})}n([...l])}t(!1)};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-slate-100 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl p-8",children:[i.jsx("div",{className:"flex items-center justify-center mb-6",children:i.jsx("div",{className:"bg-blue-600 p-3 rounded-full",children:i.jsx(Kw,{className:"w-8 h-8 text-white"})})}),i.jsx("h1",{className:"text-3xl font-bold text-center text-gray-900 mb-2",children:"Database Setup"}),i.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Create sample users for your Pharma Trading System"}),a&&i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Important Instructions:"}),i.jsxs("ol",{className:"text-sm text-blue-800 space-y-2 list-decimal list-inside",children:[i.jsx("li",{children:"This page will create 4 test users with their profiles"}),i.jsx("li",{children:"Make sure your Supabase email confirmation is disabled in your project settings"}),i.jsx("li",{children:"If email confirmation is enabled, you'll need to confirm emails manually"}),i.jsx("li",{children:"Click the button below to create all users at once"})]}),i.jsx("button",{onClick:()=>s(!1),className:"mt-3 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Got it, hide this"})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Users to create:"}),i.jsx("div",{className:"space-y-2",children:Ly.map(l=>i.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:l.email}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Password: ",l.password," | Role: ",l.role]})]}),i.jsx("span",{className:`px-2 py-1 text-xs rounded ${l.role==="admin"?"bg-red-100 text-red-700":l.role==="accounts"?"bg-green-100 text-green-700":l.role==="sales"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:l.role})]},l.email))})]}),i.jsx("button",{onClick:o,disabled:e,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium text-lg mb-6",children:e?"Creating Users...":"Create All Users"}),r.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Results:"}),r.map((l,c)=>i.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${l.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[l.success?i.jsx(ua,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}):i.jsx(Pa,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:`font-medium ${l.success?"text-green-900":"text-red-900"}`,children:l.email}),i.jsx("div",{className:`text-sm ${l.success?"text-green-700":"text-red-700"}`,children:l.message})]})]},c))]}),r.length>0&&r.every(l=>l.success)&&i.jsxs("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:[i.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"Success!"}),i.jsx("p",{className:"text-sm text-green-800 mb-3",children:"All users created successfully. You can now navigate to the login page and use any of these credentials:"}),i.jsx("div",{className:"text-sm text-green-800 space-y-1",children:Ly.map(l=>i.jsxs("div",{children:[" ",l.email," / ",l.password]},l.email))}),i.jsx("button",{onClick:()=>window.location.href="/",className:"mt-4 w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition font-medium",children:"Go to Login"})]}),r.length>0&&r.some(l=>!l.success)&&i.jsxs("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[i.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"Partial Success"}),i.jsx("p",{className:"text-sm text-yellow-800 mb-2",children:"Some users failed to create. This is usually because:"}),i.jsxs("ul",{className:"text-sm text-yellow-800 list-disc list-inside space-y-1",children:[i.jsx("li",{children:"The email already exists"}),i.jsx("li",{children:"Email confirmation is required (check Supabase Auth settings)"}),i.jsx("li",{children:"RLS policies prevented profile creation"})]}),i.jsx("p",{className:"text-sm text-yellow-800 mt-3",children:"See CREATE_USERS.md for manual setup instructions."})]})]})})}function Ide(){const[e,t]=Z.useState("loading"),[r,n]=Z.useState("Processing Gmail connection...");Z.useEffect(()=>{a()},[]);const a=async()=>{try{console.log("Starting Gmail OAuth callback...");const s=new URLSearchParams(window.location.search),o=s.get("code"),l=s.get("error");if(console.log("Callback params:",{hasCode:!!o,error:l}),l){t("error"),n(`Authorization failed: ${l}`),setTimeout(()=>window.close(),3e3);return}if(!o){t("error"),n("No authorization code received"),setTimeout(()=>window.close(),3e3);return}const{data:{user:c}}=await de.auth.getUser();if(!c){t("error"),n("User not authenticated"),setTimeout(()=>window.close(),3e3);return}const u=void 0,A=void 0,h=`${window.location.origin}/auth/gmail/callback`;if(console.log("OAuth config:",{hasClientId:!!u,hasClientSecret:!!A,redirectUri:h}),!u||!A)throw new Error("Google OAuth credentials not configured. Please check your .env file.");console.log("Exchanging code for token...");const f=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({code:o,client_id:u,client_secret:A,redirect_uri:h,grant_type:"authorization_code"})});if(!f.ok){const m=await f.text();throw console.error("Token exchange failed:",m),new Error(`Token exchange failed: ${m}`)}const d=await f.json();console.log("Token received, fetching profile...");const v=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${d.access_token}`}});if(!v.ok){const m=await v.text();throw console.error("Profile fetch failed:",{status:v.status,statusText:v.statusText,body:m}),new Error(`Failed to fetch Gmail profile (${v.status}): ${m}`)}const g=await v.json();console.log("Profile fetched:",g.email);const y=new Date;y.setSeconds(y.getSeconds()+d.expires_in);const{error:p}=await de.from("gmail_connections").upsert({user_id:c.id,email_address:g.email,access_token:d.access_token,refresh_token:d.refresh_token,access_token_expires_at:y.toISOString(),is_connected:!0,sync_enabled:!0,last_sync:null},{onConflict:"user_id,email_address"});if(p)throw console.error("Database error:",p),p;console.log("Gmail connection saved to database"),t("success"),n("Gmail connected successfully! You can close this window."),setTimeout(()=>{window.opener&&window.opener.location.reload(),window.close()},2e3)}catch(s){console.error("Callback error:",s),t("error"),n(s instanceof Error?s.message:"Failed to connect Gmail"),setTimeout(()=>window.close(),5e3)}};return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[e==="loading"&&i.jsxs(i.Fragment,{children:[i.jsx(Do,{className:"w-16 h-16 text-blue-600 mx-auto mb-4 animate-spin"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connecting Gmail..."}),i.jsx("p",{className:"text-gray-600",children:r})]}),e==="success"&&i.jsxs(i.Fragment,{children:[i.jsx(ua,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Success!"}),i.jsx("p",{className:"text-gray-600",children:r})]}),e==="error"&&i.jsxs(i.Fragment,{children:[i.jsx(Pa,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connection Failed"}),i.jsx("p",{className:"text-gray-600",children:r}),i.jsx("button",{onClick:()=>window.close(),className:"mt-4 px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition",children:"Close Window"})]})]})})}function Lde({existingOrder:e,onSuccess:t,onCancel:r}){const{user:n}=Dr(),{t:a}=ba(),[s,o]=Z.useState([]),[l,c]=Z.useState([]),[u,A]=Z.useState({}),[h,f]=Z.useState(!1),[d,v]=Z.useState({customer_id:"",customer_po_number:"",customer_po_date:new Date().toISOString().split("T")[0],so_date:new Date().toISOString().split("T")[0],expected_delivery_date:"",notes:"",currency:"IDR"}),[g,y]=Z.useState(null),[p,m]=Z.useState([{product_id:"",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,tax_percent:0,tax_amount:0,line_total:0,item_delivery_date:"",notes:""}]);Z.useEffect(()=>{w(),x()},[]),Z.useEffect(()=>{if(e&&(v({customer_id:e.customer_id,customer_po_number:e.customer_po_number,customer_po_date:e.customer_po_date,so_date:e.so_date,expected_delivery_date:e.expected_delivery_date||"",notes:e.notes||"",currency:e.currency||"IDR"}),e.sales_order_items&&e.sales_order_items.length>0)){const W=e.sales_order_items.map(M=>({product_id:M.product_id,quantity:M.quantity,unit_price:M.unit_price,discount_percent:M.discount_percent,discount_amount:M.discount_amount,tax_percent:M.tax_percent,tax_amount:M.tax_amount,line_total:M.line_total,item_delivery_date:M.item_delivery_date||"",notes:M.notes||""}));m(W),W.forEach(M=>{M.product_id&&b(M.product_id)})}},[e]);const w=async()=>{try{const{data:W,error:M}=await de.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(M)throw M;o(W||[])}catch(W){console.error("Error fetching customers:",W.message)}},x=async()=>{try{const{data:W,error:M}=await de.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(M)throw M;c(W||[])}catch(W){console.error("Error fetching products:",W.message)}},b=async W=>{try{const{data:M,error:G}=await de.from("batches").select("id, current_stock").eq("product_id",W);if(G)throw G;const H=(M==null?void 0:M.reduce((D,P)=>D+Number(P.current_stock),0))||0,{data:C}=await de.from("stock_reservations").select("reserved_quantity").eq("product_id",W).eq("status","active"),L=(C==null?void 0:C.reduce((D,P)=>D+Number(P.reserved_quantity),0))||0,O=H-L;A(D=>({...D,[W]:{total_stock:H,reserved_stock:L,free_stock:O}}))}catch(M){console.error("Error fetching stock info:",M.message)}},B=(W,M)=>{if(!l.find(C=>C.id===M))return;const H=[...p];H[W].product_id=M,H[W].unit_price=0,m(H),_(W),b(M)},_=W=>{const M=p[W],G=M.quantity*M.unit_price,H=M.discount_percent>0?G*M.discount_percent/100:M.discount_amount,C=G-H,L=C*M.tax_percent/100,O=C+L,D=[...p];D[W]={...M,discount_amount:H,tax_amount:L,line_total:O},m(D)},k=(W,M,G)=>{const H=[...p];H[W]={...H[W],[M]:G};const C=H[W],L=C.quantity*C.unit_price,O=C.discount_percent>0?L*C.discount_percent/100:C.discount_amount,D=L-O,P=D*C.tax_percent/100,Q=D+P;H[W]={...C,discount_amount:O,tax_amount:P,line_total:Q},m(H)},E=()=>{m([...p,{product_id:"",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,tax_percent:0,tax_amount:0,line_total:0,item_delivery_date:"",notes:""}])},T=W=>{if(p.length===1){alert("At least one item is required");return}console.log("Removing item at index:",W,"Current items count:",p.length);const M=p.filter((G,H)=>H!==W);console.log("New items count after removal:",M.length),m(M)},S=async()=>{if(!g)return null;try{console.log("Starting file upload:",g.name);const W=g.name.split(".").pop(),G=`customer-po/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${W}`}`;console.log("Uploading to path:",G);const{data:H,error:C}=await de.storage.from("sales-order-documents").upload(G,g,{cacheControl:"3600",upsert:!1});if(C)throw console.error("Upload error:",C),C;console.log("File uploaded successfully:",H);const{data:{publicUrl:L}}=de.storage.from("sales-order-documents").getPublicUrl(G);return console.log("Public URL generated:",L),L}catch(W){throw console.error("Error uploading file:",W),alert(`Failed to upload PO file: ${W.message||"Unknown error"}`),W}},j=async(W,M=!1)=>{if(W.preventDefault(),!d.customer_id){alert("Please select a customer");return}if(!d.customer_po_number.trim()){alert("Please enter customer PO number");return}if(p.length===0||p.some(H=>!H.product_id||H.quantity<=0)){alert("Please add valid items to the order");return}const G=e&&["approved","stock_reserved","shortage","pending_approval"].includes(e.status);if(!(G&&e&&!confirm(` Warning: This order has been approved or is awaiting approval.

Editing will:
 Release existing stock reservations
 Require re-approval from admin
 Reset status to "Pending Approval"

Do you want to continue?`)))try{f(!0);let H=(e==null?void 0:e.customer_po_file_url)||null;if(g&&(console.log("Uploading PO file..."),H=await S(),console.log("PO file URL:",H),!H))throw new Error("File upload returned no URL");const C=p.reduce((D,P)=>D+(P.quantity*P.unit_price-P.discount_amount),0),L=p.reduce((D,P)=>D+P.tax_amount,0),O=p.reduce((D,P)=>D+P.line_total,0);if(e){if(G){console.log("Releasing stock reservations for order:",e.id);const{error:re}=await de.rpc("fn_release_reservation_by_so_id",{p_so_id:e.id,p_released_by:n==null?void 0:n.id});re&&console.error("Error releasing reservations:",re)}let D;G||M?D="pending_approval":D="draft",console.log("Updating order. Items count:",p.length);const{error:P}=await de.from("sales_orders").update({customer_id:d.customer_id,customer_po_number:d.customer_po_number,customer_po_date:d.customer_po_date,customer_po_file_url:H,so_date:d.so_date,currency:d.currency,expected_delivery_date:d.expected_delivery_date||null,notes:d.notes||null,status:D,subtotal_amount:C,tax_amount:L,total_amount:O,updated_at:new Date().toISOString()}).eq("id",e.id);if(P)throw P;const{error:Q}=await de.from("sales_order_items").delete().eq("sales_order_id",e.id);if(Q)throw Q;const J=p.map(re=>({sales_order_id:e.id,product_id:re.product_id,quantity:re.quantity,unit_price:re.unit_price,discount_percent:re.discount_percent,discount_amount:re.discount_amount,tax_percent:re.tax_percent,tax_amount:re.tax_amount,line_total:re.line_total,item_delivery_date:re.item_delivery_date||null,notes:re.notes||null}));console.log("Inserting items. Count:",J.length);const{data:te,error:z}=await de.from("sales_order_items").insert(J).select();if(z)throw z;console.log("Items inserted successfully. Count:",(te==null?void 0:te.length)||0),te&&te.length!==p.length&&(console.error("WARNING: Item count mismatch!",{expected:p.length,inserted:te.length}),alert(` Warning: Expected ${p.length} items but only ${te.length} were saved. Please verify the order.`)),alert(`Sales order updated successfully${G?" and submitted for re-approval. Stock reservations have been released.":M?" and submitted for approval":""}!`)}else{const{data:D,error:P}=await de.from("sales_orders").insert({so_number:"",customer_id:d.customer_id,customer_po_number:d.customer_po_number,customer_po_date:d.customer_po_date,customer_po_file_url:H,so_date:d.so_date,currency:d.currency,expected_delivery_date:d.expected_delivery_date||null,notes:d.notes||null,status:M?"pending_approval":"draft",subtotal_amount:C,tax_amount:L,total_amount:O,created_by:n==null?void 0:n.id}).select().single();if(P)throw P;const Q=p.map(te=>({sales_order_id:D.id,product_id:te.product_id,quantity:te.quantity,unit_price:te.unit_price,discount_percent:te.discount_percent,discount_amount:te.discount_amount,tax_percent:te.tax_percent,tax_amount:te.tax_amount,line_total:te.line_total,item_delivery_date:te.item_delivery_date||null,notes:te.notes||null})),{error:J}=await de.from("sales_order_items").insert(Q);if(J)throw J;alert(`Sales order created successfully${M?" and submitted for approval":""}!`)}t()}catch(H){console.error(e?"Error updating sales order:":"Error creating sales order:",H.message),alert((e?"Failed to update sales order: ":"Failed to create sales order: ")+H.message)}finally{f(!1)}},I=(W,M)=>{const G=u[W];if(!G)return null;const H=G.free_stock>=M;return i.jsxs("div",{className:`text-xs ${H?"text-green-600":"text-red-600"}`,children:[a("salesOrders.freeStock"),": ",G.free_stock," ",!H&&"(Insufficient!)"]})},U=p.reduce((W,M)=>W+(M.quantity*M.unit_price-M.discount_amount),0),q=p.reduce((W,M)=>W+M.tax_amount,0),V=p.reduce((W,M)=>W+M.line_total,0),X=W=>{const M=W.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0});return d.currency==="USD"?`$ ${M}`:`Rp ${M}`};return i.jsxs("form",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a("sales.customer")," *"]}),i.jsxs("select",{value:d.customer_id,onChange:W=>v({...d,customer_id:W.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[i.jsxs("option",{value:"",children:[a("common.filter")," ",a("sales.customer")]}),s.map(W=>i.jsx("option",{value:W.id,children:W.company_name},W.id))]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a("salesOrders.customerPoNumber")," *"]}),i.jsx("input",{type:"text",value:d.customer_po_number,onChange:W=>v({...d,customer_po_number:W.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a("salesOrders.customerPoDate")," *"]}),i.jsx("input",{type:"date",value:d.customer_po_date,onChange:W=>v({...d,customer_po_date:W.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a("salesOrders.soDate")}),i.jsx("input",{type:"date",value:d.so_date,onChange:W=>v({...d,so_date:W.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency *"}),i.jsxs("select",{value:d.currency,onChange:W=>v({...d,currency:W.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[i.jsx("option",{value:"IDR",children:"IDR (Rp)"}),i.jsx("option",{value:"USD",children:"USD ($)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a("salesOrders.expectedDeliveryDate")}),i.jsx("input",{type:"date",value:d.expected_delivery_date,onChange:W=>v({...d,expected_delivery_date:W.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a("salesOrders.uploadPo")}),(e==null?void 0:e.customer_po_file_url)&&!g&&i.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(pr,{className:"w-4 h-4 text-blue-600"}),i.jsx("span",{className:"text-sm text-blue-700",children:"PO file already uploaded"})]}),i.jsx("a",{href:e.customer_po_file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"View"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:W=>{var M;return y(((M=W.target.files)==null?void 0:M[0])||null)},className:"w-full border rounded-lg px-3 py-2"}),g&&i.jsx("button",{type:"button",onClick:()=>y(null),className:"text-red-600 hover:text-red-800",title:"Remove selected file",children:i.jsx(An,{className:"w-5 h-5"})})]}),g&&i.jsxs("p",{className:"mt-1 text-sm text-green-600 flex items-center gap-1",children:[i.jsx(pr,{className:"w-4 h-4"}),"Ready to upload: ",g.name]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a("salesOrders.notes")}),i.jsx("textarea",{value:d.notes,onChange:W=>v({...d,notes:W.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Order Items"}),i.jsxs("button",{type:"button",onClick:E,className:"flex items-center gap-1 text-blue-600 hover:text-blue-800 text-sm",children:[i.jsx(Wn,{className:"w-4 h-4"})," ",a("sales.addItem")]})]}),i.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:p.map((W,M)=>i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsxs("label",{className:"text-xs text-gray-600",children:[a("salesOrders.product")," *"]}),i.jsxs("select",{value:W.product_id,onChange:G=>B(M,G.target.value),className:"w-full border rounded px-2 py-1 text-sm",required:!0,children:[i.jsx("option",{value:"",children:"Select Product"}),l.map(G=>i.jsx("option",{value:G.id,children:G.product_name},G.id))]}),W.product_id&&I(W.product_id,W.quantity)]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-xs text-gray-600",children:[a("sales.quantity")," *"]}),i.jsx("input",{type:"text",value:W.quantity===0?"":W.quantity,onChange:G=>{const H=G.target.value;if(H==="")k(M,"quantity",0);else{const C=parseFloat(H);isNaN(C)||k(M,"quantity",C)}},onBlur:G=>{G.target.value===""&&k(M,"quantity",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Enter quantity",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:a("sales.unitPrice")}),i.jsx("input",{type:"text",value:W.unit_price===0?"":W.unit_price,onChange:G=>{const H=G.target.value;if(H==="")k(M,"unit_price",0);else{const C=parseFloat(H);isNaN(C)||k(M,"unit_price",C)}},onBlur:G=>{G.target.value===""&&k(M,"unit_price",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Enter price"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:a("salesOrders.discountPercent")}),i.jsx("input",{type:"text",value:W.discount_percent===0?"":W.discount_percent,onChange:G=>{const H=G.target.value;if(H==="")k(M,"discount_percent",0);else{const C=parseFloat(H);!isNaN(C)&&C>=0&&C<=100&&k(M,"discount_percent",C)}},onBlur:G=>{G.target.value===""&&k(M,"discount_percent",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:a("salesOrders.taxPercent")}),i.jsx("input",{type:"text",value:W.tax_percent===0?"":W.tax_percent,onChange:G=>{const H=G.target.value;if(H==="")k(M,"tax_percent",0);else{const C=parseFloat(H);!isNaN(C)&&C>=0&&C<=100&&k(M,"tax_percent",C)}},onBlur:G=>{G.target.value===""&&k(M,"tax_percent",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"0"})]})]}),i.jsxs("div",{className:"grid grid-cols-6 gap-2 mt-2",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Item Delivery Date"}),i.jsx("input",{type:"date",value:W.item_delivery_date,onChange:G=>k(M,"item_delivery_date",G.target.value),className:"w-full border rounded px-2 py-1 text-sm"})]}),i.jsxs("div",{className:"col-span-3",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Notes"}),i.jsx("input",{type:"text",value:W.notes,onChange:G=>k(M,"notes",G.target.value),className:"w-full border rounded px-2 py-1 text-sm"})]}),i.jsxs("div",{className:"flex items-end justify-between",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:a("salesOrders.lineTotal")}),i.jsx("div",{className:"text-sm font-medium",children:X(W.line_total)})]}),i.jsx("button",{type:"button",onClick:()=>T(M),className:"text-red-600 hover:text-red-800",children:i.jsx(wa,{className:"w-4 h-4"})})]})]})]},M))})]}),i.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsxs("span",{children:[a("sales.subtotal"),":"]}),i.jsx("span",{className:"font-medium",children:X(U)})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsxs("span",{children:[a("sales.tax"),":"]}),i.jsx("span",{className:"font-medium",children:X(q)})]}),i.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[i.jsxs("span",{children:[a("salesOrders.grandTotal"),":"]}),i.jsx("span",{children:X(V)})]})]})}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",disabled:h,children:a("common.cancel")}),!(e&&["approved","stock_reserved","shortage","pending_approval"].includes(e.status))&&i.jsx("button",{type:"button",onClick:W=>j(W,!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",disabled:h,children:a(h?"common.loading":"salesOrders.saveAsDraft")}),i.jsx("button",{type:"button",onClick:W=>j(W,!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:h,children:h?`${a("common.submit")}...`:e&&["approved","stock_reserved","shortage","pending_approval"].includes(e.status)?"Submit for Re-Approval":a("salesOrders.submitForApproval")})]})]})}function Ode({salesOrder:e,items:t,onClose:r}){const n=Z.useRef(null),{t:a,language:s}=ba(),o=e.currency||"IDR",l=o==="IDR"?"Rp":o==="USD"?"$":o,c=p=>p==null?`${l} 0`:o==="IDR"?`${p.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`:`${l} ${p.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,u=p=>{const m=new Date(p),w=s==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],x=m.getDate(),b=w[m.getMonth()],B=m.getFullYear();return`${x} ${b} ${B}`},A=p=>s==="id"?h(p):f(p),h=p=>{if(p===0)return"Nol";const m=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],w=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],x=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],b=B=>{if(B===0)return"";if(B<10)return m[B];if(B>=10&&B<20)return w[B-10];if(B<100){const T=Math.floor(B/10),S=B%10;return x[T]+(S>0?" "+m[S]:"")}const _=Math.floor(B/100),k=B%100;return(_===1?"Seratus":m[_]+" Ratus")+(k>0?" "+b(k):"")};if(p<1e3)return b(p);if(p<1e6){const B=Math.floor(p/1e3),_=p%1e3;return(B===1?"Seribu":b(B)+" Ribu")+(_>0?" "+b(_):"")}if(p<1e9){const B=Math.floor(p/1e6),_=p%1e6,k=b(B)+" Juta",E=_>=1e3?(Math.floor(_/1e3)===1?"Seribu":b(Math.floor(_/1e3))+" Ribu")+(_%1e3>0?" "+b(_%1e3):""):_>0?b(_):"";return k+(E?" "+E:"")}return p.toString()},f=p=>{if(p===0)return"Zero";const m=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],w=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],x=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],b=B=>{if(B===0)return"";if(B<10)return m[B];if(B>=10&&B<20)return w[B-10];if(B<100){const E=Math.floor(B/10),T=B%10;return x[E]+(T>0?" "+m[T]:"")}const _=Math.floor(B/100),k=B%100;return m[_]+" Hundred"+(k>0?" "+b(k):"")};if(p<1e3)return b(p);if(p<1e6){const B=Math.floor(p/1e3),_=p%1e3;return b(B)+" Thousand"+(_>0?" "+b(_):"")}if(p<1e9){const B=Math.floor(p/1e6),_=p%1e6,k=_>=1e3?b(Math.floor(_/1e3))+" Thousand"+(_%1e3>0?" "+b(_%1e3):""):_>0?b(_):"";return b(B)+" Million"+(k?" "+k:"")}return p.toString()},d=()=>{window.print()},v=async()=>{if(n.current)try{const p=await n1(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:T=>{const S=T.getElementById("proforma-print-content");S&&(S.style.width="210mm")}}),m=p.toDataURL("image/png",1),w=new Ot("p","mm","a4"),x=w.internal.pageSize.getWidth(),b=w.internal.pageSize.getHeight(),B=p.width,_=p.height,k=x/B,E=_*k;if(E>b){let T=0,S=E;for(;S>0;)w.addImage(m,"PNG",0,T,x,E),S-=b,T-=b,S>0&&w.addPage()}else w.addImage(m,"PNG",0,0,x,E);w.save(`Proforma-Invoice-${e.so_number}.pdf`)}catch(p){console.error("Error generating PDF:",p),alert("Failed to generate PDF. Please try again.")}},g=e.customers,y=t.some(p=>(p.discount_amount||0)>0);return i.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[i.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:i.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[i.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",style:{printColorAdjust:"exact",WebkitPrintColorAdjust:"exact"},children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[s==="id"?"Faktur Proforma":"Proforma Invoice"," ",e.so_number]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:d,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[i.jsx(Wb,{className:"h-4 w-4"}),s==="id"?"Cetak":"Print"]}),i.jsxs("button",{onClick:v,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[i.jsx(Qo,{className:"h-4 w-4"}),"PDF"]}),i.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:i.jsx(An,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{id:"proforma-print-content",ref:n,className:"p-8",children:[i.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[i.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:i.jsxs("g",{children:[i.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),i.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),i.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),i.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),i.jsx("div",{className:"text-right",children:i.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:s==="id"?"FAKTUR PROFORMA":"PROFORMA INVOICE"})})]}),i.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No izin PBF"}),i.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),i.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),i.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Company Name:"}),i.jsxs("span",{className:"font-semibold",children:[" ",(g==null?void 0:g.company_name)||""]})]}),i.jsxs("div",{className:"pt-1 flex",children:[i.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),i.jsxs("div",{children:[i.jsx("p",{children:(g==null?void 0:g.address)||""}),i.jsx("p",{children:(g==null?void 0:g.city)||""})]})]}),i.jsxs("div",{className:"flex pt-1",children:[i.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),i.jsx("span",{children:(g==null?void 0:g.phone)||""})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"NPWP:"}),i.jsx("span",{children:(g==null?void 0:g.npwp)||""})]})]}),i.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"220px"},children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"SO Number:"}),i.jsx("span",{className:"ml-2",children:e.so_number})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"SO Date:"}),i.jsx("span",{className:"ml-2",children:u(e.so_date)})]}),i.jsxs("div",{className:"pt-1",children:[i.jsx("span",{className:"font-bold",children:"Customer PO No:"}),i.jsx("span",{className:"ml-2",children:e.customer_po_number})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Customer PO Date:"}),i.jsx("span",{className:"ml-2",children:u(e.customer_po_date)})]}),e.expected_delivery_date&&i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Expected Delivery:"}),i.jsx("span",{className:"ml-2",children:u(e.expected_delivery_date)})]})]})]})}),i.jsx("div",{children:i.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),i.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Total Qty"}),i.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"UOM"}),i.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1 ",children:s==="id"?`Unit Price (${o})`:`Unit Price (${o})`}),y&&i.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Discount"}),i.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:s==="id"?`Sub Total (${o})`:`Sub Total (${o})`})]})}),i.jsxs("tbody",{children:[t.map((p,m)=>{var _,k;const w=p.quantity||0,x=p.unit_price||0,b=p.discount_amount||0,B=w*x-b;return i.jsxs("tr",{className:"border-b border-black",children:[i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:m+1}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((_=p.products)==null?void 0:_.product_name)||"Unknown Product"}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:w.toLocaleString()}),i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((k=p.products)==null?void 0:k.unit)||"Kg"}),i.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1 ",children:c(x)}),y&&i.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:c(b)}),i.jsx("td",{className:"p-1.5 text-right print:p-1",children:c(B)})]},p.id||m)}),t.length<2&&Array.from({length:2-t.length}).map((p,m)=>i.jsxs("tr",{className:"border-b border-black",children:[i.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),y&&i.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),i.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${m}`))]})]})}),i.jsxs("div",{className:"border-2 border-black border-t-0",children:[i.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[i.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[i.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:s==="id"?"Amount In words:":"Amount in words:"}),i.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:[o," ",A(Math.round(e.total_amount))," ",o==="IDR"?"RUPIAH":o==="USD"?"DOLLARS":""]})]}),i.jsxs("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:[i.jsxs("div",{className:"flex justify-between py-1 print:py-0.5",children:[i.jsx("span",{className:"font-bold",children:"Sub Total"}),i.jsx("span",{className:"font-bold",children:c(e.subtotal_amount)})]}),i.jsxs("div",{className:"flex justify-between border-t border-black py-1 print:py-0.5",children:[i.jsx("span",{className:"font-bold",children:"VAT (PPN) 11%"}),i.jsx("span",{className:"font-bold",children:c(e.tax_amount)})]}),i.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[i.jsx("span",{className:"font-bold",children:"Grand Total"}),i.jsx("span",{className:"font-bold text-sm print:text-xs",children:c(e.total_amount)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-0 text-xs print:text-[10px]",children:[i.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[i.jsx("p",{className:"font-semibold mb-2 print:mb-1",children:"Bank Details:"}),i.jsxs("div",{className:"space-y-0.5 print:space-y-0",children:[i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Bank Name"}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{children:"BCA"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Branch"}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{children:"Sunter Mall, Jakarta"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account Name"}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{className:"whitespace-nowrap",children:"PT. Shubham Anzen Pharma Jaya"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account No."}),i.jsx("span",{className:"mr-2",children:":"}),i.jsx("span",{children:"0930 2010 14 (IDR)"})]})]})]}),i.jsxs("div",{className:"p-3 print:p-2",children:[i.jsx("p",{className:"font-semibold mb-1",children:"Authorized Signatory:"}),i.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),i.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Pharmacist"})]})]})]}),e.notes&&i.jsx("div",{className:"border-2 border-black border-t-0 p-2 print:p-1.5",children:i.jsxs("p",{className:"text-xs print:text-[10px]",children:[i.jsx("span",{className:"font-bold",children:"Notes: "}),i.jsx("span",{children:e.notes})]})}),i.jsx("div",{className:"border-2 border-black border-t-0 p-2.5 print:p-2",children:i.jsx("p",{className:"text-xs font-semibold text-center print:text-[10px]",children:s==="id"?"Ini adalah Faktur Proforma dan bukan tagihan resmi. Faktur resmi akan diterbitkan setelah pengiriman barang.":"This is a Proforma Invoice and not an official bill. Official invoice will be issued after delivery of goods."})})]})]})}),i.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #proforma-print-content,
          #proforma-print-content * {
            visibility: visible;
          }

          #proforma-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #proforma-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function Ude(){var Le,Xe;const{user:e,profile:t}=Dr(),{t:r}=ba(),[n,a]=Z.useState("active"),[s,o]=Z.useState([]),[l,c]=Z.useState([]),[u,A]=Z.useState([]),[h,f]=Z.useState(!0),[d,v]=Z.useState(""),[g,y]=Z.useState("all"),[p,m]=Z.useState(!1),[w,x]=Z.useState(!1),[b,B]=Z.useState(null),[_,k]=Z.useState(null),[E,T]=Z.useState(!1),[S,j]=Z.useState(""),[I,U]=Z.useState(null),[q,V]=Z.useState(!1),[X,W]=Z.useState(null),[M,G]=Z.useState(!1),[H,C]=Z.useState(""),[L,O]=Z.useState(null),[D,P]=Z.useState(!1),[Q,J]=Z.useState(null);Z.useEffect(()=>{te(),z()},[n]),Z.useEffect(()=>{re()},[d,g,s,n]);const te=async()=>{try{f(!0);let fe=de.from("sales_orders").select(`
          *,
          customers (
            id,
            company_name,
            address,
            city,
            phone,
            npwp,
            pharmacy_license,
            gst_vat_type
          ),
          sales_order_items (
            id,
            product_id,
            quantity,
            unit_price,
            discount_percent,
            discount_amount,
            tax_percent,
            tax_amount,
            line_total,
            item_delivery_date,
            notes,
            delivered_quantity,
            products (
              id,
              product_name,
              product_code,
              unit
            )
          )
        `);n==="active"?fe=fe.eq("is_archived",!1):fe=fe.eq("is_archived",!0);const{data:Ee,error:qe}=await fe.order("created_at",{ascending:!1});if(qe)throw qe;o(Ee||[])}catch(fe){console.error("Error fetching sales orders:",fe.message),alert("Failed to load sales orders")}finally{f(!1)}},z=async()=>{try{const{data:fe,error:Ee}=await de.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(Ee)throw Ee;A(fe||[])}catch(fe){console.error("Error fetching customers:",fe.message)}},ye=(fe,Ee)=>{const qe=fe.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0});return Ee==="USD"?`$ ${qe}`:`Rp ${qe}`},re=()=>{let fe=s;d&&(fe=fe.filter(Ee=>{var qe;return Ee.so_number.toLowerCase().includes(d.toLowerCase())||Ee.customer_po_number.toLowerCase().includes(d.toLowerCase())||((qe=Ee.customers)==null?void 0:qe.company_name.toLowerCase().includes(d.toLowerCase()))})),g!=="all"&&(fe=fe.filter(Ee=>Ee.status===g)),c(fe)},ke=fe=>{const qe={draft:{color:"bg-gray-100 text-gray-800",label:"Draft"},pending_approval:{color:"bg-yellow-100 text-yellow-800",label:"Pending Approval"},approved:{color:"bg-green-100 text-green-800",label:"Approved"},rejected:{color:"bg-red-100 text-red-800",label:"Rejected"},stock_reserved:{color:"bg-blue-100 text-blue-800",label:"Stock Reserved"},shortage:{color:"bg-orange-100 text-orange-800",label:"Shortage"},pending_delivery:{color:"bg-purple-100 text-purple-800",label:"Pending Delivery"},partially_delivered:{color:"bg-indigo-100 text-indigo-800",label:"Partially Delivered"},delivered:{color:"bg-teal-100 text-teal-800",label:"Delivered"},closed:{color:"bg-gray-100 text-gray-800",label:"Closed"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}}[fe]||{color:"bg-gray-100 text-gray-800",label:fe};return i.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${qe.color}`,children:qe.label})},be=async fe=>{if(confirm("Submit this sales order for approval?"))try{const{error:Ee}=await de.from("sales_orders").update({status:"pending_approval",updated_at:new Date().toISOString()}).eq("id",fe);if(Ee)throw Ee;alert("Sales order submitted for approval successfully!"),te()}catch(Ee){console.error("Error submitting for approval:",Ee.message),alert("Failed to submit for approval")}},ae=async()=>{if(!L||!H.trim()){alert("Please enter an archive reason");return}try{const{data:{user:fe}}=await de.auth.getUser();if(!fe)throw new Error("Not authenticated");const{error:Ee}=await de.from("sales_orders").update({is_archived:!0,archived_at:new Date().toISOString(),archived_by:fe.id,archive_reason:H,updated_at:new Date().toISOString()}).eq("id",L);if(Ee)throw Ee;alert("Sales order archived successfully!"),G(!1),C(""),O(null),te()}catch(fe){console.error("Error archiving order:",fe.message),alert("Failed to archive order")}},Ie=async fe=>{if(confirm("Unarchive this sales order?"))try{const{error:Ee}=await de.from("sales_orders").update({is_archived:!1,archived_at:null,archived_by:null,archive_reason:null,updated_at:new Date().toISOString()}).eq("id",fe);if(Ee)throw Ee;alert("Sales order unarchived successfully!"),te()}catch(Ee){console.error("Error unarchiving order:",Ee.message),alert("Failed to unarchive order")}},De=async fe=>{const Ee=prompt("Enter cancellation reason:");if(Ee)try{const{data:{user:qe}}=await de.auth.getUser();if(!qe)throw new Error("Not authenticated");const{error:Qe}=await de.rpc("fn_cancel_sales_order",{p_so_id:fe,p_canceller_id:qe.id,p_reason:Ee});if(Qe)throw Qe;alert("Sales order cancelled successfully!"),te()}catch(qe){console.error("Error cancelling order:",qe.message),alert("Failed to cancel order")}},pe=async fe=>{if(confirm("Are you sure you want to delete this sales order?"))try{const{error:Ee}=await de.from("sales_orders").delete().eq("id",fe);if(Ee)throw Ee;alert("Sales order deleted successfully!"),te()}catch(Ee){console.error("Error deleting order:",Ee.message),alert("Failed to delete order")}},we=fe=>{B(fe),x(!0)},Te=fe=>{k(fe),m(!0)},he=async fe=>{if(confirm("Approve this sales order? Stock will be reserved automatically."))try{const{data:{user:Ee}}=await de.auth.getUser();if(!Ee)throw new Error("Not authenticated");const{error:qe}=await de.from("sales_orders").update({status:"approved",approved_by:Ee.id,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",fe);if(qe)throw qe;const{data:Qe,error:Ye}=await de.rpc("fn_reserve_stock_for_so_v2",{p_so_id:fe});if(Ye)console.error("Error reserving stock:",Ye),console.error("Supabase request failed",Ye),alert("Order approved but stock reservation failed: "+Ye.message);else if(Qe&&Qe.length>0){const Nt=Qe[0];Nt.success?alert(" Sales order approved and stock fully reserved!"):alert(` Order approved with stock shortage.

`+Nt.message+`

Import requirements have been created automatically.`)}else alert("Sales order approved!");te()}catch(Ee){console.error("Error approving order:",Ee.message),alert("Failed to approve order")}},ce=async()=>{if(!I||!S.trim()){alert("Please enter a rejection reason");return}try{const{data:{user:fe}}=await de.auth.getUser();if(!fe)throw new Error("Not authenticated");const{error:Ee}=await de.from("sales_orders").update({status:"rejected",rejected_by:fe.id,rejected_at:new Date().toISOString(),rejection_reason:S,updated_at:new Date().toISOString()}).eq("id",I);if(Ee)throw Ee;alert("Sales order rejected"),T(!1),j(""),U(null),te()}catch(fe){console.error("Error rejecting order:",fe.message),alert("Failed to reject order")}},Se=fe=>{W(fe),V(!0)},Pe={total:s.length,pending_approval:s.filter(fe=>fe.status==="pending_approval").length,stock_reserved:s.filter(fe=>fe.status==="stock_reserved").length,shortage:s.filter(fe=>fe.status==="shortage").length,delivered:s.filter(fe=>fe.status==="delivered").length};return i.jsx(ca,{children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sales Orders"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage customer purchase orders and track delivery"})]}),i.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[i.jsx(Wn,{className:"w-5 h-5"}),"New Sales Order"]})]}),i.jsx("div",{className:"mb-6 border-b border-gray-200",children:i.jsxs("nav",{className:"flex gap-4",children:[i.jsx("button",{onClick:()=>a("active"),className:`px-4 py-2 font-medium border-b-2 transition ${n==="active"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Orders"}),i.jsx("button",{onClick:()=>a("archived"),className:`px-4 py-2 font-medium border-b-2 transition ${n==="archived"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Archived Orders"})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4 mb-6",children:[i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Total Orders"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-gray-900",children:Pe.total})]}),i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Pending Approval"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-yellow-600",children:Pe.pending_approval})]}),i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Stock Reserved"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-blue-600",children:Pe.stock_reserved})]}),i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Shortage"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-orange-600",children:Pe.shortage})]}),i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Delivered"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:Pe.delivered})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[i.jsxs("div",{className:"p-4 border-b flex gap-4",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(Hc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{type:"text",placeholder:"Search by SO number, PO number, or customer...",value:d,onChange:fe=>v(fe.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),i.jsxs("select",{value:g,onChange:fe=>y(fe.target.value),className:"border rounded-lg px-4 py-2",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"draft",children:"Draft"}),i.jsx("option",{value:"pending_approval",children:"Pending Approval"}),i.jsx("option",{value:"approved",children:"Approved"}),i.jsx("option",{value:"stock_reserved",children:"Stock Reserved"}),i.jsx("option",{value:"shortage",children:"Shortage"}),i.jsx("option",{value:"pending_delivery",children:"Pending Delivery"}),i.jsx("option",{value:"partially_delivered",children:"Partially Delivered"}),i.jsx("option",{value:"delivered",children:"Delivered"}),i.jsx("option",{value:"rejected",children:"Rejected"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SO Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"PO Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SO Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Delivery Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Docs"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status / Approval"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):l.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"px-6 py-4 text-center text-gray-500",children:"No sales orders found"})}):l.map(fe=>{var Ee;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",children:fe.so_number})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:(Ee=fe.customers)==null?void 0:Ee.company_name})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm text-gray-900",children:fe.customer_po_number}),i.jsx("div",{className:"text-xs text-gray-500",children:new Date(fe.customer_po_date).toLocaleDateString()})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(fe.so_date).toLocaleDateString()}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:fe.expected_delivery_date?new Date(fe.expected_delivery_date).toLocaleDateString():"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ye(fe.total_amount,fe.currency||"IDR")}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"flex items-center justify-center",children:fe.customer_po_file_url?i.jsxs("button",{onClick:()=>Se(fe.customer_po_file_url),className:"inline-flex items-center gap-1 px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg border border-blue-200 hover:bg-blue-100 transition",title:"View Customer PO",children:[i.jsx(pr,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:"1"})]}):i.jsx("span",{className:"text-gray-400 text-sm",children:"-"})})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center justify-center gap-2",children:[ke(fe.status),fe.status==="pending_approval"&&(t==null?void 0:t.role)==="admin"&&i.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[i.jsx("button",{onClick:qe=>{qe.stopPropagation(),he(fe.id)},className:"p-2 bg-green-100 hover:bg-green-200 rounded-lg transition-colors",title:"Approve Order",children:i.jsx(ua,{className:"w-6 h-6 text-green-600"})}),i.jsx("button",{onClick:qe=>{qe.stopPropagation(),U(fe.id),T(!0)},className:"p-2 bg-red-100 hover:bg-red-200 rounded-lg transition-colors",title:"Reject Order",children:i.jsx(Pa,{className:"w-6 h-6 text-red-600"})})]}),fe.status==="approved"&&i.jsx(ua,{className:"w-5 h-5 text-green-600 ml-2",title:"Approved"}),fe.status==="rejected"&&i.jsx(Pa,{className:"w-5 h-5 text-red-600 ml-2",title:"Rejected"})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>we(fe),className:"text-blue-600 hover:text-blue-800",title:"View",children:i.jsx(b0,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>{J(fe),P(!0)},className:"text-purple-600 hover:text-purple-800",title:"View Proforma Invoice",children:i.jsx(J7,{className:"w-4 h-4"})}),!["delivered","closed","cancelled","partially_delivered","pending_delivery"].includes(fe.status)&&i.jsx("button",{onClick:()=>Te(fe),className:"text-indigo-600 hover:text-indigo-800",title:"Edit",children:i.jsx(uo,{className:"w-4 h-4"})}),fe.status==="draft"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>be(fe.id),className:"text-green-600 hover:text-green-800",title:"Submit for Approval",children:i.jsx(vN,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>pe(fe.id),className:"text-red-600 hover:text-red-800",title:"Delete",children:i.jsx(wa,{className:"w-4 h-4"})})]}),!["cancelled","closed","delivered","rejected"].includes(fe.status)&&n==="active"&&i.jsx("button",{onClick:()=>De(fe.id),className:"text-orange-600 hover:text-orange-800",title:"Cancel",children:i.jsx(Pa,{className:"w-4 h-4"})}),n==="active"&&["admin","sales"].includes((t==null?void 0:t.role)||"")&&["delivered","cancelled"].includes(fe.status)&&i.jsx("button",{onClick:()=>{O(fe.id),G(!0)},className:"text-gray-600 hover:text-gray-800",title:"Archive Order",children:i.jsx(pr,{className:"w-4 h-4"})}),n==="archived"&&["admin","sales"].includes((t==null?void 0:t.role)||"")&&i.jsx("button",{onClick:()=>Ie(fe.id),className:"text-green-600 hover:text-green-800",title:"Unarchive Order",children:i.jsx(vN,{className:"w-4 h-4"})})]})})]},fe.id)})})]})})]}),p&&i.jsx(ir,{isOpen:p,onClose:()=>{m(!1),k(null)},title:_?"Edit Sales Order":"Create Sales Order",maxWidth:"max-w-6xl",children:i.jsx(Lde,{existingOrder:_||void 0,onSuccess:()=>{m(!1),k(null),te()},onCancel:()=>{m(!1),k(null)}})}),w&&b&&i.jsx(ir,{isOpen:w,onClose:()=>{x(!1),B(null)},title:`Sales Order: ${b.so_number}`,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Customer"}),i.jsx("p",{className:"text-sm text-gray-900",children:(Le=b.customers)==null?void 0:Le.company_name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),i.jsx("div",{className:"mt-1",children:ke(b.status)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Customer PO Number"}),i.jsx("p",{className:"text-sm text-gray-900",children:b.customer_po_number})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Customer PO Date"}),i.jsx("p",{className:"text-sm text-gray-900",children:new Date(b.customer_po_date).toLocaleDateString()})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"SO Date"}),i.jsx("p",{className:"text-sm text-gray-900",children:new Date(b.so_date).toLocaleDateString()})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Expected Delivery"}),i.jsx("p",{className:"text-sm text-gray-900",children:b.expected_delivery_date?new Date(b.expected_delivery_date).toLocaleDateString():"Not specified"})]})]}),b.notes&&i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notes"}),i.jsx("p",{className:"text-sm text-gray-900 mt-1",children:b.notes})]}),b.customer_po_file_url&&i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Customer PO Attachment"}),i.jsxs("a",{href:b.customer_po_file_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg border border-blue-200 hover:bg-blue-100 transition",children:[i.jsx(ki,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:"View Customer PO"}),i.jsx(Sg,{className:"w-4 h-4"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Items"}),i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-2 text-left",children:"Product"}),i.jsx("th",{className:"px-4 py-2 text-right",children:"Qty"}),i.jsx("th",{className:"px-4 py-2 text-right",children:"Price"}),i.jsx("th",{className:"px-4 py-2 text-right",children:"Total"})]})}),i.jsx("tbody",{children:(Xe=b.sales_order_items)==null?void 0:Xe.map(fe=>{var Ee;return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"px-4 py-2",children:(Ee=fe.products)==null?void 0:Ee.product_name}),i.jsx("td",{className:"px-4 py-2 text-right",children:fe.quantity}),i.jsx("td",{className:"px-4 py-2 text-right",children:ye(fe.unit_price,b.currency||"IDR")}),i.jsx("td",{className:"px-4 py-2 text-right",children:ye(fe.line_total,b.currency||"IDR")})]},fe.id)})}),i.jsx("tfoot",{className:"bg-gray-50 font-medium",children:i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"px-4 py-2 text-right",children:"Total:"}),i.jsx("td",{className:"px-4 py-2 text-right",children:ye(b.total_amount,b.currency||"IDR")})]})})]})]}),b.rejection_reason&&i.jsxs("div",{className:"bg-red-50 p-3 rounded",children:[i.jsx("label",{className:"text-sm font-medium text-red-700",children:"Rejection Reason"}),i.jsx("p",{className:"text-sm text-red-900 mt-1",children:b.rejection_reason})]})]})}),E&&i.jsx(ir,{isOpen:E,onClose:()=>{T(!1),j(""),U(null)},title:"Reject Sales Order",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rejection Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{value:S,onChange:fe=>j(fe.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter reason for rejecting this sales order..."})]}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>{T(!1),j(""),U(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:ce,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",disabled:!S.trim(),children:"Reject Order"})]})]})}),M&&i.jsx(ir,{isOpen:M,onClose:()=>{G(!1),C(""),O(null)},title:"Archive Sales Order",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Archive Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{value:H,onChange:fe=>C(fe.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter reason for archiving this sales order (e.g., Completed and delivered, Cancelled by customer)..."})]}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>{G(!1),C(""),O(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:ae,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:!H.trim(),children:"Archive Order"})]})]})}),q&&X&&i.jsx(ir,{isOpen:q,onClose:()=>{V(!1),W(null)},title:"Customer Purchase Order",children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("a",{href:X,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg border border-gray-200 hover:bg-blue-50 hover:border-blue-300 transition",children:[i.jsx(pr,{className:"w-6 h-6 text-blue-600 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Customer Purchase Order"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click to open in new tab"})]}),i.jsx(Sg,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]}),i.jsx("div",{className:"text-xs text-gray-500 text-center pt-2",children:"Document opens in a new browser tab"})]})}),D&&Q&&i.jsx(Ode,{salesOrder:Q,items:Q.sales_order_items||[],onClose:()=>{P(!1),J(null)}})]})})}function Pde({requirements:e,onRefresh:t,canEdit:r}){const[n,a]=Z.useState(null),[s,o]=Z.useState(""),l=Z.useRef(null),c=[{value:"high",label:"High",color:"text-red-600",bgColor:"bg-red-50"},{value:"medium",label:"Medium",color:"text-orange-600",bgColor:"bg-orange-50"},{value:"low",label:"Low",color:"text-green-600",bgColor:"bg-green-50"}],u=[{value:"pending",label:"Pending",color:"text-gray-600",bgColor:"bg-gray-50"},{value:"ordered",label:"Ordered",color:"text-blue-600",bgColor:"bg-blue-50"},{value:"partially_received",label:"Partially Received",color:"text-yellow-600",bgColor:"bg-yellow-50"},{value:"received",label:"Received",color:"text-green-600",bgColor:"bg-green-50"},{value:"cancelled",label:"Cancelled",color:"text-red-600",bgColor:"bg-red-50"}];Z.useEffect(()=>{n&&l.current&&l.current.focus()},[n]);const A=(m,w,x)=>{if(console.log("startEditing called:",{id:m,field:w,currentValue:x,canEdit:r}),!r){console.log("Cannot edit - canEdit is false");return}a({id:m,field:w}),o(x||""),console.log("Editing cell set:",{id:m,field:w})},h=()=>{a(null),o("")},f=async(m,w)=>{try{const x={};w==="required_quantity"||w==="shortage_quantity"||w==="lead_time_days"?x[w]=Number(s):x[w]=s;const{error:b}=await de.from("import_requirements").update(x).eq("id",m);if(b)throw b;t(),h()}catch(x){console.error("Error updating import requirement:",x),alert("Failed to update")}},d=(m,w,x)=>{m.key==="Enter"?f(w,x):m.key==="Escape"&&h()},v=m=>c.find(x=>x.value===m)||c[1],g=m=>u.find(x=>x.value===m)||u[0],y=m=>{const w=new Date,b=new Date(m).getTime()-w.getTime();return Math.ceil(b/(1e3*60*60*24))},p=m=>m<0?"text-red-700 font-bold":m<=7?"text-red-600 font-semibold":m<=30?"text-orange-600":"text-gray-600";return i.jsxs("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:[i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Product"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Sales Order"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Customer"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Required Qty"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Shortage Qty"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Delivery Date"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Priority"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Lead Time"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Notes"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(m=>{var B,_,k,E;const w=y(m.required_delivery_date),x=v(m.priority),b=g(m.status);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-4 py-3",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:(B=m.products)==null?void 0:B.product_name}),i.jsx("div",{className:"text-xs text-gray-500",children:(_=m.products)==null?void 0:_.product_code})]}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(k=m.sales_orders)==null?void 0:k.so_number}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(E=m.customers)==null?void 0:E.company_name}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===m.id&&n.field==="required_quantity"?i.jsx("input",{ref:l,type:"number",value:s,onChange:T=>o(T.target.value),onBlur:()=>f(m.id,"required_quantity"),onKeyDown:T=>d(T,m.id,"required_quantity"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):i.jsx("div",{onClick:()=>A(m.id,"required_quantity",m.required_quantity),className:`text-sm ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:m.required_quantity.toLocaleString()})}),i.jsx("td",{className:"px-4 py-3 text-sm text-red-600 font-semibold",children:m.shortage_quantity.toLocaleString()}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===m.id&&n.field==="required_delivery_date"?i.jsx("input",{ref:l,type:"date",value:s,onChange:T=>o(T.target.value),onBlur:()=>f(m.id,"required_delivery_date"),onKeyDown:T=>d(T,m.id,"required_delivery_date"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):i.jsxs("div",{onClick:()=>A(m.id,"required_delivery_date",m.required_delivery_date),className:`${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:[i.jsx("div",{className:"text-sm",children:new Date(m.required_delivery_date).toLocaleDateString()}),i.jsx("div",{className:`text-xs ${p(w)}`,children:w<0?`${Math.abs(w)} days overdue`:`${w} days`})]})}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===m.id&&n.field==="priority"?i.jsx("select",{ref:l,value:s,onChange:T=>o(T.target.value),onBlur:()=>f(m.id,"priority"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(T=>i.jsx("option",{value:T.value,children:T.label},T.value))}):i.jsx("div",{onClick:()=>A(m.id,"priority",m.priority),className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${x.color} ${x.bgColor} ${r?"cursor-pointer hover:opacity-80":""}`,children:x.label})}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===m.id&&n.field==="status"?i.jsx("select",{ref:l,value:s,onChange:T=>o(T.target.value),onBlur:()=>f(m.id,"status"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(T=>i.jsx("option",{value:T.value,children:T.label},T.value))}):i.jsx("div",{onClick:()=>A(m.id,"status",m.status),className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${b.color} ${b.bgColor} ${r?"cursor-pointer hover:opacity-80":""}`,children:b.label})}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===m.id&&n.field==="lead_time_days"?i.jsx("input",{ref:l,type:"number",value:s,onChange:T=>o(T.target.value),onBlur:()=>f(m.id,"lead_time_days"),onKeyDown:T=>d(T,m.id,"lead_time_days"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):i.jsxs("div",{onClick:()=>A(m.id,"lead_time_days",m.lead_time_days),className:`text-sm ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:[m.lead_time_days," days"]})}),i.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===m.id&&n.field==="notes"?i.jsx("textarea",{ref:l,value:s,onChange:T=>o(T.target.value),onBlur:()=>f(m.id,"notes"),rows:2,className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):i.jsx("div",{onClick:()=>A(m.id,"notes",m.notes),className:`text-sm text-gray-600 max-w-xs truncate ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,title:m.notes||"Click to add notes",children:m.notes||"-"})})]},m.id)})})]}),e.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"No import requirements found"})]})}function Dde(){const{profile:e}=Dr(),[t,r]=Z.useState([]),[n,a]=Z.useState({}),[s,o]=Z.useState(!0),[l,c]=Z.useState("pending"),[u,A]=Z.useState("all"),h=!0;Z.useEffect(()=>{f()},[l]);const f=async()=>{try{o(!0);let y=de.from("import_requirements").select(`
          *,
          products (product_name, product_code),
          sales_orders (so_number),
          customers (company_name)
        `).order("priority",{ascending:!0}).order("required_delivery_date",{ascending:!0});l!=="all"&&(y=y.eq("status",l));const{data:p,error:m}=await y;if(m)throw m;r(p||[]);const w=[...new Set(p==null?void 0:p.map(x=>x.product_id))];w.length>0&&await d(w)}catch(y){console.error("Error fetching import requirements:",y.message),alert("Failed to load import requirements")}finally{o(!1)}},d=async y=>{try{const p={};for(const m of y){const{data:w}=await de.from("batches").select("current_stock").eq("product_id",m),x=(w==null?void 0:w.reduce((_,k)=>_+Number(k.current_stock),0))||0,{data:b}=await de.from("stock_reservations").select("reserved_quantity").eq("product_id",m).eq("status","active"),B=(b==null?void 0:b.reduce((_,k)=>_+Number(k.reserved_quantity),0))||0;p[m]={product_id:m,total_stock:x,reserved_stock:B,free_stock:x-B}}a(p)}catch(p){console.error("Error fetching stock info:",p.message)}},v=t.filter(y=>u==="all"?!0:y.priority===u),g={total:t.length,high_priority:t.filter(y=>y.priority==="high"&&y.status==="pending").length,pending:t.filter(y=>y.status==="pending").length,ordered:t.filter(y=>y.status==="ordered").length};return i.jsx(ca,{children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import Requirements"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Track and manage product import needs based on stock shortages"})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-6",children:[i.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:i.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i.jsx(si,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-600 flex-shrink-0"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Total Requirements"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-gray-900",children:g.total})]})]})}),i.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:i.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i.jsx(Po,{className:"w-5 h-5 md:w-6 md:h-6 text-red-600 flex-shrink-0"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"High Priority"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-red-600",children:g.high_priority})]})]})}),i.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:i.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i.jsx(as,{className:"w-5 h-5 md:w-6 md:h-6 text-yellow-600 flex-shrink-0"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Pending"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-yellow-600",children:g.pending})]})]})}),i.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:i.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i.jsx(Ao,{className:"w-5 h-5 md:w-6 md:h-6 text-green-600 flex-shrink-0"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Ordered"}),i.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:g.ordered})]})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[i.jsxs("div",{className:"p-4 border-b flex gap-4",children:[i.jsxs("select",{value:l,onChange:y=>c(y.target.value),className:"border rounded-lg px-4 py-2",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"pending",children:"Pending"}),i.jsx("option",{value:"ordered",children:"Ordered"}),i.jsx("option",{value:"partially_received",children:"Partially Received"}),i.jsx("option",{value:"received",children:"Received"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]}),i.jsxs("select",{value:u,onChange:y=>A(y.target.value),className:"border rounded-lg px-4 py-2",children:[i.jsx("option",{value:"all",children:"All Priorities"}),i.jsx("option",{value:"high",children:"High Priority"}),i.jsx("option",{value:"medium",children:"Medium Priority"}),i.jsx("option",{value:"low",children:"Low Priority"})]}),i.jsxs("div",{className:"ml-auto text-sm text-gray-600 flex items-center gap-2",children:[i.jsx(si,{className:"w-4 h-4"}),"Click any cell to edit"]})]}),s?i.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):i.jsx(Pde,{requirements:v,onRefresh:f,canEdit:h})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Po,{className:"w-5 h-5 text-blue-600 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"About Import Requirements"}),i.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Import requirements are automatically generated when sales orders are approved but stock is insufficient. The system tracks shortages and helps procurement plan imports based on customer delivery dates and priorities."})]})]})})]})})}function Rde(){const{profile:e}=Dr(),{setCurrentPage:t}=Mo(),[r,n]=Z.useState([]),[a,s]=Z.useState(!1),[o,l]=Z.useState(!1);Z.useEffect(()=>{(e==null?void 0:e.role)==="admin"&&c()},[e]);const c=async()=>{try{const h=[],{data:f}=await de.from("sales_orders").select(`
          id,
          so_number,
          so_date,
          total_amount,
          customers (company_name)
        `).eq("status","pending_approval").order("created_at",{ascending:!1}).limit(5);f&&f.forEach(v=>{var g;h.push({id:v.id,type:"sales_order",number:v.so_number,customer_name:((g=v.customers)==null?void 0:g.company_name)||"Unknown",amount:v.total_amount,date:v.so_date})});const{data:d}=await de.from("delivery_challans").select(`
          id,
          challan_number,
          challan_date,
          customers (company_name)
        `).eq("approval_status","pending_approval").order("created_at",{ascending:!1}).limit(5);d&&d.forEach(v=>{var g;h.push({id:v.id,type:"delivery_challan",number:v.challan_number,customer_name:((g=v.customers)==null?void 0:g.company_name)||"Unknown",date:v.challan_date})}),n(h),h.length>0&&!o&&s(!0)}catch(h){console.error("Error loading pending approvals:",h)}},u=h=>{s(!1),l(!0),h.type==="sales_order"?t("sales-orders"):t("delivery-challan")},A=()=>{s(!1),l(!0)};return!a||r.length===0?null:i.jsxs("div",{className:"fixed bottom-4 right-4 z-50 w-96 max-h-[600px] overflow-hidden rounded-lg shadow-2xl bg-white border border-gray-200 animate-slide-up",children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-3 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),i.jsx("h3",{className:"font-semibold",children:"Pending Approvals"}),i.jsx("span",{className:"bg-white/20 text-xs px-2 py-0.5 rounded-full",children:r.length})]}),i.jsx("button",{onClick:A,className:"text-white/80 hover:text-white transition",children:i.jsx(An,{className:"w-5 h-5"})})]}),i.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:r.map((h,f)=>i.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition ${f===0?"bg-blue-50":""}`,onClick:()=>u(h),children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg ${h.type==="sales_order"?"bg-blue-100 text-blue-600":"bg-green-100 text-green-600"}`,children:h.type==="sales_order"?i.jsx(pr,{className:"w-5 h-5"}):i.jsx(vF,{className:"w-5 h-5"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-gray-900",children:h.type==="sales_order"?"Sales Order":"Delivery Challan"}),i.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:h.number})]}),i.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:new Date(h.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})})]}),i.jsx("p",{className:"text-sm text-gray-700 mt-1 truncate",children:h.customer_name}),h.amount&&i.jsxs("p",{className:"text-xs font-medium text-blue-600 mt-1",children:["Rp ",h.amount.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),f===0&&i.jsx("div",{className:"flex items-center gap-2 mt-2",children:i.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"Click to review "})})]})]})},`${h.type}-${h.id}`))}),i.jsx("div",{className:"bg-gray-50 px-4 py-3 text-center",children:i.jsx("button",{onClick:()=>{A(),t("sales-orders")},className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All Pending Approvals"})}),i.jsx("style",{children:`
        @keyframes slide-up {
          from {
            transform: translateY(100%);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
        .animate-slide-up {
          animation: slide-up 0.3s ease-out;
        }
      `})]})}async function J_(e){try{const{error:t}=await de.from("notifications").insert([{user_id:e.userId,type:e.type,title:e.title,message:e.message,reference_id:e.referenceId||null,reference_type:e.referenceType||null,is_read:!1}]);if(t)throw t}catch(t){console.error("Error creating notification:",t)}}async function OS(){var e;try{const{data:t}=await de.from("app_settings").select("low_stock_threshold").maybeSingle(),r=(t==null?void 0:t.low_stock_threshold)||100,{data:n}=await de.from("batches").select("id, batch_number, current_stock, products(product_name)").eq("is_active",!0).lt("current_stock",r);if(n&&n.length>0){const{data:a}=await de.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","warehouse"]);if(a)for(const s of a)(e=(await de.from("notifications").select("id").eq("user_id",s.id).eq("type","low_stock").eq("is_read",!1).limit(1)).data)!=null&&e.length||await J_({userId:s.id,type:"low_stock",title:"Low Stock Alert",message:`${n.length} batch(es) are running low on stock.`})}}catch(t){console.error("Error checking low stock:",t)}}async function US(){var e;try{const{data:t}=await de.from("app_settings").select("expiry_alert_days").maybeSingle(),r=(t==null?void 0:t.expiry_alert_days)||30,n=new Date;n.setDate(n.getDate()+r);const{data:a}=await de.from("batches").select("id, batch_number, expiry_date, products(product_name)").eq("is_active",!0).not("expiry_date","is",null).lte("expiry_date",n.toISOString()).gte("expiry_date",new Date().toISOString());if(a&&a.length>0){const{data:s}=await de.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","warehouse","sales"]);if(s)for(const o of s)(e=(await de.from("notifications").select("id").eq("user_id",o.id).eq("type","near_expiry").eq("is_read",!1).limit(1)).data)!=null&&e.length||await J_({userId:o.id,type:"near_expiry",title:"Products Near Expiry",message:`${a.length} batch(es) will expire within ${r} days.`})}}catch(t){console.error("Error checking expiry dates:",t)}}async function PS(){try{const e=new Date().toISOString().split("T")[0],{data:t}=await de.from("crm_activities").select("id, customer_id, activity_type, customers(company_name)").eq("is_completed",!1).not("follow_up_date","is",null).lte("follow_up_date",e);if(t&&t.length>0){const{data:r}=await de.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","sales"]);if(r)for(const n of r)await J_({userId:n.id,type:"follow_up",title:"Follow-ups Due",message:`You have ${t.length} follow-up(s) due today.`})}}catch(e){console.error("Error checking follow-ups:",e)}}async function Qde(){await OS(),await US(),await PS(),setInterval(async()=>{await OS(),await US(),await PS()},3e5)}function Mde(){const{user:e,profile:t,loading:r}=Dr(),{currentPage:n}=Mo();if(Z.useEffect(()=>{e&&t&&Qde()},[e,t]),window.location.pathname==="/setup")return i.jsx(Tde,{});if(window.location.pathname==="/auth/gmail/callback")return i.jsx(Ide,{});if(r)return i.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})});if(!e||!t)return i.jsx(U7,{});const a=()=>{switch(n){case"dashboard":return i.jsx(EN,{});case"products":return i.jsx(fR,{});case"stock":return i.jsx(mR,{});case"batches":return i.jsx(yR,{});case"inventory":return i.jsx(wR,{});case"customers":return i.jsx(pR,{});case"sales-orders":return i.jsx(Ude,{});case"import-requirements":return i.jsx(Dde,{});case"crm":return i.jsx(Vne,{});case"command-center":return i.jsx(Zne,{});case"tasks":return i.jsx(tae,{});case"delivery-challan":return i.jsx(vde,{});case"sales":return i.jsx(wde,{});case"finance":return i.jsx(Cde,{});case"settings":return i.jsx(Fde,{});default:return i.jsx(EN,{})}};return i.jsxs(i.Fragment,{children:[a(),i.jsx(Rde,{})]})}function Hde(){return i.jsx(T7,{children:i.jsx(L7,{children:i.jsx(O7,{children:i.jsx(Mde,{})})})})}J3(document.getElementById("root")).render(i.jsx(Z.StrictMode,{children:i.jsx(Hde,{})}));export{Ir as _,ti as c,DS as g};
